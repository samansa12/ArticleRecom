tight upper lower bounds path length binary trees external path length tree sum lengths paths root external node maximal path length difference delta difference lengths longest shortest paths tight lower upper bounds proved external path length binary trees n external nodes maximal path length difference delta prescribed particular upper bound given value delta exactly achieved infinitely many values n improves previously known upper bound could achieved factor proportional n elementary proof known upper bound also presented preliminary result moreover lower bound proved exactly achieved value n deltaleq n2 b introduction binary trees constitute important widely used data structure storage retrieval information cost accessing information stored node proportional distance node root important measure efficiency often considered respect binary tree external path length externalt sum distances external nodes root related average cost unsuccessful search tree moreover external path length related internal path length sum distances internal nodes root corresponds average cost successful search tree well known external path length binary tree n external nodes thetan lg n best case worst case bad thetan 2 large gap best worst case motivates study important quantity additional information tree available nievergelt wong 7 proposed upper bound external path length tree term number external nodes maximum weight balance subtrees recently klein wood 5 obtained upper bound requires much less information tree namely derived upper bound external path length terms n number external nodes delta maximum differences lengths paths root external node case dipartimento di informatica ed applicazioni universita di salerno 84081 baronissi salerno italy part work done author visiting ibm research division j watson research ctr yorktown heights ny 10598 aiken computation laboratory harvard university cambridge 02138 partially supported nsf grant nsfccr9007677 part work done author visiting att bell laboratories new jersey usa n also constructed trees whose external path length within upper bound paper continue extend work 5 present upper bound external path length binary trees n nodes maximum path length difference delta construct infinite class trees whose external path length matches bound exactly moreover present lower bound external path length trees case delta n2 exist trees whose external path length matches exactly bound organization paper summary results paper study path length n deltatrees extended binary trees n external nodes maximum path difference delta section 2 set notation recall elementary facts binary trees section 3 present upper bounds preliminary result section 31 give simple derivation upper bound presented 5 section 32 improve result giving better bound delta exactly achieved infinitely many n section 4 present lower bound exactly compute n external path length tree shortest external path length lower bound first lower bound improve banal lower bound obtained considering binary tree external nodes two consecutive levels shortest external path length among trees number external nodes 2 background notation section set notation recall elementary facts binary trees denote set natural numbers n set positive natural numbers n set positive real numbers r writing dxe denotes least integer greater equal x throughout paper writing lg x denotes logarithm base 2 x trees considered paper extended binary trees extended binary tree obtained binary tree adding special nodes external nodes every node binary tree exactly two children originary nodes binary tree also called internal nodes say external node e level l tree length unique path root e l let n external nodes levels l external path length externalt defined internal path length tree internalt defined sum levels internal nodes path length binary trees 3 maximum path length difference fringet defined also level l last one said dense one external node last level dense two external nodes n deltatree binary tree n external nodes maximum path length difference delta delta follows n deltatree n deltatree paper give bounds epln delta epln delta restrict attention cases exists n deltatree cases completely characterized see section 4 following simple wellknown result extended binary trees see example 4 extensively used sequel fact 21 kraft equality let l l n sequence positive integers exists extended binary tree n external nodes levels l shall say n deltatree configuration l 0 1 2 external nodes level l 3 two n deltatrees configuration said isomorphic purposes tree follows omit l configuration either clear context immaterial 3 upper bounds section present upper bounds epln delta problem computing epln delta stated follows find maximum l subject 1 l 2 3 constraints l finding exact maximum appear easy task 31 simple proof known upper bound recently klein wood 5 proved following upper bound epln delta bound 1 e base natural logarithm 5 bound derived first proving external path length related ratio geometric harmonic means certain integers applying theorem specht 8 section rederive bound 1 using elementary calculus obtain upper bound epln delta allowing l range real numbers end maximum l sequences l satisfying following constraints 1 l 2 3 x l triplet n delta x exists sequence l satisfies three constraints called admissible clear upper bound external path length binary trees given epln delta maxfmn delta xjn delta x admissible x 1 following lemma gives useful characterization maximum mn delta x lemma 31 let n delta x admissible triplet maximum mn delta x achieved sequence l 1 l one equal either x x delta proof assume way contradiction maximum reached l 0 x l 0 define sequence l 00 n following way l 00 l 0 l 0 l 0 ffi chosen kraft equality holds 2 gammal 00 notice sufficiently small values ffl ie path length binary trees 5 00are x x delta since function increasing x equal 0 positive holds therefore ffl xg sequence l 00 n satifies three constraints definition mn delta x contradicting maximality l 0 n following lemma provides upper bound maximum mn delta x lemma 32 let n delta x admissible triplet proof lemma 31 maximum achieved l l delta kraft equality get see uniquely specified n delta x maximum mn delta x thus given gammay function function f delta hence lemma ready prove bound 1 theorem 33 e base natural logarithm proof combining lemma 32 1 get ae oe 2 function maximize concave function x easily seen using elementary calculus reaches maximum fixed values n delta delta substituting 2 get bound 1 6 de santis persiano 32 improved upper bound achievable infinitely many values previous section maximizations carried real numbers show restricting x integer get better bound bound presented section improves bound 1 two accounts first accurate second value delta exactly achieved infinitely many values n bound 2 let moreover delta exists infinite subset n delta n n 2 n delta exists n deltatree ndelta proof analysis done section 31 clear upper bound external path length binary trees given lemma 32 get integer phi ndelta x maximum ie phi ndelta x concave function x integer x satisfies 3 definition phi x obtain x satisfies 3 however integer power 2 equal 2 z z would factor delta2 zgammadelta thus delta impossible hence inequalities uniquely determine x proving bound path length binary trees 7 prove bound achievable let delta x positive integers h deltax function h deltax enjoys following three properties h deltax x indeed inequality equivalent 2 x satisfied x delta b h deltax x indeed written satisfied x delta 2 c h deltax simple algebra shows equivalent holds 1 three properties delta 2 x delta exists 1g h deltax deltax deltax 1 actually several deltax instance delta 2 consider infinite set n delta 1y deltal g fix delta n 2 n delta consider external nodes level l deltal 2 delta level l delta l first tree exists fact deltal kraft equality satisfied definition deltal obtain h deltal deltal deltal definition function h deltal lg l lg jm follows compute externalt turns exactly bound 2 fact one delta2 delta clear bound 2 accurate bound 1 fact every n delta 1 absolute maximum function phi 2 maximum function subject additional constraint x example 1 example consider case 5 binary trees satisfy bound 2 equality larger l example 2 plugging bound 2 obtain actually proved bound tight values n see 2 3 example 3 simple application bound 2 derive upper bound internal path length redblack trees class redblack trees constitute important class balanced binary trees guarantee worstcase search cost 1 bound obtain terms lower order equal one presented 1 proved asymptotically tight bound obtained observing redblack tree fringe logn 1 bound 2 increasing delta bound 3 let redblack tree n internal nodes refer reader 3 proof bound 4 lower bound section present lower bound exactly achieved n 4 2 delta n2 dealing general case let us briefly discuss cases see 6 complete treatment case easily settled exists n power 2 case n external nodes located level lg n tree unique hand n 1tree exists n power 2 case unique external nodes unique n 1tree located levels dlg ne gamma 1 dlg ne external path length ndlg ne following property n 1trees easily proved using kraft equality lemma 41 n 1tree exists c 0 external nodes level dlg ne c power 2 due c n none integers n n power 2 let us consider case delta n2 n 4 start characterizing n deltatrees minimum external path length prove theorem 45 trees belong class n deltatrees particular structure compute external path length trees structure obtain lower bound minimizing obtained external path lengths lemma 42 let n deltatree minimum external path length configuration l 1 two dense levels moreover two dense levels two levels consecutive 2 level path length binary trees 9 proof prove 1 proof 2 similar assume way contradiction tree two nonconsecutive dense levels minimum external path length case one two dense levels last one similar consider tree 0 configuration l 0 0 0 still n deltatree external path length thus cannot minimum external path length immediate cannot two intermediate levels one external node even consecutive fact suppose three levels one external node obviously least two must nonconsecutive going let us introduce following notation n deltatree type unspecified greater equal b 0 external nodes level l precisely configuration l 0 shall say n deltatree type l b 0 0 external nodes first b 0 levels 1 external nodes following b 1 levels configuration l times symbols b b denote respectively b levels external nodes less external nodes done configuration omit l say tree type b 0 context immaterial lemma 43 let tree type l 0 contains external node levels l exactly one external node type l 0 proof consider grandparent e two external nodes level l node two children one internal node parent two external nodes level l b child e cannot internal node would imply either level l 2 external nodes successive level external nodes thus level l exactly one external node prove induction case also proving lemma ready completely characterize configuration n deltatrees minimum external path length fact theorem 45 prove tree must n delta atree defined follows definition 44 n 4 define n delta atree following way 1 n delta gamma1tree n deltatree type 2 let 0 2g n delta atree n deltatree type 3 remark notice definition considered case log fact tree type l contains least 2 external nodes l 1 thus 2 a1 n lg n gamma 1 also notice using kraft equality easy see n delta atree exists unique see also discussion following lemma 46 theorem 45 n 4 n deltatree minimum external path length n delta atree gamma1 1g proof view lemma 42 n deltatree minimum external path length two dense levels levels preceeding dense levels except first one empty consider first case two dense levels dense levels first two levels lemma 43 tree type 2 2 1 deltagamma2 2 thus n delta gamma1tree instead last two levels dense tree type thus n delta finally two dense levels intermediate lemma 43 tree type 1 0 thus n delta atree consider case exists one single dense level level first tree n delta gamma1tree last level tree n delta otherwise tree n delta atree 0 2g lemma 46 0 x 1tree u configuration l 0 1 exists exists configuration l b x 1tree u configuration l 0 1 exists exists configuration l 0 c x 1tree u configuration l exists exists proof prove part lemma proofs parts b c similar brevity denote configuration l path length binary trees 11 b first c nonnegative integers 0 2 a1 moreover 0 1 gamma2 l1 0 1 using kraft equality existence one two trees implies sums equal 1 thus trees exist lemma implies fixed n delta exists unique delta atree fact lemma 46 naturally defines invertible mapping trees trees greater delta therefore n delta two nonisomorphic n delta atrees inverting mapping would construct two nonisomorphic trees number external nodes possible next lemma gives necessary sufficient conditions existence n delta atree computes external path length aim define function f n delta follows dlg xa n deltae1 gamma2 dlg xandeltae 2 a2 lemma 47 n 4 n delta atree exists interval xa n delta xa contain power 2 case external path length f n delta proof prove lemma 0 1g cases proved similar way suppose interval xa n delta xa contain power 2 lemma 41 since unique xa n delta 1tree least 2 a1 external nodes first level therefore hypothesis part lemma 46 hold thus n delta atree exists implication proved similar way compute external path length n delta atree use lemma 46 configuration n delta atree thus external path length completely determined configuration corresponding x 1tree expressed function l 0 1 turn depend value x thus compute external path length n delta atree tedious computation shows exactly f n delta next study behavior external path length n delta atree fixed n delta see external path length n delta atree bitonic function nonincreasing certain value ffdelta nondecreasing ffdelta integer part unique solution equation easily seen ffdelta equal either blg deltac gamma 2 blg deltac gamma 1 lemma 48 let n 4 1g n delta gamma 1tree exists f n delta proof difference f gamma delta equal hypothesis n delta gamma 1tree exists therefore lemma 47 interval contain power 2 delta 2 power 2 dlg definition xa gamma therefore lemma proved let us consider case xa power 2 case interval xa gamma contain power 2 therefore ffdelta delta hand ffdelta delta path length binary trees 13 lemma 49 let n 4 1g n delta gamma 1tree exist n delta atree n delta gamma 2tree exist f n delta proof proof lemma similar one previous lemma omitted refer reader 3 complete proof lemma 410 let n 4 delta n2 ffdelta n delta fftree exist n delta ff gamma 1tree n delta ff exist proof n delta fftree exists lemma 47 interval contains power 2 previous power 2 interval interval contain power 2 thus n delta ff gamma 1tree exists since xff gamma first inequality follows definition xa n delta second equivalent inequality holds thus proving n delta ff gamma 1tree exists existence n delta ff 1tree established similar way summarize lemmata saying n delta fftree exists interval xff n delta xff contain power 2 n delta fftree exist lemma 410 n delta ff gamma 1tree n delta ff exist minimum path length obtained either one thus proved following bound 4 n 4 delta n2 contain power 2 14 de santis persiano ff integer part unique solution equation x dlg xa n deltae1 gamma2 dlg xandeltae 2 a2 acknowledgements second author would like thank prof harry lewis suggestions also thank marios mavronicolas careful reading manuscript r internal path length redblack trees stacs 91 tight upper lower bounds path length binary trees coding information theory path length binary trees art computer programming upper bounds total path length binary trees zur theorie der elementaren mittel tr