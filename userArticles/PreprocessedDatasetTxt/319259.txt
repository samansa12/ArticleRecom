alignment using distributions local geometric properties abstractwe describe framework aligning images without needing establish explicit feature correspondences assume geometry two images adequately described affine transformation develop framework uses statistical distribution geometric properties image contours estimate relevant transformation parameters estimates obtained using proposed method robust illumination conditions sensor characteristics etc since image contours relatively invariant changes moreover distributional nature method alleviates common problems due contour fragmentation occlusion clutter etc provide empirical evidence accuracy robustness algorithm finally demonstrate method real synthetic images including multisensor image pairs b introduction image alignment variously known registration positioning etc amounts establishing common frame reference set images alignment essential step many tasks data fusion change detection pose recovery etc widely investigated various contexts good survey existing literature 4 traditionally transformation required achieve image alignment computed using either feature matching 13 search strategy optimises meaningful image similarity measure eg mutual information 19 normalised crosscorrelation 10 feature matching methods give accurate solutions obtaining correct matches features hard problem especially case images acquired using different sensors widely different viewing positions therefore methods use feature matching scenarios either use specific domain knowledge assume features well preserved two different views hand methods using similarity maximisation relatively insensitive variations sensor characteristics computationally expensive typically need good initial guesses ensure correct convergence therefore methods may converge local minima case images large transformations recently direct methods 2 11 17 lot success methods assume images aligned small transformation multiscale approach used measure image intensity similarity minimised using optimisation routines multiscale approach ensures convergence optimisation method transformation model gradually made complex simple translation euclidean affine best describe transformation images however methods limitation cannot guaranteed converge cases large transformation two images eg scale change large also images taken different viewpoints different radiometric properties eg pair visible infrared images images taken different lighting conditions direct method applicable 10 case multisensor images handled nonlinear filtering images emphasises high frequency components enhances discontinuities images however aligment scheme applied limited multisensor context methods correspondenceless restrictive either solve translation 1 assume image consists single unfragmented curve 12 15 assume images textured patterns 16 3 21 cannot handle noise andor occlusion robust fashion 6 paper propose alignment method overcomes limitations interest developing method robust mentioned variations handle large changes viewing positions well small ones contour c b contour figure 1 contour c rotated version contour c tangent lines corresponding points two curves indicated difficult directly relate intensity information across images geometric properties image discontinuities remain relatively stable ie boundaries regions change illumination changes etc geometric information contained stable image contours often sufficient determine transformation images utilisation geometric properties image contours estimate relevant transformation images key idea developed paper assume scene approximately planar relative geometry images adequately captured affine transformation fur thermore assume images contain atleast one contour extracted standard techniques treatment alignment problem discrete features like points lines see 18 develop intuitive understanding method use simple illustrative example consider contours shown fig 1 contour b rotated version one let rotation angle two contours aligning contours equivalent estimating rotation angle consider point p contour c corresponding point second contour cated circles slope angles tangents points p denoted psi respectively observe relationship holds every corresponding point pair contours hence rotation angle easily recovered measurements given point pairs however need establish point correspondences extract slope distribution c b slope distribution rotation angles c rotation estimate figure 2 b show distributions slope angles two contours c shows crosscorrelation distributions peak occurs correct rotation angle rotation angle instead note since relation holds every point pair also holds distribution measures image words denote p distribution slope angles contour simple relationship hence given two distributions slope angles two images recover rotation angle simple fashion done minimising norm jjp equivalent maximising crosscorrelation two distributions see fig 2 note probability distributions computed independently image without need establish feature correspondences idea extended transformation parameters transformation model consists n parameters reparametrised independent parameters parametrisation chosen way parameter g computable observed images using method develop section example euclidean transformation parameters used would rotation angle translations x directions new parameters estimated manner similar described case rotation angle notions formally developed different transformation models described section 3 discussions follow consider point p curve c image 1 corresponding point curve c image 2 local geometric properties measured points p called geometric descriptors denoted respectively chosen manner pair corresponding points p p g parameter transformation words pair operators chosen manner given corresponding pair points value related given value parameter g intuitively notation implies correct value parameter g functions identical values computed corresponding points p p notion key estimation process since enables us choose parameter satisfies relationship n parameter transformation would need establish n relationships using different transformation parameters g estimate transformation denote parameter g observable value recovered descriptor pair case rotationwe choose psi hence implies observable since value obtained thus n parameter transformation model recover transformation given n independent descriptors make parameters observable however since explicit correspondences available convert observability parameters descriptor pairs observability distributions descriptors given descriptor easily determine probability density function pd image computing value points along contours computing histograms computed values denote probability functions thus obtained images pd p respectively correct value g relationship hence observation distribution noise estimate g maximising similarity pd p practice observed distributions would identical p errors introduced image noise discretisation contours etc since true distributions errors analytically tractable assume errors well described monotonically decreasing noise process mode zero like gaussian laplacian etc describe estimator g given pdfs ie pd p follows theorem 1 given image pair descriptors dp p g maximum likelihood estimator mle g arg min g p p p observed probability measures respectively l n norm n 0 probability distribution function pdf observation noise assumed monotonically decreasing mode zero convenience shall henceforth denote gt g denote true probability distributions p observed distribution p modelled p know every possible distribution pair f p p g relationship p holds notational convenience denote conditional probability measures p djg p djg respectively therefore using observation model estimating mle defined ip denotes probability observations p 2 words maximise probability jointly observing two probability distributions p p images respectively given observation model get due monotonicity noise model observe triangle inequality eqn 2 know therefore pg pg since right hand side equation 4 equal k assumption independence noise 1 note true distributions p p random variables since given image pair distribution geometric properties deterministic hence distributions treated general functions p observations extract images arg min g hence maximum likelihood estimator parameter g given eqn 1 effect theorem states determine optimal estimate transformation parameter maximising similarity two distributions descriptor sets case gaussian noise model estimation process amounts picking parameter minimises least squares error two distributions two images 3 transformation models following subsections examine specific transformation models show estimate relevant parameters shall denote points first image second image transformation model adopted denotes 2d translation vector matrix denotes 2 theta 2 invertible matrix henceforth shall refer matrix transformation matrix 31 euclidean euclidean transformation parametrised three parameters rotation angle two translation parameters x compute rotation choose descriptors dp p slope angles points curves two images example shown fig 1 rotation value computed using mle defined compensated rotation images compute xdirection translation x two images using xcoordinate point p ycomponent translation also computed similar fashion note estimation process different traditional method taking difference centers mass two sets contours method comparing distributions robust estimator unlike mean see section 4 experimental comparision 32 similarity compute similarity transformation need compute additional scale parameter since radius curvature r point directly proportional scaling parameter p deduce hence simple additive relationship also since radius curvature independent slope angle compute scaling rotation parameters independently 33 quasiaffine consider case quasiaffine transformation defined form case curvature slope angles longer independent however reparametrise eqn 8 aea cos sin sy compute determinant transformation jt consider following curves c c parametrised indices respectively 2 theta 2 matrices p defined ps p denote derivatives respect appropriate parametrisation curves x x note ds ds see 5 details parametrisation chosen ds ds simple relationship therefore use pj compute determinant transformation scaling curves get new relationship aea cos sin sin cos rotation angle computed manner invariant ratio scales ae 2 use relationship two sides eqn 11 equated dp solved parameter ae satisfies relationship implies x thus also solve parameter ae hence recover transformation matrix 3 translation recovered 34 affine consider general case affine transformation two images described equation b c da 15 nonsingular matrix case need compute four independent parameters transformation matrix accomplished following manner determinant jt j computed manner described previous subsection use simple relationship x x 3 note eqn 12 known since estimated using eqn 11 simple reparametrisation parameters equation get x x solve ratio using lefthand side eqn 16 dp righthand side similar analysis recover ratio c using relationship finally since know ratios observe c ratio b computed taking logarithm sides equation 4 unknowns 4 different relationships parameters denote c substituted relationship jt using relationship solve value using relationships derive value matrix sign ambiguity easily resolved considering correctness transformations applied image contours may noted reparametrisation b c results finite range possible estimate values new parameters ie range oe gamma may also noted using equations could compute either ratios ie b c c see section 4 details used robust estimation translational component recovered manner identical previous cases emphasised cases chosen computations two sides equality relationship carried independently two different images choice enables us eliminate need correspondences 4 implementation evaluation section describe method implemented practice following consider various issues arise implementation practice method also present empirical evaluation performance 41 implementation subsection detail practical issues implementations method results detailed section 5 obtained applying fully automatic techniques cannylike edge detector used extract curves segments curves smaller 20 pixels discarded subsequently relevant differential properties estimated along curves images distributions computed estimate transformation parameters ffl derivative computation important issue implementation accurate computation differential properties general sensitive noise shown 20 using gaussian smoothing kernel fit curves computing derivative discrete contour incorrect since estimator biased overcome problem use method robust computation derivatives detailed 14 method involves least squares fitting continuous function using polynomial orthogonal bases neighbourhood centered discrete point interest computations closed form solutions exist form convolution kernels derivative easily computed convolving curve kernels found estimates derivatives using method stable even cases noise added curves ffl discrete distribution representations since use finite number bins compute distributions geometric properties need choose bin size accuracy estimation interested example want compute angle oe represents estimate affine case values c within accuracy 05 ffi need use least 720 bins appropriate distribution also since distributions computed assigning descriptor measure appropriate bin computational complexity directly related number points curves geometric descriptors computed fact n points curves seek resolution accuracy delta computational complexity n however computational load substantially reduced adopting multiresolution technique example case estimation angle estimate angle coarser resolution say 2 ffi refine estimate computing correct angle finer resolution around current estimate important case parameter separable eg affine case case estimation mle amounts search space possible solutions nonoptimised implementation affine parameter estimation matlab computation time typically order tens seconds sparc ultra 1 faster implementations easily conceivable may also noted case parameter separable ie expressed function geometric descriptors alone eg rotation euclidean model scale similarity model estimation parameter straight forward maximisation correlation two different parametrisations figure 3 points shown two curves ones would closest correspondences different parametrisation curves achieved using convolution hence estimation considerably faster cases computational time order seconds regard accuracy may noted estimation fractions c use tangent function could lead inaccurate solutions estimated angle oe close 90 ffi however cases may noted close 90 ffi ratio b would close 0 estimated accurately without instabilities strategy adopt implementation angle tan gamma1 estimated required switch representation parametrisation uses ratio b instead applies ratio c ffl parametrisation curves estimation accuracy also dependent manner curves parametrised noted section 33 curves parametrised ds ds sampling geometric properties uniform intervals curve would correct since every point sample curve would ensure sample corresponding point transformed version however method necessary parametrise curves manner satisfy criteria since finite number bins representing distribution points values within fraction bin size would fall within bin show true consider following fig 3 show curve two different parametrisations also indicate series points curves according two independent parametrisations let step size cases delta obviously satisfy relationship ds ds sets points would correspondence hence measurement geometric properties would equivalent upto parameter want estimate consider case ds ds 1 let geometric property measure denoted f set geometric descriptor values measured first instance ffg would values computed points according parametrisation second case f values computed points according parametrisation would measured different set points according parametrisation every point first set would neighbour within distance delta second set therefore assume df ds bounded ds dh f hausdorff distance 9 sets f f thus lim delta0 delta0 therefore sample curves densely enough would ensure every point sampled first image would sample point close enough corresponding point second image implies effectively capture statistical nature two distributions without needing correct parametrisation found true course experimen tation simple arclength parametrisation followed uniform sampling found sufficient figure 4 images left 25 overlap correctly registered images shown right half image ffl iterative refinement one underlying assumptions method scenes imaged ie contours two images arise area hence minimising metric would result correct estimate transformation parameter ever case overlapping areas image small ie say less assumption cannot true hence parameter estimates may correct however applying estimated transformation images increase percentage overlap hence better approximate assumptions common scene found extracting overlapping areas applying initial estimate recomputing transformation using areas get correct transformation estimate illustrate example fig 4 two images left extracted larger image images size 300 theta 300 relative translation images 150 pixels x directions overlap 25 initial estimate translation 151124 pixels estimated translation applied images overlapping areas two images extracted common area 80 hence new images better approximation underlying assumption common scene required transformation recomputed new estimate found correct ie 150150 pixels registered images shown right half fig 4 found similar cases little overlap correct registration achieved applying one two iterations method general parameter estimate assumes previous estimates correct hence stagewise errors accumulate however stage since error bounded maximum possible error also bounded practice problem found significant moreover easily corrected either increasing resolution estimates stage increasing number bins recomputing transformation using idea iterative refinement described ffl multiple peaks method estimation parameter amounts maximisation given metric therefore need detect largest peak given function case computation rotation see multiple peaks see fig 2 correct one ideally prominent however uniqueness correct solution may violated many practical scenarios eg lot clutter high amounts fragmentation small amount image overlap cases since underlying distributions longer arise curves onetoone correspondence across images get spurious peaks particular case rectangular buildings aerial images since buildings typically strong edges oriented 90 ffi apart would get peaks 90 ffi away true solution tackle situations using simple verification process eliminate spurious peaks case rotation easy see estimate verified accuracy registering curves edges observed choosing wrong peak would result totally incorrect alignment results thus cases multiple competing solutions particular parameter maintain possible solutions progress estimation process eliminate spurious solutions arrive unique solution practice observed 3 different estimates need consider choosing correct one 42 evaluation characterising accuracy robustness algorithm typically additive white gaussian noise assumptions made observed data however method possible propagate assumptions arrive appropriate noise models final representations used estimation process example even assume image noise gaussian extremely difficult cumbersome model error resultant distribution slope angle geometric property measure since number processing steps involved moreover particularly strong assumption many image alignment methods eg moment based methods make curves complete ie fragmented practice seldom case fact one prime motivations development method uses distributional representation alleviate problem missing data due curve frag mentation circumstances important determine robustness alignment methods however since possible accurately model process curve fragmentation need take recourse empirical evaluation evaluate accuracy robustness proposed algorithm carried following evaluations ffl translation accuracy comparision mean estimation ffl rotation accuracy comparision moment based methods ffl robustness affine estimation noise ffl robustness affine estimation fragmentation standardise evaluation used test pattern test pattern shown fig 5 test accuracy translation method subjected test pattern translation 10 20 pixels form second curve subsequently test translated patterns randomly fragmented extent 10 25 total lengths lost estimated translation using method compare accuracy method also computed translation standard method taking difference centroids two curves experiment repeated 1000 times results tabulated table 1 form means standard deviations two estimators easily noted method accurate robust simple process taking mean 10 fragmentation 25 fragmentation method mean std mean std true value 10002000 10002000 method mean based 9582125 258 8372256 786 table 1 comparision translation estimation accuracy 1000 experiments true translation 1020 table shows mean estimates position standard deviation method meanbased method two different fragmentation levels method mean error std dev error method 017 moment based 124 table 2 comparision rotation estimation accuracy 1000 experiments conducted 25 fragmentation compare accuracy rotation estimation used ellipse tested recovery rotation ellipse rotated angle chosen range gamma original ellipse test ellipse subjected fragmentation 25 total lengths recovered rotation angle using method sake comparision also used moment based method solving rotation angle using moment equations recover angle rotation experiment repeated 1000 times different rotation angles absolute error computed cases table 2 shows results two cases mean standard deviation absolute error shown noted method rotation estimation accurate moment based one like case translation nonrobust estimator due integrative nature moment functions case moments computed cannot separate contributions spurious curve segments etc context would like point traditional image alignment techniques use moments different manner cases moment invariants used matching features algebraic equations solved calculate required alignment transformation 7 quite different using moment based approach compute transformation without using explicit matching cases use moments calculate transformation eg 15 make strong assumptions scene single contour fragmentation assumptions imply explicit matching constitute general correspondenceless technique figure 5 test pattern used evaluation affine alignment accuracy level average registration error b figure figure left shows example noise contamination noise white gaussian standard deviation 1 pixel graph right shows average error different noise levels notice alignment quite reasonable even extremely high levels noise evaluate estimation accuracy affine parameter estimation method test following cases ffl estimation accuracy noise ffl estimation accuracy fragmentation case estimation noise apply known affine transformation test pattern shown fig 5 subsequently add white gaussian noise different standard deviations 025 every point test pattern one instance shown fig 6 evaluate accuracy estimated transformation use estimate warp back transformed contour onto original test pattern measure root mean square error rmse obtained b figure 7 circle figure left outlier appear second image dotted curve figure right shows registration achieved presence contaminating outlier noticed alignment quite reasonable given high levels contamination due outlier easily refined get correct estimate figure 8 fragmented transformed version test pattern test pattern estimated aligned pattern average rmse errors different noise levels shown fig 6 b observed performance estimator degrades gracefully gives reliable estimates even severe amounts noise shown fig 6 study effects outliers estimation process consider scenario fig 7 large circle present second image hence corrupt distributions different geometric properties case effect presence circle severe since contributes large numbers samples distributions however observed fig 7 estimate transformation reasonable considering severe amounts contamination given estimate easy reject outliers reestimate transformation get correct solution affine transformation two images evaluate method fragmentation contours used test pattern shown 10 fragmentation 25 fragmentation measure pixels pixels median 045 097 mean 058 111 std dev 027 072 table 3 rmse 1000 experiments fragmentation fig 5 subjected affine transformation used evaluation robustness noise fragmented contours estimated transformation considered fragmentations 10 25 total length repeated experiments 1000 times case one instance fragmented pattern shown fig 8 results tabulated table 3 noted estimation process fairly robust even severe fragmentations order 25 pixels contours section present results obtained applying method variety images technique used examples implementation detailed section 4 figure figure image affine transformed version figure 9 image affine transformed version fig 9 shows synthetic image affine transformed version resulting registration achieved shown fig 10 subpixel accuracy root mean squared error rmse 05 pixels fig 11 show registration achieved 25 image occluded observed result registration accuracy affected since nature registered images figure 10 alignment result images fig 9 transformed contours second image shown dotted curves distributions altered extent mles significantly perturbed fig 12 shows mosaic constructed aligning images video sequence common frame reference using euclidean model sequence obtained handheld camera involved translation rotation case euclidean model sufficient achieving accurate alignment fig 13 shows alignment aerial images mojave desert obtained balloon flying area alignment achieved accurate evident alignment image features like roads rock outcrops etc fig 14 show results aligning pair images landsat thematic mapper tm images different bands electromagnetic spectrum therefore different radiometric properties images correctly aligned observed continuity coastline alignment features run across two images fig 15 shows results obtained another pair landsat tm images used quasiaffine transformation model achieve alignment figs 13 14 15 illustration algorithm affine transformation estimation show two examples different application domains 16 show registration achieved two mri images different modalities image left fig 16 proton density mri image one middle corresponding t2 weighted image subjected arbitrary affine transformation image right shows alignment single contour different modalities may noted correct alignment achieved inspite difference photometric properties images alignment refined necessary using standard energy minimisation techniques original image occluded transformed image registered image figure 11 alignment occluded image transformed version occluded image shown registration achieved within subpixel accuracy finally demonstrate applicability method alignment multisensor images large transformations fig 17 show two satellite images river taken spot tm modalities observed image intensity patterns quite different therefore intensity based direct method directly applicable moreover relative scaling images large 14 large scalings seldom dealt using optimisation schemes alignment two images shown fig 18 use checkerboard pattern illustrate alignment two images different sensors minor discrepancies exist alignment probably due deviation images affine model overall alignment good especially given large scaling two images desired final alignment easily refined using different techniques examples illustrate ability algorithm achieving correct alignment variety possible scenarios also demonstrated method gives good performance broad range cases especially case transformations images large small amount overlap images something energy minimisation methods would fail achieve 6 discussions advantage method fact use method computing alignment cases possible since use distributional framework local geometric frames b mosaic figure 12 mosaic created video sequence frames used shown properties estimate transformation parameters result method works well images large transformation images small transformations always case energy minimisation methods typically require solution started fairly close true solution avoid trapped local minima also explicit need domain dependent knowledge avoided since image primitives use contours usually extractable using standard edgedetection techniques believe significant advantage case multisensor images since methods deal multisensor image alignment utilise specific knowledge imaging geometry radiometry tune algorithms work specific domains application use distributional method significant advantages fragmentation contours easily handled since local geometric properties still computed fragments without significant loss information possible since contour say length 200 pixels fragmented many segments add say 180 pixels total length still 180 points compute geometric properties probability distribution estimate significantly changed therefore observe graceful degradation method increasing loss information due occlusion fragmentation demonstrated evaluations robustness would possible use traditional global techniques like moments unless special care taken handle change shape due occlusion fragmentation easy note results momentbased method would perturbed significantly due small amounts fragmentation contours method would still give correct estimates voting based schemes combinatorial explosion possible solutions need checked increase dimensionality search space significantly figure 13 alignment set aerial images number observations increased since voting schemes use possible combinations hypothesised feature matches populate space possible solutions search maxima space case two advantages regard firstly computations carried independently image final stage two distributions compared secondly stage parameter estimation onedimensional since parametrise transformation set independently estimated parameters result computational load reduced also detection peaks onedimensional functions easier higher dimensions especially noisy scenarios demonstrated examples theoretical framework developed works well many reallife examples existence clutter occlusion fragmentation image contours violate underlying assumptions method robust enough able easily handle problems however would advantageous modify metric minimise take account knowledge scene determine parts image contain areas visible images parts occluded etc modify metric exploit information make method robust one limitation framework scene assumed approximately planar may case scenarios perspective effects images dominant however still use method get reasonable estimate true transformation figure 14 alignment landsat tm images different bands figure 15 alignment two landsat tm images figure image left proton density image one middle t2 weighted image right shows registration single contour two modalities 7 conclusion described framework image alignment use explicit feature correspon dences demonstrated effectiveness explained advantages using distributional framework computation parameters required image alignment framework robust general many existing methods acknowledgments would like acknowledge e rignot b manjunath maintainers ucsb image registration web site providing data sets used paper would also like thank r chellappa z duric j oliensis comments paper r robust correspondenceless translationdetermining algo rithm hierarchical modelbased motion estimation shape texture estimation isotropy moments survey image registration techniques invariant signatures planar shape recognition partial occlusion recovering 3d rigid motion without correspondence momentbased approach registration images affine geometric distortion image registration without explicit point correspondences comparing images using hausdorff distance robust multisensor image alignment recovery egomotion using image stabilisation recovery global nonrigid motion model based approach without point correspondences contourbased approach multisensor image regis tration smooth differentiation filters images using moments acquire motion parameters deformable object without correspondences extracting affine transformation textured moments compact representations videos dominant multiple motion estimation multisensor image registration using feature consensus alignment maximization mutual information noise resistant invariants curves recovering surface shape orientation texture tr ctr rujirutana srikanchana jianhua xuan matthew freedman charles c nguyen yue wang nonrigid image registration neural computation journal vlsi signal processing systems v37 n23 p237246 junejuly 2004 kenneth nilsson josef bigun localization corresponding points fingerprints complex filtering pattern recognition letters v24 n13 p21352144 september christophe doignon dominique knittel detection noncircularity eccentricity rolling winder artificial vision eurasip journal applied signal processing v2002 n1 p714727 january 2002 bogdan georgescu peter meer point matching large image deformations illumination changes ieee transactions pattern analysis machine intelligence v26 n6 p674688 june 2004