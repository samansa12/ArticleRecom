fast multigrid solution advection problem closed characteristics numerical solution advectiondiffusion problem inviscid limit closed characteristics studied prelude efficient high reynoldsnumber flow solver demonstrated heuristic analysis numerical calculations using upstream discretization downstream relaxation ordering multigrid cycle appropriate residual weighting leads efficient solution process upstream finitedifference approximations advection operator derived whose truncation terms approximate physical laplacian viscosity thus avoiding spurious solutions homogeneous problem artificial diffusivity dominates physical viscosity brandt yavneh j comput phys 93 1991 pp 128143 b introduction efficient multigrid algorithms numerical solution partial differential problems normally require good ellipticity measures scales problem implies nonsmooth solution components resolved local processing 2 problems small ellipticity measures marked either indefiniteness anisotropies latter case technionisrael institute technology haifa israel university twente enschede netherlands z weizmann institute science rehovot israel exist socalled characteristic directions strong dependence nonsmooth components solution advected along char acteristics hence cannot resolved locally 1 typical example steady flow high reynolds numbers small viscosity applied problems small ellipticity usual multigrid algorithms often exhibit severe degradation performance compared seen elliptic problems indeed multigrid codes use today solving steady flows high reynolds numbers although yielding great improvement previous singlegrid solvers fall far short attaining socalled textbook multigrid efficiency general even smooth flows regain efficiency multigrid algorithm requires modifications take account anisotropic properties operator example shown 4 9 using upstream discretization downstream relaxationordering yields fully efficient multigrid solver flows whose characteristics streamlines start part boundary end another without recirculating entering flows obtain efficient multigrid solvers flows closed characteristics however different modifications proposed defectcorrection cycles residual overweighting 5 main drawbacks latter approaches likely generalize efficiently orders accuracy higher one b require w cycles may substantially expensive simple v cycles parallel computation c suggest different treatment different types flow viz recirculating versus entering flows upshot present work obtain unified approach types flow employing upstream discretization downstream relaxation ordering recirculating flows well section 2 formulate simple model problem advectiondiffusion present first differential approximation discretized form section 3 present twolevel cycle use approximation section 2 heuristic analysis priori prediction performance algorithm section 4 new firstorder upstream discretizations advection operator presented whose first truncation terms approximate isotropic diffusivity schemes shown eliminate spurious solutions homogeneous ie unforced smallviscosity advectiondiffusion equation reported 3 section 5 presents numerical calculations testing accuracy discretization efficiency multigrid algorithm compares predictions section 3 section 6 summarizes main conclusions research plans 2 scalar advectiondiffusion equation study scalar advectiondiffusion equation closed characteristics prelude study flow problems equation serves well preliminary problem since advection part ie momentum equations responsible degraded performance observed solution incompressibleflow equations usual multigrid algorithm 5 also shown entering flows 4 solutionprocess advection part system effectively decoupled elliptic part due continuity equation hence efficient solution advection problem necessary stage development fully efficient flowequations solver 4 suggests resulting advectionproblem solver indeed used designing soughtafter flowsolver advectiondiffusion equation two dimensions ffl positive constant b f g given functions x equation 1 discretized uniform grid meshsize h whose gridlines lie parallel x coordinates characteristic direction advection operator 1 given locally oe local angle nonalignment x coordinate characteristic direction focus attention particular case characteristics defined b form closed loops vortices one may coincide omega internal flows suppose 1 discretized stable finitedifference discretization firstorder accuracy main aspects problem analyzed substituting discrete operator first differential approximation 8 also 1 2 9 advectiondiffusion equation positive vanishingly small ffl need consider advection oper ator since tiny diffusion dominated artificial diffusivity represented truncation terms except stagnation points let l h denote firstorder accurate discrete approximation advection opera tor taylor series expansion generally u h denotes discretized function h meshsize uniform grid functions x specific details determined b discretization fda approximation l h differential operator remains 2 oh 2 terms neglected hence applies sufficiently smooth u h since neglected terms higher derivatives assume simplicity discussion equation normalized 2 introduce conformal local coordinate system j denotes local streamwise coordinate parallel characteristic direction j denotes crossstream coordinate perpendicular characteristic thus fda l h local coordinate system therefore 2 4 assume consistent stable discretization requires artificial viscosity operator represented first truncated term elliptic implying oh part operator 5 positive type special circumstances consistent alignment characteristics grid h vanish property marginally violated case physical diffusion term becomes important matter small ffl may analysis apply accordingly assume h 1 large compared h usual case 3 twolevel errorreduction analysis analyze error reduction attainable twolevel cycle using upstream discretization downstream relaxationordering 31 twolevel cycle proposed twolevel cycle given discrete problem l h u defined follows ffl starting approximation u h perform 1 small integer relaxation sweeps ffl calculate residuals r u h current approximation solution transfer twicecoarser grid 2h multiplied globallyuniform weight w ffl solve coarsegrid problem l 2h v correction r 2h restriction r h coarse grid ffl interpolate add correction v 2h finegrid approximation ffl perform 2 small integer finegrid relaxation sweeps studying asymptotic performance twolevel cycle number prerelaxation sweeps 1 need distinguished number postrelaxation sweeps 2 recall associate asymptotic performance spectral radius ae iteration matrix aeab aeba pair square matrices b dimension denote total number sweeps analyzing twolevel cycle shall make many simplifying assump tions degree assumptions justified needs judged degree numerical results match predictions analyses 32 model problem analysis analyze twolevel convergence discrete approximation 1 limit vanishing ffl problems closed characteristics considering following model problem grid h l h discretization advection operator domain solution boundary conditions require periodicity order simulate closed characteristics choose simplicity discussion 2 0 1 boundary conditions crossstream direction germane present context simplicity let main point approach use discretization purely upstream relax equation downstream ordering starting ordering means relax variable relaxing unknowns participate equation corresponds variable except perforce thus full relaxation sweep results elimination residuals except narrow band oh width stretches coincides due periodicity neglecting width band find residual function r h remains least one full relaxation sweep carried modeled r h finegrid error v h satisfies residual equation wherever residual vanishes revert fda obtaining defined 5 add simplifying assumption 5 independent j hence may expand 8 fourier series j error component expij frequency equations 5 8 yield oh terms first neglected homogeneous equation since multiply derivatives therefore small compared dv h solution 9 interval 0 1 therefore given z h ds h amplitude v h shall determine shortly superscripts denote infinitesimal positive negative incre ment particular 1 average value h 1 entire domain assumption j gammaindependent recalling domain length direction one important note dh approximately factor single relaxation sweep amplifies reduces error component oscillates frequency j direction due fact given upstream differencing downstream relaxation ordering yields numerical integration dh factor integration domain reduces error equation 11 implies relaxation reduces error components large efficiently components smooth along j need corrected coarse grid fda longer useful instead jump v h proportional fourier coefficient r h j corresponding frequency denote jump ffi h periodicity implies 10 11 h following twolevel algorithm attempt approximate weighted residual equation coarse grid 2h assume discretization stencil used coarse grid fine note important assumption entire method hinges also assume restriction operator jump condition approximated correctly coarse grid practice holds provided proper averaging used fullweighted residual transfers analogously 1011 12 respectively obtain z 2hs ds 2h w constant weight chosen since stencils l h l 2h also assume also since assume restriction operator transfers jump condition correctly ffi 2h equations 12 15 16 yield 2h h neglecting effects intergrid transfers aliasing assume remaining error adding coarsegrid correction hence finegrid error amplified factor v h addition relaxation sweeps performed fine grid amplify error dh noted twolevel erroramplification factor tl given absolute value product terms note however determining values coarsegrid correction term depend one begins relaxing fine grid immediately following coarsegrid correction since finegrid values end one sweeps determined solely values relaxation begins due upstream differencing downstream relaxation ordering fine grid relaxation begins shortly point residual nonzero 2h h however finegrid relaxation begins small overlap region relaxed h 33 optimal residual weighting 11 order obtain hindependent analysis assume take value interval 0 1 optimal value w minimizes supremum tl 1 fixed w supremum evidently obtained either 18 19 thus obtain dm function w calculate w opt value w yields fastest convergence either cases 18 yielding larger tedious calculations need carried numerically w opt tends 2 cases rather quickly expected since value ratio greens functions coarse fine grids components smooth crosscharacteristic direction components reduced relaxation obtain 18 19 equating derivative 20 respect zero get relevant root twolevel erroramplification factor obtained substituting 21 20 sufficiently small gamma2 may neglect term obtaining fact 22 gives excellent approximation maximal tl 20 erring less 2 2 curious coincidence asymptotic twolevel erroramplification factor large 2e gamma1 obtained poisson equation rectangle using gauss seidel relaxation redblack order 7 thus analysis leads us expect efficiency comparable obtained poisson problem example 1 apply algorithm advectiondiffusion problem closed characteristics used 10 originally 6 0 1 ux advection term use discretization used finest grid 6 10 standard upstream su defined use value stagnation point adding viscosity elsewhere maintain upstream discretization since physical viscosity dominated artificial viscosity elsewhere anyway difference small alternatively could use much smaller ffl everywhere levels grid w 1 w 2 mgd9v table 1 number cycles necessary reduce l 2 residual norm factor 10 8 example 1 problem taken 10 mgd9v automatic method de zeeuw used 10 initial guess u inomega zero cycle l 2 norm residuals reduced 10 gamma8 times initial value performed test 4 5 6 7 8 levels coarsest grid always 5 theta 5 including boundary points 10 used v11 cycles throughout usual fullweighted residual transfers bilinear terpolation see section 5 details implementation relaxation table 1 compare results w1 2 reported mgd9v automatic method de zeeuw available six levels using socalled sawtooth cycle one illu incomplete line lu relaxation sweep per level must stressed efficiency robustness method convincingly demonstrated 10 results achieved ten problems including nonrecirculating advection diffusion far better evidently present method performs well efficiency comparable elliptic equations simple test problem clearly downstream relaxation ordering sufficient recirculation problem illu mgd9v present method residual overweighting show clear deterioration grid refined proper overweighting convergence rate remains excellent even fine grids reiterate residual overweighting approach may apply mgd9v since different stencils used different grids requiring different overweighting 34 several bands residuals may always easy obtain single band residuals per vortex happens relaxation carried piecewisedownstream ordering would case domaindecomposition setting example analysis extended case several bands nonzero residuals remain relaxation found one requires two coarsegrid corrections optimal weights 1 2 approximately seems imply w cycle required situation also one must use upstream intergrid transfers avoid averaging interfaces subdomains may actually cause divergence 4 discretization flows streamlines start end boundaries constitute closed curves require special considerations discretization cases even small viscosity plays important role determining main flow throughout domain solution limit vanishing viscosity depends strongly coefficients tend zero effect advection terms determine behavior solution along streamlines whereas viscous terms determine crossstream form since boundary often streamline propagation information boundary domain governed viscous terms matter small may effect discussed detail 3 9 shown advectiondiffusion problem incompressible navier stokes equations solutions schemes numerical viscosity anisotropic different viscosity coefficients crossstream streamwise directions standard upstreamdifference schemes may spurious general case shown even isotropic viscosity sufficient convergence solution one must actually specify uniform viscosity know retaining purely upstream structure see remarks section 6 however homogeneous advectiondiffusion problem several indications though proof isotropy suffices shown also 3 9 also shown numerical example suffice incompressible navier stokes equations consistent fact vorticity navier stokes equations satisfies homogeneous advectiondiffusion equation obtain discretization scheme exhibits appropriate physical like behavior vanishing viscosity must thus either add sufficient explicit isotropic viscosity dominate artificial viscosity discrete advection operator else derive discretization advection operator satisfies condition isotropy lowestorder truncated terms since want scheme remain purely upstream follow latter approach consider standard upstream scheme 23 assume simplicity discussion b 0 2 taylor expansion hence order obtain isotropic artificial viscosity may either add approximation 05ha gamma bu xx else subtract approximation 05ha gamma bu yy order retain upstream scheme define additional viscosity point gamma general b obtain first case isotropicviscosity upstream scheme ivu1 defined ja ij j jb ij j otherwise second case obtain scheme ivu2 defined ja ij j jb ij j otherwise i1 j1 defined 23 similarly first truncated term scheme ivu1 thus gamma05 minja ij j jb ij jdeltau ivu2 gamma05 maxja ij j jb ij jdeltau schemes isotropic artificial viscosity ivu1 smaller fact vanishes upon alignment characteristic directions grid discretizations stable downstreamordered gaussseidel relax ation former nonnegativeweighted average standard firstorder secondorder upstream schemes stable relaxation latter produces mmatrix expected stability problems many numerical calculations 5 numerical experiments first test numerically discretizations derived section 4 model problem standard upstream scheme shown yield spurious solutions 3 9 asymptotic error reduction twolevel multilevel cycles investigated several problems 51 accuracy test accuracy different discretizations tested model problem b given coefficients example 2 picture characteristics appears figure 1a domain solution unit square centered origin square diagonal 05 whose sides form 45 degree angle axes removed center outer boundary prescribed inner boundary solve problem three upstream schemessu ivu1 ivu2 also nonupstream isotropicviscosity scheme used 3 denoted iso viscosity added solutions compared obtained standard secondorder upstream scheme physical viscosity coefficient 0001 latter solution obtained 257 theta 257 grid grid su ivu1 ivu2 iso 129 theta 129 00750 00057 00163 00098 table 2 l 1 difference norms solutions obtained several schemes different resolutions highaccuracy solution obtained grid 257 theta 257 see text details three isotropicviscosity schemes seen yield convergent solutions standard upstream su scheme table 2 present l 1 norms differences test solutions various resolutions secondorder accurate solution restricted corresponding grid injection since solution smooth physical viscosity dominates secondorder truncation terms high resolution latter solution assumed accurate evidently three schemes isotropic artificial viscosity produce convergent solutions su scheme despite fact average viscosity smaller ivu2 iso ivu1 least artificial viscosity four schemes tested produces smallest error 52 efficiency tests remainder numerical calculations aimed testing performance algorithm various configurations comparing analytical predictions section 3 test su scheme widely used firstorder scheme ivu1 scheme accurate ivu2 also employs fourpoint stencil tests use firstorder upstream residual restriction bilinear interpolation corrections restriction performed follows even j fine grid define i1 j1 23 restrict corresponding coarsegrid righthand side coarsegrid point i2 j2 average finegrid residuals points j i1 j j1 i1 j1 restriction gives slightly better results standard full weighting multivortex problems since residuals less likely transferred one vortex another finest grid tests 129 129 six levels employed except twolevel tests include physical viscosity except stagnation points required wellposedness calculate convergence factors follows boundary conditions righthand sides chosen zero choice immaterial linear problems allows us normalize solution constant factor every cycles order avoid roundoff errors initial solution field pseudo random 100 cycles performed calculate convergence factor geometric average errorconvergence per cycle last 80 cycles averaging used cases convergence history smooth value corresponding particular cycle may carry much meaning however noted cases convergence factors vicinity optimal w sensitive exact choice w example 2 first test efficiency problem used test discretization without inner island pure recirculation everywhere characteristics problem form single clockwiserotating vortex plotted figure 1a relaxation sweep implemented sweeping four times domain sweep relaxing roughly one quarter variables follows first sweep variables locations ax bx nonnegative relaxed designated first quadrant second sweep variables corresponding locations ax nonnegative bx nonpositive relaxed second quadrant third sweep variables locations ax bx nonpositive relaxed third quadrant fourth sweep variables corresponding locations ax nonpositive bx nonnegative relaxed fourth quadrant fi nally stagnation points case one relaxed last entire process comprises single clockwise sweep course quartersweep performed downstream order ie x increasing first quarter increasing decreasing second etc efficient store order relaxation entire sweep setupsweep costs little full clockwise sweep costs nearly ordinary lexicographic gaussseidel sweep note specify nonnegative nonpositive descrip tion ensured boundaries quadrants included quadrant important tests clockwise sweep indeed eliminates residuals except along narrow band extends center vortex boundary vortex rotates counterclockwise several bands would remain hence examples 35 clockwise counterclockwise vortices exist would general case perform analogous counterclockwise sweep following clockwise one quadrant counterclockwise sweep starts bearing performance experiments use exactly reverse order allows us save work performing counterclockwise sweep three quadrants since fourth quadrant ax nonpositive bx nonnegative relaxed clockwise sweep thus begin third quadrant b nonpositive second finally first quadrant note way difference usual symmetric gaussseidel sweeps performed downstream ordering within quadrant quadrants scanned symmetrically problems 35 especially also sensitivity quadrant one chooses start relaxation sweep somewhat different convergence rate optimal overweighting obtained one performed clockwise sweep one relaxed say second quadrant first third fourth finally first hence tests shifted relaxation startingpoint one quadrant every cycle obtain results represent average typical case first performed twolevel tests order compare numerical results analysis used theoretically optimal w calculated 19 relevant value example since oneline overlap quadrants results given table 3 evidently analysis captures main features problem well despite numerous simplifications seen especially su results calculations also carried v10 v11 v21 cycles optimal value determined experimentally numerical results summarized table 4 find experimental vcycle results also match twolevel predictions fairly well table 3 comparison erroramplification factors obtained analytical prediction twolevel numerical calculations example 2 w opt optimal values w obtained 19 vicinity optimal residualweighting factors optimal w somewhat higher predicted although show expected dependence number relaxation sweeps performed problems reported optimal value varied always fairly close 2 overall performance optimal w used satisfactory noted performance sensitive moderate changes w see also example 3 example features flow four vortices rather one b given characteristics plotted figure 1b domain examples except example 5 unit square centered origin numerical results using v11 v21 cycles appear tables 5 6 respectively convergence performance remains excellent even though nonvanishing residuals remain relaxation parts borderlines vortices flow leads away borderline recall however full relaxation sweep consists one clockwise sweep followed three quarters counterclockwise sweep see description implementation order allow opposite sign vortices cycle w su ivu1 v10 1 0795 0898 v11 1 0676 0831 v21 1 0536 0724 2 0280 0440 2 0143 0302 2 0069 0133 table 4 erroramplification factors obtained numerical calculations example 2 optimal values w obtained experimentally see text example 4 order test effect gridalignment borderlines vortices solve problem borderline aligned grid problem b given 1 respectively represents superposition two oppositesign vortices characteristics depicted figure 1c numerical performance shown tables 5 6 see loss efficiency performance still satisfactory far better usually exhibited problems example 5 test mixed problem flow enters leaves boundary also exists large recirculation zone obtained redoing example 2 extended domain example su ivu1 table 5 erroramplification factors obtained v11 cycles w opt latter found experimentally example su ivu1 table obtained v21 cycles w opt latter found experimentally mesh still uniform finest grid 193 129 characteristics shown figure 1d numerical performance given tables 5 6 examples virtually sensitivity order relaxation sweeps performed clockwise first counterclockwise vice versa summary often one may wish search optimal residual weighting factors every problem instead one simply use nominal value 2 realistic examples 35 one saves 25 time spent relaxation using optimal value rather 2 usually much less would also case example 1 employ symmetric relaxation even nominal value convergence rates comparable elliptic problems 6 conclusions research experimental approach hoped eventually lead fully efficient solver general highreynolds flows introduced analyzed tested advectiondiffusion problem inviscid limit numerical tests mostly match predictions well indicating main cause slow convergence usual multigrid algorithms recirculating flows indeed understood way eliminate found multigrid vcycle using downstream relaxation upstream dis cretization shown yield efficient solver tested problem several simple situations closed characteristics mixed en teringrecirculation problem tests performed classical standard firstorder upstream discretization scheme also novel firstorder upstream discretization shown preclude spurious solutions reported 3 present approach cheaper implement developed 5 straightforwardly applied mixed enteringrecirculating flows important potential success highorder discretization approach 5 yields inadequate compromise however results obtained still preliminary effect intergrid transfers small band residuals consequences terms error reduction efficiency investigated wide variety cases along study deal avoid situations remain several bands nonvanishing residuals per vortex research directed towards higherorder discretization case effectivelyupstream discretization needs developed whose truncation error represents isotropic artificial diffusivity one approach use predictorcorrector type discretization employing upstream scheme local driver possibly higherorder necessarily upstream scheme local corrector finally present approach tested advection problem experiments incompressible navier stokes equations flows closed streamlines need performed employing distributive gaussseidel relaxation shown 4 doubt raise questions anticipated techniques investigated carry three dimensions although implementation considerably complicated supported fact simple experiments performed overweighting methods 5 three dimensions exhibited expected performance obvious drawback entire approach inherently sequen tial efficient parallel implementations hard envisage parallelization might achievable performing downstream line gauss seidel relaxation also conceivable domain decomposition approach leaves several lines residuals per vortex another drawback present approach directly applicable flows significant additional viscosity since entails using discretizations purely upstream methods deal flows well presently investigated acknowledgment work supported royal netherlands academy arts sciences feinberg graduate school united statesisrael binational science foundation grant 9400250 united states air force grant f4962092j0439 carl f gauss minerva center scientific computation r multigrid solvers nonelliptic singular perturbation steady state problems 1984 multigrid guide applications fluid dynam ics inadequacy firstorder upwind difference schemes recirculating flows multigrid solution highreynolds incompressible entering flows accelerated multigrid convergence high reynolds recirculating flows efficient solution finite difference finite element equations algebraic multigrid fundamental algo rithms correctness first differential approximation difference schemes multigrid techniques incompressible flows tr