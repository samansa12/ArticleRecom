staircase failures explained orthogonal versal forms treating matrices points n2dimensional space apply geometry study explain algorithms numerical determination jordan structure matrix traditional notions sensitivity subspaces replaced angles tangent spaces manifolds n2dimensional space show subspace sensitivity associated small angle complementary subspaces tangent space manifold n2dimensional space show staircase algorithm failure related small angle call staircase invariant space tangent space matrix notions n2dimensional space generalized pencils 2mndimensional space apply theory special examples studied boley demmel kgstrm b introduction problem accurately computing jordan kronecker canonical structures matrices pencils captured attention many specialists numerical linear algebra standard algorithms process denoted staircase algorithms shape resulting matrices 22 page 370 understanding fail incomplete paper study geometry matrices n 2 dimensional space pencils 2mn dimensional space explain failures follows geometrical program complement perhaps replace traditional numerical concepts associated matrix subspaces usually viewed n dimensional space paper targets expert readers already familiar staircase algorithm refer readers 22 page 370 10 excellent background material list literature section 11 reader wishing comprehensive understanding algorithm mathematical side also helpful reader knowledge arnolds theory versal forms though dedicated reader able read paper without knowledge perhaps skipping section 32 important contributions paper may summarized ffl geometrical explanation staircase algorithm failures department mathematics room 2380 massachusetts institute technology cambridge 021394307 edelmanmathmitedu httpwwwmathmiteduedelman supported nsf grants 9501278dms 9404326ccr department mathematics room 2333 massachusetts institute technology cambridge 021394307 httpwwwmathmiteduyanyuan supported nsf grants 9501278dms ffl identification three significant subspaces decompose matrix pencil space b r important spaces choose call staircase invariant space ffl idea staircase algorithm computes arnold normal form numerically appropriate arnolds matrices depending parameters ffl first order perturbation theory staircase algorithm ffl illustration theory using example boley 3 paper organized follows section 11 briefly review literature staircase algorithms section 12 introduce concepts call pure greedy directed staircase emphasize subtle distinctions algorithm might used section 13 contains important messages result theory follow section 2 presents two similar looking matrices different staircase behavior section 3 studies relevant n 2 dimensional geometry matrix space section 4 applies theory staircase algorithm main result may found theorem 6 sections 5 6 7 mimic sections 2 3 4 matrix pencils section 8 applies theory towards special cases introduced boley 3 demmel b kagstrom 12 11 jordankronecker algorithm history first staircase algorithm given kubla novskaya jordan structure 1966 31 normalized qr factorization used rank determination nullspace separation ruhe 34 first introduced use svd algorithm 1970 svd idea developed golub wilkinson 23 section 10 kagstrom ruhe 27 28 wrote first library quality software complete jnf reduction capability returning different steps reduction recently chatitinchatelin fraysse 6 developed nonstaircase qualitative approach staircase algorithm kronecker structure pencils given van dooren 13 14 15 kagstrom ruhe 29 kublanovskaya 32 fully analyzed ab algorithm however earlier work ab algorithm goes back 1970s kagstrom 25 26 gave rgdsvdrgqzd algorithm provided base later work software error bounds algorithm given demmel kagstrom 8 9 beelen van dooren 2 gave improved algorithm requires om 2 n operations theta n pencils boley 3 studied sensitivity algebraic structure error bounds given demmel kagstrom 10 11 staircase algorithms used theoretically practically elmroth kagstrom 19 use staircase algorithm test set 2by3 pencils hence analyze algorithm demmel edelman 7 use algorithm calculate dimension matrices pencils given form dooren 14 20 30 5 emaminaeini 20 kautsky nichols 30 boley 5 wicks decarlo 35 consider systems control applications software control theory provided demmel kagstrom 12 number papers use geometry understand jordan kronecker structure problems fair grieve 21 regularizes taking degenerate matrix neighborhood edelman elmroth kagstrom 17 18 study versality stratifications boley 4 concentrates stratifications 12 staircase algorithms staircase algorithms jordan kronecker form work making sequences rank decisions combination eigenvalue computations wish emphasize variations algorithm might used coining terms pure staircase greedy staircase directed staircase pseudocode jordan versions appear near end subsection combination three choices one choose option zeroing choices explained three variations purposes discussion considered exact arithmetic pure version pure mathematicians algorithm gives precisely jordan structure given matrix greedy version also useful pure mathematician attempts find interesting jordan structure near given matrix directed staircase attempts find nearby matrix preconceived jordan structure roughly speaking difference pure greedy directed whether jordan structure determined matrix user controlled neighborhood matrix directly user respectively pure staircase algorithm rank decisions made using singular value decomposition explicit distinction made zero singular values nonzero singular values determines exact jordan form input matrix greedy staircase algorithm attempts find interesting jordan structure nearby given matrix word interesting degenerate used sense precious gems rarer interesting algorithmically many singular values possible thresholded zero user defined threshold singular values set 0 rarer sense codimension see 7 17 18 directed staircase algorithm allows user decide advance jordan structure desired jordan structure dictates singular values set 0 directed staircase used special circumstances example used separating zero jordan structure right singular structure used guptri 10 11 moreover elmroth kagstrom imposed structures staircase algorithm investigation set 2 theta 3 pencils 19 recently lippert edelman 33 use directed staircase compute initial guess newton minimization approach computing nearest matrix given form frobenius norm greedy directed modes explicitly zero singular values end computing new matrix staircase form jordan structure matrix near original one explicitly zero singular values end computing matrix orthogonally similar original one absence roundoff errors nearly staircase form example guptri 11 choice whether zero singular values made user input parameter named zero may true false summarize many choices associated staircase algorithm really five distinct algorithms worth considering pure algorithm stands otherwise two choices combinatorial structure greedy directed may paired choice zero thereby five algorithms 1 pure staircase 2 greedy staircase zeroing 3 greedy staircase without zeroing 4 directed staircase zeroing 5 directed staircase without zeroing notice pure staircase specify zeroing since give result vacuously course algorithms run finite precision one detail freedom singular value calculations lead ambiguity staircase form case unequal singular values order must specified singular values equal choice basis made specify order svd except singular values considered zero appear first ith loop iteration use w denote number singular values considered 0 directed algorithm w input otherwise w computed pseudocode following staircase algorithms computing jordan form corresponding eigenvalue input specify pure greedy direct mode specify zeroing zeroing output matrix may may staircase form tmp full rank use svd compute n tmp n tmp unitary matrix v whose leading w columns span nullspace approximation choice pure use svd algorithm compute w exact nullspace choice ii greedy use svd algorithm threshold small singular values user specified tolerance thereby defining w corresponding singular vectors become first w vectors v choice iii directed use svd algorithm w defined input jordan structure w singular vectors first w columns v let tmp lower right n corner endwhile zeroing return form block strictly upper triangular matrix staircase algorithm often works well known fail say greedy algorithm fails detect matrix least generic form 7 possible within given tolerance say directed algorithm fails staircase form produces far orders magnitude terms usual frobenious norm matrix space staircase form nearest matrix intended structure paper mainly concentrate greedy staircase algorithm failure theory applicable approaches emphasize intentionally vague far far may application dependent consider several orders magnitude constitute notion far 13 geometry staircase arnold forms geometrical approach inspired arnolds theory versality 1 readers already familiar arnolds theory point new normal form enjoys properties arnolds original form useful numerically numerical analysts point ideas important understanding staircase algorithm perhaps safe say numerical analysts arnold normal form years recognize computer us automatically power normal form introduce section 3 provides first order rounding theory staircase algorithm show instead decomposing perturbation space normal space tangent space matrix algorithm chooses called staircase invariant space take place normal space directions staircase invariant space close tangent space algorithm fail theory decompose matrix space three subspaces call b r precise definitions three spaces given definitions 1 3 b r two subspaces tangent space certain complimentary space tangent space matrix space impatient reader point angles spaces related behavior staircase algorithm note r always orthogonal use delta delta represent angle two spaces angles components staircase fails weak stair large large 2 small small stair large small 2 small large small 2 large large weak stair 16 mean near rank deficiency superdiagonal block strictly block upper triangular matrix 2 staircase algorithm failure motivate theory consider two matrices ffi 15e9 approximately order square root double precision machine roughly 22e16 matrices clearly jordan structure j 3 0 staircase algorithm 1 2 behave differently test used guptri 11 algorithm guptri 1 requires input matrix two tolerance parameters epsu gap ran guptri 22e14 roughly 100 times double precision machine ffl singular values two matrices 1 2 oe 88816e15 set gap always 1 let vary value tolerance effectively observations tabulated computed jordan structure 1 computed jordan structure use j k represent k theta k jordan block eigenvalue table typically ff 6 fi 6 0 setting small smaller smaller singular value second stage software returns two nonzero singular values first second stages algorithm one nonzero singular value third stage setting epsu theta gap large larger oe 2 zero two singular values first stage one second stage giving structure j 2 0 phi j 1 0 1 matrix within o10 gamma9 1 2 form 0 interesting case appropriate epsu theta gap fl oe 2 zero one singular value three stages getting j 3 0 o10 gamma14 away 2 get j 3 0 o10 gamma6 away 1 words staircase algorithm fails 1 2 pictured figure 21 1 example indicates matrix 1 guptri 10 11 greedy algorithm sophisticated thresholding procedure based two input parameters epsu gap 1 threshold oe defining oe n1 j 0 first argument maximum oe k ensures large gap thresholded nonthresholded singular values second argument ensures oe kgamma1 small readers look guptri software note singular values ordered smallest largest contrary modern convention correct jordan structure may within specified tolerance staircase algorithm may fail find consider situation 1 2 transformed using random orthogonal matrix q second experiment pick gamma39878 20047 gamma89487 gamma84538 gamma45853 27400 take impose perturbation order ffl ran guptri two matrices following result computed jordan structure 1 computed jordan structure table values previous table case guptri still able detect j 3 structure although one finds o10 gamma6 away fails find j 3 structure 1 comparison 1 2 two experiments indicates explanation subtle notion weak stair superdiagonal block almost column rank deficient 16 paper present geometrical theory clearly predicts difference 1 2 theory based close certain directions denote staircase invariant directions tangent space manifold matrices similar matrix specified canonical form turns 1 directions nearly tangent space 2 crucial difference tangent directions staircase invariant directions combine form versal deformation sense arnold 1 one useful properties purposes 3 staircase invariant space versal deformations 31 staircase invariant space related subspaces consider block matrices figure 31 dividing matrix blocks row column sizes obtain general block matrix block matrix conforming also partitioned blocks ja fig 21 staircase algorithm fails find a1 distance 22e14 find j3 0 j2 0 phi j1 0 given much larger tolerance latter ffi away manner general block matrix nonzero entries upper triangular blocks excluding diagonal blocks call block strictly upper triangular matrix general block matrix nonzero entries lower triangular blocks including diagonal blocks call block lower triangular matrix matrix staircase form divide blocks sizes strictly block upper triangular matrix every superdiagonal block full column rank general block matrix nonzero entries diagonal blocks diagonal block orthogonal matrix call block diagonal orthogonal matrix call matrix e b block orthogonal matrix conforming block antisymmetric matrix conforming ie b antisymmetric zero diagonal blocks abuse word conforming since e b block structure definition 1 suppose matrix staircase form call staircase invariant matrix block lower triangular call space matrices consisting staircase invariant space denote remark columns independent except possibly zero matrix extreme case however generic sparsity structure may determined general block matrix block strictly upper triangular matrix block lower triangular matrix00000000000000000000000000000011111111111111111111111111111111111111110000000000000011111111111111000000011111111111111 matrix staircase block diagonal orthogonal matrix block orthogonal matrix arbitrary block0000000000000000000011111111111111111111 full column rank block00000000000000111111111111111111111 orthogonal block special block zero block fig 31 schematic block matrices defined text sizes blocks example let staircase form theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta thetac c c c c c c c staircase invariant matrix every column left eigenvector ffi notation indicates 0 entries block lower triangular part consequence requirement every column left eigenvector may formulated general rule find one block size n theta n blocks lowest block row appear sparsity structure example ffi appear another block size 2 special case strictly upper triangular 0 bottom row shown readers familiar arnolds normal form notice given single jordan block normal form contains versal directions theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta thetac c c c c definition 2 suppose matrix call oa nonsingular matrixg orbit matrix call matrixg tangent space oa theorem 1 let n theta n matrix staircase form staircase invariant space tangent space form oblique decomposition n theta n matrix space ie r proof assume ij j block n theta n j course n 2 1 degrees freedom first block column n 1 columns column may chosen n 1 dimensional space left eigenvectors indeed n 2 degrees freedom ith block n columns may chosen n dimensional space left eigenvectors matrix obtained deleting first rows columns total number degrees freedom combined dimt gives dimension whole space n 2 2 also form ax gamma xa matrix x first step show x must block upper triangular form conclude ax gamma xa strictly block upper triangular since block lower triangular follow also must 0 let first block column x block upper triangular structure clearly ith block column xa 0 diagonal block ith block column contains vectors column space however every column left eigenvector definition notice require column vectors independent one jordan block case good example therefore orthogonal column space thus ith block column 0 full column rank conditions superdiagonal blocks conclude x 0 block diagonal definition 3 suppose matrix call block antisymmetric matrix conforming ag block orthogonalorbit matrix call block antisymmetric matrix conforming ag block tangent space block orthogonal orbit b call r j f block strictly upper triangular matrix conforming ag strictly upper block space note complementary structure two matrices r see always orthogonal r theorem 2 let n theta n matrix staircase form tangent space orbit oa split block tangent space b orbit b strictly upper block space proof know tangent space orbit dimension decompose block upper triangular matrix block antisymmetric matrix decompose every strictly upper triangular matrix matrix b since r b r dimension 12n must exactly dimension 12n thus know actually form decomposition strictly upper block space r also represented r j conforming ag corollary 1 r n 2 figure 32 definition 3 really need whole set merely need small neighborhood around readers may well wish skip ahead section 4 interested mathematical technicalities review simple concepts suppose partitioned orthogonal decomposition ndimensional space k mutually orthogonal subspaces dimensions point flag manifold grassmann manifold equivalently point flag manifold specified filtration ie nested sequence subspaces v dimension corresponding decomposition written may expressed concretely unitary matrix u define v r fig 32 diagram orbits related spaces similarity orbit indicated surface oa block orthogonal orbit indicated curve b surface tangent space b b indicated line r lies oa pictured line staircase invariant space represented line pointing away plane span first n 1 point flag manifold course many unitary matrices u correspond flag manifold point open neighborhood fe b g near point e map fe b g open subset flag manifold one one homeomorphism former set referred local cross section 24 lemma 41 page 123 lie algebra two unitary matrices local cross section would sequence subspaces 32 staircase versal deformation next going build theory versal form following arnold 1 deformation matrix matrix entries power series complex variables convergent neighborhood good introduction versal deformations may found 1 section 24 17 key property versal deformation enough parameters matter matrix perturbed may made equivalent analytic transformations versal deformation choice parameters advantage concept numerical analyst might make rounding error direction yet still think perturbation standard canonical form let ae smooth submanifold manifold consider smooth mapping another manifold let point 2 n mapping called transversal n tangent space direct sum tm tangent space tn tangent space n tangent space mapping tm induced jacobian theorem 3 suppose staircase form fix 2 dims follows versal deformation every particular small enough miniversal basis proof theorem 1 tells us mapping transversal orbit equivalence transversality versality 1 know versal deformation since dimension staircase invariant space codimension orbit given equation 31 miniversal deformation basis ie dims true versal deformation every matrix neighborhood words space transversal orbit every take set matrices x st x gamma ax form basis tangent space orbit know phi phi implies fixed minimum angle small enough guarantee x still linearly independent span subspace tangent space least say 2 away means tangent space transversal arnolds theory concentrates general similarity transformations seen staircase invariant directions perfect versal deformation idea refined consider similarity transformations block orthogonal everything except add block strictly upper triangular matrices r compensate restriction block orthogonal matrices spell detail definition 4 matrix c block orthogonal every refer deformation block orthogonal deformation say two deformations b block orthogonallyequivalent exists block orthogonal deformation c identity matrix say deformation block orthogonallyversal deformation b block orthogonallyequivalent deformation aoe oe mapping analytic 0 theorem 4 deformation block orthogonallyversal iff mapping transversal block orthogonalorbit proof proof follows arnold 1 sections 23 24 except use block orthogonal version relevant notions remember tangents block orthogonal group commutators block antisymmetric matrices since know decomposed b phi r get theorem 5 suppose matrix staircase form fix 2 k dims fix r follows block orthogonallyversal deformation every particular small enough block orthogonallyminiversal fs g fr j g bases r hard see theory set matrices eigenvalues 0 generalized matrix different eigenvalues staircase form block upper triangular matrix diagonal blocks form staircase form defined beginning chapter superdiagonal blocks arbitrary matrices staircase invariant space spanned block diagonal matrices diagonal block staircase invariant space corresponding diagonal block r space spanned block strictly upper triangular matrices st every diagonal block r space corresponding b defined exactly one eigenvalue case theorems still valid give definitions apply theorems really use values eigenvalues important many different eigenvalues words working bundle instead orbit forms normal forms property arnolds normal form continuous perturbation reason introduce block orthogonal notation staircase algorithm realization first order block orthogonallyversal deformation see next section 4 application matrix staircase forms ready understand staircase algorithm described section 12 concentrate matrices eigenvalues 0 since otherwise staircase algorithm separate structures continue recursively use notation staira denote output staircase algorithm described section 12 suppose matrix staircase form zeroth order instance staircase algorithm replaces diagonal orthogonal course change staircase structure q 0 represents arbitrary rotations within subspaces depend software written subtlety roundoff errors many singular values 0 next suppose perturb ffle according corollary 1 decompose perturbation matrix uniquely theorem 6 states addition block diagonal matrix q 0 staircase algorithm apply block orthogonal similarity transformation kill perturbation theorem 6 suppose matrix staircase form e perturbation matrix staircase algorithm without zeroing ffle produce orthogonal matrix q depending ffl output matrix staircase structure staircase invariant matrix r block strictly upper triangular matrix singular values zeroed algorithm kills outputs r offl proof first stage staircase algorithm first block column orthogonal columns property preserved completion algorithm generally ith iteration ith block column including diagonal block orthogonal columns right property preserved algorithm terminates matrix whose columns including diagonal block orthogonal columns right words matrix staircase form plus staircase invariant matrix always write similarity transformation matrix block diagonal orthogonal matrix x block antisymmetric matrix depend ffl local cross section property mentioned beginning section 3 notice constant matrix decided depends ffle first order written instead q 0 however expand q 0 since long block diagonal orthogonal transformation change staircase structure matrix hence get r b respectively q easy check b still space x block antisymmetric matrix satisfying ax know x uniquely determined dimensions b block antisymmetric matrix space reason ax hence last equality 41 holds algorithm forces output form described first paragraph proof r staircase form ffl staircase invariant matrix since phi r b zero matrix b term must vanish understand clearly observation tells us let us check simple situations matrix perturbed direction r similarity transformation simply block diagonal orthogonal matrix q 0 ignore transformation change structure think output unchanged input reason call staircase invariant space reason include r staircase invariant space fflr still within b matrix perturbed along block tangent direction b staircase algorithm kill perturbation block diagonal orthogonal similarity transformation although staircase algorithm decides q 0 step step algorithm due svd rank decisions actually think q 0 decided first step even ignore q 0 reason comes svd use follows specific way sort singular values different choose basis singular vector space singular values appear know every matrix reduced staircase form orthogonal transformation words always think general matrix p ap staircase form thus general staircase algorithm always introduces orthogonal transformation returns matrix staircase form first order perturbation staircase invariant direction ie stairm obvious staircase form matrix almost normal staircase algorithm behave well hand close fail emphasize write conclusion conclusion 1 angle staircase invariant space tangent space decides behavior staircase algorithm smaller angle worse algorithm behaves one jordan block case ifandonlyif condition near theorem 7 let n theta n matrix staircase form suppose block sizes 1 theta 1 sa close iff following two conditions hold 1row condition exists nonzero row st every entry row o1 2chain condition exists chain length chain value o1 k lowest row satisfying 1 call 1 2 chain length product 1 2 chain value proof notice close equivalent almost perpendicular n normal space case n spanned fi consists matrices nonzero entries last row considering angle two matrices two spaces straightforward show almost perpendicular n equivalent 1 exists k st n entry matrices 2 entry o1 must o1 entry matrix assume k largest choice different ks combinatorial argument show two conditions equivalent row chain conditions respectively theorem remark 1 note exists o1 entry matrix equivalent say exists singular value matrix o1 chain condition saying singular values ngammak offl smaller generally ifandonlyif condition close necessary condition least one superdiagonal blocks original unperturbed matrix singular value almost 0 ie weak stair close actually hard show angle b r order smallest singular value weak stair perturbation matrix e decomposed r typically large whether large depends whether close notice equation 41 valid sufficiently small ffl range ffl sufficiently small clearly ffl smaller smallest singular value ffi weak stairs moreover algorithm requires perturbation along smaller ffi assume angle generally large would expect ffl smaller ffi sufficiently small however close 0 random perturbation would expect ffl order ffi sufficiently small see angle decides range effective ffl small ffl sufficiently small observed discontinuity 0th order term equation 41 caused ordering singular values certain stages algorithm thus instead identity matrix get permutation matrix 0th order term theory explains staircase algorithm behaves differently two matrices 1 2 section 2 using theorem 7 see 1 staircase failure 2 1 direct calculation find tangent space staircase invariant space 1 close situation 2 3 transforming get 1 2 q approximate orthogonal matrix order square root machine precision ffl another error order comparable ffi experiment staircase algorithm actually runs shifted version see r large o10 gamma6 added j 3 second table 2 might well call 2 staircase failure situation 1 suffers much worse failure situation staircase algorithm fails detect j 3 structure tangent space staircase invariant space close component large hence equation 41 apply 5 staircase algorithm failure motivate theory pencils pencil analog staircase failure section 2 15e8 pencil structure l 1 phi j 2 0 add random perturbation size 1e14 pencil guptri fails return back original pencil matter epsu choose instead returns back generic l 2 phi j 1 0 pencil offl away hand another pencil l 1 phi j 2 0 structure guptri returns l 1 phi j 2 0 pencil offl away point readers may correctly expect reason behind angle two certain spaces matrix case 6 matrix pencils parallel matrix case set similar theory pencil case simplicity concentrate case pencil lblocks j0blocks pencils containing l blocks nonzero including 1 eigenvalue blocks always reduced previous case transposing exchanging two matrices pencil andor shifting 61 staircase invariant space related subspaces pencils pencil b staircase form divide b block rows sizes r columns sizes strictly block upper triangular every superdiagonal block full column rank b block upper triangular every diagonal block full row rank rows orthogonal allow k1 zero pencil called conforming b block structure b square matrix called row column conforming diagonal block sizes row column sizes b definition 5 suppose b pencil staircase form b block diagonal part b call sa sb staircase invariant pencil b complimentary structure b call space consisting sa sb staircase invariant space b denote example let b staircase form theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta7 7 7 7 7 7 7 5 theta theta theta theta theta theta theta theta theta theta theta theta theta theta theta ffi ffi staircase invariant pencil b every column sa left null space every row sb right null space b notice sparsity structure sa sb complimentary b respectively sa sb often less sparse requirement nullspace precise find one diagonal block size among blocks size blocks lowest block row appear sparsity structure sa diagonal blocks b square block sb zero entries throughout corresponding block column special cases strictly upper triangular square matrix b upper triangular square matrix diagonal entries nonzero sa nonzero entries bottom row sb simply zero matrix strictly upper triangular n theta n 1 matrix b upper triangular diagonal entries nonzero sa sb zero pencil definition 6 suppose b pencil call oa b nonsingular square matrices g orbit pencil b call square matrices g tangent space oa b b theorem 8 let b theta n pencil staircase form staircase invariant space b tangent space form oblique decomposition theta n pencil space ie r proof proof theorem similar theorem 1 first prove dimension sa b codimension b prove induction readers may try fill details definition 7 suppose b pencil call b b j fp block antisymmetric matrix row conforming b block antisymmetric matrix column conforming b block orthogonalorbit pencil b call b j x block antisymmetric matrix row conforming b block antisymmetric matrix column conforming bg block tangent space block orthogonalorbit b b b call r j u block upper triangular matrix row conforming b v block upper triangular matrix column conforming bg block upper pencil space b theorem 9 let b theta n pencil staircase form tangent space orbit oa b split block tangent space b orbit b b block upper pencil space r ie proof proved similar argument concerning dimensions matrix dimension r 2 dimension b codimension orbit oa b corollary 2 r 62 staircase versal deformation pencils theory versal forms pencils 17 similar one matrices deformation pencil b pencil b entries power series real variables say two deformations b c equivalent exist two deformations p q identity matrices theorem 10 suppose b staircase form fix 2 dims follows versal deformation every particular b small enough b miniversal basis definition 8 say two deformations b c block orthogonally equivalent exist two block orthogonal deformations p q identity matrix exponentials matrices conforming b row column respectively say deformation b block orthogonallyversal deformation c block orthogonallyequivalent deformation boe oe mapping holomorphic 0 theorem 11 deformation b b block orthogonallyversal iff mapping b transversal block orthogonalorbit b corresponding result theorem 4 since know decomposed b phi r get theorem 12 suppose pencil b staircase form fix 2 k dims fix r follows block orthogonallyversal deformation every particular b small enough b block orthogonallyminiversal b fs g fr j g bases r notice matrix case also extend definitions theorems general form containing l blocks nonzero eigenvalue blocks specify eigenvalues hence get bundle case want point one particular example b staircase form strictly upper triangular matrix nonzero entries super diagonal b triangular matrix nonzero entries diagonal except n zero matrix sb matrix nonzero entry n 7 application pencil staircase forms concentrate l phi j0 structures since otherwise staircase algorithm separate structures continue similarly shift andor transpose part matrix case staircase algorithm basically decomposes perturbation pencil three spaces b r kills perturbation b theorem 13 suppose b pencil staircase form e perturbation pencil staircase algorithm without zeroing b ffle produce two orthogonal matrices p q depending ffl output pencil staira b roffl b sane staircase structure staircase invariant pencil b r block upper pencil space r singular values zeroed algorithm kills output use formula explain statement clearly similarly see pencil almost normal staircase algorithm behave well hand close behave badly exactly situation two pencil examples section 5 although two pencils ill conditioned direct calculation shows first pencil staircase invariant space close tangent space angle second one angle ifandonlyif condition close difficult matrix case one necessary condition one super diagonal block almost full column rank one diagonal block b almost full row rank usually referred weak coupling 8 examples geometry boley pencil others boley 3 example 2 page 639 presents example 7 theta 8 pencil b controllable generic kronecker structure yet known uncontrollable system nongeneric kronecker structure nearby distance 6e4 makes example interesting staircase algorithm fails find nearby uncontrollable system methods succeed theory provides geometrical understanding famous example leads staircase failure staircase invariant space close tangent space pencil refer bffl dots refer zeros original boley example staircase algorithm predicts distance 1 therefore nearly four orders magnitude understand failure theory works best smaller values ffl still clear even continue difficulties useful express pencil bffl zero except one 77 entry b part p 0 bundle pencils whose kronecker form l 6 j 1 delta perturbation e exactly unique staircase invariant direction hence notation pointed end section 6 relevant quantity angle staircase invariant space pencil space easy calculation reveals angle small radians order get feeling range ffl first order theory applies calculated exact distance dffl j dp ffl bundle using nonlinear eigenvalue template software 33 first order figure 81 plots distances first ffl 2 0 2 closeup size perturbation distance orbit size perturbation distance orbit fig 81 picture explain change distance pencils p0 ffle bundle l6 changes second subplot part first one points near observation based data suggests first order theory good two decimal places one place ffl 10 gamma2 understand geometry staircase algorithmic failure one decimal place even merely order magnitude quite sufficient summary see clearly staircase invariant direction small angle tangent space therefore staircase algorithm difficulty finding nearest pencil bundle predicting distance difficulty quantified angle since boley example computed distance well past 1 breakdown first order theory attributed curving bundle towards three dimensional schematic portrayed figure 82 fig 82 staircase algorithm boley example surface represents orbit op0 tangent space pencil p0 p0 represented plane bottom p1 lies staircase invariant space inside bowl hyperplane uncontrollable pencils represented plane cutting surface along curve c intersects p0 along l angle l c angle p0 represented angle hp0p1 relevant picture control theory planar intersection picture control theory set special requirement matrix form 0 pencils intersection hyperplane bundle termed uncontrollable analytically calculated angle c tangent space uncontrollable found 00040 using nonlinear eigenvalue template software 33 numerically computed true distance ffle uncontrollable surfaces calculated ratio distance ffl found ffl 8e gamma 4 ratio agrees well similar analysis three pencils c 1 c 2 c 3 given j demmel b kagstrom 12 found sin values angles respectively 24325e02 34198e02 88139e03 sin values b r respectively 17957e02 73751e03 33320e06 explains saw staircase algorithm behave progressively worse especially explains perturbation 10 gamma3 added pencils c 3 behaves dramatically worse c 1 c 2 component almost order entries original pencil conclude reason staircase algorithm work well example actually staircase failure tangent space close staircase invariant space also perturbation large even know angle advance estimate distance well acknowledgement authors thank bo kagstrom erik elmroth helpful discussion conlab software easy interactive numerical testing staircase invariant directions originally discovered single jordan blocks erik elmroth visiting mit fall 1996 r matrices depending parameters improved algorithm computation kroneckers canonical form singular pencil estimating sensitivity algebraic structure pencils simple eigenvalue estimates algebraic structure pencils block toeplitz matrices placing zeroes kronecker canonical form lectures finite precision computations dimension matrices matrix pencils given jordan kronecker canonical forms stably computing kronecker structure reducing subspace singular pencils computing stable eigendecompositions matrix pencils generalized schur decomposition arbitrary pencil generalized schur decomposition arbitrary pencil accurate solutions illposed problems control theory computation kroneckers canonical form singular pencil generalized eigenstructure problem linear system theory reducing subspaces definitions oral communication geometric approach perturbation theory matrices matrix pencils part 1 versal deformations geometric approach perturbation theory matrices matrix pencils part 2 stratificationenhanced staircase algorithm set 2by3 matrix pencils kronecker structures transitions perturbations computation zeros linear multivariable systems application singularity theory computation jordan canonical form matrix computations differential geometry generalized singular value decomposition general algorithm 560 jnf algorithm numerical computation jordan normal form complex matrix matrix pencils robust pole assignment linear state feedback method solving complete eigenvalue problem degenerate matrix nonlinear eigenvalue problems algorithm numerical determination structure general matrix computing distance uncontrollable system tr ctr naren ramakrishnan chris baileykellogg sampling strategies mining datascarce domains computing science engineering v4 n4 p3143 july 2002