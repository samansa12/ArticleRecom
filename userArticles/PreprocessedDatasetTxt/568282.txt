binary generalized post correspondence problem give new proof decidability binary post correspondence problem pcp originally proved 1982 ehrenfeucht karhumki rozenberg proof complete somewhat shorter original proof although use basic copyright 2002 elsevier science bv rights reserved b introduction let b two nite alphabets h g two morphisms post correspondence problem pcp short determine exists nonempty word w 2 proved post 8 problem undecidable general word w called solution instance h g pcp binary pcp assume size instance h g two 2 problem proved decidable ehrenfeucht karhumki rozenberg 2 shall give new shorter proof binary case although use basic idea 2 proofs combined 4 3 added details proof make easier read also although restrict binary pcp shall achieve information really needed binary case note also known jaj 7 pcp remains unde cidable see 7 decidability status open 3 jaj 6 another important problem generalized pcp gpcp short consists two morphisms gpcp tell whether exists word w 2 w called solution shall denote instance gpcp called begin words called end words note also gpcp known decidable jaj 2 see 2 undecidable jaj 7 see 6 pcp decidability status gpcp open alphabet size two bounds basic idea 2 instance h g binary pcp either 1 periodic ie 2 reduced equivalent instance binary generalized pcp marked morphisms proved two cases decidable recall morphism h called marked images letters begin dierent letter ie hx hy start dierent letter whenever decidability proof periodic case see 2 5 shall also present proof next section shall give new proof second case 2 proved binary gpcp decidable marked morphisms proof case analysis rather long shall give new proof follows lines 3 proved gpcp decidable marked morphisms alphabet size since shall concentrate binary case decidability proof becomes elementary shorter 3 proof decidability marked binary gpcp uses idea reducing problem instance nitely many new instances least one new instances solution original one iterating reduction shall nally get nitely many new instances decision easy note pcp gpcp may always assume image alphabet b binary since b injectively encoded f0 1g example encoding therefore binary case shall assume shall rst x notations empty word denoted word x 2 said prex 2 z 2 denoted x prex length k denoted pref k also z 6 xz x proper prex usual denoted x say x comparable x x word x 2 said sux 2 z 2 denoted x 4 z 6 x called proper sux denoted x also denote 2 periodic case shall begin easier part solution consider rst instances binary pcp one morphisms periodic prove result shall need lemma states property one counter languages contextfree languages see 1 lemma 1 let z monoid morphism additive group integers let r regular language decidable whether proof language 1 0 one counter language one counter languages closed intersection regular languages emptiness problem decidable one counter languages even contextfree languages see example 9 proof next theorem 5 see also 2 theorem 1 pcp decidable instances h g h periodic proof let assume h periodic word dene morphisms 2 dene regular set fg w 2 1 0 r w 6 gw 2 u words lemma 1 latter property decidable therefore claim follows note proof holds alphabet sizes binary case 3 pcp gpcp morphism periodic dene mapping h 1 words images h 1 cyclic shifts images h dene recursively h two words u v 2 well known uv vu u v powers common word follows maximum common prex h01 h10 length jh01j 1 lemma 2 let z h maximum common prex h01 h10 marked morphisms h w 2 f0 1g moreover w jhwj z h hw proof may assume symmetry jh1j jh0j assume rst clearly h 0 h 1 begin dierent letters maximality z h jh0j juvj jh0j ux h0 two possibilities either jh1j jh1j h since v x begin dierent letters h marked see also figure 1 still need prove h morphisms follows since therefore w 2 h h hwz h last part claim follows directly figure 1 case note h already marked z let h g h instance binary pcp assume h g nonperiodic let z h j may assume symmetry n following lemma lemma 3 instance h g binary pcp solution instance z 1 z h binary gpcp solution proof obvious instance h g pcp solution z g z h seen assume w solution assume rst instance gpcp solution w ie z h h z h therefore true assume h g solution w since h g n mor phisms get gwz g z 1 therefore z h h wz 1 true z h h z h proves claim marked pcp section shall consider solution method marked binary pcp proofs lemmata section 4 shall prove results alphabet sizes block instance h g h marked pcp pair u v 2 prexes v danger confusion also say block letter block letter block u v hu b gv words b rst letter images block accordingly block minimal nontrivial solution equation lemma 4 let h g instance marked pcp h letter 2 exists one block u v u particular instance h g jaj blocks moreover blocks h g eectively found proof consider pair u v words hu gv comparable hu 6 gv since h g marked exists unique 2 hua gv hu gva comparable hu gv gv hu respectively since morphisms marked clear rst letter u determines uniquely rst letter v claim follows inductively latter claim evident since fu regular set instance marked binary pcp h block letterg 1 note ja 0 j jaj although 0 b since jaj blocks lemma 4 dene successor g 0 u v block letter 2 0 lemma 5 let h g instance marked pcp successor 0 instance marked pcp ii solution 0 proof clear since dierent block words h g begin dierent letters assume solution w w two factorizations letter solution 0 since h 0 w assume 0 solution w blocks solution k denitions x exists block therefore claim follows denition successor gives inductively sequence instances note reduction instance successor 0 already used 2 reduction done dierence shall iterate reduction decidability marked pcp 4 eventually based fact successor sequence dened nitely many distinct instances authors 4 used two measures instance marked pcp namely size alphabet sux complexity clear alphabet sizes 0 ja 0 j jaj note studying binary case know alphabet size decreases get unary case pcp becomes decidable straightforward lemma 6 instance marked pcp 0 successor proof let exists least one block u v 4 v let h function ps z minimal length markedness z unique therefore p injective function similarly dene injective function h 0 g claim follows injectivity previous lemma together ja 0 j jaj yields following result lemma 7 let instance marked pcp exist numbers id n 0 numbers n 0 eectively found previous lemma means n 0 consecutive successors instances begin cycle n 0 lemma 8 sequence following properties size alphabet constant ii instance 0 marked pcp solution n 0 one letter solution proof case follows denition n 0 ii may assume n proof lemma 5 case ii every solution x solution x i1 i1 solution minimum length 0 relation solutions solution x lemma 7 since g h cannot lengthdecreasing jx 0 j jx j chosen minimum length solution x also solution 0 therefore necessarily jx morphisms g 0 letters occurring x letters rst letter x already solution 0 proof lemma 5 instances loop one letter solution proves case ii theorem 2 marked pcp decidable proof constructing successor sequence meet one following cases 1 alphabet size one 2 sux complexity goes zero 3 cyclic sequence rst two easy decide lemma 8 decide third case checking whether solution length one claim follows note also decide whether instance marked pcp solution beginning xed letter since may map back found one letter solutions proof lemma 8 check whether one begins 5 block structure marked binary gpcp instances binary gpcp reduced instances since solution must shall extract denition successor marked binary pcp marked binary gpcp denitions section apply alphabet size binary therefore use arbitrary alphabet domain alphabet whenever consider binary case shall mentioned instance pcp neither marked periodic transform instance marked gpcp done section 3 assume instance construct blocks h g case pcp shall also construct called begin block x p 1 exists r x p 1 begin block unique end words called end block block precise hus block u 1 u v 1 v let end block hu gvg set end blocks letter 2 lemma 9 let instance marked xed letter set end blocks e rational relation eectively found moreover block letter e nite ii e innite union nite set nite number sets words u v x proof without loss generality may assume end blocks found similarly found blocks letter check rst v v end block construct sequence always comparable lemma 4 whenever hu z z 1 check word w hu w exists unique g marked consequently end block notice necessarily unique block letter block u v always u u v v sequence terminates nitely many possible z hu z claim follows hereby considerations e innite block letter sequence order get innitely many possible z possible words x end block form jyj end block always written xu k u equivalently xu 0 u 00 get desired form since nitely many prexes u 0 v 0 potential end blocks rationality e follows proofs ii shall call xu k yv k w xu k w yv k lemma 9 ii extendible end blocks instance marked gpcp solution w block decomposition w begin block blocks minimal solutions hu easy see following lemma holds lemma 10 every solution w 2 unique block decomposition figure 2 block decomposition solution w note since block decomposition solution may consist end block necessary construct also set x begin block moreover begin block exist innite lemma 9 case studied lemma 12 instance binary marked gpcp binary case three choices solution 0 blocks solution 1 exactly one block used solution 2 two blocks used solution expression used blocks mean number dierent blocks block decomposition shall use next lemma prove solutions type 0 1 eectively found lemma 11 let x xed words decidable whether pair xu k w yv k z solution k 0 ie whether proof xu k w yv k z contains solution k obtain lefthand side depend k equation holds either unique k satisfying therefore assume since case uniqueness k guarantees decidability 4 holds k holds k consequently dierence jp 1 hxu k wj constant may assume symmetry jp 1 hxj least number jp 1 gyv j jp 1 hxj since possible overow p 1 hxu k w p 2 gyv k z unique length argument proved 1 dierent cases check solutions clearly instance decided since either one check whether xu k z since eectively found proved claim case 0 prove lemma 12 let instance marked binary gpcp decidable whether solution type 0 moreover decidable contains solution proof solution w type 0 w w either e p begin block end block words need check whether solution forms consider set e p rst e p nite decision easy therefore assume extendible end block xu k w yv k lemma 11 decidable whether extendible end block contains solution note z since lemma 9ii may exist nitely many extendible end blocks completed rst part proof second case solutions form end block also reduces lemma 11 since begin block unique end blocks ones consider number end blocks nite decision easy extendible end block say xu k w yv k search solution 0 done lemma 11 replace x also prove solutions type 1 eectively found consequence lemma 11 lemma 13 decidable whether instance marked binary gpcp solution type 1 proof assume one block used solution ie solution w form begin block block letter end block xed end decision whether solution 1 0 done lemma 11 solutions type 1 harder case seems possible extendible end block assume therefore extendible end block 9 fact h g marked block extendible end block necessarily begin dierent letters decide whether k solution also case reduces lemma 11 two cases assume rst 1 n 6 1 n n n nonempty overow words comparable words comparable n solution n rst letter r makes unique case assume solution rst letter r equal rst letter xu yv dierent rst letter respectively therefore 1 1 1 1 comparable cannot solutions powers greater xed eectively nd construct pairs words words construct solution blocks nitely many dierent overows pairs suitable possible overow exists nd hand overow exists overow twice pair longer comparable since unique may replace x decidability follows case n solution necessarily xu k k moreover jtj 6 jsj unique previous case exists enough check whether done lemma 11 corollary get corollary 1 unary gpcp decidable proof since solutions unary gpcp type 0 1 claim follows lemmata 12 13 shall concentrate type 2 solutions note case extendible end block may occur lemma 9 next dene successors instances marked gpcp assume begin block x exists x x set p 0 let successor h g let u v end block 0 u successor wrt u v 0 2 dened follows otherwise 0 u v dened lemma 14 instance solution successor 0 u 2 solution end block u v moreover solution w written solution 0 x begin block u v end block proof assume rst solution w block decomposition letter 2 k begin block u end block clearly u 1 v 1 v 1 u 1 rst cases hold p 0 0 k1 0 u ie 0 u v solution w cases similar assume 0 u solution w begin block lemma 5 iii xh 0 w 0 solution note begin block exists succes sors possible solutions e p case decidable lemma 12 hand end words disappear instance decidable next lemma lemma 15 let instance binary gpcp cases gpcp decidable proof let new symbol f0 1g extend morphisms h g following way h g instance marked pcp decide whether solution beginning 6 cycling instances lemma 14 reduce instance successors end blocks problem approach lemma 9 potentially innitely many successors extendible end block solutions instance necessarily type 0 1 instances decidable lemmata 12 13 therefore may concentrate case extendible end blocks since unary gpcp decidable alphabet size 2 lemma 14 solution one successors sux complexity goes zero step always decide successors letters thus solve original problem otherwise lemma 7 number n 0 morphisms start cycle clearly decide marked binary gpcp suces show solve cycling instances morphisms binary successor sequence mean sequence instances marked gpcp successor p notice set pairs end words set ith members successor sequences assume begin block condition hold know instance i1 dened possible solutions e p b satised instance instance reduces marked pcp decidable lemma 15 shall next show treat instances begin cycle ie exists successor sequences shall call instance 0 loop instance length loop notice also p p id 2 since begin words constructed blocks therefore begin words morphisms previous instance notice since lemma 8 alphabet size decrease block letters f0 1g particular cannot extendible end blocks lemma 16 assume instances cycle 5 solution exists two cases p 0 2 minimal solution 0 w initial letter w satises h 0 6 g 0 hence h 6 g 0 ii p 0 minimal solution w prex u p 0 proof case follows lemma 8 since marked pcp solution solution length one case ii exists u p k 2 k therefore holds j k since instance cycling p 0 k get contradiction since p 0 hereafter assume p 0 2 since case reduces cycling instances ha ga h would like upper bound lengths new end blocks loop 5 demonstrate limit number l solution exists minimal solution found sequence shorter l moreover limit eectively found main result follows follows assume p minimal solution p 1 u prex minimal solution unique since assumed p 1 morphisms marked consequently unique end block u v block decomposition minimal solution follows exists unique successor sequence instances end block minimal solution successor sequence called branch minimal solutions note cannot determine end block minimal solution desired limit obtained anyway let instance branch minimal solutions w minimal solution recall permanently assume 2 implies also 2 lemma 17 let w minimal solution let p proof instances share begin block marked morphisms clearly w w id since minimal solutions cannot u p u prex recall p 2 w minimal solution instance lemma 14 solution w 0 successor p consequently jwj jw 0 j morphisms nonerasing hence jw inductively jw proves claim byproduct obtain lemma 18 instance occurs twice successor sequence solutions proof proof previous lemma length minimal solution decreases strictly instance marked binary gpcp assume symmetry 2 4 1 end block u v instance satises equation end block solution necessarily successor end words lemma 19 let 2 branch minimal solutions cycling instance loop length let also w minimal solution p 2 prex p proof suces take proof analogous values recall also lemma 17 w w 0 therefore shall next prove jh 0 w j assume contrary jh 0 w j proof lemma 14 therefore hence js contradiction since js follows jh 0 w similarly prove jg 0 w loss generality assume since p 0 comparable jh 0 w necessarily p 0 figure 3 prex property previous lemma used proof last lemma gives upper bound size end blocks branch minimal solutions occurrence word u gw gblock covering solution w instance p 1 factor w 2 u factor z 3 u factor gv 4 gv note gblock covering occurrence factor u gw unique hence dene integer k gcovering length occurrence u w lemma 20 let 2 branch minimal solutions cycling instance loop length h i1 covering lengths i1 2 g covering length 1 g i1 covering lengths i1 2 h covering length iproof lemma 19 words iand iare covered prove case one analogous simplify notations denote either show cases h 0 covering length 0 gcovering length assume u v end block minimal solution w let also u rst letter u u 4 v gives us two cases consider 1 words u v equation obtained block construction letter also block letter necessarily 0 h 0 ie h 0 covering length 0 1 see figure 4 figure 4 picture case 1 2 assume rst gcovering length word gs 0 word clear gs 0 shares every one block factors including rst one since case 1 hu covered single gblock longer hu see figure 5 illustration show h 0 covering 0 longer gcovering gs 0 figure 5 block covering gu vertical lines illustrate block covering claim follows let w 0 minimal solution 0 word beginnning block satises consequently w prex minimal solution show covering 0 longer gcovering gs 0 sucient show block borderlines dh 0 w cutting 0 mapped injectively block borderlines p 1 hwgs figure 6 let 0 w 0 word determines block borderline eg 0 w word prex w since g marked also determines block borderline word p 2 cuts gs 0 hence p 1 hw p 2 gy notice nally word determines z 0 uniquely since g injective z 0 determines 0 eg 0 z h injective previous lemma gives us tool recognizing instances branch minimal solutions let 0 cycling instance loop length consider instances found rst reductions 0 solution unique 2 branch minimal solutions let maximal g hcovering length end words 1 2 follows lemma 20 branch minimal figure relation gs 0 0 solutions g h covering length always less equal sequence cycling instances sux complexity constant since blocks instance images successor i1 block length never 1 previous lemma corollary 2 let branch minimal solutions cycling instance loop length end words longer mi 1 7 decidability results ready prove main results theorem 3 binary marked gpcp decidable proof already proved marked binary gpcp decidable unary case solutions type 0 1 found remains shown nd type 2 solutions ie solve binary marked gpcp cycling instances 0 cycling instance blocks letters p successors particular extendible end blocks nitely many successors successor relation naturally denes tree 0 root successors 0 vertices pairs edges decision procedure based constructing partially rst inserting vertices depth distance root computing number maximal covering length end words instances depth vertices check whether solutions type 0 1 end block u v 2 e p vertices always decide solution lemma 15 vertex solution successors removed hand solution 0 also solution procedure may stop vertices depth greater partial construction specic successors inserted corollary 2 branch minimal solutions included partial construction nitely many instances inserted path successor sequence partially constructed eventually contain instance twice thus 0 solution lemma 18 unless vertex solution vertex u u saw section 3 binary pcp decidable binary marked gpcp therefore theorem 3 following corollary theorem 4 binary pcp decidable proof first one morphisms periodic decided theorem 1 instance marked decided theorem 2 otherwise construct equivalent instance binary marked gpcp binary marked gpcp decidable theorem 3 decision procedure achieved reduces instance binary marked gpcp nitely many simpler equivalent instances continuing reduction reduced instance create successor tree decision done path separately according following seven rules get unary successors decide successors corollary 1 ii get extendible end block solutions type 0 1 cases decided lemmata 12 13 respectively iii get end block u u 0 decidable lemma 15 iv get instance already occurred path instances path cannot solution lemma 18 v lengths end words break computable limit mi 0 1 continue branch since branch minimal solutions corollary 2 vi get end block u u e p solution also begin block possible solutions e p cases decidable lemma 12 vii end blocks solutions 8 conclusions open problems proved binary case post correspondence problem decidable solutions based construction successors equivalent original instance decidability sense reduction suciently many times obtain instances decision easy note instance binary gpcp also reduced instance binary marked gpcp using almost similar arguments lemma 3 therefore also gave new proof decidability binary gpcp open problems state following immediate questions decidability pcp gpcp ternary case ie 3 decidability strongly 2marked pcp morphism strongly 2marked image letter unique prex length 2 see also 4 also important open question considering form solutions binary pcp let h g instance binary pcp h nonperiodic true solution set fu vg possibly equal words u v see also 5 r generalized post correspondence problem lists consisting two words decidable generalizes pcp decidable marked morphisms decidability undecidability marked pcp morphisms handbook formal lan guages remarks generalized post correspondence problem decision problems semithue systems rules variant recursively unsolvable problem formal languages tr formal languages morphisms marked pcp decidable remarks generalized post correspondence problem decision problems semithue systems rules ctr vesa halava tero harju juhani karhumki decidability binary infinite post correspondence problem discrete applied mathematics v130 n3 p521526 23 august vesa halava tero harju juhani karhumki michel latteux extension decidability marked pcp instances unique blocks theoretical computer science v380 n3 p355362 june 2007 vesa halava tero harju juhani karhumki undecidability regular languages fundamenta informaticae v73 n12 p119125 april 2006