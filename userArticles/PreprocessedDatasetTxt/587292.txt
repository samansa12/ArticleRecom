multiresolution tensor spline method fitting functions sphere present details multiresolution method proposed taormina wavelet conference 1993 see lspline wavelets wavelets theory algorithms applications c chui l montefusco l puccio eds academic press new york pp 197212 suitable fitting functions data sphere method based tensor products polynomial splines trigonometric splines adapted produce surfaces either tangent plane continuous almost tangent plane continuous result convenient compression algorithm dealing large amounts data sphere give full details computer implementation highly efficient respect storage computational cost also demonstrate performance method several test examples b introduction many applications eg geophysics meteorology medical modelling etc one needs construct smooth functions defined unit sphere approximate interpolate data shown 11 one way work tensorproduct functions form e defined rectangle quadratic polynomial bsplines gamma2 2 periodic trigonometric splines order three 0 2 care choice coefficients see sect 2 associated surface 1 institutt informatikk university oslo pobox 1080 blindern 0316 oslo norway tomifiuiono supported nato grant crg951291 part work completed stay institut national des sciences appliquees laboratoire approximation et optimisation universite paul sabatier toulouse france department mathematics vanderbilt university nashville tn 37240 smarscasvanderbiltedu supported national science foundation grant dms9803340 nato grant crg951291 tangent plane continuous practice often encounter large data sets get good fits using tensor product splines 11 large numbers knots required resulting many basis functions many coefficients since two spline spaces nested knot sequences nested one way achieve efficient fit without sacrificing quality look multiresolution representation 11 ie recursively decompose splines coarser meshes corresponding correction wavelet terms compression achieved standard way thresholding small coefficients paper organized follows sect 2 introduce notation give details tensor product splines used sect 3 describe general decomposition reconstruction algorithm matrix form sect 4 present tensor version algorithms required matrices corresponding polynomial trigonometric spline spaces respectively derived sections 5 6 sect 7 devoted details implementing algorithm sect 8 present test examples sect 9 several concluding remarks x2 tangent plane continuous tensor splines standard normalized quadratic bsplines associated knot sequence recall supported interval x bsplines form partition unity gamma2 2 let classical trigonometric bsplines order 3 defined knot sequence m3 x see sect 6 recall j supported interval associated 2periodic trigonometric bsplines see 10 splines normalized oe 2 0 2 e cos x e cos x e sin x since left right boundaries h map north south poles respectively function f form 11 welldefined x fs fn values poles since f 2periodic oe variable c 1 continuous variables might expect corresponding surface f continuous tangent plane nonpolar points however since working parametric setting needed following theorem shows mild conditions f normally satisfied practice get tangent plane continuity except poles theorem 21 suppose f spline 11 satisfies conditions 25 addition f oe 0 oe 2 h corresponding surface f tangent plane continuous nonpolar points proof since f c 1 spline partial deriviatives f f oe continuous h two tangents surface f point f oevv v v v v v vv oe normal vector surface point given cross product nn n n n n n nn 1 theta 2 hypotheses continuous thus assure continuous tangent plane suffices show nn n n n n n nn positive length insures surface singular points cusps using mathematica easy see theta cos 2 f clearly positive values oe 2 h 6 sigma2 additional side conditions coefficients f make surface f also tangent plane continuous poles required conditions cf 311 cos x sin cos x bn sin bs bn constants x3 basic decomposition reconstruction formulae suppose nested sequence finitedimensional linear subspaces innerproduct space x ie let corresponding orthogonal decompositions application convenient express decomposition reconstruction matrix form cf 12 let kmk basis v k let basis w nestedness exists k theta kgamma1 matrix p k equation 31 usual refinement relation similarly exists k theta let gram matrices size k theta k n kgamma1 theta n kgamma1 respectively easy see clearly gram matrices g k h symmetric linear independence basis functions oe ki ki implies g k h positive definite thus nonsingular following lemma shows decompose reconstruct functions v k terms functions v kgamma1 w kgamma1 lemma 31 let f k k function v k associated coefficient vector k 2 ir mk let orthogonal decomposition moreover proof find kgamma1 take innerproduct sides 35 kgamma1i using refinement relation 31 orthogonality kgamma1i kgamma1j get gives formula kgamma1 instead take innerproducts get formula b kgamma1 view linear independence functions reconstruction formula 36 follows immediately 35 refinement relations x4 tensorproduct decomposition reconstruction section discuss decomposition reconstruction functions tensor product spaces v k theta e previous section e similar subspaces innerproduct space e x particular suppose e e previous section let e analogous matrices associated spaces e theorem 41 let f k k function v k theta e associated coefficient matrix k f k orthogonal decomposition f 2 matrices computed system equations g e g e e e e g e e e e moreover e e e e proof find formula kgamma1gamma1 take innerproduct sides 41 kgamma1i gamma1j formulae b obtained similar way reconstruction formula follows directly 41 inserting refinement relations using linear independence components vectors k note computing matrices kgamma1gamma1 b decomposition step done quite efficiently since several matrix products occur need solve linear systems equations involving four matrices g g h shall see setting first two banded matrices second two periodic versions banded matrices precomputed stored compact form x5 decomposition matrices polynomial splines section construct matrices p k q k g k needed decomposition reconstruction quadratic polynomial splines closed interval gamma2 2 consider nested sequence knots associated normalized quadratic bsplines supports intervals x k k span v k kmk k dimensional linear space c 1 quadratic splines knots x k spaces clearly nested addition wellknown refinement relations simple computation shows equations 52 53 provide entries matrix p k particular first two last two columns determined 53 3 2 ith column p k contains zeros except four rows contain numbers 14 34 34 14 example general p k two nonzero entries row four nonzero entries column order construct matrices q k give basis wavelet space w kgamma1 work usual l 2 innerproduct l 2 gamma2 2 let theorem 51 given k 1 let k 2 let gamma6864gamma4967gamma4061 addition k 2 let form basis w kgamma1 proof wavelets 55 wellknown quadratic spline wavelets see eg 1 described 5 coefficients remaining wavelets computed forcing orthogonality v kgamma1 view 32 wavelets linearly independent matrix q k full rank follows since submatrix q k obtained taking rows easily seen diagonally dominant alternate proof linear independence see lemma 11 5 view properties bsplines easy see 2 describe matrices q k theorem 51 general k 2 nonzero elements third column q k repeated successive column shifted two rows first two last two columns q k contain nonzero elements q 2 clearly q k 4 nonzero entries row 8 nonzero entries column describe gram matrices g k general symmetric fivebanded get g k start matrix 66h k 120 diagonal 26h k 120 first subdiagonal h k 120 second diagonal replace entries 3 theta 3 submatrices upperleft lowerright corners example x6 decomposition matrices trigonometric splines section present matrices e needed decomposition reconstruction periodic trigonometric splines order 3 suppose 1 nested sequence knots h 0 otherwise usual trigonometric bspline order three associated uniformly spaced knots 0 h 2h 3h set ae oe later use define em span e em space periodic trigonometric splines order three clearly spaces nested fact following refinement relation theorem 61 proof nestedness nature support h numbers u v w z symmetry enough compute u v find u note 0 h using 62 solve u find v note solve v using 62 theorem 61 used find entries matrix e needed sect 2 particular column exactly four nonzero elements starting first row column one shifted two rows time move one column right last column last two elements moved top column example e next describe basis wavelet space f w gamma1 dimension 1 case work usual l 2 innerproduct theorem 62 given 1 let basis space f proof construct wavelets f apply theorem 51 6 gives explicit formulae q terms innerproducts gamma1j show linearly independent suffices show e full rank see construct n gamma1 theta moving last column e front first column selecting rows 2 show matrix strictly diagonally dominant thus full rank first note row b element diagonal sum absolute values diagonal elements jq 1 h j simple computation shows functions dh r h taylor expansion alternating series particular using first two terms series get easy see theta jq 3 also alternating series expansion get range h shows b strictly diagonally dominant proof complete formulae q theorem 62 appropriate small values case use following taylor expansions rather computing time need precompute store necessary values see table 1 sect 7 describe matrix e needed sect 2 decomposing reconstructing trigonometric splines e evaluated h 1 2 column e contains 8 entries evaluated h particular entries start row 1 column 1 shifted two time move one column right last three columns entries falling last row moved top clearly e q exactly four nonzero entries row example e evaluated h 2 finally describe gram matrices theorem 63 1 3 associated given e 00 01 01 00 01 02 01 00 01 01 00 01 02 01 00 01 01 z x 01 z x 00 z x moreover e proof using 62 necessary integrals computed directly formulae theorem 63 clearly appropriate small values case following formulae used precompute store values 00 01 02 various levels see table 2 sect 7 values x7 implementation 71 decomposition decomposition procedure begins tensor spline form 11 based polynomial splines ki given level k 1 periodic trigonometric splines j oe given level 1 coefficient matrix c k size k theta e carry one step decomposition solve systems 42 set continue decomposition carry procedure matrix kgamma1gamma1 process repeated mink times step new spline coefficients wavelet coefficients stored c thus entire decomposition process requires additional storage beyond original coefficient matrix banded nature matrices appearing 42 careful programming use appropriate band matrix solvers jth step decomposition carried om kgammaj1 e help keep number operations small possible precompute store entries matrices g appearing 42 table 1 gives values needed e table gives values h needed e g matrices h k symmetric positive definite sevenbanded e h symmetric positive definite periodic sevenbanded matrices check robustness decomposition process computed exact condition numbers matrices g k h k e h eight levels none condition numbers exceeded 10 conclude algorithm highly robust 6 28996175484404513950 14695303891951439472 30286111072242944246 9 28999940238853933503 14699926613409589417 30299782947935722381 tab 1 trigonometric spline wavelet coefficients various 72 thresholding typically jth step decomposition many entries matrices kgammajgammaj wavelet coefficients quite small thus achieve compression removed thresholding process view 56 tangent plane continuity maintained poles retain coefficients first two last two rows matrices given ffl jth level remove 9 05500021215280431720 021666764608909212581 0008333384794548569195 tab 2 inner products trigonometric bsplines various wavelet coefficients b 1 kgammajgammaj whose absolute values smaller ffl2 j b 3 kgammajgammaj using threshold value ffl300 smaller threshold applied scaling wavelets 73 reconstruction view 43 carry one reconstruction step simply involves matrix multiplication using stored matrices band nature matrices computation kgammajgammaj requires om kgammaj e operations step reconstruction store coefficients matrix c decomposition carried x8 examples test general performance algorithms begin following simple example example 1 let tensor spline coefficients discussion since normalized quadratic bsplines form partition unity follows 21 coefficients j 1 oe 2 h ie corresponding surface exactly unit sphere case coefficient matrix size 770 theta 1536 involves 1182720 coefficients test algorithms performed decomposition various values ffl including zero cases reconstruction got coefficients correct machine accuracy working double precision run time typical workstation seconds full 7 levels decomposition reconstruction illustrate ability multiresolution approach achieve high levels compression retaining important features surface create tensor spline fit smooth surface number bumps example 2 let b surface shown upper lefthand corner figure 1 discussion surface b created fitting spline f 88 data created choosing 10 random sized subrectangles random positions h adding tensor product quadratic bsplines maximum height 34 support rectangle constant values corresponding unit sphere coefficient matrix size 770 theta 768 involves 591360 coefficients test algorithms performed decomposition thresholding values 9 table 3 shows results typical run step nco 6 9746 tab 3 reduction coefficients example 2 almost 34 coefficients removed first step decomposition 7 steps end 9745 coefficients amounts 601 compression ratio table 4 shows differences original coefficients coefficients obtained reconstruction table lists maximum norm average 1 norm mem original coefficients c ij reconstructed ones due scaling wavelets numbers somewhat larger corresponding ffl surfaces corresponding values shown figure 1 near perfect looking reconstruction major features reproduced small wiggles surface fig 1 compressed surfaces example 2 larger oscillations surface example shows critical value ffl beyond surface exhibits increasing oscillations little additional compression x9 remarks remark 91 approach discussed paper first presented taormina wavelet conference october 1993 far know first spherical multiresolution method proposed corresponding proceedings paper 6 focuses general theory lspline wavelets due space limitations full description method could included meantime tab 4 coefficient errors example 2 selected ffl become aware recent work 248913 2 authors use tensor splines based exponential splines oe variable method 4 uses discretizations certain continuous wavelet transforms based singular integral operators method 8 uses tensor functions based polynomials trigonometric polynomials finally method 9 utilizes c 0 piecewise linear functions defined spherical triangulations except last method aware implementations methods remark 92 original paper 6 alternative way making sure tangent plane continuity maintained poles proposed idea decompose original tensor product function two parts h p mk gamma2 e reconstruction performed h adding p reconstructed spline possesses tangent plane continuity poles implementation method exhibits essentially performance terms compression accuracy method described higher compression ratios produces surfaces quite visually pleasing near poles remark 93 method described extended case nonuniform knots oe variables case computational effort increases considerably since various matrices longer precomputed stored remark 94 sect 4 presented details tensorproduct decomposition reconstruction algorithms assuming initial function f k lies space v k phi e necessarily since spaces always reindexed strictly necessary abstract setting convenient application natural indexing spaces remark 95 computing coefficients needed sections 5 6 found convenient use mathematica remark 96 several methods computing approximations form 11 explicit quasiinterpolation method using data regular grid along derivatives north south poles found 11 paper also describes twostage method used interpolate scattered data least squares method used fit noisy data general theory quasiinterpolation operators based trigonometric splines found 7 remark 97 closed bounded connected set u ir 3 topologically equivalent sphere called spherelike surface means exists onetoone mapping u onto unit sphere moreover exists point inside volume surrounded u every point surface u seen surfaces also called starlike applications focus class spherelike surfaces form ae smooth function defined function f defined u composition ae function g defined remark 98 indicated 9 compression methods sphere adapted problem creating multiresolution representations bidirectional reflection distribution functions brdfs althought basic domain functions actually hemisphere explore use method purpose later paper remark 99 wellknown polynomial bsplines stable particular quadratic bsplines general knots3 kck1 k coefficient vectors c bounds hold trigonometric splines since linear functionals introduced 11 dual analogous stability results hold general pnorms r introduction wavelets multiresolution analysis wavelets 2 3 algorithms smoothing data sphere tensor product splines spherical wavelet transform discretiza tion wavelets theory efficiently representing functions sphere basic theory fitting scattered data spherelike surfaces using tensor products trigonometric polynomial splines wavelets computer graphics biorthogonale wavelets auf der sphare tr ctr thomas w sederberg david l cardon g thomas finnigan nicholas north jianmin zheng tom lyche tspline simplification local refinement acm transactions graphics tog v23 n3 august 2004 el bachir ameur driss sbibih quadratic spline wavelets arbitrary simple knots sphere journal computational applied mathematics v162 n1 p273286 1 january 2004 john e lavery shapepreserving interpolation irregular data bivariate curvaturebased cubic l