sensorbased intrusion detection intradomain distancevector routing detection routingbased attacks difficult malicious routing behavior identified specific network locations addition configuration signatures used intrusion detection sensors timeconsuming errorprone task take account network topology characteristics particular routing protocol use describe intrusion detection technique uses information network topology positioning sensors determine considered malicious particular place network technique relies algorithm automatically generates appropriate sensor signatures paper presents description approach applies intradomain distancevector protocol reports results evaluation b introduction attacks ip routing infrastructure used perform substantial denialofservice attacks basis sophisticated attacks maninthemiddle nonblindspoofing attacks given insecure nature routing protocols currently use preventing attacks requires modifications routing protocols routing software possibly network topology critical role routing considerable inertia process consequence insecure routing protocols still widely use throughout internet complementary approach securing routing infrastructure relies detection routing attacks execution permission make digital hard copies part work personal classroom use granted without fee provided copies made distributed profit commercial advantage copies bear notice full citation first page copy otherwise republish post servers redistribute lists requires prior specific permission andor fee ccs02 november 1822 2002 washington dc usa appropriate countermeasures detecting routing attacks complex task malicious routing behavior identified specific network locations addi tion routing information propagates router router throughout network therefore presence malicious routing information necessarily restricted location attack carried describe misuse detection technique uses set sensors deployed within network infrastructure sensors intrusion detection components equipped set signatures describe characteristics malicious behavior trac sent network links matched signatures determine malicious use multiple sensors intrusion detection wellestablished practice analysis network trac dierent locations network supports comprehensive intrusion detection respect singlepoint analysis disadvantage distributed approach diculty configuring sensors according characteristics protected network problem exacerbated nature routing configuration sensors take account network topology positioning sensors network characteristics particular routing protocol use addition attacks detected sensors communicate consequence configuration signatures used sensors timeconsuming errorprone task novel contribution approach algorithm given network topology positioning intrusion detection sensors automatically determine signature configuration sensors messages sensors exchange detect attacks routing infrastructure paper introduces general approach describes application routing information protocol rip rip intradomain distancevector routing protocol 13 startup every rip router knows addresses links corresponding addresses every rip router propagates information immediate neighbors receiving routing information neighbors update routing tables add modify delete routes advertised destinations routers add route destination one route modified advertised route better one router already router receives message neighbor advertising unreachability certain destination router using neighbor reach destination router deletes route destination routing table certain conditions rip might converge may exhibit bouncingeect problem counttoinfinity problem 9 problems partially overcome using splithorizon technique triggeredupdates limiting number hops advertised destination 1 order decide whether routing update malicious router needs reliable nonlocal topology information unfortunately rip routers information support routerbased intrusion detection would necessary modify rip protocol routing software therefore approach relies external sensors sensor configurations generated oine basis complete network topology positions sensors network configuration generation algorithm determines every possible path every router every router configuration individual sensor subset information based position sensor network sensors need reconfigured routers links added topology however sensors need reconfigured topology changes due link router failures remainder paper organized follows section related work field section 3 introduces abstract reference model network routing infrastructure section 4 presents algorithm generate configuration intrusion detection sensors rip distancevector protocol section 5 discusses routing attacks detected section 6 describes experimental setup used analyze attacks evaluate detection technique section 7 discusses strengths weaknesses approach section 8 draws conclusions outlines future work 2 related work one earliest works securing routing protocols radia perlman 16 perlman suggests use digital signatures routing messages protect byzantine failures main drawback approach generating digital signatures computationally intensive task signature verification usually expensive solutions use digital signatures require number verified leading considerable performance overhead use digital signatures also advocated murphy et al 14 15 distancevector linkstate advertisements kent et al 12 11 describe approach allow recipient bgp 18 message verify entire path destination smith et al 19 introduce scheme protect bgp using digital signatures also describe scheme secure distancevector routing protocols using predecessor information 20 several schemes proposed reduce performance overhead associated securing routing protocols using digital signatures hauser et al 7 describe two techniques ecient secure generation processing updates linkstate routing zhang 24 describes routing messages protected using onetime 1 limiting number hops ensures route declared unusable protocol converge number advertised hops exceeds maximum number allowed hops however also limits diameter networks rip used signatures message chains 6 goodrich describes leapfrog cryptographic signing protocol uses secretkey cryptography research referenced far focuses preventing attacks complementary approach problem securing routing infrastructure focuses detecting attacks 1 5 8 example cheung et al 3 4 present solutions denialofservice problem routing infrastructure using intrusion detection another example protocol called watchers described bradley et al 2 protocol detects reacts routers drop misroute packets applying principle conservation flow routers network jinao project mcncncsu focuses detecting intrusions especially insider attacks ospf wu et al 21 17 23 22 10 consider eciently integrate security control intrusion detection single system approach described paper diers intrusion detection approaches focuses topological characteristics network protected placement detection sensors approach relies topology information automatically generate signatures used sensors detect attacks details algorithm application described following sections 3 reference model abstract reference model network introduced describe algorithm used generate signatures signatures used detect attacks routing infrastructure network represented undirected graph e vertices vn denote set routers positive weight edges links connecting router interfaces routers v v j 2 subnet range ip addresses network mask every link e ij associated subnet ij s1 s2 sm set subnets corresponding set links e assume e every vertex associated set e represents set edges connected v j set subnets corresponding set links e j every link e ij associated cost sensor placed link e ij identified sensor ij host p connected link e ij denoted h p ij consider subgraph gsub g shown figure 1 context routing problems occur due faults routers due malicious actions routers host h p ij hosts routers termed malicious compromised used means modify normal operation network network failures threats due malicious intent need included threat model sensor cannot always dierentiate two approach described concerned attacks involving injection alteration removal routes specific destinations 2 sake simplicity model consider possibility two routers connected single link model extended support possibility assuming graph g hypergraph 3 model consider possibility links asym metric ie dierent costs dierent directions model extended support asymmetric costs assuming graph g directed graph ik e ik figure 1 threat reference model malicious hosts routers security threats eg unauthorized access information dropping alteration data packets routers etc addressed pre cisely describe threat model respect gsub follows 1 v fails result suboptimal paths paths ij ik viceversa 2 v compromised misconfigured advertise suboptimal infinitecost path ik result suboptimal paths paths ij ik 3 v j compromised misconfigured advertise better optimal path ik result hosts subnet ij using v j reach hosts subnet ik even though v better route subnet ik actually path subnet ik packets subnet ij reach subnet ik 4 h p ij pretends v respect v j pretends either v j vk respect v h p ij advertise routes 2 3 5 h p renders v unusable pretends v h p advertises information v since v unusable packets get routed gsub represents segment network represented g incorrect routing information generated sensor present every link gsub faulty malicious entity identified response process initiated absence sensors every link gsub incorrect routing information propagate rest network case attack still detected determining origin attack requires analysis eects incorrect routing information analysis considerably dicult perform scope approach described 4 sensor configuration sensor configured basis network topology sensors position network sensors position network specified link sensor placed separate component called sensor configurator given network topology position available sensors inputs sensor configurator uses algorithm generate configuration sen sor configurations loaded appropriate sensors first step sensor configurator algorithm find paths corresponding costs every e e figure 2 sensor configuration example router every router graph g results organized 2dimensional vertextovertex matrix th entry matrix points list 2tuples ij list contains tuple path vertices ij set vertices traversed reach v j v c k ij cost path p k ij vertices example consider figure 2 v1 v2 v3 routers e12 e13 e23 e24 e35 links associated subnets respectively cost links equal 1 table 1 shows vertextovertex matrix graph figure 2 cost path entry row v1 column v1 set possible paths corresponding costs vertex v1 take reach vertex v1 entry 0 means vertex v1 reach vertex v1 cost 0 entry row v1 column v2 means vertex v1 reach vertex v2 cost 1 cost 2 vertex v3 second step algorithm vertextovertex matrix transformed 2dimensional vertextosubnet matrix column representing vertex v j vertextovertex matrix replaced set columns one subnet directly connected vertex ie one member j consider set columns replacing column set paths vertextosubnet matrix ijx k th path router v subnet jx vertextosubnet matrix p k ij corresponding path vertextovertex matrix set costs vertex tosubnet matrix c k ijx cost k th path router v subnet jx vertextosubnet matrix c k ij corresponding cost vertextovertex trix c jx cost link e jx associated subnet jx cost must taken account c k ij represents cost path router v v j cost reach subnet jx router v j added c k get total cost c k ijx example vertextovertex matrix shown table 1 transformed vertexto subnet matrix shown table 2 cost path entry row v1 column s12 set possible paths vertex v1 take reach subnet s12 corresponding costs entry 1 v1 means vertex v1 reach subnet s12 cost 1 v1 entry row v1 column s23 means vertex v1 reach subnet s23 cost 2 vertex v2 cost 3 vertices v3 v2 v1 0 1 2 v3 1 2 v2 v2 1 2 v3 0 1 2 v1 v3 1 2 v2 1 2 v1 0 table 1 vertextovertex matrix v1 1 v1 1 v1 2 v2 2 v2 2 v2 2 v3 2 v3 2 v3 3 v3 v2 3 v3 v2 3 v3 v2 3 v2 v3 3 v2 v3 3 v2 v3 v2 2 v1 2 v1 1 v2 1 v2 1 v2 2 v3 2 v3 2 v3 3 v3 v1 3 v3 v1 3 v1 v3 3 v1 v3 3 v1 v3 v3 2 v1 2 v1 2 v2 2 v2 2 v2 1 v3 1 v3 1 v3 3 v2 v1 3 v2 v1 3 v1 v2 3 v1 v2 3 v1 v2 table 2 vertextosubnet matrix vertextosubnet matrix format similar one used routers vertextosubnet matrix computed entire network portion vertextosubnet matrix relevant sensor extracted sensor uses vertextosubnet matrix validate routing advertisements sent link sensor placed precisely sensor ij placed link e ij needs validate routing advertisements routers v v j 4 therefore vertextosubnet matrix sensor ij rows common vertextosubnet matrix corresponding entries vertextosubnet matrix may correspond actual routing information therefore matrix reduced ignoring entries consider vertextosubnet matrix sensor ij link e ij routers v v j ik subnet link e ik routers v vk sab subnet context vertextosubnet matrix sensor ij reduced according following rules 1 neighboring routers v vk row v columns ik ski cost path tuple ignored path form vk example table 2 row v1 column s31 cost path tuple 2 v3 ignored subnet s31 directly connected router v1 therefore v1 never advertise route link e12 subnet s31 router v3 cost 2 2 row columns sab sba cost path tuple ignored path form va v b example table 2 row v1 column s23 cost path tuple 3 v3 v2 ignored router v1 reach subnet s23 cost router v3 therefore v1 advertise route subnet s23 v3 v2 cost 3 3 neighboring routers v v j row v columns ij ji cost path tuple ignored example table 2 row v1 column s12 cost path tuple 2 v2 ignored routers v1 v2 directly connected subnet s12 cost s12 router v2 never use longer path v1 reach directly connected subnet 4 sensor needs validate routing advertisements routers connected link placed distancevector routers advertise routing information links connected directly s12 therefore v1 never advertise route v2 4 neighboring routers v v j row v column cost path tuple ignored path form v j example table 2 row v1 column s23 cost path tuple 2 v2 ignored route advertised v1 subnet s23 first hop router v2 v1 learned route v2 implies v2 better route s23 v1 never use v1 reach s23 fore v1 never advertise route v2 splithorizon check rip ensures thing simplification vertextosubnet matrix sensor ij rows v v j term v actually replaced tuple v link link linklevel address interface router v connected corresponding ip address similarly replaced tuple v link finally information regarding position sensors added vertextosubnet matrix marking links sensors placed 5 sensor detection algorithm oine process generating sensor configurations completed configurations loaded sensors runtime sensors analyze routing advertisements sent corresponding link match contents routing advertisement configuration decide whether routing advertisement represents evidence attack consider sensor ij placed link e ij addition storing link link sensor ij also stores e link bcast ij e ip bcast ij linklevel ip broadcast addresses link e ij rip linkmcast rip ipmcast linklevel ip multicast addresses rip routers vertextosubnet matrix sensor ij also stores cost path sets router v subnet sab form c optimal cost router v send data subnet sab path p iab multiple optimalcost paths p iab costs c iab router v subnet sab c iab router v also send data subnet sab path iab suboptimal cost c 1 iab multiple suboptimalcost paths p 1 iab router v subnet sab next consider distancevector routing advertisement type linklevelheader ipheader udpheader distancevector routing routing advertisement linksrc link dst linklevel source destination addresses respectively ipsrc ip dst ip source destination addresses spectively ttl timetolive field ip header c ab cost advertised subnet ab using information stored sensor information contained routing message possible verify correctness linklevel networklevel information plausibility distancevector information messages needed verify advertised routes frequency routing updates four verifications described following sections 51 linklevel networklayer information verification legitimate routing advertisement must linklevel address ip address one routers connected link 5 timetolive value equal 1 following relation fields linksrc link dst ipsrc ip dst ttl c ab ab legitimate routing advertisement link link dst v link link dst e link bcast bcast link dst rip linkmcast v ipmcast link link dst v link link dst e link bcast bcast link dst rip linkmcast ipmcast relation linklevel ip source addresses routing advertisement router v linklevel ip destination addresses router v j broadcast address link e ij multicast address rip routers originated router v j source linklevel ip addresses router v j destination linklevel ip addresses router v broadcast address link e ij multicast address rip routers timetolive field 1 note linklevel networklayer information spoofed therefore verification alone enough conclude routing advertisement malicious 52 distancevector information verification routing advertisements subnets belong local autonomous system indicate routing advertisements malicious 6 sensor scans routing ad 5 distancevector routing protocols routing advertisements meant routers immediate neighbors 6 routers running intradomain routing protocols routes every possible subnet usually routes subnets sensor 34 sensor 12 sensor sensor 67 sensor 89 e 34 e e 78 e e 67 e 26 e 59 figure 3 sensor detection example vertisement attacks matching every advertised subnet list subnets sensor config uration sensor find match declares routing advertisement malicious next routing advertisement analyzed determine whether advertised cost optimal suboptimal im possible optimal cost cost one shortest paths router destination advertised router suboptimal cost cost one paths router destination advertised router path may necessarily shortest impossible cost cost associated paths router destination advertised router unreachability ie advertised cost 15 considered suboptimal rather impossible consider routing advertisement originating router v link e ij advertising cost c ab subnet ab sensor configuration defines following costs reaching sab optimalcost suboptimalcost impossiblecost relation states routing advertisement advertised router v subnet sab cost c ab optimal belongs set optimal costs suboptimal belongs set suboptimal costs impossible belong set optimal costs suboptimal costs assuming sensor correct topological information impossiblecost advertisement detected sensor considered malicious betterthanoptimalcost routing advertisements detected checking routing advertisements impossiblecost advertisements example consider figure 3 costs links equal 1 set optimal costs router v2 advertise subnet s45 link e12 3 using path v2 v3 v4 set suboptimal costs router v2 advertise subnet s45 link e12 5 6 6 paths v2 v6 v7 v8 tively paths router v1 considered since router v2 advertise paths learned router v1 link e12 costs advertised router v2 link e12 subnet s45 3 5 6 impossible costs side autonomous system known border routers nonborder routers use default routes border routers external subnets 53 path verification impossiblecostadvertisement verification cannot determine validity optimalcost suboptimalcost advertisement malicious entity advertise suboptimal cost destination even though corresponding optimalcost path available use example figure 3 subnet s45 reached cost 3 router v2 malicious entity link e12 pretend router v2 cost 6 subnet s45 result router v1 using router v10 instead router v2 send data subnet s45 malicious entity also advertise optimal cost optimalcost path available example figure 3 malicious entity link e12 pretend router v2 advertise cost 3 subnet s45 subnet s45 longer reachable using path v2 v3 v4 addi tion malicious entity subvert router configure drop data packets may impersonate router disabled router attacks advertised distancevector information correct therefore attacks cannot detected merely verifying distancevector informa tion detect attacks sensors use pathverification algorithm consider sensor ij link e ij routers v v j sensor ij finds routing advertisement cost c ab advertised router v subnet ab optimal suboptimal costs c k ab sensor searches configuration paths p k iab cost c k iab set sensors path p k iab sensor k iab sensor ij verifies path p k iab sending message every sensoryz iab example consider figure 3 case sensor12 link e12 detects routing advertisement router v2 subnet s45 cost 3 therefore sensor12 searches configuration find paths cost 3 sensor12 finds path v2 v3 v4 cost 3 con figuration sensor12 also information path links e34 e45 sensor34 sensor45 validate advertisement sensor12 sends messages sensor34 sensor45 advertised cost 5 sensor12 would sent messages sensor67 sensor89 sensor45 pathverification algorithm formally stated follows sensor ij link e ij verifies routing advertisement router v advertising optimal suboptimal cost c ab subnet sab using following steps 1 c ab optimal cost c iab router v subnet configuration find paths iab router v subnet sab corresponding cost c iab set available sensors sensor k paths 2 sensor k sensors path verify path router v subnet sab exists sensors every link path p k iab entire path verified sensors present every link path p k iab sensor present eab intermediate path cannot verified verified subnet sab reachable router v sensor present eab cannot verified whether subnet sab reachable router v 3 sensor k iab sensor ij sends message every sensoryz sensor k iab every path p k iab 4 every path p k iab available path every iab replies sensor ij one available paths p k valid routing advertisement none declares malicious 5 c ab suboptimal cost sensor ij searches configuration find paths p q k iab router v subnet sab corresponding every cost c q iab c c q iab optimal cost router v subnet sab sensor ij also determines sets available sensors sensor q k iab corresponding paths p q k iab sends message every sensoryz sensor k paths p k iab router v subnet sab corresponding every cost c iab c iab optimal cost router v subnet sab note dierence p q k iab iab latter contain paths costs equal c ab therefore p k iab sensor k iab 7 every path p k iab available path every iab replies sensor ij available exist sensor ij verifies paths p k router v subnet sab corresponding cost ab every path p k iab every sensoryz iab replies sensor ij available path one available paths p k routing advertisement cost c ab considered valid routing advertisement available paths sensor ij declares malicious 8 every available path p k iab ie every sensoryz iab replies sensor ij sensor ij waits timeperiod delay every available path p k sensor ij get routing advertisement cost c k iab within delay sensor ij declares routing advertisement malicious example consider figure 3 sensor12 detects routing advertisement router v2 subnet s45 cost 3 sensor12 searches configuration finds 3 optimal cost router v2 subnet s45 sensor12 finds path v2 v3 v4 cost 3 therefore sensor12 sends messages sensors available path ie sensor34 sensor45 sensor12 get replies sensor34 sensor45 concludes path router v2 subnet s45 unavailable sensor12 gets reply sensor45 sensor34 sensor12 conclude subnet s45 reachable router v2 cannot verify path sensor12 gets reply sensor34 sensor45 sensor12 cannot sure subnet s45 reachable router v2 sensor12 gets reply sensor34 sensor45 sensor12 sure subnet s45 reachable router v2 placement sensors figure 3 sensor12 never sure complete optimal path router v2 subnet s45 since link e23 sensor assume sensor12 detects routing advertisement router v2 subnet s45 cost 5 sensor searches configuration finds 5 suboptimal cost router v2 subnet s45 identifies path v2 v6 v7 v8 v4 path cost 5 router v2 subnet s45 addition sensor looks paths costs greater equal optimal cost less 5 path case path optimal cost 3 therefore sensor12 sends messages sensors available path cost 3 sensor12 finds path unavailable sensor12 sends messages sensors available path cost 5 ie sensor67 sensor89 sensor45 sensor12 gets replies sensor67 sensor89 sensor45 routing advertisement cost 5 valid however possible reliably determine path cost 3 unavailable general hostile environment sensor determine availability path subnet cannot determine unavailability dropping rerouting message requesting sensor replying sensor malicious entity make requesting sensor believe path subnet unavailable hand malicious drop reroute packets path path unreliable unreliable path good available sensor12 finds path cost 3 available possible either routing advertisement cost 5 malicious routing advertisement due transitory change routing configuration routing advertisement transitory path v2 subnet s45 cost 3 available v2 eventually advertise route subnet s45 cost 3 sensor12 see routing advertisement cost 3 routing advertisement cost 5 malicious sensor12 sees routing advertisement cost 3 sensor verify path cost 5 54 timing verification routers advertise routing messages certain intervals time interval time rip messages advertised rip interval router send one rip message rip interval 7 rip high threshold maximum number packets sensor ever see within rip interval sensor maintains counter rip counter timer rip timer router v connected link sensor placed sensor initializes rip timer sets rip counter 0 sets timeout value rip interval sensor increments rip counter every rip advertisement sees router v rip counter greater rip high threshold rip timer expires considered attack sensor also maintains value rip low threshold minimum number packets sensor see within rip interval rip counter less rip low threshold rip timer expires inferred router working could due denialofservice attack router due failure rip high threshold rip low threshold implementation topology dependent values experimentally statistically determined network 6 experimental validation experimental testbed network built test vulnerability routing protocols testbed routers multihomed pcs equipped gnu zebra routing daemon version 091a testbed contains five dierent autonomous systems autonomous systems exchange 7 rip information one router may split advertised multiple rip messages routing information using bgp interior gateway protocol used within autonomous systems either rip ospf figure 4 schematic complete testbed topol ogy experiments presented paper use autonomous system 1 autonomous systems used conduct experiments ospf bgp experiments discussed paper networks testbed addresses range 192168xx network subnet mask 255255 2550 following subnet x used denote subnet 192168x0 address xx denotes ip address 192168xx following sections discuss three simple attacks carried testbed attacks proofofconcepts demonstrate vulnerabilities distancevector routing protocols approach described used detect attacks 61 routing loop attack routing loop attack demonstrates false routing information generated remote host propagate routers consequence install wrong routes routing tables consider network shown figure 4 routing loop subnet 30 created spoofing routing advertisements note subnet 30 exist figure 4 spoofed routing advertisements generated host mike source ip address spoofed routing advertisements set address router hotel destination spoofed routing advertisements router foxtrot particular choice source destination addresses dictated particular topology network spoofed routing advertisements source address router golf forwarded golf therefore source spoofed routing advertisement cannot golf addition routers accept routing information neighbors therefore source spoofed routing advertisements hotel spoofed routing advertisements mike routed golf reach foxtrot consequence foxtrot adds route subnet route golf hotel believes hotel source route receiving advertisement foxtrot golf adds route subnet 30 foxtrot golf sends routing advertisement subnet hotel advertisement processed hotel route subnet golf added hotel routing table results routing loop traceroute host india address subnet 30 shows path golffoxtrothotelgolfgolf 62 faulty route attack faulty route attack demonstrates malicious divert trac advertising route cost lower optimal cost consider figure 4 malicious host link golf foxtrot wants access incoming trac subnet 25 achieve attacker convince foxtrot best way reach subnet 25 route trac golf instead romeo route associated romeo cost 2 therefore malicious host pretends golf sends routing message foxtrot advertising route subnet 25 cost 1 consequence foxtrot modifies route subnet 25 routing table new route goes golf instead romeo bravo alpha charlie echo oscar papa quebec november foxtrot golf hotel juliet 11 1231334252 61 627282 91 92104111 121 122132162141151 152172201 211 221as3 as4232 as2 ospf bgp bgp bgp kilo rip romeo sierra242 as5 252 251 tango uniform261272282 bgp bgp figure 4 testbed topology 63 denialofservice attack denialofservice attack malicious hosts links foxtrot golf foxtrot hotel foxtrot romeo collaborate make subnet 10 unreachable fox trot malicious host link foxtrot golf pretends golf spoofs routing advertisements foxtrot advertising unreachability subnet 10 receipt spoofed routing advertisements foxtrot modifies route subnet 10 routing table go hotel instead golf next malicious host link foxtrot hotel pretends hotel spoofs routing message foxtrot advertising unreachability subnet 10 receipt spoofed routing advertisement foxtrot modifies route subnet 10 routing table go romeo instead hotel romeo advertises unreachability subnet 10 foxtrot removes route subnet 10 routing table way reach subnet 10 except golf hotel romeo traceroute foxtrot returns network unreachable error malicious hosts keep sending spoofed routing updates rate faster actual routing updates thus preventing infrastructure reestablishing correct routes experiments demonstrate spoofed routing advertisements unauthorized entities disrupt distancevector routing infrastructure malicious entity advertise nonexistent routes advertise unreachability route actually present advertise betterthanoptimal routes divert trac 64 detection preliminary experimental evaluation intrusion detection approach presented detailed evaluation approach subject current research current objective establish proofofconcept detecting attacks outlined section 6 two sensors placed testbed figure 4 sensor gf placed link routers golf foxtrot sensorgm placed link connecting golf subnet 10 sensor configurations generated following algorithm presented section 4 consider routing loop attack routing advertisements subnet spoofed mike analyzed sen sorgm link connecting golf subnet 10 sensorgm detects source linklevel ip addresses routing advertisements incorrect spoofed routing advertisements source linklevel ip addresses hotel whereas possible routing advertisement link router golf sensor gf also detects spoofed routing advertisements subnet 30 advertised spoofed routing message exist domain consider faulty route attack sensorgf detects routing message appears come router golf advertising route subnet 25 cost 1 therefore sensor gf searches configuration possible paths golf subnet 25 foxtrot first hop possible paths either router uniform router hotel none paths cost 1 therefore sensor gf infers advertised cost golf subnet 25 impossible cost consequence routing advertisement considered malicious consider denialofservice attack sensor gf receives spoofed routing message appears coming router golf considers unreachability sub optimalcost advertisement therefore sensor gf sends message sensorgm validate whether route subnet golf available sensor gf receives reply sensorgm consequence sensorgm concludes routing message malicious 7 algorithm evaluation experimental evaluation validates fact suggested approach successfully detect malicious routing advertisements nonetheless approach limitations discussed 71 computational complexity allpairallpath algorithm used generate sensor configurations finds paths every router every router network algorithm exponential lower bound however algorithm suitable mediumsize sparse topologies several real topologies run rip analyzed allpairallpath algorithm converged acceptable time topologies algorithm converge acceptable time topologies running rip since topologies large dense addition sensor configurations generated line configurations regenerated routers links added topology sensors brought oine time however router crashes link failures require sensor configurations regenerated 72 message overhead another drawback approach additional trac generated validate optimal suboptimal routes sensor trac increases number sensors grows required security guarantees become stringent consider routing advertisement router v advertising path subnet sab sensor sensor ij determines cost advertised impossible cost sensor ij declare routing advertisement malicious without communicating sensor therefore trac overhead case determines cost advertised optimal cost sensor ij search configuration find optimal paths router v subnet sab let set optimal paths router v subnet sab p 3 corresponding set number sensors path n 3 maximum number messages sensor ij generate verify n 1 first optimal path verified p 1 found valid path router v subnet sab sensor ij generate n omessages verify p 1 first path verified noptimal number messages sensor ij generate verify optimalcost advertisement received router v subnet sab assuming every sensor replies every request total overhead 2 noptimal messages determines cost advertised suboptimal cost sensor ij search configuration find set paths p p router v subnet sab p 1 optimal path p 1 1 suboptimal path p 1 path corresponding advertised cost n corresponding set number sensors path maximum number messages sensor ij generate verify paths router v subnet sab costs less advertised cost available nadvertised paths less advertised cost found unavailable sensor ij generate nadvertised messages verify least one path advertised cost available n nadvertised n case total overhead 2 nadvertised nadvertised suboptimalcost advertisement sensor ij might find available path subnet sab router v cost less advertised cost let available path e 34 e 45s sensor 12 sensor figure 5 message overhead example number messages generated sensor ij nadvertised since messages generated verify paths advertised cost unless determined paths costs lesser advertised cost unavailable case total overhead 2 nadvertised path verification done every routing update advertises optimal suboptimal cost every sensor detects routing advertisement generate overhead noptimal every optimal route 2 nadvertised nadvertised every suboptimal route routing advertisement however overheads 2 noptimal 2 nadvertised nadvertised decrease proximity sensor advertised destination increases routing updates generated every seconds assume verification packet size 48 bytes including headers every seconds verification one destination result overhead 48 2 noptimal nadvertised bytes depending whether advertised cost optimal suboptimal example consider figure 5 cost links equal 1 router v4 advertises route subnet s45 cost 1 link e34 sensor34 searches configuration determines advertisement v4 s45 cost 1 optimalcost advertisement since one path v4 v4 s45 sensor45 available sensor path sensor34 sends verification request sensor45 sensor45 replies verification reply sensor34 since verification message size 48 bytes verification sensor34 requires 96 bytes next v3 advertises route subnet s45 cost 2 link e23 since e23 sensor verification messages generated next v2 advertises route s45 cost 3 e12 sensor12 searches configuration determines advertisement v2 s45 cost 3 optimalcost advertisement one path v2 v3 v4 v2 s45 two sensors sensor34 sensor45 available path therefore sensor12 sends one message sensor34 one message sensor45 sensor34 sensor45 reply back therefore verification sensor12 requires 48 bytes entire verification process requires 96 bytes amount overhead generated every seconds overhead due pathverification might tolerable normal circumstances attack conditions overhead discussed depending whether advertised cost impossible optimal sub optimal malicious entity might try use sensors denialofservice attack sending excessive amount routing updates however result generation routing updates sensors threshold condition sensor appropriately scale back path verification mechanism raise alert however overhead due pathverification may unacceptable conditions major part network fails link breaks every router using path contains broken link send routing update neighbors every routing update generate overhead discussed moreover link breakage result suboptimal cost advertisements unreachability advertisements also treated suboptimal cost advertisements overhead verify suboptimalcost advertisement verifying optimalcost advertisement number links fail routes many destinations change become unavailable leading many routing updates consequently increase number sensor verification messages links get reconnected 8 better paths might advertised consequence increase number sensor verification messages message overhead due pathverification protocol reduced reducing number sensors network reducing frequency path verification verifying advertisement selectively however approaches lead weaker security guarantees present work focused reducing overhead due path verification without reducing eectiveness detection possible way reducing overhead modifying path verification algorithm try verify every path corresponds advertised cost instead sending verification message every sensor every path advertised cost verifying sensor sends one message ip address destination subnet message traverse certain path reach des tination sensors present path send back reply verifying sensor based replies sent back sensor decides whether exists path advertised cost replying sensors approach reduce path verification overhead significantly 73 limitations approach capable detecting attacks certain conditions random dropping modification data packets unauthorized access routers cannot detected verifying sensor uses probe packets verify path cost less advertised cost available since malicious router present path verifying sensor destination drop probe packets possible reliably determine consider malicious router every available path cost less advertised cost verifying sensor destination routers drop probe packets verifying sensor made believe paths cost less advertised cost unavailable verifying sensor consider suboptimal path valid even though better paths present attacks cannot detected links sensors present malicious entity advertise false routing information links sensors without detected false routing information accepted routers connected link advertised eects false routing information propagate undetected reaches link sensor present 8 consider links part topology used generate sensor configurations detection scheme might also generate false positives sensors configurations based correct network topology might generate false alarms incorrect threshold values timers also may cause false alarms example sensor sends verification message sets timer within expects receive reply sensor reply gets delayed due network condition false alarms may generated false alarms may also generated verifying sub optimalcost advertisements verify suboptimalcost advertisement sensor first verifies optimalcost paths unavailable verifying sensor receives replies sensors associated optimal path infer optimal path available however sensors placed every link might broken link last sensor used verification optimal path consequence verifying sensor assume optimal path available generate false alarm indicating suboptimal path malicious 8 conclusion paper presented novel approach detect attacks routing infrastructure approach uses set sensors analyze routing trac dierent locations within network algorithm automatically generate detection signatures intersensor messages needed verify state routing infrastructure devised case rip distancevector routing protocol approach described number advantages first implementation approach require modification routers routing protocols current approaches require routers routing protocols changed high cost replacing routers risk largescale service disruption due possible routing protocol incompatibility resulted inertia deployment approaches approach hand deployable provides preliminary solution detecting attacks routing infrastructure second detection process use computational resources routers might additional load routers forward trac generated sensors however additional load much would router perform publickey decryption every routing update received current schemes require third approach supports automatic generation intrusion detection signatures humanintensive errorprone task however approach drawbacks first complexity oine computation generates sensor configurations increases density network graph increases experience suggests problem case reallife topologies could become unmanageable densely interconnected infrastruc tures addition sensors generate additional trac validate routing advertisements amount additional traffic generated increases required security guarantees become stringent finally attacks subverted routers modify contents data packets drop packets selectively cannot detected using approach future work focused extending approach described intradomain linkstate protocols eg ospf interdomain protocols eg bgp vulnerabilities associated protocols already analyzed testbed network preliminary version algorithm ospf bgp protocols devised address largescale networks knowledge complete topology cannot assured working model intelligent decisions made based partial topology information acknowledgments want thank prof richard kemmerer invaluable comments research supported army research fice agreement daad190110484 defense advanced research projects agency darpa rome laboratory air force materiel command usaf agreement number f306029710207 us government authorized reproduce distribute reprints governmental purposes notwithstanding copyright annotation thereon views conclusions contained herein authors interpreted necessarily representing ocial policies endorsements either expressed implied army research oce defense advanced research projects agency darpa rome lab oratory us government 9 r intrusion detection systems taxomomy survey detecting disruptive routers distributed network monitoring approach protecting routing infrastructures denial service using cooperative intrusion detection intrusion detection network infrastructures reducing cost security linkstate routing intrusiondetection system largescale networks routing internet design implementation scalable intrusion detection system protection network infrastructure secure border gateway protocol securebgp real world performance deployment issues secure border gateway protocol securebgp rip version 2 presentation security architecture internet infrastructure digital signature protection ospf routing protocol network layer protocols byzantine robustness statistical anomaly detection linkstate routing protocols border gateway protocol 4 bgp4 vulnerablity protection ospf routing protocol design implementation scalable intrusion detection system ospf routing protocol intrusion detection linkstate routing protocols tr routing internet protecting routing infrastructures denial service using cooperative intrusion detection digital signature protection ospf routing protocol reducing cost security linkstate routing securing distancevector routing protocols vulnerabilities protection ospf routing protocol efficient message authentication scheme link state routing ctr marco rolando matteo rossi niccol sanarico dino mandrioli formal approach sensor placement configuration network intrusion detection system proceedings 2006 international workshop software engineering secure systems may 2021 2006 shanghai china yian huang wenke lee cooperative intrusion detection system ad hoc networks proceedings 1st acm workshop security ad hoc sensor networks october 31 2003 fairfax virginia antonio pescap giorgio ventre experimental analysis attacks intradomain routing protocols journal computer security v13 n6 p877903 december 2005