approximation algorithms 0extension problem 0extension problem given weighted graph nodes marked terminals semimetric set terminals goal assign rest nodes terminals minimize sum edges product edges weight distance terminals endpoints assigned problem generalizes multiway cut problem dahlhaus et al siam j comput 23 1994 pp 864894 closely related metric labeling problem introduced kleinberg tardos proceedings 40th ieee annual symposium foundations computer science new york 1999 pp 1423we present approximation algorithms sc 0extension arbitrary graphs present olog kapproximation algorithm k number terminals also give o1approximation guarantees weighted planar graphs results based natural metric relaxation problem previously considered karzanov european j combin 19 1998 pp 71101 similar flavor linear programming relaxation garg vazirani yannakakis siam j comput 25 1996 pp 235251 multicut problem similar relaxations graph partitioning problems prove integrality ratio metric relaxation least c sqrtlg k positive c infinitely many k results improve results kleinberg tardos understanding use metric relaxations b introduction let v finite set let v let semimetric 1 semimetric v extension v iff every addition every 0extension v consider following optimization problem denoted 0extension given graph e nonnegative edge weights c subset nodes semimetric find 0extension v minimizes total weighted length edges helps compare 0extension multiway cut problem dahlhaus johnson papadimitriou seymour yannakakis 5 6 multiway cut following problem given graph e nonnegative edge weights r subset v terminals find mapping minimize x words find set edges minimum total weight whose removal disconnects terminal pairs define uniform metric ie exactly problem find minimize cu v dfu fv 0extension natural generalization multiway cut instead uniform metric arbitrary semimetric words must find minimize cu v dfu fv dahlhaus et al 6 show multiway cut therefore 0extension apxhard thus exists constant 1 polynomialtime algorithm find solution within factor optimum unless pnp paper develop approximation algorithms 0extension problem study seems us natural linear programming relaxation problem specifically given semimetric extend semimetric larger set v minimize uv2e cu vu v call metric relaxation obviously set feasible extensions defined ojv linear constraints objective function linear thus finding best extension linear programming problem solved polynomial time derive approximation algorithms using metric relaxation thus bounding also integrality ratio relaxation arbitrary graphs give randomized olog jt japproximation algorithm show integrality ratio least constant times log jt j infinitely many jt j improve upper bounds o1 weighted planar graphs fact family graphs excludes k rr minor fixed r karzanov 11 considers metric relaxation 0extension problem characterizes cases relaxation gives optimal solution multiway cut problem known metric relaxation yields 2 2jt japproximation algorithm see 2 indeed observation uses idea underlying combinatorial algorithm dahlhaus et al 6 performance guarantee general case quality metric relaxation known prior work multiway cut different relaxation gives better approximations asymptotic ratio significantly 2 see calinescu karloff rabani 2 r semimetric iff every metric improved bounds cunningham tang 3 karger klein stein thorup young 10 clear calinescu et al relaxation extended handle general case 0extension recent paper kleinberg tardos 14 give approximation algorithms similar problem classification pairwise relations call metric labeling problem terminals distinct vertices called labels semimetric labels node graph vector assignment costs labels goal minimize total assignment cost plus sum weighted edge lengths formally given graph e nonnegative edge weights c set labels metric nonnegative assignment cost function problem finding mapping minimize cu v dfu fv case uniform metric kleinberg tardos give 2approximation algorithm based relaxation similar calinescu et al relaxation multiway cut unlike multiway cut problem integrality ratio relaxation least 2 2jt j chuzhoy 4 improves result three four terminals achieving tight 43 bound three terminals kleinberg tardos give constant approximation algorithm class hierarchically wellseparated tree metrics hst following bartals small distortion embeddings metrics hst metrics 1 use result trees give olog jt j log log jt japproximation algorithm arbitrary metrics gupta tardos 9 later give local searchbased 4approximation algorithm case truncated linear metric ie kleinberg tardos gupta tardos motivate work several applications mostly concerning computer vision image restoration visual correspondence applications nodes graph pixels raster image edges model adjacency fact graph twodimensional mesh image restoration applications labels model pixel intensities colors assigning label pixel amounts determining true intensity color pixel observed values assignment cost penalizes difference observed assigned intensity visual correspondence applications labels model possible shifts two images assigning label pixel amounts determining shift pixel two images assignment cost penalizes difference values supposedly matching pixels types applications structure graph arises assuming priori distribution true labels generated markov random field distribution pixel depends distribution neighbors notice 0extension special case metric labeling set u 62 cu results improve upon results 14 case note 0 extension formulation seems appropriate many computer vision applications mentioned 14 9 example connect pixel weighted edge label corresponding observed intensity get assignment cost proportional distance observed assigned value algorithm weighted planar graphs actually uses fact v n induces planar graph alternative constantratio approximation algorithm computer vision problems another problem related multicut problem first considered context approximation algorithms two papers garg vazirani yannakakis 7 8 implicitly klein agarwal ravi rao 12 problem given weighted graph k pairs terminals nodes graph goal find set edges minimum weight whose removal disconnects every pair terminals different generalization multiway cut latter viewed multicut problem k pairs terminals incomparable 0extension problem sense neither problem special case 8 garg et al give olog jt approximation algorithm multicut problem based metric relaxation assign lengths edges distance every specified pair terminals least 1 result tight relaxation example achieving asymptotically integrality ratio expander upper bounds use regiongrowing technique similar used leighton rao 15 approximating minimum flux edge expansion graph klein plotkin rao 13 improve leightonrao technique planar graphs generally graphs exclude k rr minor get constant factor approximation minimum flux using technique tardos vazirani 17 exhibit constant factor approximation algorithm multicut problem planar graphs k rr result seen counterpart garg et al tardosvazirani results regiongrowing technique give good approximation case 0extension however results viewed form randomized region growing application scaling function distances implicit general case algorithm explicit planar graphs algorithm use klein et al technique scaled distances may worth noting expanders particularly bad case relaxation see section 4 rest paper organized follows section 2 present algorithm general case section 3 improved bounds planar graphs section 4 discuss quality linear programming relaxation underlying approximation algorithms throughout rest paper use k denote number jt j terminals call vertices v n nonterminals olog kapproximation algorithm section present randomized algorithm finds 0extension weight olog times optimum begin computing optimal solution following natural linear programming relaxation denote met minimize cu vu v subject v semimetric 1 assignment defines optimal solution 0extension problem putting u defines feasible solution met weight optimal solution therefore optimal value z met lower bound minimum weight 0extension exhibit rounding procedure takes feasible solution met value z constructs 0extension assignment weight oz log k rounding procedure works follows pick uniformly random permutation independently choose uniformly random interval 1 2 real number rounding algorithm iteratively assigns nodes terminal 1 remaining nodes terminal 2 every rounding procedure given rounding procedure pick random permutation terminals pick uniformly random interval 1 2 unassigned nonterminals u u j u set assign u j endfor endfor first show rounding procedure produces 0extension claim 1 rounding procedure assigns every nonterminal terminal proof consider nonterminal v let 2 terminal v choose j v assigned terminal iterations must assigned iteration j 1 pair nodes u v 2 v define random variable su say separated fu 6 fv notice u v separated su goal bound expectation esu v first state bound probability u v separated lemma 2 fix u pru v separated 4h k u v k kth harmonic number prove bound state prove consequence bound esu v core analysis algorithm lemma 3 pair distinct vertices proof fix u 6 v put u v triangle inequality v u u terminal therefore inequality 3 su v 3 always u v nonterminals triangle inequality terminal j 2 u therefore u assigned terminal regardless choice su always thus may assume u v nonterminals 0 consider two cases depending whether small compared u v u 4 v 5 inequality 3 su v similarly v 4 su v 19 therefore u 4 v 4 lemma holds assume therefore 1 g recall also assume 0 u v u v first inequality follows lemma 2 inequality 3 conclude theorem 4 randomized polynomialtime olog kapproximation algorithm 0extension proof let optimal solution met cost z lemma 3 expected weight 0extension obtained rounding procedure oz log k therefore exists choice produces solution weight oz log k obtain polynomialtime algorithm notice given permutation two different values 1 2 produce combinatorially distinct solutions terminal j node u u thus enumerate kjv j interesting values determine values sorting fractions u ja u nodes u u 0 2 constant 38 somewhat arbitrary definitely could improved proof lemma 2 let eu v denote event terminal j j processed u assigned j whereas v remains unassigned define ev u similarly show symmetry prev u 4h k v therefore lemma follows inequality 4 1 let let notice disjoint subsets terminals put assume rounding procedure uses 2 1 2 v must assigned terminal equivalent r j similarly u cannot assigned terminal indeed u assigned terminal j l j based whether r j j either moreover eu v happens first terminal ms processed indeed first terminal j 2 v possibly also u assigned j thus notice exists j r never empty distributed uniformly 1 2 get z 2m 5 need following claim 5 fix positive integer k let nonnegative real let nondecreasing sequence reals let hr another sequence reals r j 1 j 2 z 2m proof notice 1 function integrating welldefined let largest index l 2 k l t1 2 prove induction value integral h h k z 2m z r 11d assume claim true case 1 values l j 2 consider sequences exactly js l j 2 compare value integral case value 0 integral sequences hl first sequence becomes hl notice latter sequences satisfy conditions claim furthermore 1 js l j 2 therefore inductive hypothesis 0 h 1 l r 0 claim holds case thus may assume l r range integrands differ 2 l minfr 2g range every j l j therefore second pair sequences 1 original sequences 2 l minfr 2g greater 1 difference integrands therefore therefore 0 minfr 2g l r l l 2 r l hence 0 completes proof claim 5 proceed proof lemma 2 notice l j 2 u using assumption 4 u j v u u u u 3 u 4 u hence using claim 5 z 2m combining equation 5 inequality 7 get preu v 4h k u proves inequality 4 thus lemma 3 o1approximation algorithm planar graphs section use linear programming relaxation met get improved bounds planar graphs achieve improved bounds present different rounding procedure show input graph e k rr minor rounding procedure presented section guarantees 3 approximation ratio planar graphs k 33 minor free gives polynomialtime o1approximation algorithm planar graphs generally k rr minor free graphs every fixed r main tool use following theorem klein plotkin rao 13 extension weighted case stated tardos vazirani 17 theorem 6 klein plotkin rao constants polynomialtime algorithm kprh c r takes input graph nonnegative integral edge nonnegative edge costs c eh q positive rational positive integer r finds either 1 k rr minor h 2 set edges total ccost r e2eh ece whose removal decomposes h connected components shortest path h using edge lengths two nodes component r 2 let r positive integer let r feasible solution met weight z using theorem 6 exhibit deterministic rounding procedure obtains 0extension weight oz assuming input graph g k rr minor free main idea rounding procedure partition nonterminals clusters two nodes u v cluster u twice v assign nodes cluster terminal closest one nodes cluster formally rounding procedure computes 0extension follows second rounding procedure every terminal every nonterminal u 2 v endfor let e subgraph g induced remaining nonterminals v 0g every edge uv 2 cuv cu v maxfa g endfor execute kpr g resulting cluster c v choose x 2 c minimize x choose endfor first establish simple facts rounding procedure let uv2 uvcuv 7 z 2z min proof notice u v 0 u v min maxfa uv2 uv2 u v uv2 8 total ccost edges removed kpr g c 12r 2 min r 3 z resulting clusters c diameter 12 min proof theorem 6 sum cuv edges uv u v different clusters r z claim 7 4r 3 z 3 z also theorem 6 diameter resulting cluster c 12 relate distances original distances lemma 9 let u v 2 length shortest path g u v respect edge lengths 12 min u v u proof let vi shortest path g u v respect edge lengths 1 j let triangle inequality x u notice 1 2 j therefore j x 1 x also therefore x using j 1 last inequality follows hypothesis length hx 12 min conclude j u finally notice triangle inequality u v j ready analyze performance rounding procedure lemma 10 let r 0 integer every input graph g k rr minor free every feasible solution met weight z rounding procedure produces 0extension weight 3 z proof let uv 2 e edge g endpoints u v 62 endpoint either terminal node distance 0 terminal hence dfu u 62 together cluster c contains assigned terminal definition rounding procedure node x 2 c x combining claim 8 lemma 9 v x v therefore using triangle inequality v 2a v using triangle inequality dfu however u therefore dfu fv 3u v left edges uv 2 e denote cluster containing u uv2 uv2 however g second inequality follows fact definition algorithm every nonterminal u fu terminal closest x 2 cu fu argued previous case x u u inequality follows triangle inequality fu u therefore uv2 uv2 uv2 cuv uv2 states uv2 e cu6cv cuv 3 z conclude main result section theorem 11 let r 0 fixed integer deterministic polynomialtime o1approximation algorithm 0extension k rr minor free weighted graphs proof solve met optimally use rounding procedure section clearly implemented polynomial time lemma 10 establishes performance guarantee algorithm 4 integrality ratio section use max flowmin cut theorem prove following lower bound integrality ratio natural relaxation theorem 12 c 0 infinitely many positive integers k instance 0 extension k terminals optimal value objective function least c lg k times optimal value relaxation proof reals 0 infinitely many graphs g known expanders maximum degree g subset jv gj2 nodes least jsj nodes adjacent least one node fact given prime q 13 congruent 1 mod 4 infinitely many lubotzky phillips sarnak construct 6regular expander either qq 2 1 qq 2 12 nodes take given sufficiently large q use expander e need n maxfn 0 16g n 0 determined later define l dlg nee n dnle choose k distinct nodes h new nodes l new edges current graph get new path p starting h ending new node label new node finished let new graph g vertices je define instance 0extension follows vertex set v 0 set terminals f1 2 3 kg k distance g 0 j define cu v 1 uv cu show integrality ratio instance large first study relaxation define u v distance g 0 u v clear also clear semimetric g 0 follows uv cu vu adjacent vertices g 0 distance 1 prove universal c 0 feasible solution ie function uv cu vdfu fv cn lg n note first minimum distance two distinct terminals j least 2l 2 lg n see however least k2 terminals distance terminal least lg n fixed positive constant lg n need lemma lemma 13 2 least k2 vertices h g whose distance h exceeds lg k proof contradiction assume k2 vertices g distance h degree bound number vertices g distance h 1 1 hence k2 a1 hence 1 choose n 0 large enough k function n must least 4 4 giving us contradiction show without loss generality every vertex v 0 v p maps lemma 14 given except new vertices path p map f 0 f uv cu vdfu fv proof name vertices h path v 0 uv uv l 1 triangle inequality l 1 difference nonpositive let us assume maps new vertices p terminal let r ig two cases lg n g expander jr j n2 number edges uv u least jr j hence lg n cross edge counted twice case 2 r say r 1 size exceeding n2 use expansion max flowmin cut theorem prove theorem choose dk2e terminals distance g h h 1 least lg k 13 exist let f set chosen terminals n 16 lg n 4 lg unique neighbor h v 0 v let build directed network n v fs tg new nodes follows start subgraph g 0 induced v replace edge pair antiparallel arcs capacity one add arcs u u capacity 1 add arcs x x 2 x capacity 1 r 1 v finite capacity cut defined fsg x choose finite capacity cut c possibly c set arcs u v expansion g jcj jsj let sg corresponding f h 62 arc total thus total number arcs c least penultimate inequality following fact either h x 2 f follows minimum capacity cut n least k2 max flowmin cut theorem maximum flow value 0 1 arc flow u v v u 1 u 6 v change flow arcs 0 result maximum flow uses one u v v u u 6 v flow decomposed least k2 arcdisjoint paths n u 6 v one u v v u appears path follows least k2 arcdisjoint paths x 2 f vertex path using fx least lg n since paths arcdisjoint least k2 infer 4 lg using definition k last sum least 16 lg lg n since feasible solution met value je 0 j 2 2n ratio two least lg k choose proof theorem 12 complete following theorem shows analysis asymptotically tight also suggests alternative rounding procedure instances performs better results section 2 though general far worse theorem 15 polynomialtime algorithm takes input connected graph e subset terminals computes function du v minimum number edges path u v proof add new vertex g connect terminals run breadthfirst search starting computing every node v 2 v distance lv notice every classes c r smallest positive integer jc r j jej max max define f let arbitrary terminal every every v 2 v lv r set v terminal closest v g least one inequalities strict therefore dt consider edge uv 2 c r 1 lu lv r dfu 2 r lu lv r dfu remaining case use trivial bound dfu fv max using bounds r jc r j ir uv2cr ir interesting note bounded degree expanders bounds much better using arguments similar proofs theorems 12 15 prove theorem 16 every sufficiently large positive integer constant 0 infinitely many k expander e maximum degree jv j ok log k set v size k integrality ratio met 0extension instance defined g gpath metric least log log k hand every every nnode expander g maximum degree choice terminals integrality ratio met 0extension instance defined g gpath metric log log n polynomialtime algorithm achieves bound r approximating arbitrary metrics tree metrics improved approximation algorithm multiway cut optimal 3terminal cuts linear programming private communication complexity multiway cuts complexity multiterminal cuts approximate maxflow minmulticut theorems applications rounding algorithms geometric embedding minimum multiway cut minimum 0extension graph metrics approximation multicommodity flow planar graphs approximate maxflow mincut theorem uniform multicommodity flow problems applications approximation algorithms ramanujan graphs tr ctr howard karloff subhash khot aranyak mehta yuval rabani earthmover distance metric labeling 0extension proceedings thirtyeighth annual acm symposium theory computing may 2123 2006 seattle wa usa