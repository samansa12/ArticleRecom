longtime energy conservation numerical methods oscillatory differential equations consider secondorder differential systems highfrequency oscillations generated linear part present frequency expansion solution discuss two invariants system determine coefficients frequency expansion invariants related total energy oscillatory harmonic energy original systemfor numerical solution study class symmetric methods discretize linear part without error interested case product step size highest frequency large sense backward error analysis represent numerical solution frequency expansion coefficients solution modified system allows us prove nearconservation total oscillatory energy long time intervals b introduction longtime nearconservation total energy adiabatic invariants numerical solutions hamiltonian differential equations important wide range physical applications molecular dynamics nonlinear wave propagation backward error analysis bg94 hal97 rei98 shown symplectic numerical integrators approximately conserve total energy adiabatic invariants times exponentially long step size precisely times length expch highest frequency system result meaningful h 0 often practical assumption example spatially discretized wave equations h cfl number chosen small actual computations recently gss99 hol99 new symplectic symmetric timestepping methods studied admit secondorder error bounds finite time intervals independently frequencies dominant linear part system particular longtimestep methods case computational interest situation reminiscent stiff versus nonstiff differential equations stiff integrators appropriately analyzed considering limit behavior h 0 stiff case much insight gained studying behavior numerical methods wellchosen rather simple linear nonlinear stiff model problems first step towards understanding numerical energy behavior hamiltonian systems product step size highest frequency small quantity consider article nonlinear highly oscillatory model problem x dept de mathematiques universite de geneve ch1211 geneve 24 switzerland mathematisches institut universitt tubingen auf der morgenstelle 10 d72076 tubingen germany email lubichnaunituebingende blocks arbitrary dimensions nonlinearity lipschitz constant bounded independently situation arises celebrated fermipastaulam model present numerical experiments clearly model problem 11 take strong restrictions high frequencies confined linear part problem linear part single high frequency diagonal form ofomega essential since numerical methods invariant diagonalization matrix study longtime energy behavior class symmetric numerical methods used step sizes h product h bounded away zero arbitrarily large methods integrate linear part 11 exactly reduce stormerverlet method class includes methods gss99 hol99 classical symmetric methods stormerverlet method trapezoidal rule numerovs method considered article however using results present paper energy behavior 11 h range linear stability analyzed hal99 approach nearconservation energy based frequency expansion solution xt 11 asymptotic series coefficient functions yt z k together derivatives bounded independently turns system determining coefficient functions two formally exact invariants one close total energy according partitioning omegagamma invariant close represents oscillatory energy system numerical solution derive similar frequency expansion valid grid points nonresonance assumption h equations determining coefficient functions similar structure continuous problem allows us obtain two almostinvariants close h rigorous estimates nearconservation total oscillatory energy time intervals size cn h gamman restriction n comes nonresonance condition analysis uses symmetry methods require symplecticness sect 2 describe numerical methods present numerical experiments fermipastaulam problem experiments illustrate longtime conservation total oscillatory energy nonresonance situations later completely explained theory also show energy behavior methods near resonances behavior depends strongly properties filter functions determine numerical method identify conditions yield satisfactory energy conservation near resonances correct energy exchange highly oscillatory components sect 3 gives complete analysis twodimensional linear case 11 whole range nonresonant nearresonant exactly resonant cases gives already much insight conditions determining energy conservation general situation frequency expansion analytical solution 11 introduced sect 4 numerical solution sect 5 numerical invariants derived sect 6 main result numerical longtime conservation energy 11 formulated proved sect 7 2 numerical methods numerical experiments section present numerical methods illustrate main results paper fermipastaulam problem 21 discretization consider differential equation 11 symmetric positive semidefinite necessarily diagonal real matrix assume initial values x 0 x 0 given variationof constants formula exact solution 11 satisfies tomega gammaomega sin tomega cos tomega somega ds observe tomega welldefined also singularomegagamman therefore natural consider fixed step size h explicit discretization homega xn gammaomega sin real functions oe depending smoothly 2 method integrates problem 11 without error method consistent order 2 fixedomega h 0 secondorder convergence follows classical results article mainly interested situation homega take large values longtime integrations symmetric andor symplectic methods expected favorable properties exchanging n 2223 seen method symmetric gx sinc sin shown direct verification 2223 symplectic discretization addition 24 also holds condition required analysis paper since nonlinearity gx 11 depend x eliminate xn 22 help 23 case symmetric discretization thus get twostep recurrence starting value x 1 obtained 22 recognize wellknown stormer method stiff harmonic soft nonlinear fig 1 alternating soft stiff springs methods type 25 2223 proposed studied several authors gautschi gau61 suggests take 2 choice 11 integrated exactly even const deuflhard deu79 discretizes integral 21 trapezoidal rule thus arrives 25 recently garciaarchilla sanzserna skeel gss99 introduce function oe argument g consider case method symplectic hochbruck lubich hol99 consider oe papers gss99 hol99 derive error bounds finite time intervals independent smoothness solution article consider general functions oe zeros except possibly integral multiples since interested energy conservation numerical solution need also approximation derivative use twoterm recurrence relation 25 obtained relation 23 case symmetric method also formula possible h nonzero integral multiple obtain 26 subtracting 25 twice formula 22 symmetric method obtain formula exchanging n 23 subtracting resulting formula 23 obtain twostep recurrence gamma2omega sin formulas 25 27 give symmetric twostep method even 24 satis fied method exact const choice 1 considered hol99 22 experiments fermipastaulam problem consider chain springs soft nonlinear springs alternate stiff harmonic springs see ggmv92 fig 1 variables x displacements endpoints springs movement described hamiltonian system using symplectic change variables u 2 get new hamiltonian system h h h c h 100 200 3001 h 100 200 300 100 200 300 c h fig 2 energy exchange stiff springs exactly form 11 numerical experiments consider case shown fig 1 initial values take zero remaining initial values apply method 2223 following data c 0 1 given 24 study total energy 28 oscillatory energy along numerical solution interval 0 400 chosen initial values fig 2 plotted three different step sizes three methods numerical values 1 2 3 h gamma 08 see exchange energy takes place going first stiff spring energy 1 second stiff spring later third one smallest step size also plotted gray numerical values perturbed initial values obtained adding 10 gamma8 u 1 0 illustrates solution sensitive perturbations 6 e hairer ch lubich cases see h well preserved whole interval even step sizes numerical solution completely wrong experiments shown preservation holds much longer intervals tested explanation phenomenon main objective paper 23 numerical experiments nearresonant situations product step size frequency h close multiple different methods show widely different behavior energy conserved choices oe satisfactory numerical behavior also nearresonance situations obtained numerical method satisfies following additional conditions conditions yield longtime energy conservation values h exception h intervals width oh near integral multiples 2 total energy appears conserved uniformly arbitrary values h necessity conditions seen analysis linear case given sect 3 h close 2m positive integer condition 29 requires double zero 2m similarly h close odd multiple condition requires simple zero choice hol99 condition 29 obviously satisfied values h 210 violated near odd multiples condition 210 trivially satisfied h condition 29 fails near even multiples choice satisfies three conditions 29 h condition 212 satisfied methods previously proposed literature table methods used numerical experiments sect 23 sinc 1 2k p let us illustrate effect conditions 29 210 211 numerical solution h close multiple consider fermipastaulam problem sect 22 initial values apply six different methods characteristics given table 1 sign p indicates corresponding condition oe satisfied condition satisfied values 22 c scale 22 fig 3 energy conservation different methods fig 4 energy conservation different methods fig 5 energy conservation different methods h give values close violated methods b c one conditions 29211 fulfilled fig 3 show errors hamiltonian interval 0 1000 used step size maximal error size 396497 1 given 24 singularity 2 2 2 2 fig 6 error total oscillatory energies function h fpu problem methods show clear drift constant value hamiltonian methods b e f three conditions satisfied close conserve hamiltonian well pictures corresponding three methods changed scale small oscillations become visible fig 4 shows experiment time chosen 20000001 delta situations get qualitative behavior plot oscillatory energy instead hamiltonian results experiments confirm conditions 29 210 211 cannot omitted interested longtime energy estimates hold uniformly h fig 5 numerical results nonresonant case included methods give satisfactory results accurate results obtained method c upper pictures fig 6 plot maximal errors hamiltonian function h take step sizes 0025 picture right corresponds method e table 1 picture left obtained method f satisfies 212 uniform convergence error observed case lower pictures fig 6 show analogue deviations oscillatory energy close integral multiples 2 deviation large methods phenomenon observed already linear problems see fig 8 complete analysis given sect 3 24 energy exchange energy exchange stiff components takes place time intervals length fig 2 reproduced qualitatively correctly large h case 1 numerical frequency expansion sect 5 shows condition 2 hh 2 hh 2 ii 2 ii fig 7 experiment fig 6 method 25 method 216 right pictures needed approximation energy exchange stiff components h bounded away zero compare equations z 2 component 48 58 severe condition excludes methods considered far exception abovementioned method hand seen method rather poor energy conservation properties therefore extend class methods 25 homegagamma2 consistency functions k oe k must satisfy conditions 29 210 needed condition 213 replaced example method 26 equivalently onestep form homega xn gammaomega sin shows correct energy exchange large h method b fig 2 fig 7 compare energy conservation method 25 method step sizes fig 6 216 total oscillatory energies well conserved long times except h intervals length oh around integral multiples ease presentation following analysis done methods class 25 arguments extend obvious way class 214 3 longtime energy conservation linear problems start analysis case twodimensional symmetric matrix satisfying 11 0 linear gives already lot insight illustrates importance conditions 29212 situation differential equation 11 becomes x total energy h given 15 invariant system following assume h delta bounded uniformly requires x 2 31 analytical solution exact solution 31 given gamma2 eigenvalues 11 gamma2 given initial values x0 consequently implies quantity remains gamma1 close constant value delta times 32 numerical solution search functions b v xn xnh satisfies numerical scheme 25 implies eigenvalue v corresponding eigenvector section use short notation oeh since offdiagonal elements 33 small eigenvalues close ff respectively corresponding eigenvectors fl gammafl oe general solution thus written complex coefficients computed initial values b obtained 22 inserting study longtime nearconservation h delta delta distinguish two cases case wellseparated eigenvalues assume one conditions 11 satisfied covers nearly choices h values intervals length oh excluded theorem 31 consider numerical method 2223 applied 31 one restrictions 35 36 step size conditions 29 210 211 numerical method energies h 15 16 along numerical solution satisfy n 0 constants symbolized odelta independent h n proof characteristic polynomial matrix 33 zeros computed explicitly conditions 35 36 together 211 implies eigenvalues 33 hence sufficiently small h 1 2 real interval gamma1 1 angles defined therefore also real satisfy next estimate coefficients b b 34 since v real coefficients b complex conjugates b situations 35 36 assumption 29 consequently condition b using b convenient work b xh gamma cos cos estimates sinc h2 follow 29 210 get second relation consequence fact follows 211 statement 38 immediate consequence 39 modulus c i2 independent nearconservation hamiltonian seen similarly one conditions 35 36 satisfied get floe sin 2 implies jbx 0 const together 38 proves statement 37 total energy case ii nearly collapsing eigenvalues consider complementary case4 h 2 two eigenvalues 33 close theorem 32 consider numerical method 2223 applied 31 condition 212 numerical method viz n 0 uniformly h c 0 constants symbolized odelta independent h n proof condition 212 numerical method satisfies 29 210 theorem 31 applicable therefore remains consider situation h restricted 310 condition 310 implies 1 2a 11 sufficiently small h assume oe 0 satisfied choice 212 guarantees eigenvalues 33 real oe 11 oh 3 special choice 212 jflj 1 p coefficients 34 satisfy o1 3 2 4 2 4 2 4 2 4 fig 8 error total oscillatory energies function h linear problem holds recall consequence estimate oe fact jflj 1 oe relations 312 313 thus yield 11 together 34 implies prove tdependent term small need relation 212 oe using also 312 313 obtain sin completes proof theorem 32 proof shows general situation theorem 31 first term righthand expression 314 becomes negligible longtime conservation concluded 12 6 0 cosh 14 e hairer ch lubich oe fl 1 oe fl oe floe oe initial condition b none terms 314 neglected different integral multiple 2 expression 314 cannot remain close constant value result intuitively clear situation 310 two frequencies indistinguishably close numerical method upper pictures fig 8 show maximal error hamiltonian hxn dependence h problem 31 initial values three curves correspond step sizes 005 picture left obtained method satisfying 212 uniform convergence error nicely observed picture right corresponds method e table 1 lower pictures fig 8 plot maximal deviation oscillatory energy ixn function h confirms analysis shows h satisfying 11 oscillatory energy cannot well conserved 4 frequency expansion analytical solution main tool analysis nonlinear problems decomposition solution xt 11 smooth part highly oscillatory terms smoothly varying amplitudes decomposition valid finite time intervals show existence two almostinvariants coefficients decomposition related total energy oscillatory energy system repeated use almost invariants allows us prove longtime nearconservation oscillatory energy 41 frequency expansion assume nonlinearity g 11 analytic open set consider solutions 11 satisfy k compact subset assume initial values limited harmonic energy2 k e independent theorem 41 assumptions 42 41 0 solution xt eq 11 arbitrary n 2 expansion form e ikt z k rn remainder term derivative bounded real functions complex functions z bounded together derivatives z unique terms size gamman gamma2 constants symbolized onotation independent e n order derivative proof determine smooth functions put e ikt z k insert function 11 expand nonlinearity around yt compare coefficients e ikt notation g yz following system differential equations z k z k sums range 1 multiindices integers ff j satisfying given sum large dominating terms differential equations given leftmost expressions however since central terms involve higher derivatives confronted singular perturbation problems interested smooth functions satisfy system defect size gamman spirit eulers derivation eulermaclaurin summation formula see eg haw96 remove disturbing higher derivatives using iteratively differentiated equations 4749 leads system z k formal series powers gamma1 since get formal algebraic relations eliminate variables functions f finally obtain algebraic relations z k z k system real secondorder differential equations 1 complex firstorder differential equations z point forget derivation take motivation ansatz 410411 truncate gamman terms inserting ansatz first second derivatives 4749 comparing like powers recurrence relations functions f k jl shows functions together derivatives bounded compact sets determine initial values 411 function e xt 46 satisfies e x0 special structure ansatz 410 411 gives system implicit function theorem yields locally unique initial values 1 0 0 assumption 42 implies z 2 follows boundedness f 2l z 2 looking closer structure function g k jl seen contains least k times factor z 2 implies stated bounds functions still estimate remainder rn xt consider solution 410411 initial values 412 construction functions satisfy system 4749 defect gamman gives defect size gamman function e xt 46 inserted 11 hence finite time obtain slightly sharper bounds 44 apply proof n replaced n 2 42 hamiltonian frequency expansion consider situation 11 hamiltonian system x hamiltonian ux assumed analytic let v k 4749 functions satisfy sum 1 multiindices integers ff given sum write denote follows vector v satisfies system neglecting gamman terms hamiltonian theorem 42 assumptions 42 41 constants symbolized odelta independent depend e n proof multiplying 417 418 respectively gives dt integrating 0 using v bounds theorem 41 hand 414 43 using follows inserted 422 423 yields statement 421 43 another almostinvariant besides hamiltonian hy v coefficients frequency expansion another almostinvariant depends oscillating part given almostinvariant turns close energy harmonic oscillator theorem 43 assumptions 42 41 constants symbolized odelta independent depend e n proof vector holds uy differentiating identity respect yields z gammak proof theorem 43 similar theorem 42 multiply relation 418 gammaikv gammak instead summing yields use 428 gammai derivative iv 424 dt v gammak sums terms k gammak cancel hence statement 426 follows 429 430 using bounds theorem 41 hand using arguments proof theorem 42 proves second statement theorem corollary 44 xt 2 k constants symbolized odelta independent depend e n proof fixed 0 let v j denote vector frequency expansion terms correspond starting values xjt xjt 427 vn vn vn note iv j1 0 uniqueness statement theorem 41 v j1 bound 426 theorem 43 argument applies ivn vn vn 0 yields result remark already known article bgg87 oscillatory energy xt nearly preserved long times proofs bgg87 completely different use coordinate transforms hamiltonian perturbation theory show nearly preserved time intervals grow exponentially carefully tracing ndependence constants gamman terms possible obtain nearconservation exponentially long time intervals also within present framework frequency expansions 5 frequency expansion numerical solution section show numerical solution 22 23 nonlinear problems 11 frequency expansion similar analytical solution following idea backward analysis motivated results sect 4 look function e ikt z k smooth yt z k depending h 1 small defect assume throughout section numerical solution phix n remains compact subset region gx analytic ie 51 functional calculus computation functions yt z k following functional calculus convenient let f entire complex function bounded jfij c e fljij converges every function x analytic disk radius r flh around note hd k two entire functions whenever sides exist particular avoid overloaded notation hats use letters z k analytical solution hope cause confusion therefore introduce operator homega sin h 0 approximation h 2 2 next study application operator functions form e zt leibniz rule calculus hd k e zt short calculation also yields fhde 52 modified equations coefficient functions frequency expansion operator lhd 55 condition 52 becomes inserting ansatz 51 expanding righthand side 57 taylor series around phiyt comparing coefficients e ikt yields functions yt z k multiindex proof theorem 41 ff abbreviation mtupel phiz ff get smooth functions yt z k solve 58 small defect look dominating terms taylor expansions lhd lhd ikh abbreviations 2 kh ihd situation complicated 4749 frequency expansion analytical solution several coefficients 59 may vanish due numerical resonance confine discussion nonresonant case assume h gamma1 lie subregion small parameters exists positive constant c 2 longtime energy conservation 21 condition excludes h close integral multiples given h condition imposes restriction n following n fixed integer 510 holds theorem 51 limitedenergy condition 42 nonresonance condition 510 conditions 53 54 conditions 29 210 numerical method 2224 numerical solution form uniformly functions satisfy 58 defect oh n2 first components ohh n2 second components together derivatives functions bounded constants symbolized onotation independent h depend e n proof assumption 510 first nonvanishing coefficients 59 dominant ones derivation defining relations z k analytical solution theorem 41 insert 59 58 eliminate recursively higher derivatives motivates following ansatz computation functions z k z k z k functions depend smoothly variables 1 bounded parameters h inserting ansatz derivatives 58 comparing like powers h yields recurrence relations functions jl functions g k jl k 1 contain least k times factor oehz 2 f 2l contains least factor since series 512 need converge truncate next determine initial values 1 0 xh 51 coincide starting values x 0 x 1 numerical scheme x 1 computed x 0 x 0 via formula 22 using nonresonance 22 e hairer ch lubich assumption 510 condition b formula first component 22 x b implies second component x x 22 b x 2 delta division h sinc h yields four equations 513 514 515 constitute nonlinear system four quantities 1 0 z implicit function theorem using limitedenergy assumption 42 get locally unique solution sufficiently small h conditions 29 210 satisfied initial value z 2 satisfies z 2 follows 210 512 implies z 2 estimates 511 directly obtained 512 conse quently values b xnh inserted numerical scheme 25 yield defect size oh n2 standard convergence estimates show bounded time intervals size ot 2 h n first component size oht 2 h n second component completes proof theorem 51 53 frequency expansion derivative approximation condition 510 h 6 k integer k derivative approximation xn given 26 define b x 0 continuous analogue using condition 210 theorem 51 implies bounded time intervals next write function b x 0 e ikt z 0k inserting relation 51 gammai equivalent 517 comparing coefficients e ikt obtain sinc ihd particular get z 1 2 z 01 cos h sin h theorem 52 assumptions theorem 51 numerical solution xn given 26 satisfies uniformly functions together derivatives bounded z 01 constants symbolized onotation independent h depend e n proof estimates follow 519 theorem 51 0 1 z 01 2 use formulas 512 get sharper result 54 energy along numerical solution hamiltonian case gammaru total energy h oscillatory energy related frequency expansion coefficients follows lemma 53 coefficients frequency expansions xn xn satisfy 511 521 respectively proof definition 425 ibx b e z 1 e z 1 statement 523 follows fact jv formula 522 proved way 6 almostinvariants numerical frequency expansion section show hamiltonian case coefficients frequency expansion numerical solution invariants obtained sect 4 denote z k coefficients frequency expansion 51 similar 416 consider function sum taken 1 multiindices nonvanishing integral components follows theorem 51 coefficients v k satisfy r factor oeh defect 63 due presence factor oehz 2 relations 512 defining zcomponents similarity relations 417 418 allows us obtain invariants analogues h sect 4 61 first invariant sect 42 multiply 62 63 respectively thus obtain dt since know bounds z k derivatives theorem 51 switch quantities z k get equivalent relation dt shall show lefthand side total derivative expression depends z k derivatives indeed term 2l written dt similarly get z gammak z z dt z z z z dt z z z z dt z z im z z dt z z z hence exists function b depends values functions first n derivatives 64 reads dt yields immediately first statement following result theorem 61 assumptions theorem 51 coefficient functions proof formula b h 0 obtained formulas 59 lhd together estimates theorem 51 remark symplectic discretizations 62 second invariant proof theorem 43 function 61 consequently follows 63 gammai written z variables becomes gammai sect 61 lefthand expression written total derivative function b 0 zt depends values function z first n derivatives dt theorem 62 assumptions theorem 51 coefficient functions h theorem 61 proof 65 estimates theorem 51 obtain condition 210 yields stated formula b 0 7 longtime energy conservation numerical discretization able prove main result paper shows total energy h oscillatory energy nearly conserved time intervals length cn h gamman n nonresonance condition 510 satisfied convenience reader restate assumptions ffl limitedenergy condition 26 e hairer ch lubich ffl boundedness condition 54 numerical solution sequence phix n stays compact subset domain analyticity g ffl condition 53 h 0 ffl conditions 29 210 numerical method ffl nonresonance condition 510 n 2 theorem 71 conditions numerical solution 11 obtained method 2224 satisfies nh constants symbolized odelta independent n h satisfying conditions depend n proof consider linear combinations b 0 0 follows theorem 61 theorem 62 moreover theorem 61 theorem 62 together lemma 53 b xt defined frequency expansion 51 coefficients yt defined 517 relations 71 72 hold finite time frequency expansion defined b apply relations repeatedly intervals length h frequency expansions corresponding different starting values long satisfies limitedenergy condition 42 possibly larger constant e theorem 51 gives us frequency expansion coefficients yn zn corresponding starting values uniqueness oh n1 coefficients frequency expansion following diagram commutes terms size oh n1 numerical method oh n1 construction coefficient functions via 512 shows also higher derivatives n zn h n1 zn1 0 differ oh n1 thus 73 71 using relation repeatedly obtain moreover 72 following coefficient functions corresponding starting values xn construction b x 0 theorem 52 obtain gives desired bound deviation total energy along numerical solution argument applies ixn acknowledgment grateful sebastian reich drawing attention fermipastaulam problem r realization holonomic constraints freezing high frequency degrees freedom light classical perturbation theory hamiltonian interpolation near identity symplectic mappings application symplectic integration algorithms study extrapolation methods based multistep schemes without parasitic solutions problem energy equipartition large systems fermipastaulam type analytical numerical estimates numerical integration ordinary differential equations based trigonometric polynomials lifespan backward error analysis numerical integrators energy conservation stormertype numerical integrators analysis history gautschitype method oscillatory secondorder differential equations dynamical systems tr ctr van daele g vanden berghe geometric numerical integration means exponentiallyfitted methods applied numerical mathematics v57 n4 p415435 april 2007 ernst hairer important aspects geometric numerical integration journal scientific computing v25 n1 p6781 october 2005 j franco new methods oscillatory systems based arkn methods applied numerical mathematics v56 n8 p10401053 august 2006 paul j atzberger peter r kramer charles peskin stochastic immersed boundary method fluidstructure dynamics microscopic length scales journal computational physics v224 n2 p12551292 june 2007