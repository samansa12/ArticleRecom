computing symmetric rankrevealing decompositions via triangular factorization present family algorithms computing symmetric rankrevealing vsv decompositions based triangular factorization matrix vsv decomposition consists middle symmetric matrix reveals numerical rank three blocks small norm plus orthogonal matrix whose columns span approximations numerical range null space show semidefinite matrices vsv decomposition computed via ulv decomposition indefinite matrices must computed via urvlike decomposition involves hypernormal rotations b introduction rankrevealing decompositions general dense matrices widely used signal processing applications accurate reliable computation numerical rank well numerical range null space required singular value decomposition svd certainly decomposition reveals numerical rank mind rrqr ie urv ulv decompositions computed particular updated eciently svd see eg 7 xx275277 20 x22 33 chapter 5 details references theory algorithms applications key eciency rrqr utv algorithms consist initial triangular factorization tailored particular matrix followed rankrevealing postprocessing step matrix mn n numerical rank k initial triangular factorization requires omn 2 ops rankrevealing step requires kn 2 ops k n okn 2 ops n updating always done 2 ops implemented properly refer original papers 9 10 16 18 19 23 31 32 details algorithms structured matrices eg hankel toeplitz matrices initial triangular factorization rrqr utv algorithms complexity rankrevealing step namely omn ops see 7 x842 signal processing aspects however accurate principal singular values vectors also computed means lanczos methods complexity omn ops 13 hence advantage rankrevealing decomposition depends matrix structure numerical rank matrix rankrevealing decompositions general sparse matrices also use eg optimization geometric design 27 sparse matrices initial pivoted triangular factorization exploit sparsity however utv postprocessors may produce severe amount rrqr postprocessor p yalamov supported fellowship danish rectors conference grants mm70797 i70297 national scientic research fund bulgarian ministry education science department mathematical modelling technical university denmark building 321 dk 2800 lyngby denmark pchimmdtudk z center applied mathematics informatics university rousse 7017 rousse bulgaria yalamovamiruacadbg p c hansen p yalamov restricted lie columns permuted right triangular factor 7 thm 671 alternative sparse url decomposition u rl u orthogonal r l upper lower triangular respectively proposed 26 decomposition computed less expense working one orthogonal matrix numerically rankdecient symmetric matrices also arise many applications notably signal processing optimization algorithms based interior point continuation methods areas fast computation efcient updating key issues sparsity also issue optimization problems symmetric rankrevealing decompositions enable us compute symmetric rankdecient matrix approximations obtained neglecting blocks rank revealing decomposition small norm important eg rankreduction algorithms signal processing one wants compute rankdecient symmetric semidenite matrices addition utilization symmetry leads faster algorithms compared algorithms nonsymmetric matrices spite little work done symmetric rankrevealing decom positions luk qiao 24 introduced term vsv decomposition proposed algorithm symmetric indenite toeplitz matrices baker degroat 2 presented algorithm symmetric semidenite matrices purpose paper put work 2 24 broader perspective surveying possible rankrevealing vsv decompositions algorithms including underlying theory emphasis algorithms addition revealing numerical rank provide accurate estimates numerical range null space build algorithms existing methods computing rank revealing decompositions triangular matrices based orthogonal transformations symmetric decompositions algorithms inherit properties underlying algorithms well understood today emphasize goal paper present detailed implementations vsv algorithms rather set stage implementations papers 4 28 clearly demonstrate careful implementations ecient robust mathematical software numerically rankdecient problems requires major amount research outside scope present paper paper organized follows brie surveying general rankrevealing decompositions x2 dene analyze rankrevealing vsv decomposition symmetric matrix x3 numerical algorithms computing vsv decompositions symmetric semidenite indenite matrices presented x4 conclude numerical examples x5 2 general rankrevealing decompositions paper restrict attention real square n n matrices singular value decomposition svd square matrix given u v columns orthogonal matrices u v numerical rank k respect threshold number singular values greater equal ie k k1 20 x31 rrqr urv ulv decompositions given q ur ul vr vl orthogonal matrices permutation matrix r upper triangular matrices l lower triangular matrix moreover partition triangular matrices numerical rank k revealed triangular matrices sense k k f rst k columns left matrices q ur ul span approximations numerical range dened spanfu g last n k columns right matrices vr vl span approximations numerical nullspace dened spanfv g see eg 20 x31 details precise denitions rrqr decompositions algorithms given chandrasekaran ipsen 11 gu eisenstat 19 hong pan 23 associated largescale implementations available fortran 4 denitions utv decompositions algorithms given stewart 31 32 matlab software rrqr utv decompositions available utv tools package 17 3 symmetric rankrevealing decompositions symmetric n n matrix need rankrevealing decompositions inherit symmetry original matrix particular true eigenvalue decomposition evd right singular vectors corresponding utv decompositions luk qiao 24 dened following vsv decomposition vs orthogonal matrix symmetric matrix partitioning 11 k k say vsv decomposition rankrevealing 4 p c hansen p yalamov denition similar denition used luk qiao except use ktrius 22 k 2 f instead ks 22 k 2 f triu denotes upper triangular part choice motivated fact ks 22 k 2 n ks 12 given vsv decomposition 32 rst k columns vs last columns vs provide approximate basis vectors numerical range null space respectively moreover given illconditioned problem b compute stabilized truncated vsv solution x k neglecting three blocks consists rst k columns vs return computation x k x44 instead working directly matrix convenient work symmetric decomposition particular 11 form decomposition depends matrix semidenite indenite rankrevealing algorithm hence postpone discussion particular form presentation algorithms instead summarize approximation properties vsv decomposition theorem 31 let vsv decompositions given 32 partition matrix 33 k numerical rank singular values diags 11 22 related moreover angle subspaces spanned rst k columns v vs dened sin bounded sin proof bound 34 follows standard perturbation bound singular values use singular values symmetric perturbation matrix appear pairs prove upper bound 35 partition columns moreover write k insert partitionings well 31 32 product av s0 obtain multiplying left v k get obtain taking norms expression inserting sin get sin 1 immediately leads upper bound 35 prove lower bound use taking norms using sin k1 obtain left bound 35 conclude welldened gap k ks 22 k 2 norm ks 12 k 2 odiagonal block suciently small numerical rank k indeed revealed rst k columns vs span approximation singular subspace spanfv g following theorem shows welldened gap also important perturbation bounds theorem 32 let e let denote angle subspaces spanned rst k columns vs e sin 4 g proof bound follows corollary 32 14 see small upper bound guaranteed kak 2 well k1 somewhat smaller k 4 algorithms symmetric rankrevealing decompositions similar general rankrevealing algorithms symmetric algorithms consist initial triangular factorization rankrevealing postprocessing step purpose latter step ensure largest k singular values revealed leading submatrix 11 corresponding singular subspace approximated span rst k columns vs semidenite matrix initial factorization symmetrically pivoted p permutation matrix c upper triangular trapezoidal factor numerical properties algorithm discussed higham 22 symmetric semidenite toeplitz matrix good evidence although strict proof cholesky factor computed eciently reliably without need pivoting means standard schur algorithm 30 indenite would convenient work initial factorization form p c c triangular diag1 unfortunately factorizations guaranteed exist therefore initial factorization symmetrically pivoted ldl factorization p permutation matrix l unit lower triangular matrix block diagonal matrix 11 22 blocks diagonal stateoftheart ldl algorithms described 1 pointed special care must taken implementation avoid large entries l ill conditioned alternatively one could use factorization g 6 p c hansen p yalamov table four postprocessing rankrevealing steps symmetric semidenite matrix postproc decomposition symmetric matrix r 22 r 22 rrqr 22 22 22 l 21 l 22 l 22 described 29 g block triangular symmetric indenite toeplitz matrix currently reliable approach computing ldl factorization seems via orthogonal transformation cauchy matrix 21 reason need postprocessing step initial factorization may reveal numerical rank guarantee small eigenvalues manifest small diagonal elements c small eigenvalues particular since 2 obtain 2showing small n may revealed l ill conditioned 41 algorithms semidenite matrices symmetric semidenite matrices simple relationship svds c theorem 41 right singular vectors p ap also right singular vectors c proof result follows inserting svd c p hence computed initial pivoted cholesky factorization 41 proceed computing rankrevealing decomposition c done several ways let e denotes exchange matrix consisting columns identity matrix reverse order write p ap compute urv rrqr decomposition c ulv decomposition ece rrqr decomposition ece shown left part table 41 approach using urv decomposition c suggested 2 table 41 also shows particular forms resulting symmetric matrix derived following relations r rst third fourth approaches lead symmetric matrix reveals numerical rank odiagonal block 12 bottom right block 22 small norm second approach produce blocks 12 22 small norm instead since 11 well conditioned algorithm provides permutation p guaranteed produce wellconditioned leading remaining three algorithms yield approximate bases range null spaces due theorem 31 well known among rankrevealing decompositions ulv decomposition expected provide accurate bases right singular subspaces form columns vl see eg 32 15 therefore algorithm computes ulv decomposition ece preferred remark matrix ul ulv decomposition need computed terms blocks 12 22 ulvbased algorithm algorithm guarantees small norms odiagonal block 22 bottom right block 22 l 22 norms l 12 l 22 guaranteed small theorem 41 denition ulv decomposition therefore ks 12 k 2 ks 22 k 2 k1 sparse matrix situation dierent utv postprocessors may produce severe rrqr postprocessor produces n k rightmost columns example upper bidiagonal matrix b p upper bidiagonal p p matrix ones e p pth column identity matrix urv threshold produces full k k upper triangular r 11 rrqr threshold produces k k upper bidiagonal 11 hence sparsity reasons utv approaches may suited computing vsv decomposition depending sparsity pattern alternative use algorithm based rrqr decomposition transposed permuted cholesky factor ece note permutation matrix needed terms matrix bottom right submatrix guaranteed norm order k1 relations ks ks 22 k practice situation better rrqralgorithmwhen applied matrix e c e may produce odiagonal block 12 whose norm smaller guaranteed namely order 12 reason initial cholesky factor c often trailing n whose norm close 12 k1 may produce norm ks 12 k 2 close k1 partitionings 22 en k en k c fact rrqr postprocessor leaves column norms unchanged may permute leading n k columns e c e back see norm resulting odiagonal block 12 rrqr decomposition bounded numerical examples x5 illustrate however stress rrqr approach guarantee ks 12 k 2 order 12 point illustrated matrix 8 p c hansen p yalamov 1 compute eigenvalue decomposition 2 write jj 12 3 compute orthogonal w c lower triangular fig 41 interim processor symmetric indenite matrices k infamous kahan matrix 7 p 105 left unchanged qr factorization ordinary column pivoting yet numerical rank factorization symmetric pivoting computes cholesky factor apply rrqr e c e obtain upper triangular matrix n nelement small kt 12 n 42 algorithms indenite matrices matter factorization used indenite matrix 42 43 simple relationship singular values matrix factors hence four intrinsic decompositions table 41 apply diculty develop new factorization numerical rank determined rankrevealing algorithms currently use maintain triangular form matrix consideration apply algorithms matrix l ldl factorization 42 destroy block diagonal form avoid diculty inserting additional interim stage initial ldl factorization rankrevealing postprocessor middle blockdiagonal matrix replaced signature matrix diag1 time l replaced product orthogonal matrix triangular matrix interim processor summarized fig 41 thus computes factorization w orthogonal c upper triangular interim processor simple implement requires 2 opera tions w w block diagonal matrices block structure 1 1 block ii corresponding 1 1 blocks w jj 12 w equal 1 jd ii j 12 1 respectively 2 2 block compute eigenvalue decomposition ii ii1 ii1 i1i1 corresponding 22 block w w ii associated 22 block w givens rotation chosen c stays triangular sparse may introduced c interim processor since givens transformations applied nonoverlapping 22 blocks introduced treatment particular block spread processing blocks type processor also applied g g factorization 43 order turn block triangular matrix g triangular form future developments rankrevealing algorithms general matrices triangular ones may render interim processor super uous may also possible compute factorization 45 directly shall explore possibilities using triangular rankrevealing postprocessors similar ones semidenite matrices modied yield decomposition c leftmost matrix u hypernormal respect signature matrices b ie require u hypernormal matrices corresponding transformations introduced 8 connection downdating symmetric indenite matrices use maintain triangular form matrix c following theorem shows small singular value guaranteed revealed triangular matrix c theorem 42 n c denotes smallest singular value c interim factorization 45 proof 1 result follows unfortunately guarantee n c underestimate 12 dramatically neither ensure size n revealed illustrate small 5 5 numerical example 1 given singular values full rank respect threshold corresponding matrix c singular values thus 5 c good approximation 12 5 base rank decision 5 c threshold wrongly conclude numerically rank decient conclusion indenite matrices well conditioned c ensures well conditioned cannot rely solely c determination numerical rank rules use rrqr factorization c ece following theorem expands results 24 shows proceed instead theorem 43 let wn eigenvector c c corresponding eigenvalue n smallest absolute value let wn approximation wn moreover choose orthogonal matrix b v b last column identity matrix partition matrix p c hansen p yalamov 11 n 1 n 1 ks wn wn k 2 wn wn proof let c consider rst quantity wn 22 next write au wn u combining two results obtain 22 n n u taking norms get ks ks 12 k 2 2 js 22 n j lower bounds lefthand side kuk 2 bounded tan combining bound k obtain two bounds theorem theorem shows order n reveal must compute approximate null vector c apply givens rotations vector transform e n accumulate rotations right c time apply hypernormal rotations left order keep c upper triangular theorem 43 ensures wn close enough wn ks 12 k 2 small 22 approximates n note hypernormal transformations numerically unstable implementations use stabilizations stabilized hyperbolic rotations 7 x334 step performed de ate problem apply technique n 1n 1 submatrix leading submatrices updated factors precisely algorithm 24 process stops small singular values revealed computed urvlike decomposition r u r middle rankrevealing matrix given r tb 1 k k condition estimator used urvlike postprocessor must modied compared standard urv algorithm must estimate smallest table summary approaches symmetric indenite matrices note rrqr approaches reveal numerical rank ulvlike approach impractical postproc decomposition comments decomposition r r r 11 rrqr singular value matrix c c implementation use one step inverse iteration applied c c starting vector condition estimator ordinary urv algorithm applied c finally consider ulvlike approach applied ece must compute approximate null vector c c transform form e n means orthogonal transformation transformation applied right ece hypernormal transformation left required resotre lower triangular form de ate factorization note leading n 1 n 1 block l given l 11 shows cannot merely work block l 11 also 1 n 1 block 21 needed hence de ation step must work trapezoidal matices instead triangular matrices fact renders ulvlike approach impractical summarize symmetric indenite matrices approach using urvlike postprocessor leads practical algorithm revealing numerical rank moreover well conditioned c signals well conditioed c cannot reveal numerical rank analysis summarized table 42 urv based algorithm summarized fig 42 following presentations 17 rankdecision tolerance 43 updating vsv decomposition one advantages rank revealing vsv decomposition evd svd updated eciently modied rankone change v v relation see updating amounts updating rankrevealing matrix rankone matrix ww v ie done evdsvd updating requires 3 operations consider rst semidenite case let denote one triangular 12 p c hansen p yalamov 1 let k n compute initial factorization p 2 apply interim processor compute p 3 condition estimation let e k estimate k c1 k 1 let w k estimate corresponding right singular vector 4 e k 12 exit 5 revealment determine orthogonal q k q 6 update c1 k 1 7 update c1 k 1 hypernormal chosen updated c 8 de ation let k k 1 9 go step 3 fig 42 urvbased vsv algorithm symmetric indenite matrices matrices r l algorithms table 41 see vsv updating identical standard updating triangular rrqr utv factor done stably eciently means givens transformation described 5 31 32 next consider indenite case 49 updating takes form showing vsv updating involves hypernormal rotations hence updating computationally similar utv downdating whose stable implementation discussed 3 25 downdating vsv decomposition cases also involve hypernormal rotations 44 computation truncated vsv solutions brie consider computation truncated vsv solution dene consists rst k columns vs urvbased decompositions simple use ulvbased decomposition safely neglect term l whose norm order k1 finally rrqrbased decomposition use following theorem theorem 44 triangular qr factor alternatively columns matrix form orthonormal basis null space w 1 4 table numerical results rankrevealing vsv algorithms postprocessor semidef ulv mean 27 semidef rrqr mean 15 semidef urvlike mean indef proof qr factorization 1 whici 411 relation leads 1 denotes pseudoinverse 6 used combined relation w w immediately leads 412 rst relation 411 theorem 44 used k n second relation 412 useful k n note w computed orthonormalization columns matrix approach particularly useful sparse matrices introduce working skinny n n 5 numerical examples purpose section illustrate theory derived previous sections means test problems although robust ness eciency op counts important practical issues also tightly connected particular implementation rankrevealing postprocessor subject paper experiments done matlab use implementations ulv urv rrqr algorithms utv tools package 17 condition estimation three implementations clineconnvan loan ccvl estimator 12 modied urv algorithm used symmetric indenite matrices based urv algorithm 17 augmented stabilized hypernormal rotations needed condition estimator consisting ccvl algorithm followed one step inverse iteration applied matrix c c numerical results rankrevealing algorithms shown table 51 present mean maximum values norms various submatrices associated vsv decompositions particular x 12 x 22 denotes either r 22 l 22 22 results computed basis randomly generated test matrices size 64 128 256 100 matrices size n 4 eigenvalues geometrically distributed 1 10 4 14 p c hansen p yalamov table numerical results improved singular vector estimates urv mean 18 semidef urvlike mean 86 indef remaining four eigenvalues given numerical rank respect threshold test matrices produced generating random orthogonal matrices multiplying diagonal matrices desired eigenvalues indenite matrices signs eigenvalues chosen alternate table 51 illustrates superiority ulvbased algorithm semidenite matrices norm ks 12 k 2 odiagonal block always much smaller norm ks 22 k 2 bottom right submatrix due fact ulv algorithm produces lower triangular matrix l whose odiagonal block l 21 small norm emphasize size norm depends condition estimator second best algorithm semidenite matrices one based rrqr algorithm ks 12 k 2 ks 22 k 2 size note latter algorithm recommend sparse matrices urvbased algorithm semidenite matrices produces results consistently less satisfactory two algorithms results consistent theory indenite matrices urvlike algorithm used results table 51 show algorithm also behaves expected theory order judge backward stability algorithm uses hypernormal rotations also computed backward error ka k 2 three hundred test problems largest residual norm 19 10 11 average conclude loose digits accuracy due use hypernormal rotations well known norm odiagonal block triangular urv factor depends quality condition estimator better singular vector estimate smaller norm hence interesting see much norms odiagonal blocks r decrease improve singular vector estimates means one step inverse iteration expense additional ops semidenite case apply inverse iteration step ccvl estimate indenite case use two steps inverse iteration applied c c instead one results shown table 52 matrices table 51 expected norms odiagonal blocks smaller expense work average backward errors ka vs v change experiment 6 conclusion dened analyzed class rankrevealing vsv decompositions symmetric matrices proposed algorithms computing decomposition semidenite matrices ulvbased algorithm method choice dense matrices rrqrbased algorithm better suited sparse matrices preserves sparsity better indenite matrices urvbased algorithm guaranteed work r accurate symmetric inde correlationbased subspace tracking algorithm algorithm stability theory downdating ulv decomposition rankrevealing qr factorizations generalizing linpack condition estima tor perturbation analysis twosided complete orthogonal decompositions bounding subspaces rank revealing twosided orthogonal decompositions matlab templates rank revealing utv decompositions rank null space calculations using matrix decomposition without column interchanges transformation techniques toeplitz toeplitzplushankel matrices ii analysis cholesky decomposition semide nite matrix rank revealing qr decomposition svd symmetric rankrevealing toeplitz matrix decomposition sparse url rather urv factorization sparse multifrontal rank revealing qr factorization cholesky factorization semide nite toeplitz matrices updating algorithm subspace tracking updating rankrevealing ulv decomposition matrix algorithms vol tr