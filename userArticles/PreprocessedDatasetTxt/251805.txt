distance metric 3d models 2d images recognition classification abstractsimilarity measurements 3d objects 2d images useful tasks object recognition classification distinguish two types similarity metrics metrics computed imagespace image metrics metrics computed transformationspace transformation metrics existing methods typically use image metrics namely metrics measure difference image observed image nearest view object example measure euclidean distance feature points image corresponding points nearest view measure computed solving exterior orientation calibration problem paper introduce different type metrics transformation metrics metrics penalize deformations applied object produce observed imagein particular define transformation metric optimally penalizes affine deformations weakperspective closedform solution together nearest view according metric derived metric shown equivalent euclidean image metric sense bound therefore provides easytouse closedform approximation commonlyused leastsquares distance models images demonstrate image understanding application true dimensions photographed battery charger estimated minimizing transformation metric b introduction object recognition process selecting object model best matches observed image common approach recognition uses features points edges represent objects object recognized approach exists viewpoint model features coincide corresponding image features eg roberts 1965 fischler bolles 1981 lowe 1985 huttenlocher ullman 1987 basri ullman 1988 thompson mundy 1987 ullman basri 1991 since images often noisy models occasionally imperfect rarely case model aligns perfectly image systems therefore look model reasonably aligns image consequently measures assess quality match become necessary similarity measures 3d objects 2d images needed range applications ffl recognition specific objects noisy images described ffl initial classification novel objects application new object associated similar objects database way image eg victorian chair associated models different familiar chairs ffl recognition nonrigid objects whose geometry fully specified example recognition 3d hand gestures task generic shape gesture known particular instances differ according specific physiology hand existing recognition methods usually tailored solve first application namely recognition specific objects noisy images many methods suboptimal see section 2 review may result large number either misrecognition falsepositives methods extended handle problems classification recognition nonrigid objects performance may even less predictable general problem recognition therefore requires measures provide robust assessment similarity objects images paper describe two measures develop rigorous solution minimization problem measure entails common measure comparing 3d objects 2d images euclidean distance feature points actual image corresponding points nearest view object assumption underlying measure images significantly less reliable models perturbations measured image plane assumption often suits recognition tasks measures may better suit different assumptions exam ple classifying objects inherent uncertainty structure classified object one may therefore attempt minimize amount deformations applied object account uncertainty distance measured transformation space rather image space definition two types measures given section 3 measures compare 3d models 2d images generally desired metrical properties monotonically increase difference measured entities exact definition given appendix euclidean distance image nearest view defines metric refer measure image metric difficulty employing measure closedform solution problem yet found therefore currently numerical methods must employed compute measure common method achieve closedform metric extend set transformations objects allowed undergo rigid affine one problem measure bounds rigid measure methods either achieve suboptimal distances define metric existing approaches reviewed section 2 paper presents closedform distance metric compare 3d models 2d images metric penalizes nonrigidities induced optimal affine transformation aligns model image weakperspective projection metric shown bound leastsquare distance model image foresee three ways use metric developed paper 1 obtain direct assessment similarity 3d models 2d images 2 obtain lower upper bounds image metric many cases bounds may suffice unequivocally determine identity observed object 3 provide initial guess used numerical procedure solve image distance rest paper organized follows section 2 review related work section 3 define concepts used paper section 4 summarize main results paper results discussed detail proved section 5 transformation metric section 6 image metric sections 5 6 omitted first reading finally section 7 compare distances 3d objects 2d images obtained alignment results previous approaches previous approaches problem model image comparison using point features divided three major categories 1 leastsquare minimization image space 2 suboptimal methods using correspondence subsets 3 invariant functions traditional photometric approach problem model image comparison involves retrieving view object minimizes leastsquare distance image problem referred exterior orientation calibration problem recovery handeye transform defined follows given set n 3d points model points corresponding set n 2d points image points find rigid transformation minimizes distance image plane transformed model points image points analytic solution problem yet found analytic solutions absolute orientation problem leastsquare distance pairs 3d objects found see horn 1987 horn 1991 analytic solution leastsquare distance pairs 2d images yet found consequently numerical methods employed see reviews tsai 1987 yuan 1989 solutions often suffer stability problems computationally intensive require good initial guess avoid using numerical methods frequently object allowed undergo affine transformations instead rigid ones affine transformations composed general linear transformations rather rotations translations include addition rigid transformations also reflection stretch shear solution affine case simpler rigid case quadratic constraints imposed rigid case taken account enabling construction closedform solution least six points required find affine solution perspective projection fischler bolles 1981 four required orthographic projection ullman basri 1991 affine measure bounds rigid measure rigid measure however bounded demonstrated following example consider case matching four model points four image points weakperspective since case always exists unique affine solution affine distance model image zero hand since three points uniquely determine rigid transformation aligns model image perturbating one point increase rigid distance unboundedly second approach comparing models images involves selection small subset correspondences alignment key solving transformation using subset transforming points measuring distance corresponding image points three fischler bolles 1981 rives et al 1981 haralick et al 1991 four horaud et al 1989 points required perspective projection three points perspective ullman 1989 huttenlocher ullman 1987 obtained distance critically depends choice alignment key different choices produce different distance measures model image results almost always suboptimal since generally better match points small errors exactly match subset points project errors onto others third approach involves application invariant functions functions return constant value applied image particular model invariant functions successfully used special kinds models planar objects eg lamdan et al 1987 forsyth et al 1991 general objects recognized using modelbased invariant functions weinshall 1993 noisefree data modelbased invariant functions return zero image exact instance object account noise output functions usually required fixed threshold general little research conducted characterize behavior functions model image perfectly align result thresholding therefore becomes arbitrary 3 definitions notation following discussion assume weakperspective projection namely object undergoes 3d transformation includes rotation translation scale orthographically projected onto image perspective distortions accounted treated noise order define similarity measure comparing 3d objects 2d images discussed section 1 first define bestview 3d object given 2d image difference measure two 2d images n features given 2d image object composed n features bestview 3d object model composed n corresponding features view smallest value obtained minimization performed possible views model views obtained applying transformation taken set permitted transformations followed projection pi compute difference two 2d images n features two ways image metric measure position differences image namely euclidean distance corresponding points two images summed points transformation metric images considered instances single 3d object metric measures difference two transformations align object two images difference measured instance computing euclidean distance matrices represent two transformations two transformations linear mentioned measure applied given image views given model views generated applying transformation set permitted transformations view minimizes distance image considered best view distance best view actual image considered distance object image consider paper two families transformations rigid transformations affine transformations discuss following metrics measures image distance given image best rigid view object measures image distance given image best affine view object assume image affine view object substitute image best affine view look rigid view object minimize difference two transformations affine transformation object image rigid transformation object possible rigid views words look view minimize amount affine deformations applied object illustrate difference image metrics transformation metrics figure 1 shows example three 2d images whose similarity relations reverse depending kind metric used consider planar object figure 1b reference object assume contains set rigid transformations 2d images c obtained stretching object horizontally 97 vertically 32 respectively image b obtained applying unit matrix object b c closer space closer space image figure 1 2d image shown b closer image difference computed transformation space closer image c difference euclidean difference two images ffl image metric images b 4 two pixel left corners rectangle image metric images b c 2 one pixel upper corners rectangle therefore according image metric figure c closer b ffl compute transformation metric consider planar object illustrated b compute difference matrices represent affine transformation b c matrix represent best rigid transformation case unit matrix obtained b horizontal stretch 97 transformation metric b therefore c obtained b vertical stretch 32 transformation metric case therefore according transformation metric figure closer b c interesting note example solution obtained minimizing transformation metric seems better correlate human perception solution obtained minimizing image metric 31 derivation n im n af define rigid affine image metrics explicitly weakperspective pro jection position image q model point rigid transformation given r scaled 3 theta 3 rotation matrix translation vector pi represents orthographic projection explicitly denote r 1 r 2 top two row vectors r denote rigid metric n im minimizes difference two sides eq 1 subject constraints 2 object allowed undergo affine transformations rotation matrix r replaced general 3 theta 3 linear matrix denoted constraints 2 ignored denote tand tthe top two row vectors obtain affine metric n af minimizes difference two sides eq 3 define rigid affine metrics first note translation component best rigid affine transformations ignored centroids model image points moved origin words begin translating model image points claim proof given appendix c denote matrix model point coordinates denote x b x nc b nc 5 location vectors corresponding image points rigid metric reflects desired minimization given corresponding affine metric given affine case solution simple assume rank p 3 case general coplanar 3d objects denote pseudoinverse p obtain affine distance given since solution rigid case significantly difficult solution affine case often affine solution considered rigidity constraints used verification eg ullman basri 1991 weinshall 1993 dementhon davis 1992 constraints 2 substituting r using eq 8 rewritten x x denote obtain b n theta n symmetric positivesemidefinite matrix rank 3 rank would smaller object points coplanar call b characteristic matrix object b natural extension 3 theta 3 modelbased invariant matrix defined weinshall 1993 general definition efficient computation images discussed appendix b 32 derivation n tr define transformation metric follows consider affine solution nearest affine view object obtained applying model matrix p pair vectors 1 2 defined eq 8 general solution rigid rigid constraints 2 hold vectors metric described based following rule looking another pair vectors r 1 r 2 satisfy rigid constraints minimize euclidean distance affine vectors 1 2 pr 1 pr 2 define best rigid view object defined metric metric n tr defined 1 2 constitutes optimal affine solution therefore section 5 present closedform solution metric section 6 show metric used bound image metric 4 summary results rest paper prove following results 41 transformation space transformation metric defined eq 13 following solution n tr 2 b defined eq 10 x eq 5 best view according metric given defined appendix 42 image space using n tr bound image metric denote show eigenvalues p p suboptimal solution n im given computation described appendix e tighter upper bound deduced suboptimal solution harmonic mean 2 3 suboptimal solution proposed initial guess iterative algorithm compute n im 5 closedform solution transformation space present metric compare 3d models 2d images weak perspective projection metric closedform solution transformation metric n tr defined eq 13 use notation developed section 3 b n theta n characteristic matrix object x 2 r n contain x ycoordinates image features metric given metric penalizes nonrigidities optimal affine transformation note two rigid constraints eq 11 satisfied otherwise n tr 0 represents optimal penalty deviation satisfying two constraints derivation results rest section prove expression n tr given eq 14 indeed solution transformation metric defined eq 13 proof proceeds follows theorem 1 computes minimal solution r 1 r 2 restricted plane spanned 1 2 theorem 2 extends result threespace r r22 figure 2 vectors 1 2 r 1 r 2 coordinate system specified theorem 1 1 2 represent solution affine case r 1 r 2 constrained plane 1 2 orthogonal share norm theorem 1 r 1 r 2 limited spanfa 1 2 g n tr given eq 14 proof first define new coordinate system see figure 2 angle 1 2 w 1 w 2 lengths 1 2 respectively common length two rotation vectors r 1 r 2 gammaff angle 1 r 1 without loss generality assumed 0 ffi 180 ffi notice w 1 w 2 given ff unknown denote f term minimized partial derivatives f given find possible minima equate derivatives zero solutions optimal case fff 2 later show solutions 0 always imply smaller values f 6 0 f tan ff therefore cos ff min q notice similarity expression expression f minimum point f rewritten apparent solution f 6 0 would smaller solution substituting ff min obtain therefore recall w 1 w 2 lengths 1 2 angle two vectors namely obtain theorem 1 proved r 1 r 2 restricted plane spanned 1 2 metric n tr given eq 14 theorem 2 prove solution r 1 r 2 results larger value f therefore minimum f obtained inside plane implying n tr indeed given eq 14 theorem 2 optimal r 1 r 2 lie plane spanned 1 2 proof assume way contradiction r 1 show corresponding value f minimal consider first plane spanned r 2 1 assume way contradiction show exists vector r 0 1 contradicting optimality f assume 1 vector length direction r 2 theta 1 theta r 2 vector lies spanfr 2 1 g satisfies exist two vectors opposing direction consider one nearest 1 show denote angle 1 r 0 1 ff denote angle r 0 1 r 1 fi also k rotate coordinate system obtain therefore ff contradicting minimality property therefore r g similarly shown r 2 2 spanfr 1 2 g therefore four vectors 1 2 r 1 r 2 lie single planecorollary 3 transformation metric given best view metric proof expression metric immediately follows theorem 1 2 expression best view developed appendix d6 solution image space order compute image metric defined section 3 need solve constraint minimization problem defined eq 6 section 61 shows n tr computed previous section used bound n im section 62 describes direct method compute suboptimal approximation n im outlines iterative algorithm improve estimate obtain optimal n im 61 bounding image metric transformation metric section show using transformation metric defined section 5 n tr affine metric n af given eq 9 bound image metric n im prove following theorem theorem 4 let denote three eigenvalues p p proof denote r 1 r 2 vectors minimize term image metric given eq 6 namely denote r 1 r 2 vectors minimize transformation metric given eq 13 namely start showing upper bound since r 1 r 2 minimize term n im break term sum two orthogonal components follows holds orthogonality readily follows identity since two components orthogonal holds similarly therefore recall r 1 r 2 minimize n tr 3 largest eigenvalue p p next prove lower bound proof similar proof upper bound case time start breaking terms orthogonal components use facts r 1 r 2 minimize n tr 1 smallest eigenvalue p p consequently direct solution image metric section develop tighter bounds image metric direct methods following steps took derivation transformation metric section 5 unlike transformation metric cannot obtain closedform solution image metric obtain better estimator previously described also enables us develop iterative method compute distance exactly section 621 describe change coordinate system arriving minimization problem similar one solve transformation metric difference sought vectors constrained lie ellipsoid rather sphere ellipsoid defined 3 theta 3 positivedefinite version characteristic matrix b section 622 restrict solution vectors u v lie plane data vectors x derive optimal solution constraint solution however suboptimal since contrast transformation metric optimal solution case lie plane using solution derive tighter upper bound optimal solution section 623 describe general problem needs solved outline iterative method propose solution obtained plane initial guess method 621 reducing dimensionality problem section 61 shown image metric broken two orthogonal terms implying property useful direct computation image metric first term n af depend r 1 r 2 compute n im therefore second term needs minimized min note first pp x pp two vectors r n lie single linear subspace dimension 3 follows fact shown ullman basri 1991 every image 3d object written linear combination three independent views moreover three columns p lie subspace therefore follows vectors must also lie subspace denote projection x column space p denote note r characteristic matrix object rewrite problem follows min since vectors u v lie 3d subspace column space p perform minimization r 3 transform system r 3 rotate vectors characteristic matrix b get nontrivial nonzero values three coordinates recall distances quadratic forms invariant rotation rotation applied terms defined eigenvectors b applying matrix b results diagonal matrix three positive eigenvalues b 622 closedform solution plane theorem 5 u v limited spanf g solution eq 19 given principal axes ellipse defined intersection ellipsoid b plane spanf g note similarity solution n tr eq 14 fact proof closely follows proof n tr presented section 5 theorem 2 therefore skip details proof first define new coordinate system without loss generality assumed gamma90 given ff unknown notice setting coordinate system similar one used theorem 1 exceptions u v lie ellipse rather circle general none points brought lie principal axis denote f term minimized partial derivatives f given find possible minima equate derivatives zero solutions ignored since correspond global minimum similar reason proof theorem 1 6 0 f tan ff cos ff min similarly eq 15 substitute min cos ff min using identity cos eq 22 manipulations obtain follows substitute identities eq 25 eq 23 obtaining expression eq 20the derivation 1 2 given appendix e suboptimal solution plane used improve bounds image metric previously discussed theorem 4 theorem 3 three eigenvalues p p harmonic mean 2 3 proof eigenvalues characteristic matrix b 1 1 shown appendix e since 1 1 1 2 represent eigenvalues section b holds see eg strang 1976 p 270 1 using eq 21 obtain using eq 17 obtain upper bound trcorollary 7 note since hmfa bg 2 minfa bg every b following corollary corollary 8 cannot yet improve lower bound theorem 4 conjecture conjecture 1 let 3 three eigenvalues p p motivation know two data points x lie ellipse whose principal axes length 1 2 smallest crosssection ellipsoid b show solution local minimum namely possible improve solution applying small perturbations solution vectors623 iterative optimal solution solution obtained theorem 5 suboptimal lowest distance give cost function function four variables minimized obtain precise value image metric first define coordinate system sin ff cos fi sin fl sin ff sin fi sin fl known ff fi fl free note setting coordinate system similar one used theorem 5 u v lie ellipsoid rather ellipse notation free parameters selected satisfy two rigid constraints compute image metric following function minimized fs ff fi n im global minimum fs ff fi fl assuming fs ff fi fl convex area contains global minimum n im suboptimal solution n af employ following iterative method compute n im 1 compute 2 improve solution gradientdescent method local minimum obtained convexity assumption correct method returns correct image metric otherwise may return suboptimal solution simulations test presented metric compared alignment method mentioned section 2 alignment method involves selection small subset correspondences alignment key solving transformation using subset transforming rest points measuring distance corresponding image points obtained distance critically depends choice alignment key different choices produce different distance measures model image results almost always suboptimal since usually better match points small errors exactly match subset points project errors entirely onto others simulations models composed four points projected image using weak perspective projection gaussian noise standard deviation 005 radius 3d object added obtained images using expression n tr given 14 computed upper lower bounds image metric model noisy images addition computed corresponding alignment distances reflecting distance one model point predicted projection image alignment remaining three image points model figures summarize results figure 3 shows percentage alignment distances actually lie within bounds image metric computed metric percent inside range condition number tight bounds general bounds figure 3 percent alignment distances lie within bounds image metric computed closedform equations abscissa gives condition number characteristic matrix b determines far apart lower upper bounds image metric larger condition number apart bounds solid alignment distances relative wide bounds eq 26 dashed lines alignment distances relative tight upper bound eq 27 given eq 26 seen bounds relatively tight condition number characteristic matrix b relatively low alignment solutions exceed upper bound condition number gets larger alignment distances lie within bounds tighter upper bound used eq 27 smaller portion alignment distances actually lie within bounds figure 4 shows maximal minimal alignment distances obtained different runs relative upper lower bounds image metric given eq 26 eq 27 seen many cases even best alignment solution one minimizes still exceeds upper bound summary proposed transformation metric measure similarity 3d models 2d images transformation metric measures amount affine deformation applied object produce given image simple closedform solution metric presented solution optimal transformation space used bound image metric alignment log scale random model image smallest alignment distance largest alignment distance158398100025126310alignment log scale random model image smallest alignment distance largest alignment distance b158398100025126310alignment log scale random model image smallest alignment distance largest alignment distance158398100025126310alignment log scale random model image smallest alignment distance largest alignment distance c figure 4 maximal minimal alignment distances plotted number models objects varying along abscissa distances plots normalized obtain constant lower upper bounds lower bound set 1 upper bound set average ratio upper bound lower bound sequence runs small 15 25 large 45 55 condition numbers used results compared wide eq 26 tight eq 27 bounds small condition number wide bounds b small condition number tight bounds c large condition number wide bounds large condition number tight bounds transformation metric presented paper used several different ways recognition classification tasks 1 provides direct assessment similarity models images measuring amount deformation applied objects makes suited task object classification uncertainty structure observed objects inherent 2 transformation metric used bound image metric distance image closest view object shown simulations bounds often provide better estimates provided using alignment consequently believe many cases bounds suffice unequivocally determine identity observed object 3 transformation metric provides suboptimal closedform estimate image metric scheme uses measure prefer symmetric objects objects whose convexhull close sphere objects significantly stretched contracted along one spatial dimension solution also used initial guess iterative process computes optimal value image metric numerically appendices metric properties measures described paper compare entities different dimensionalities 3d objects 2d images define metric comparing entities follows let p set n model points let q set n corresponding image points distance function np q defined using difference function q q 0 two views see section 3 called metric 1 every model p image q 2 q rigid view p 3 image metric n im simply euclidean distance corresponding points compared images straightforward see conditions hold case rest appendix prove conditions also hold transformation metric n tr transformation metric transformation metric n tr measures amount affine deformation applied object image metric conditions n tr defined follows 1 every model p image q 2 exists rigid view coincides pp words best affine view object rigid view affine deformation 3 theorem 9 n tr metric proof 1 n tr 0 n tr minimizes nonnegative distance function therefore always nonnegative 2 best affine view rigid denote x x coordinates points q according eq 14 equation holds sides zero implying best affine view object given pp following eq 11 best affine view also satisfies rigidity constraints therefore forms rigid view 3 metric n tr defined eq 13 n tr let w 2 optimal vectors q 0 n tr obtain n tr b computation characteristic matrix eq 10 characteristic matrix b defined using matrix euclidean model point coordinates p give general though equivalent definition b using matrix affine model point coordinates q namely point coordinates q given coordinate system whose axes necessarily orthonormal definition makes possible compute b directly three images completely linear algorithm requires pseudoinverse select affine coordinate system whose independent axes defined three object points called basis points let p bas denote submatrix p corresponding coordinates basis points let q denote affine coordinates object points basis immediately follows denote characteristic matrix three basis points eq 10 follows bas 30 finally definition pseudoinverse readily verified describe b terms q b bas substituting eq 31 definition b eq 10 using eq 30 obtain linear incremental computation matrices q b bas least three images object points described weinshall tomasi 1992 eliminating translation appendix show translation ignored set centroids model image points origin show prove best rigid affine transformations maps model centroid image centroid begin showing given two sets n 2d points images best translation relates two images maps centroid first image second two sets corresponding points denote centroids translation 2 r 2 minimizes term given proof assume way contradiction best translation given nonzero ffi 2 r 2 denote new term 0 p obtain therefore implies contradicting initial assumptionusing lemma 10 prove best rigid affine transformations map model centroid image centroid theorem 11 let 3 set n model points let q corresponding n image points rigid transformation fs minimizes term fsrtg pi denotes orthographic projection satisfies proof denote according lemma since obtain theorem holds also consider affine transformations rather rigid ones rotation matrix r replaced case general linear transformation atheorem 11 shows best rigid affine transformations map model centroid image centroid consequently two centroids moved origin translation component vanishes follows immediately theorem 11 since implies appendix develop expression best view transformation metric n tr derivations follow notations used proof theorem 1 cos sin according theorem 2 r g therefore express r 1 r 2 scalars substituting definitions vectors r 1 r 2 1 2 obtain cos gammas sin sin cos therefore substituting ff obtain sin substituting w 1 w 2 obtain best view use following identities therefore computing eigenvalues ellipse appendix compute eigenvalues ellipsoid b eigenvalue elliptic section ellipsoid first show eigenvalues characteristic matrix b 1 1 three positive eigenvalues p p derived follows multiplying sides p obtain denote implies given r 3 positive definite 3 theta 3 matrix b let b 0 denote ellipse defined intersection ellipsoid b plane spanf g need find eigenvalues b 0 1 1 without loss generality assume x lie ellipsoid defined b namely normalize vectors angle x define two orthonormal vectors x 0 0 span plane spanf g follows every vector v 2 spanf g written intersection ellipse b 0 given 3 theta 2 matrix whose columns x 0 0 therefore substituting expressions x 0 0 get obtain two eigenvalues b 1 solve characteristic equation b 0 whose roots acknowledgments thank larry maloney valuable discussions technical help eric grimson yael moses tomasso poggio comments earlier drafts paper r alignment objects smooth surfaces random sample consensus paradigm model fitting applications image analysis automated cartography invariant descriptors 3d object recognition pose analytic solution perspective 4point problem relative orientation revisited object recognition using alignment recognition 3d objects 2d images recovering orientation position rigid body space single view machine perception threedimensional solids linear algebra applications versatile camera calibration technique highaccuracy 3d machine vision metrology using offtheshelf tv cameras lenses aligning pictorial descriptions approach object recog nition recognition linear combinations models linear incremental acquisition invariant shape models image sequences general photogrammetric method determining object position orientation tr ctr hausan wong kent k cheung horace h ip evolutionary optimization approach 3d human head model classification proceedings 5th acm sigmm international workshop multimedia information retrieval november 0707 2003 berkeley california hausan wong kent k cheung chunip chiu yang sha horace h ip hierarchical multiclassifier system design based evolutionary computation technique multimedia tools applications v33 n1 p91108 april 2007