efficient protocol authenticated key agreement paper proposes efficient twopass protocol authenticated key agreement asymmetric publickey setting protocol based diffiehellman key agreement modified work arbitrary finite group particular elliptic curve groups two modifications protocol also presented onepass authenticated key agreement protocol suitable environments one entity online threepass protocol key confirmation additionally provided variants protocols standardized ieee p1363 17 ansi x942 2 ansi x963 4 iso 154963 18 currently consideration standardization us governments national institute standards technology 30 b introduction key establishment process two entities establish shared secret key key subsequently used achieve cryptographic goal confidentiality data integrity broadly speaking two kinds key establishment protocols key transport protocols key created one entity securely transmitted second entity key agreement protocols parties contribute information jointly establish shared secret key paper shall consider key agreement protocols asymmetric publickey twoentity setting let b two honest entities ie legitimate entities execute steps protocol correctly informally speaking key agreement protocol said provide implicit key authentication b entity assured entity aside specifically identified second entity b possibly learn value particular secret key note property implicit key authentication necessarily mean assured b actually possessing key key agreement protocol provides implicit key authentication participating entities called authenticated key agreement ak protocol informally speaking key agreement protocol said provide key confirmation b assured second entity b actually possession particular secret key implicit key authentication key confirmation b provided key establishment protocol said provide explicit key authentication b key agreement protocol provides explicit key authentication participating entities called authenticated key agreement key confirmation akc protocol extensive survey key establishment see chapter 12 menezes van oorschot vanstone 27 extreme care must exercised separating key confirmation implicit key authen tication ak protocol offer key confirmation used pointed 10 desirable agreed key confirmed prior cryptographic use done variety ways example key subsequently used achieve confiden tiality encryption key begin carefully chosen known data systems may provide key confirmation realtime telephone conversation separating key confirmation implicit key authentication sometimes desirable permits flexibility particular implementation chooses achieve key confirmation thus moves burden key confirmation establishment mechanism application paper propose new efficient twopass ak protocol protocol based diffiehellman key agreement 14 many desirable security performance attributes discussed 10 see x2 two modifications protocol also presented onepass ak protocol suitable environments one entity online threepass protocol key confirmation additionally provided protocols described paper establish shared secret k two entities derivation function used derive secret key shared secret necessary k may weak bits bits information k predicted correctly nonnegligible advantage one way derive secret key k apply oneway hash function sha1 28 k exception protocol 3 x62 paper include key derivation functions protocol descriptions protocols described paper described setting group points elliptic curve defined finite field however easily modified work finite group discrete logarithm problem appears intractable suitable choices include multiplicative group finite field subgroups z n n composite integer subgroups z p prime order q elliptic curve groups advantageous offer equivalent security groups smaller key sizes faster computation times remainder paper organized follows x2 discusses desirable attributes ak akc protocols x3 describes elliptic curve parameters common entities involved protocols public keys methods validating x4 reviews mti protocols describes active attacks attacks influenced design new twopass ak protocol presented x5 x6 presents onepass variant protocol threepass variant provides explicit key authentication finally x7 makes concluding remarks desirable attributes ak akc protocols numerous diffiehellmanbased ak akc protocols proposed years ever many subsequently found security flaws main problems appropriate threat models goals secure ak akc protocols lacked formal defini tion blakewilson johnson menezes 10 adapting earlier work bellare rogaway 9 symmetric setting provided formal model distributed computing rigorous definitions goals secure ak akc protocols within model concrete ak akc protocols proposed proven secure within framework random oracle model 8 paper follows definitions goals secure ak akc protocols described informally x1 classification threats secure protocol able withstand passive attacks adversary attempts prevent protocol achieving goals merely observing honest entities carrying protocol active attacks adversary additionally subverts communications injecting deleting altering replaying messages addition implicit authentication key confirmation number desirable security attributes ak akc protocols identified see 10 discussion 1 knownkey security run key agreement protocol two entities b produce unique secret key keys called session keys protocol still achieve goal face adversary learned session keys 2 perfect forward secrecy longterm private keys one entities compromised secrecy previous session keys established honest entities affected 3 keycompromise impersonation suppose longterm private key disclosed clearly adversary knows value impersonate since precisely value identifies however may desirable loss enable adversary impersonate entities 4 unknown keyshare entity cannot coerced sharing key entity b without knowledge ie believes key shared entity c 6 b b correctly believes key shared 5 key control neither entity able force session key preselected value desirable performance attributes ak akc protocols include minimal number number messages exchanged run protocol low communication overhead total number bits transmitted low computation overhead attributes may desirable circumstances include rolesymmetry messages transmitted entities structure noninteractiveness messages transmitted two entities independent nonreliance encryption meet export requirements hash functions since notoriously hard design timestamping since difficult implement securely practice 3 domain parameters key pair generation section describes elliptic curve parameters common entities involved protocols ie domain parameters key pairs entity 31 domain parameters domain parameters protocols described paper consist suitably chosen elliptic curve e defined finite field f q characteristic p base point remainder subsection elaborate suitable parameters outline procedure verifying given set parameters meet requirements order avoid pollardrho 32 pohlighellman 31 algorithms elliptic curve discrete logarithm problem ecdlp necessary number f q rational points e denoted ef q divisible sufficiently large prime n writing commonly recommended n 2 160 see 3 4 fixed underlying field f q n selected large possible ie one n q ef q almost prime remainder paper shall assume n 2 160 n 4 p q hasses theorem hence implies n 2 divide ef q thus ef q unique subgroup order n also since unique integer h namely guard potential small subgroup attacks see x41 point p order n precautions exercised selecting elliptic curve avoid reduction algorithms menezes okamoto vanstone 24 frey ruck 16 curve nonsupersingular ie p divide q generally one verify n divide q large enough computationally infeasible find discrete logarithms f q c suffices practice 3 avoid attack semaev 34 smart 35 satoh araki 33 f q anomalous curves curve f q anomalous ie ef q 6 q prudent way guard attacks similar attacks special classes curves may discovered future select elliptic curve e random subject condition ef q divisible large prime probability random curve succumbs specialpurpose attacks negligible curve selected verifiably random choosing coefficients defining elliptic curve equation outputs oneway function sha1 according prespecified procedure procedure accomplishing similar spirit method given fips 186 29 selecting dsa primes verifiably random described ansi x962 3 summarize domain parameters comprised 1 field size q q prime power practice either odd prime 2 indication fr field representation representation used elements f q 3 two field elements b f q define equation elliptic curve e f q ie case p 3 case 4 two field elements x p p f q define finite point prime order ef q since p described two field elements implies p 6 denotes point infinity 5 order n point p 6 cofactor domain parameter validation set domain parameters q fr b verified meet requirements follows process called domain parameter validation 1 verify q prime power 2 verify fr valid field representation 3 verify b x p p elements f q ie verify proper format elements f q 4 verify b define nonsingular elliptic curve f q ie 4a 3 case p 3 b 6 0 case 5 verify p satisfies defining equation e p 6 6 verify n 4 p q n prime n sufficiently large eg n 2 160 7 verify 8 compute verify 9 ensure protection known attacks special classes elliptic curves verify n divide q 20 n 6 q 32 key pair generation given valid set domain parameters q fr b h entity private key integer selected random interval 1 n gamma 1 public key elliptic curve point key pair q run key agreement protocol two entities b produce unique shared secret key hence protocols described paper entity two public keys static longterm public key ephemeral shortterm public key static public key bound entity certain period time typically use certificates new ephemeral public key generated run protocol static key pair denoted wa wa ephemeral key pair denoted remainder paper assume static public keys exchanged via certificates cert denotes publickey certificate containing string information uniquely identifies name address static public key wa certifying authority cas signature information avoid potential unknown keyshare attack see x42 ca verify possesses private key wa corresponding static public key wa information may included data portion certificate including domain parameters known context entity b use authentic copy cas public key verify certificate thereby obtaining authentic copy static public key publickey validation using entitys purported public key q prudent verify possesses arithmetic properties supposed namely q finite point subgroup generated p process called publickey validation 19 given valid set domain parameters q fr b purported public key validated verifying 1 q equal 2 xq q elements field f q ie proper format elements 3 q satisfies defining equation e 4 embedded publickey validation computationally expensive operation publickey validation scalar multiplication step 4 static public keys validation could done ca however since new ephemeral key generated run protocol validation ephemeral key places significant burden entity performing validation reduce burden step 4 omitted key validation instead protocols proposed x5 x6 ensure shared secret k generated finite point subgroup generated p summarize given valid set domain parameters embedded publickey validation purported public key accomplished verifying 1 q equal 2 xq q elements field f q ie proper format elements f q 3 q satisfies defining equation e 4 mti key agreement protocols mtia0 mtic0 key agreement protocols described special cases three infinite families key agreement protocols proposed matsumoto takashima imai 23 1986 designed provide implicit key authentication provide key confirmation closely related protocols kea 30 proposed goss 17 yacobi 37 latter operating ring integers modulo composite integer yacobi proved protocol secure certain types knownkey attacks passive adversary provided composite modulus diffiehellman problem intractable however desmedt burmester 13 pointed security heuristic knownkey attack active adversary section illustrates mtia0 mtic0 families protocols vulnerable several active attacks small subgroup attack presented x41 illustrates mtic0 protocol originally described provide implicit key authentication unknown attack presented x42 illustrates mtia0 protocol possess unknown keyshare attribute circumstances active attacks ak protocols discussed diffie van oorschot wiener 15 burmester 11 vaudenay 20 lim lee 22 41 small subgroup attack small subgroup attack first pointed vanstone 26 see also van oorschot wiener 36 anderson vaudenay 1 lim lee 22 attack illustrates authenticating validating static ephemeral keys prudent sometimes essential measure take diffiehellman ak protocols illustrate small subgroup attack mtic0 protocol protocol assumes b priori possess authentic copies others static public keys mtic0 ak protocol 1 generates random integer r computes point sends b 2 b generates random integer r computes point sends tb 3 computes r 4 b computes 5 shared secret point k small subgroup attack launched order n base point p prime say attack forces shared secret one small known subset points small subgroup attack mtic0 protocol 1 e intercepts message replaces 2 e intercepts bs message tb replaces mtb 3 computes r mtb 4 b computes k lies subgroup order group generated p hence takes one possible values since value k correctly guessed e high probability shows mtic0 protocol provide implicit key authentication effects especially drastic subsequent key confirmation phase may fail detect attack e may able correctly compute messages required key confirmation example e may able compute behalf message authentication code mac k message consisting identities b ephemeral point purportedly sent point sent b small subgroup attack mtic0 prevented example mandating use base point p prime order requiring b perform key validation ephemeral public keys receive 1 case static private keys w selected subject condition 42 unknown keyshare attack active attack mtia0 protocol described subsection first pointed menezes qu vanstone 25 attack many variants illustrate prudent require entity prove possession private key corresponding static public key ca ca certifies public key belonging proof possession accomplished zeroknowledge techniques example see chaum evertse van de graaf 12 mtia0 ak protocol 1 generates random integer r computes point sends ra cert b 2 b generates random integer r computes point sends rb cert b 3 computes 4 b computes 5 shared secret point k one variant unknown keyshare attack adversary e wishes messages sent b identified originated e accomplish e selects integer e 1 e gets certified public key notice e know logical private key corresponds public key assuming course discrete logarithm problem ef q intractable although knows e unknown keyshare attack mtia0 protocol 1 e intercepts message ra cert replaces ra cert e 2 b sends rb cert b e forwards erb cert b 3 computes 4 b computes b share secret k even though b believes shares secret e note learn value k hence attack illustrates mtia0 protocol possess unknown keyshare attribute hypothetical scenario attack may launched successfully following scenario first described diffie van oorschot wiener 15 suppose b bank branch account holder certificates issued bank headquarters within certificate account information holder suppose protocol electronic deposit funds exchange key bank branch via mutually authenticated key agreement b authenticated transmitting entity encrypted funds deposited account number certificate suppose authentication done encrypted deposit message might case save bandwidth attack mentioned successfully launched deposit made es account instead account 5 new authenticated key agreement protocol section twopass ak protocol described following notation used x5 x6 f denotes bitlength n prime order base point q finite elliptic curve point q defined follows let x xcoordinate q let x integer obtained binary representation x value x depend representation chosen elements field f q q defined integer observe q mod n 6 0 51 protocol description describe twopass ak protocol protocol 1 optimization refinement protocol first described menezes qu vanstone 25 depicted figure 1 subsequent figures w awa denotes static private key static public key wa wa respectively domain parameters static keys set validated described x3 b priori possess authentic copies others static public certificates included flows ra figure 1 twopass ak protocol protocol 1 protocol 1 1 generates random integer r computes point sends b 2 b generates random integer r computes point sends 3 embedded key validation rb see x32 validation fails terminates protocol run failure otherwise computes terminates protocol run failure 4 b embedded key validation ra validation fails b terminates protocol run failure otherwise b computes terminates protocol run failure 5 shared secret point k 52 security notes rationale although security protocol 1 formally proven model distributed computing heuristic arguments suggest protocol 1 provides mutual implicit key authenti cation addition protocol 1 appears security attributes knownkey security forward secrecy keycompromise impersonation key control listed x2 another security attribute protocol 1 compromise ephemeral private keys r r b reveals neither static private keys wa wb shared secret k kaliski 21 recently observed protocol 1 possess unknown keyshare attribute demonstrated following online attack adversary e intercepts ephemeral public key ra intended b computes certified static public key note e knows corresponding private key transmits b b responds sending rb e e forwards b compute secret k however b mistakenly believes shares k e emphasize lack unknown keyshare attribute contradict fundamental goal mutual implicit key authentication definition provision implicit key authentication considered case b engages protocol honest entity e isnt application using protocol 1 concerned lack unknown keyshare attribute online attacks appropriate confirmation added example specified protocol 3 protocol 1 viewed direct extension ordinary unauthenticated diffiehellman agreement protocol quantities b serve implicit signatures ephemeral public key ra bs ephemeral public key rb respectively shared secret rather r r bp would case ordinary diffiehellman expression ra uses half bits xcoordinate ra done order increase efficiency computing k scalar multiplication rawa 4 done half time full scalar multiplication modification appear affect security protocol definition ra implies ra 6 0 ensures contribution static private key wa cancelled formation 1 multiplication h 2 4 ensures shared secret k see equation 5 point subgroup order n ef q check ensures k finite point protocol 1 used agree upon kbit key subsequent use symmetrickey block cipher recommended elliptic curve chosen n 2 2k protocol 1 desirable performance attributes listed x2 point view dominant computational steps run protocol 1 scalar multiplications r ap rbwb hsa rb rbwb hence work required entity 25 full scalar mul tiplications since r ap computed offline online work required entity 15 scalar multiplications addition protocol low communication overhead rolesymmetric noninteractive use encryption timestamping hash function may used key derivation function derive session key shared secret k security protocol 1 appears less reliant cryptographic strength hash function ak protocols protocol 3 10 particular requirement key derivation function preimage resistant appears unnecessary non reliance hash functions advantageous history shown secure hash functions difficult design 6 related protocols section presents two related protocols onepass ak protocol protocol 2 threepass akc protocol protocol 3 61 onepass authenticated key agreement protocol purpose onepass ak protocol protocol 2 entities b establish shared secret transmit one message b useful applications one entity online secure email storeandforward protocol 2 depicted figure 2 assumes priori authentic copy bs static public key domain parameters static keys set validated described x3 ra figure 2 onepass ak protocol protocol 2 protocol 2 1 generates random integer r computes point sends b 2 computes terminates protocol run failure 3 b embedded key validation ra see x32 validation fails b terminates protocol run failure otherwise b computes n terminates protocol run failure 4 shared secret point k heuristic arguments suggest protocol 2 offers mutual implicit key authentication main security drawback protocol 2 knownkey security forward secrecy since entity b contribute random permessage component course case onepass key agreement protocol 62 authenticated key agreement key confirmation protocol describe akc variant protocol 1 depicted figure 3 domain parameters static keys set validated described x3 mac message authentication code algorithm used provide key confirmation examples provably secure practical mac algorithms see bellare canetti krawczyk 5 bellare guerin rogaway 6 bellare kilian rogaway 7 h 1 independent key derivation functions practical instantiations h 1 include h 1 protocol 3 1 generates random integer r computes point sends b 2 21 b embedded key validation ra see x32 validation fails b terminates protocol run failure 22 otherwise b generates random integer r computes point ra figure 3 threepass akc protocol protocol 23 b terminates protocol run failure shared secret k 24 b uses xcoordinate z point k compute two shared z z sends together rb 3 31 embedded key validation rb validation fails terminates protocol run failure 32 otherwise computes terminates protocol run failure 33 uses xcoordinate z point k compute two shared z z 34 computes mac 0 verifies equals sent b 35 computes mac 0 sends b 4 b computes mac 0 verifies equals sent 5 session key akc protocol 3 derived ak protocol 1 adding key confirmation latter done exactly way akc protocol 2 10 derived ak protocol 3 10 protocol 2 10 formally proven secure akc protocol heuristic arguments suggest protocol 3 paper secure akc protocol addition desirable security attributes listed x2 7 concluding remarks paper presented new ak akc protocols possess many desirable security attributes extremely efficient appear place less burden security key derivation function proposals neither protocols proposed formally proven possess claimed levels security heuristic arguments suggest case hoped protocols appropriate modifications plausible assumptions proven secure model distributed computing introduced 10 acknowledgements authors would like thank simon blakewilson johnson comments earlier drafts paper ms law dr solinas would like acknowledge contributions colleagues national security agency r minding ps qs keying hash functions message authenti cation xor macs new methods message authentication using finite pseudorandom functions security cipher block chaining random oracles practical paradigm designing efficient protocols entity authentication key distribution key agreement protocols security analysis risk opening distributed keys improved protocol demonstrating possession discrete logarithms generalizations towards practical proven secure authenticated key distri bution new directions cryptography authentication authenticated key ex changes remark concerning mdivisibility discrete logarithm divisor class group curves cryptographic method apparatus public key exchange authenti cation contribution ansi x9f1 working group authenticated multiparty key agreement contribution ansi x9f1 ieee p1363 working groups key recovery attack discrete logbased schemes using prime order subgroup seeking smart publickey distribution sys tems reducing elliptic curve logarithms logarithms finite field new key agreement protocols providing mutual implicit authentication key agreement need authentication handbook applied cryptography secure hash standard shs digital signature standard skipjack kea algorithm specification improved algorithm computing logarithms gf p cryptographic significance monte carlo methods index computation mod p fermat quotients polynomial time discrete log algorithm anomalous elliptic curves evaluation discrete logarithms group ptorsion points elliptic curve characteristic p discrete logarithm problem elliptic curves trace one diffiehellman key agreement short expo nents key distribution paradox tr ctr johann groschdl alexander szekely stefan tillich energy cost cryptographic key establishment wireless sensor networks proceedings 2nd acm symposium information computer communications security march 2022 2007 singapore kyungah shim sung sik woo cryptanalysis tripartite multiparty authenticated key agreement protocols information sciences international journal v177 n4 p11431151 february 2007 kyungah shim vulnerabilities generalized mqv key agreement protocol without using oneway hash functions computer standards interfaces v29 n4 p467470 may 2007 maurizio adriano strangio efficient diffiehellmann twoparty key agreement protocols based elliptic curves proceedings 2005 acm symposium applied computing march 1317 2005 santa fe new mexico mario di raimondo rosario gennaro hugo krawczyk secure offtherecord messaging proceedings 2005 acm workshop privacy electronic society november 0707 2005 alexandria va usa