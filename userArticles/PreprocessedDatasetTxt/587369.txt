symplectic balancing hamiltonian matrices discuss balancing hamiltonian matrices structure preserving similarity transformations method closely related balancing nonsymmetric matrices eigenvalue computations proposed osborne j acm 7 1960 pp 338345and parlett reinsch numer math 13 1969 pp 296304 implemented linear algebra software packages shown isolated eigenvalues deflated using similarity transformations symplectic permutation matrices balancing based equilibrating row column norms hamiltonian matrix using symplectic scaling matrices due given structure sufficient deal leading half rows columns matrix numerical examples show method improves eigenvalue calculations hamiltonian matrices well numerical methods solving continuoustime algebraic riccati equations b introduction eigenvalue problem hamiltonian matrices g g q 2 r nthetan g q symmetric plays fundamental role many algorithms control theory areas applied mathematics well computational physics chemistry computing eigenvalues hamiltonian matrices required eg computing h1 norm transfer matrices see eg 9 10 calculating stability radius matrix 13 29 computing response functions 22 many hamiltonian matrices also closely related continuoustime algebraic riccati equations care form g q 11 x 2 r nthetan symmetric solution matrix many numerical methods solving 12 based computing certain invariant subspaces related hamiltonian matrices see eg 19 21 26 28 detailed discussion relations hamiltonian matrices continuoustime algebraic riccati equations 12 refer 18 eigenvalue computations matrices matrix pencils often preprocessed using balancing procedure described 23 25 general matrix 2 r nthetan first permuted via similarity transformations order isolate eigenvalues ie permutation matrix p 2 r nthetan computed upper triangular matrices diagonal matrix universitat bremen fachbereich 3 mathematik und informatik zentrum fur technomathe matik 28334 bremen germany email bennermathunibremende computed rows columns gamma1 z zdz close norm possible balancing consists permutation step scaling step scaling step rows columns matrix scaled usually leads decrease matrix norm preprocessing step often improves accuracy computed eigenvalues significantly isolated eigenvalues ie contained 1 2 even computed without roundoff error unfortunately applying balancing strategy hamiltonian matrix h given 11 general destroy hamiltonian structure problem subsequent eigenvalue algorithm preserve use hamiltonian struc ture past fifteen years several structure preserving methods hamiltonian eigenproblem suggested particular squarereduced method 31 hamiltonian qr algorithm 11 rank 12 recently proposed algorithm based symplectic urvlike decomposition 7 implicitly restarted symplectic lanczos method 5 large sparse hamiltonian eigenproblems appropriate choices developing subroutines library usage raise need symplectic balancing routine similarity transformations symplectic matrices preserve hamiltonian structure thus order balance hamiltonian matrix preserve structure required permutation matrix diagonal scaling matrix symplectic section 2 give necessary background isolating eigenvalues hamiltonian matrices without destroying structure achieved using symplectic permutation matrices topic section 3 equilibrate rows norms hamiltonian matrices similar way proposed 25 using symplectic diagonal scaling matrices presented section 4 invariant subspaces eigenvectors solutions algebraic riccati equations target computations postprocessing steps required applications proposed symplectic balancing method discussed section 5 numerical examples use proposed balancing strategy eigenvalue computation numerical solution algebraic riccati equations given section 6 2 preliminaries following classes matrices employed sequel definition 21 let n n theta n identity matrix matrix h 2 r 2ntheta2n hamiltonian hj lie algebra hamiltonian matrices r 2ntheta2n denoted h 2n b matrix h 2 r 2ntheta2n skewhamiltonian hj jordan algebra skewhamiltonian matrices r 2ntheta2n denoted sh 2n c matrix 2 r 2ntheta2n symplectic sjs lie group symplectic matrices r 2ntheta2n denoted 2n matrix u 2 r 2ntheta2n unitary symplectic u 2 2n uu compact lie group unitary symplectic matrices r 2ntheta2n denoted us 2n observe every h 2 h 2n must block representation given 11 11 important relation symplectic hamiltonian matrices proved proposition 22 let 2 r 2ntheta2n nonsingular gamma1 hs hamiltonian h 2 h 2n result shows general similarity transformations preserve hamiltonian structure symplectic scaling real scalar following proposition shows structure 2n theta 2n orthogonal symplectic matrices permits represented pair n theta n matrices hence arithmetic cost storage accumulating orthogonal symplectic matrices halved proposition 23 24 orthogonal matrix u 2 r 2ntheta2n symplectic takes form 2 following wellknown property spectra hamiltonian matrices see eg 18 21 references given therein proposition 24 spectrum real hamiltonian matrix denoted oe h symmetric respect imaginary axis ie 2 oe h gamma 2 oe h spectrum hamiltonian matrices therefore partitioned oe solving hamiltonian eigenproblems one would like compute schur form hamiltonian matrices analogous real schur form nonsymmetric matrices done structurepreserving way definition 25 let h form g 2 r nthetan real schur form quasiupper triangular real hamiltonian quasitriangular b h 2 h 2n exists u 2 us 2n real hamiltonian quasitriangular h real hamiltonian schur form u hu called hamiltonian schur decomposition hamiltonian schur decomposition exists h 22 u chosen oe structurepreserving methods hamiltonian eigenproblem ie using symplectic similarity transformations rely following result hamiltonian matrices purely imaginary eigenvalues result first stated 24 full generality given proved 20 theorem 26 let h 2 h 2n let iff pairwise distinct nonzero purely imaginary eigenvalues furthermore let associated hinvariant subspaces spanned columns u k following equivalent exists 2 2n gamma1 hs real hamiltonian quasitriangular ii exists u 2 us 2n u hu real hamiltonian schur form congruent j always appropriate dimension note theorem 26 follows purely imaginary eigenvalues h 2 must even algebraic multiplicity order hamiltonian schur form h exist 3 isolating eigenvalues symplectic permutations let p denote n theta n permutation matrix easy see symplectic permutation matrices form matrices type 31 possible transform hamiltonian matrix 22 0 z z z z z z 11 33 upper triangular either q existence p proved constructive way later algorithm 34 transforms hamiltonian matrix form given 32 hamiltonian matrix form 32 total 2p h read directly seen following result lemma 31 let h 2 h 2n form 32 either g exists permutation matrix 2ntheta2n upper triangular 22 g 22 2r theta 2r hamiltonian submatrix h proof let h 32 13 11 12 g 12 g 11 13 22 gammaa diag pi q r 0 r q 07 7 7 7 7 7 5 thus desired form eigenvalue relation 34 follows gammai q 0 gammai q 0 13 11 lemma 31 merely theoretical interest demonstrates order solve hamiltonian eigenvalue problem proceed working h 22 transformations used proof general nonsymplectic want compute invariant subspaces eigenvectors andor hamiltonian schur form given theorem 26 transform hamiltonian matrix 32 hamiltonian schur form rows columns accomplished using symplectic permutation matrices form 31 therefore need another class transformation matrices definition 32 matrix p j 2 r 2ntheta2n called jpermutation matrix symplectic ie p c row column exactly one nonzero entry p j 2 us 2n clear similarity transformation jpermutation matrix preserves hamiltonian structure analogy standard permutations similarity transformations p j performed without floating point opera tions moreover represented signed integer vector ip length n rows columns k j interchanged sign indicates corresponding entry p j 1 gamma1 entries p j rows 2n deduced ip proposition 23 furthermore symplectic permutation matrices given 31 jpermutation matrices lemma 33 h 2 h 2n form 32 exists jpermutation matrix p j 11 12 g 11 22 g g 22 t3 11 upper triangular notation 32 proof let hamiltonian matrix h given 32 need jpermutation matrix first step let obviously p 1 jpermutation matrix 11 12 gammag 13 g 11 g 12 13 22 assume g q 13 t0 11 12 13 g 11 g 12 thus obtain form 39 another similarity transformation pi q defined 38 case ie q cases jpermutation matrix p hamiltonian matrix desired form 39 order isolate eigenvalues sufficient restrict symplectic permutations computed form 32 possible still isolated eigenvalues h 22 applying procedure used isolate eigenvalues h h 22 transform h 22 form 32 process repeated isolated eigenvalues found accumulating permutations symplectic permutation matrix p form 31 results similarity transformation 0 0 gps gps jj upper triangular either hamiltonian submatrix tt g tt isolated eigenvalues define p partition h 310 32 first step proof lemma 31 performed obtain form 37 blockstructure upper left lower right diagonal blocks 37 complicated still possible bring upper triangular form using repeatedly sequence permutations used proof lemma 31 shows 2p q eigenvalues hamiltonian matrix read directly 310 h permutationally similar to4 z h tt eigenvalues required continue working h tt also eigenvectors andor invariant subspaces required similarity transformations used solve reducedorder eigenproblem h tt applied whole matrix h case h transformed form given 39 partitioning h 310 32 perform first step proof lemma 33 jpermutation matrix p 1 subsequent steps achieve upper triangular form first p q rows columns performed first distinguishing cases q procedure transform hamiltonian matrix h form 310 given following algorithm note given algorithm algorithm 34 input matrices g q 2 r nthetan defining hamiltonian output symplectic permutation matrix p matrices g q defining hamiltonian matrix form end end end end end end execution outer whileloop first search row isolating eigenvalue row found look column isolating eigenvalue fashion guaranteed end isolated eigenvalues although always touch first n rows columns hamiltonian matrix actual implementation one would course never form permutation matrices explicitly store relevant information integer vector multiplications permutation matrices realized swapping data contained rows columns permuted details see eg 3 rather difficult give complete account cost algorithm 34 isolated eigenvalues algorithm requires 4n floating point additions 2n comparisons opposed 8n additions 4n comparisons unstructured permutation procedure 25 implemented lapack subroutine xgebal 3 applied h 2 r 2ntheta2n worst case algorithm 34 would execution outer whileloop isolated eigenvalue found last execution second inner whileloop case cost consists 4n 3 3 floating point additions moving floating point numbers worstcase analysis eigenvalues isolated permuting nothing left hamiltonian matrix hamiltonian schur form worstcase study xgebal shows permutation part requires 8n 3 moving floating point numbers therefore conclude algorithm 34 half expensive procedure proposed 25 applied hamiltonian matrix 4 symplectic scaling suppose transformed hamiltonian matrix form 310 since subsequent transformations determined h tt scaling parameters balance h tt chosen rows columns h tt instead close norm possible order simplify notation sequel call hamiltonian matrix h let h offdiagonal part h ie may without loss generality assume none rows columns h vanishes identically otherwise could isolate another pair eigenvalues want scale h norms rows columns close norm noted employing technique parlett reinsch 25 destroys hamiltonian structure diagonal scaling thus performed using symplectic diagonal matrix matrix must form 2 r nthetan nonsingular diagonal matrix let us first note obvious result hamiltonian matrices sequel use colon notation see eg 15 h k hj indicate kth column jth row respectively matrix h lemma 41 let h 2 r 2ntheta2n hamiltonian matrix p 1 ie pnorms ith column equals norm n ith row norm ith row equals norm n proof result obvious noting kxk x 2 r 2n observing structure hamiltonian matrices furthermore equation 43 follows analogously noting conclude sufficient equilibrate norms first rows columns 2n theta 2n hamiltonian matrix using consequence lemma 41 corollary 42 let h 2 r 2ntheta2n hamiltonian matrix p 1 since similarity transformation diagonal matrix affect diagonal elements transformed matrix following sufficient consider h employ notation ith column h transpose ith row h sequel convenience use 1 results also hold pnorm computational point view also reasonable use 1norm since computation involve floating point multiplications furthermore reducing norm h one norm usually implies also reduction norms equilibrating achieved similar way parlettreinsch method fi denotes base floating point arithmetic oe signed integer compute fi oe closest real scalar thus h general longer hamiltonian unfortunately using symplectic diagonal matrix computing obtain thus general k nevertheless equilibrating 1norms h h achieved requiring solving resulting quartic equation jg ii j remains show equation 46 positive solution theorem 43 let h 2 r 2ntheta2n hamiltonian matrix denote offdiagonal part h assume none rows columns h vanishes identically exists unique real number h 44 proof solutions equation 46 nonzero solutions k0 k k recalling g ii coefficients polynomial p satisfy since one change sign coefficients polynomial p descartes rule signs shows one positive zero p exists positive solution 46 unique assumption kh therefore either ii part h either 3 0 4 0 q ii part h thus know p polynomial degree least 3 positive leading coefficient hence lim t1 hand using mean value theorem follows exists positive zero p g ii 0 zero p third order polynomial positive zero mean value theorem least one positive zero hence equation 46 least one positive real solution regardless value g ii hand already observed one solution conclude exists unique solving equation 46 whence k h equalities follow immediately corollary 42 computing exact value equilibrating ith nith rows columns would require solution fourthorder equation 46 since diagonal similarity transformations chosen set machine numbers sufficient find machine number fi oe closest ffi done similarly computation general case proposed 25 implemented fortran 77 subroutines balanc eispack 14 successor xgebal lapack 3 starting quantities 45 evaluated compared k h repeated use achieved following algorithm algorithm 44 input hamiltonian matrix h 2 h 2n isolated eigenvalues base floating point arithmetic output diagonal matrix 2 2n h overwritten gamma1 row column norms equilibrated far possible r end r end end diag diag diag end one execution outer forloop algorithm 44 considered sweep algorithm terminated whole sweep usually row column norms approximately equal sweeps afterwards iteration makes limited progress therefore parlett reinsch propose 25 modification translated problem becomes let ffi determined two inner whileloops algorithm 44 compute jg ii j fl given positive constant compute algorithm 44 otherwise set behavior essentially algorithm 44 cases algorithm 44 increases kh happen 1 slightly smaller one step skipped would produce insubstantial reduction kh actual computation similarity transformations applied directly blocks g q hamiltonian matrix without forming hamiltonian matrix thus similarity transformation performed using 4n gamma 4 multiplications standard structure preserving scaling procedure 25 applied h similarity transformation requires multiplications recall algorithm 44 two rows columns equilibrated time one row column treated step inner forloop standard procedure number sweeps required converge similar general case since theory derived 25 requires assumption similarity transformations diagonal matrices step sweep ith rows columns equilibrated far possible accomplished algorithm 44 moreover ffi taken exact solution 46 convergence sequence similarity transformations stationary point proved 23 16 solution 46 sweep k lim k1 ffi k hence limit h balanced hamiltonian matrix note sweep length n standard balancing algorithm one go rowcolumn pair matrix thus sweep length 2n thus computational cost scaling 2n theta 2n hamiltonian matrix algorithm 44 assuming k 1 sweeps required 4n n opposed 8n 2 n standard scaling procedure given 25 assumed sweeps required convergence general k 1 k 2 structurepreserving scaling strategy half expensive standard procedure flop counts based assumption cost determining considered small o1 compared similarity transformations remark 45 17 proposed solve matrix balancing problem using convex programming approach compare complexity approach algorithm 44 suppose algorithm 44 terminates k 1 sweeps matrix h balanced let ng theta ng eg assume e theorem 5 17 states complexity computing diagonal matrix positive diagonal entries rows columns gamma1 hy balanced accuracy achieved algorithm 44 ne hmin numerical experience assumed respect n hence algorithm 44 considered complexity 2 complexity clearly superior convex programming approach still case k algorithm 44 requires careful implementation guard underflow due largesmall ffi use bounds discussed 25 implemented lapack subroutine xgebal 3 take account step scale fi sigma2 rather fi xgebal 5 backtransformation ordering eigenvalues applications far considered problem computing eigenvalues hamiltonian matrix order compute eigenvectors invariant subspaces solutions algebraic riccati equations transform hamiltonian matrix real schur form considering structurepreserving methods goal transform hamiltonian matrix real hamiltonian schur form given theorem 26 exists assume applied algorithm 34 hamiltonian matrix obtained symplectic permutation matrix p p hp form given 310 applied jpermutation p j permuted hamiltonian matrix rows columns numbered hamiltonian schur form ie p form given 39 lemma 33 know p j exists next applied algorithm 44 hamiltonian submatrix h tt 2 h 2r 311 obtained diagonal matrix diag 22 g g 22 t3 11 2 r pqthetapq upper triangular hamiltonian submatrix h 22 a22 q22 g22 isolated eigenvalues rows columns equilibrated algorithm 44 assume hamiltonian schur form h 22 exists computed u u22 v22 v22 u22 us 2r transforms h 22 real hamiltonian schur form set 22 real hamiltonian quasitriangular first n columns span lagrangian hinvariant subspace applications cstable hinvariant subspace desired let us assume method used transform h 22 hamiltonian schur form chooses u 22 first r columns u 22 ie columns u22 v22 span h 22 invariant subspace choice guarantee isolated eigenvalues 11 desired ones case reorder hamiltonian schur form order move undesired eigenvalues lower right block h desired ones upper left block assume want compute lagrangian hinvariant subspace corresponding set ae oe h closed complex conjugation note necessary condition order obtain lagrangian invariant subspace 2 using standard reordering algorithm real schur form n theta n unsymmetric matrix given 15 30 find orthogonal matrix u orthogonal symplectic matrix u diag u u 11 12 g 11 22 g g 22 t3 11 22 quasiupper triangular 22 therefore swap eigenvalues 22 gamma 22 note eigenvalues reordered among isolated eigenvalues hence real implies 22 upper triangular reordering achieved analogously reordering eigenvalues real schur form given 15 30 following procedure uses standard reordering order swap eigenvalues within 22 22 requires rotations working exclusively rows columns n 2n order exchange eigenvalues 22 eigenvalues gamma 22 assume 22 22 sn gammas n cn givens rotation matrix annihilates second component gnn u n symplectic givens rotation matrix acting planes n 2n 11 12 1n g 11 22 g g 22 gnn 22 0 bar indicates elements changed similarity transformation next step move n upper diagonal block using standard ordering subroutine obtain form given 51 11 2 r ngammak1thetangammak1 relations 52 hold procedure repeated 11 remark 51 hamiltonian matrix form h corresponds linear system stabilizable c detectable isolated eigenvalue 51 given diagonal elements 11 negative real part otherwise eigenvalues unstable undetectable stabilizeddetected therefore mixed blocks jpermutation matrix p j ie algorithm 34 n cstable hinvariant subspace required reordering necessary remark 52 solving algebraic riccati equations using approach based hamiltonian eigenproblem symplectic balancing strategy proposed often enough minimize errors caused illscaling due effect balanced hamiltonian matrix h g still may kqk ae kgk may cause large errors computing invariant subspaces 27 therefore another symplectic scaling using similarity transformation diag ae n ae 2 r applied h order achieve kak kgk kqk far possible see 4 details discussion several heuristic strategies achieve remark 53 everything derived far hamiltonian matrices applied way skewhamiltonian matrices n 2 sh 2n h g skewhamiltonian structure preserved symplectic similarity transformations hence isolating eigenvalues reordering etc achieved way hamiltonian matrices considered transformations depend signs matrix blocks g q distinction zerononzero isolating eigenvalues absolute values entries equilibrating rows norms note algorithm 44 even simplifies quite lot real skewhamiltonian matrices q computed general balancing algorithm nonsymmetric matrices 45 obtain k eigenvalues skewhamiltonian matrices well skewhamiltonian schur form computed numerically strong backward stable way van loans method 31 advisable balance skewhamiltonian matrices using proposed strategies prior applying algorithm remark 54 considered far real hamiltonian skew hamiltonian matrices isolating eigenvalues equilibrating rows columns complex skewhamiltonian matrices achieved exactly way structurepreserving numerically backward stable hence numerically strong backward stable method solving complex skewhamiltonian eigenproblem recently proposed 8 proposed symplectic balancing method also used prior applying algorithm 6 numerical examples tested symplectic balancing strategy eigenvalue computations computations done matlab 1 version 52 machine precision 22204 theta 10 gamma16 algorithms 34 44 implemented matlab functions used modified algorithm suggested 48 set suggested 25 implemented lapack subroutine xgebal 3 eigenvalues balanced unbalanced hamiltonian matrix 1 matlab trademark mathworks inc computed squarereduced method using matlab function sqred implements explicit version squarereduced method see 31 also tested effects symplectic balancing numerically backward stable structurepreserving method hamiltonian eigenvalue problem presented 7 like squarereduced method algorithm uses square hamiltonian matrix avoids forming square explicitly using symplectic urvtype decomposition hamiltonian matrix reference values used eigenvalues computed unsymmetric qr algorithm parlettreinsch balancing implemented lapack expert driver routine dgeevx 3 applied hamiltonian matrix using quadruple precision moreover tested effects balancing solving algebraic riccati equations structurepreserving multishift method presented 1 examples benchmark collection 6 present intriguing results example 61 6 example 6 system data come optimal control problem j100 jet engine special case multivariable servomechanism problem resulting hamiltonian matrix h 2 r 60theta60 8 isolated eigenvalues triple eigenvalues sigma200 simple eigenvalues sigma333 algorithm 34 returns permuted hamiltonian matrix hn1ni l gamma1n1ni l next hamiltonian submatrix scaled using algorithm 44 six sweeps obtain balanced hamiltonian decreased 2norm matrix used subsequent eigenvalue computation five orders magnitude eigenvalues computed square reduced method applied unbalanced hamiltonian matrix triplet isolated eigenvalues returned pair conjugate complex eigenvalues relative errors gamma11 simple eigenvalue relative error 396 theta 10 gamma11 simple eigenvalue 333 relative error 77 theta 10 gamma15 balanced version eigenvalues returned full accuracy since affected roundoff errors relative errors isolated eigenvalues given figure 61 use relative distance computed eigenvalues computed dgeevx estimate real relative error figure 61 contains relative errors eigenvalues positive real parts sqred returns eigenvalues exact plusminus pairs 26th eigenvalue missing computed relative error balanced version zero respect machine precision eigenvalues ordered increasing absolute values figure 61 increasing accuracy decreasing ratio khk 2 jj obvious without balancing computed eigenvalues balanced matrix accurate unbalanced one increase accuracy significant eigenvalues smaller magnitude reflects decrease ratios khk 2 jj less determines accuracy computed eigenvalues see 31 decrease factor khk 2 5 theta 10 gamma6 accuracy eigenvalues smaller magnitude increases almost factor figure 62 see symplectic balancing also improves eigenvalues computed method proposed 7 method suffer perturbation accuracy computed eigenvalues similar also note unbalanced version isolated eigenvalues computed relative accuracy ranging 70 theta 10 gamma14 12 theta 10 gamma15 eigenvalue number relative errors symplectic balancing without balancing fig 61 squarereduced method eigenvalue number relative errors symplectic balancing without balancing fig 62 symplectic urv using balanced matrix order solve algebraic riccati equations multishift method described 1 obtain following results multishift method applied unbalanced data computed solution yields residual size 15 theta 10 gamma6 using balanced hamiltonian matrix get r shows numerical methods solving algebraic riccati equations substantially improved employing balancing example 62 6 example 13 hamiltonian matrix defined 11 diag 1 0 denotes fourth unit vector four sweeps algorithm 44 khk 2 reduced 10 12 15 theta 10 6 accuracy computed eigenvalues improve significantly stabilizing solution algebraic riccati equation frobenius norm residual defined 61 dropped r 7 concluding remarks seen isolated eigenvalues real hamiltonian matrix deflated using similarity transformations symplectic permutation matrices deflated problem scaled order reduce norm deflated hamiltonian matrix equilibrate row column norms remaining isolated eigenvalues determined computing eigenvalues deflated balanced hamiltonian submatrix invariant subspaces required use jpermutation matrices symplectic reordering strategy order obtain desired invariant subspaces method applied order balance skewhamiltonian complex skewhamiltonian matrices numerical examples demonstrate symplectic balancing significantly improve accuracy eigenvalues hamiltonian matrices well accuracy solutions associated algebraic riccati equations computed structurepreserving methods final remark acknowledgments work presented article continues preliminary results derived 4 author would like thank ralph byers heike fabender volker mehrmann helpful suggestions r multishift algorithm numerical solution algebraic riccati equations contributions numerical solution algebraic riccati equations related eigenvalue problems collection benchmark examples numerical solution algebraic riccati equations continuoustime case structure preserving method computing eigenvalues real hamiltonian symplectic pencils bisection method computing h1 norm transfer matrix related problems fast algorithm compute h1norm transfer function matrix matrix factorization symplectic qrlike methods matrix eigensystem routines eispack guide extension matrix computations matrix balancing complexity matrix balancing algebraic riccati equation invariant subspace methods numerical solution riccati equations canonical forms hamiltonian symplectic matrices pencils autonomous linear quadratic control problem solution large matrix equations occur response theory schur decomposition hamiltonian matrices balancing matrix calculation eigenvalues eigenvec tors computational methods linear control systems solving continuoustime matrix algebraic riccati equations condition accuracy estimates algorithms linearquadratic optimization fast algorithm compute real structured stability radius algorithm 506hqr3 exchng fortran subroutines calculating ordering eigenvalues real upper hessenberg matrix symplectic method approximating eigenvalues hamiltonian matrix tr ctr peter benner daniel kressner volker mehrmann structure preservation challenge computational control future generation computer systems v19 n7 p12431252 october pierluigi amodio computation eigenvalues positive definite hamiltonian matrices future generation computer systems v22 n4 p403411 march 2006 peter benner daniel kressner algorithm 854 fortran 77 subroutines computing eigenvalues hamiltonian matrices ii acm transactions mathematical software toms v32 n2 p352373 june 2006