procrustes problem orthogonal stiefel matrices paper consider procrustes problem manifold orthogonal stiefel matrices given matrices cal bbb rmtimes k cal bin bbb rmtimes p mge p ge k seek minimum cal acal bq2 matrices qin bbb rptimes k qtqiktimes k introduce class relaxation methods generating sequences approximations minimizer offer geometric interpretation methods results numerical experiments illustrating convergence methods given b introduction begin defining set ostp k orthogonal stiefel matrices compact submanifold dimension manifold op p theta p orthogonal matrices dimension 1 trace 2 denote standard frobenius norm r mthetak procrustes problem orthogonal stiefel matrices minimize q 2 ostp k problem 12 simplified performing singular value decomposition matrix b 2 r mthetap let due fact last rows zeros simplify 13 introducing new notations denote assuming oe 2 r pthetak matrix composed first p rows consequently procrustes minimization set orthogonal stiefel matrices given 2 r pthetak diagonal sigma 2 r pthetap minimize q 2 ostp k w bojanczyk lutoborski original formulations procrustes problem found 1 2 may write 14 explicitly procrustes problem solved analytically orthogonal case see 8 case q 2 op provided singular value decomposition sigmaa minimizer 16 functional pa sigma 15 sum two functionals q bilinear functional traceq sigma 2 q linear functional gamma2traceq sigmaa well known minimize functionals separately minimum value bilinear functional equal sum squares k smallest diagonal entries sigma result due ky fan 9 linear functional minimized traceq sigmaa maximized maximum trace given sum singular values matrix sigma upper bound trace functional established jvon neumann 13 see also 8 separate minimization quadratic linear part well understood since know analytical solutions robust numerical methods analytical solution orthogonal procrustes problem stiefel matrices known best knowledge constitutes major challenge useful interpret minimization 14 geometrically define eccentric stiefel manifold ostsigmap eccentric stiefel manifold ostsigmap k image orthogonal stiefel manifold ostp linear mapping q gamma sigmaq image sphere kg radius k r pthetak mapping ellipsoid r pthetak ostsigmap k subset eccentric stiefel manifold compact set contained larger ball r pthetak centered 0 radius note ostsigmap 1 standard ellipsoid r ostip therefore min point sigmaq projection onto eccentric stiefel manifold ostsigmap k due compactness manifold projection sigmaq exists big difficulty face task computing minimizer q fact manifold ostsigmap k convex set procrustes problem stiefel matrices 3 2 notations elementary plane rotation angle oe represented sin oe cos oe elementary plane reflection line slope tan oe cos oe sin oe sin introduce following submatrices consists mth row q consists nth rows q consists rows complementary q mn consists entries intersections mth nth rows columns q plane rotation angle oe k lplane r p represented matrix g kl oe g kl oe kl plane reflection r kl oe k lplane defined similarily means roe j kl p set plane rotations reflections k lplane j p set plane rotations reflections planes clearly j kl p ae j p ae op 3 relaxation methods procrustes problem stiefel manifold ostp k admissible set minimizer functional p 14 manifold however vector space poses severe restrictions succesive approximations obtained previous ones additive corrections admissible stiefel manifold closed respect left multiplication orthogonal matrix r 2 op thus rq q 2 ostp k admissible approximation consequently restrict considerations class minimization methods construct approximations q minimizer q rule q respectively current next approximations minimizer follows consider relaxation minimization methods seek minimizer functional p according 31 dimension manifold ostp k r 2 op depends single parameter whose value results scalar minimization problem refer left multiplication r 31 sweep relaxation method consists repeated applications sweeps produce minimizing sequence problem 14 4 w bojanczyk lutoborski choose matrices r orthogonally similar plane rotation reflection different choices similarities lead different relaxation methods set define may depend current approximation choice p fully determines relaxation method 313334 selection parameter ff 34 result scalar minimization ff matrix r viewed plane rotation reflection plane spanned pair columns matrix p indices r pair columns selected according ordering n set pairs ordering bijection oe inclusion guarantees contains least distinct pairs necessary construct arbitrary q 2 ostp k product matrices r clear relaxation methods satisfying 35 always produce nonincreasing sequence values pa sigmaq pthetap 34 r sweep 31 following particularly simple form relaxation method defined 36 refered leftsided relaxation method lsrm orthogonal complement q hence kthetak thus induction sweep 31 form kthetak relaxation method defined 37 refered rightsided relaxation method rsrm specific type rightsided relaxation method investigated h park 11 method 11 based concepts discussed earlier ten berge knol 2 procrustes problem orthogonal stiefel matrices called unbalanced problem solved means iteratively solving sequence orthogonal procrustes problems called balanced problems relaxation approach new leftsided relaxation method topic paper procrustes problem stiefel matrices 5 another interesting aspect approach clear geometric interpretation relaxation step study minimization methods submanifolds spaces matrices see 10 12 4 planar procrustes problem present leftsided relaxation method without loss generality let us assume planes r transformations operate chosen row cyclic order way analogous used cyclic jacobi method svd computation see 5 case n given n q 36 following form r j rs 2 j rs p let q rs current approximation sweep next approximation minimizer q selection parameter ff results scalar minimization main goal show find ff 42 consider functional j gamma 42 simplicity notation omitted indices without loss generality assume n diag gff plane rotation case reflection similar treated completely analogous way minimization 42 precisely minimization 11 12 delta delta delta 1k 21 22 delta delta delta 2k gff let uq gammav q svd decomposition q 12 note last columns matrix b 44 always approximated zero columns thus minimization fff equivalent minimization restricted first two columns c gammas 6 w bojanczyk lutoborski angle plane rotation reflection uq may write 45 explicitly denote completing squares may represent f oe following form sin oe thus minimization functional 49 equivalent following problem given c 2 r 2theta1 diagonal z 2 r 2theta2 minimize q 2 ost2 1 minimization problem type 410 called planar procrustes problem problem solved step relaxation method geometrically equivalent projecting c onto ellipse next section consider two different iterative methods finding projection 5 projection ellipse geometrical formulation planar procrustes problem 410 simple given point c ellipse ae oe r 2 want find point projection c onto e achieved variety ways describe classical projection point onto ellipse due appolonius leading scalar fourth order algebraic equation method iterated reflections based reflection property ellipse procrustes problem stiefel matrices 7 51 hyperbola appolonius recall construction normal ellipse point see 14 due appolonius given ellipse e 51 point c associate hyperbola h following way equation normal ellipse z z clearly cs normal e iff point equivalently cs normal e iff point satisfies z 53 quadratic x 1 x 2 equation hyperbola h written center h coordinates f figure 1 hyperbola appolonius hyperbola h asymptotes parallel axes ellipse passes origin point c h degenerates line point c one axes ellipse nongeneric trivial case analyzed h also characterized locus centers conics pencil generated ellipse arbitrary circle centered c find coordinates projection point intersect hyperbola appolonius ellipse solve system two quadratic equations 51 54 using 54 eliminate x 2 51 obtain fourth 8 w bojanczyk lutoborski order polynomial equation x 1 specific numerical values coefficients equation easily solved symbolically simpler purely numerical alternative solve system using newtons method another alternative reduce system scalar equation assume first quadrant projection setting sin oe 53 next substituting leads equation easy see since function gt convex one positive root also seen gt method starting initial approximation generate decreasing convergent sequence approximations root 52 iterated reflections assume c first quadrant fig2 every case reduces one reflections let procrustes problem stiefel matrices 9 f r figure 2 iterated reflections reflection property e says c inside outside e characterized let figure 2 given sin c outside tan oe cos case c inside e coordinates points l r computed similarly analogously bisection method compute intermediate point l r l r setting oe h delta delta denotes inner product oe r oe oe set l oe hold set l thus construct sequence flng ae e lim n1 53 remarks general planar procrustes problems planar procrustes problem several features general problem 14 projection onto eccentric stiefel manifold posses ffl e reflection properties appolonius normal reflection properties ellipse extend eccentric stiefel manifold particular even ellipsoids r p construction appolonius normal ellipse based orthogonality ellipse w bojanczyk lutoborski associated hyperbola results scalar equation 56 also particular planar problem result case p k 1 relaxation step amounts solving planar procrustes problem cannot directly generalized higher dimensional problem ffl point belonging e either unique projection onto e finite number projections hence conve exits unique projection c onto e characterized f 2 conve point c inside ellipse e nonunique projection c major axis points b gammab various locations c projections shown fig 3 along upper part evolute ellipse locus centers curvature e number normals 23 4 drawn c depends position c relative evolute f figure 3 points first quadrant projections ellipse nonuniqueness c segment gammab b reflected non differentiability function shown fig 4 general solutions procrustes problem may form submanifold stiefel manifold finally observe e cuts plane two components however procrustes problem stiefel matrices 11 c sphere radius 2 r 3theta2 containing stiefel manifold osti3 2 point kc k 2 rcannot connected 0 segment intersecting ost3 2 figure 4 graph observations concerning analytical problem reflected computations computational implications 6 geometric interpretation left right relaxation methods since notion standard ellipsoid ostsigmap 1 r p intuitive interpret minimization problem 111 treating matrices r pthetak ktuples vecors r p let given ktuple vectors r p current approximation minimizer clearly points sigmaq belong ellipsoid ostsigmap 1 thus minimization pa sigmaq interpreted finding points sigmaq ellipsoid q orthonormal vectors best match measured pa sigmaq given vectors r p relaxation method described section 3 interpreted follows pick orthonormal basis r p next sweep rotate current set vectors q frame planes spanned pairs vectors current basis leftsided relaxation method basis cannonical basis sweeps relaxation steps exactly amount solving planar procrustes problem rightsided relaxation method basis consists two subsets changes sweep sweep first subset basis consists columns current approximation q second subset consists columns orthogonal complement q q working columns q equivalent socalled balanced procrustes problem studied park 11 solved means w bojanczyk lutoborski svd computation relaxation step 11 balanced problem consists computing svd 2 theta 2 matrix sigmaq r relaxation setting relaxation step rightsided relaxation method requires solving scalar minimization problem 35 min leads linear equation tangent ff equivalent 2 theta 2 svd computation 11 2 theta 2 steps rotation vectors sigmaq r sigmaq plane spanned q r q rotated vectors ellipsoid best approximate two given vectors r however columns q span whole space r p might happen k g hence might possible generate sequence approximations converge q order overcome problem matrix q extended orthogonal complement subproblems 11 involving vectors subsets referred 11 unbalanced subproblems scalar minimizations following min c unbalanced subproblem find vector ellipsoid plane spanned q r q closest given vector r intersection plane ellipsoid ellipse unbalanced subproblem expressed planar procrustes problem 410 algorithms discussed section 5 used solve unbalanced problem choices bases may possible choices leading left right sidedrelaxation methods seem natural 7 numerical experiments section present numerical experiments illustrating behavior left right relaxation methods discussed section 3 start summarizing left right relaxation methods given pseudocodes given 2 r pthetak construct sequences stiefel matrices approximating minimizer 14 algorithm lsrm 1 initialization set maxstep 2 iterate sweeps r threshold n maxstep solve planar procrustes problem procrustes problem stiefel matrices 13algorithm rsrm 1 initialization set maxstep 2 iterate sweeps r threshold n maxstep solve min ff solve planar procrustes problem measure cost two methods number sweeps performed two methods sweep lsrm method consists pp12 planar procrustes problems planar procrustes problem requires computation svd 2 theta k matrix achieved first computing qr decomposition followed 2 theta 2 svd problem svd calculated projection ellipse determined cost sweep approximately okp 2 floating point operations sweep rsrm method consists kk computations p theta 2 svd problems adition kp gamma procrustes problems requiring computation svd p theta 2 matrix followed computation projection ellipse thus cost sweep approximately okp 2 floating point operations surely precise cost sweep depend number iterations needed obtaining satisfactory projections resulting ellipses projection depend location point projected well shape ellipse computation projection costly ellipse flat seen sweeps two methods may different costs however number sweeps performend methods give bases comparing convergence behavior two methods begin illustrating behavior lsrm method finding q procrustes problem initial approximation 4theta2 intermediate values q listed table 1 14 w bojanczyk lutoborski table 1 matrices q minimizing sequence generated lsrm present comperative numerical results lsrm rsmr methods recall functional p sum linear bilinear term consider classes examples functional approximated linear bilinear term first class examples linear term dominates bilinear term words jjajj jjsigmajj deal perturbed linear functional minimum functional p approximated sum singular values sigma second class examples consists cases quadratic term dominates linear term jjajj jjsigmajj deal perturbed bilinear functional minimum value functional p approximated sum k smallest singular values sigma third class exampless consists cases functional quadratic sigmaq q 2 ostp k minimum functional close zero procrustes problem stiefel matrices 15 class examples pick two different matrices sigma one corresponding ellipsoid almost sphere sigma corresponding ellipsoid flat one planes oe 1 large algorithms written matlab 42 run hp9000 workstation machine relative precision initial approximation took pthetak lsrm pthetap rsrm planar procrustes solver used based hyperbola appolonius iterated reflections solver giving numerically equivalent results representative results shown tables 26 rsrm lsrm 6 table 2 2 rsrm lsrm 6 table 3 table 2 illustrates behavior two methods ellipsoid almost sphere exists q bilinear linear terms comparable size experiments suggest lsrm requires less sweeps obtain satisfactory approximation minimizer table 3 illustrates behavior two methods length half ellipsoids axes approximately 10 half approximately 001 w bojanczyk lutoborski addition exists q case convergance rsrm particularly slow observed least initially rsrm fails locate minimizer ost4 2 unable establish proper signs entries matrix q lsrm hand approximates minimizer correctly rsrm lsrm 6 table 4 2 rsrm lsrm 28 143e02 316e01 000e00 table 5 2 table 4 illustrates behavior two methods ellipsoid almost sphere chosen bilinear term dominates linear term case minimum functional estimated minimum value bilinear term table 4 esterror denotes difference minimum value bilinear term computed value functional qk q q last penultimate approximations minimizer experiments suggest lsrm requires less sweeps obtain satisfactory approximation minimizer procrustes problem stiefel matrices 17 table 5 illustrates behavior two methods ellipsoid almost sphere chosen linear term dominates quadratic terms case minimum functional estimated minimum value linear term table 5 esterror denotes difference minimum value linear term computed value functional experiments suggest rsrm requires less sweeps obtain satisfactory approximation minimizer 8 remarks constrained linear least squares problems quadratically constrained linear least squares problem min arises many applications 6 7 3 changing variables problem transformed special procrustes problem procrustes problem min procrustes problem equivalent projecting point onto ellipsoid ostsigmap 1 1 clear vector direction normal vector ellipsoid point sigmaq thus sigmaq projection ellipsoid vector gamma sigmaq parallel vector n thus exists scalar fi obtain equation fi parameter fi computed solving equation components q given equation 84 socalled secular equation characterizes critical points lagrangian see 8 thus multiplier fi 83 lagrange multiplier 85 r algorithms regularization illconditioned least squares problems stationary values seconddegree polynomial unit sphere cyclic jacobi method computing principal values complex matrix least squares quadratic constraint quadratically constrained least squares quadratic problems matrix computations johns hopkins theorem weyl concerning eigenvalues linear transformations convergence eulerjacobi method parallel algorithm unbalanced orthogonal procrustes problem optimization techniques riemannian manifolds matrix inequalities metrization matrix space enzyklopadie der elementar mathematik b tr