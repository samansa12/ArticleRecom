solutions affine generalized equations using proximal mappings normal map proven powerful tool solving generalized equations form find z 949 c 0 949 fz convex set ncz normal cone c z paper use tmap generalization normal map solve equations general form find z 949 domt 0 949 fz present pathfollowing algorithm determines zeros coherently oriented piecewiseaffine functions use algorithm together tmap solve generalized equation affine coherently oriented functions f polyhedral multifunctions pathfollowing algorithm develop extends piecewiselinear homotopy framework eaves case representation subdivided manifold unknown b introduction paper concerned solving generalized equations 20 21 form maximal monotone multifunction ir n ir n f continuously differentiable function open setomega oe domt ir n recall monotone multifunction point set mapping graph hdelta deltai denotes inner product maximal graph properly contained monotone multifunction domt represents effective domain date algorithmic development generalized equations focused special case nc normal cone convex set c defined case yields generalized equation material based research supported national science foundation grant ccr9157632 air force office scientific research grant f496209410036 department energy grant defg0394er61915 mathematics department university colorado denver colorado 80217 z computer sciences department university wisconsin madison wisconsin 53706 many problems mathematical programming equilibrium complementarity fields expressed form example f rf 2 represents first order necessary optimality conditions problem minimize fx subject x 2 c another important instance 2 variational inequality problem find z 2 c problem known equivalent 2 see 21 final example mention complementarity problem wealth applications appears variety forms 13 standard nonlinear complementarity problem find well known 13 15 complementarity problems reformulated variational inequal ities therefore treated context generalized equation 2 prominent tool solving 2 normal map 8 22 26 normal map fc function f nonempty closed convex set c oeomega defined c x denotes projection respect euclidean norm x onto set c importance normal map lies fact solving 2 equivalent finding zero normal map fc specifically x zero normal map z c x solves 2 conversely z solution 2 x z gamma f z zero normal map thus problem solving generalized equation 2 expressed setvalued functions reduced finding zero piecewise smooth singlevalued function several algorithms developed based idea algorithms based theory piecewise linear homotopies given eaves 9 specialization general algorithm given 9 determines zero normal map tracing zero curve piecewise linear homotopy mapping shown 12 lemkes famous method 16 solving linear complementarity problems conceptually equivalent path following corresponding piecewise linear system idea easily extended general algorithms 10 11 based eaves work cao ferris 3 analyzed algorithm solving affine ie f x affine variational inequality problems polyhedral sets showed lemkes method processed matrices class pc 2 nonaffine problems c rectangular ralph 18 proposed newtonbased algorithm iteration newton point calculated solving affine variational inequality avi linearization normal map equation current point approach developed computationally dirkse ferris 5 6 7 produce path efficient robust code solving mixed complementarity problems similar approach developed rutherford 24 paper begin generalize class algorithms removing restriction normal cone convex set first step paper focus solving affine generalized equation f affine function polyhedral graph union finitely many convex polyhedrons strategy essence generalization avi algorithm cao ferris use generalization normal map reformulate 1 zero finding problem piecewise affine function use piecewiselinear homotopy framework eaves 9 generate algorithm determining zeros piecewiseaffine functions describe algorithm detail section 2 prove assumption coherent orientation algorithm finds zero finite number steps remainder paper describes algorithm used solve affine generalized equations section 3 discuss generalization normal map called tmap mapping knowledge introduced minty 17 provides means reformulating generalized equations involving operators necessarily correspond normal cone set describing reformulation focus case polyhedral case viewed extension special case nc c convex polyhedron section 4 describe algorithm presented section 2 used solve affine generalized equations section 5 specialize case separable finally section 6 discuss algorithm applied solve piecewise linearquadratic programming problems 25 words notation needed notation point set mapping multifunction maps points ir n subsets ir n discussing multi functions may refer either point set mapping delta graph mapping set fx j 2 xg expression gamma1 delta defined set inverse ie tg effective domain defined domt fxjt x 6 g discussing matrices vectors subscripts used refer components example refer ith row jth column jth entry respectively may also use index sets refer specific components example g use matlab notation comma separate columns semicolon separate rows example x row vector whereas x column vector unless otherwise indicated vectors taken column vectors superscripts used indicate iteration count index label matrices vectors contrast scalars sets functions subscripts used labels set c affc intc ric recc dimc ffideltajc refer affine hull interior relative interior recession cone dimension indicator function c respectively see 23 definitions terms 2 algorithm finding zeros mpa maps first task describe algorithm finding zeros piecewise affine functions algorithm present viewed generalization lemkes method linear complementarity problem algorithm solving affine variational inequalities convex polyhedral sets described 3 theoretical basis algorithm derived theory piecewiselinear homotopies given 9 order describe algorithm carefully need preliminary definitions definition 21 cell polyhedral convex set oe ae ir n called cell oe called kcell let oe fxjax ag 2 ir pthetan 2 ir p p nonnegative integer p said represent oe p smallest number representation oe exists p called minimal representation oe set 2 ir n called face oe set indices ff ae g dim called iface oe cell minimal representation definition 22 piecewise affine let collection ncells let oe2m oe said piecewiseaffine respect denoted mpa ie restriction f oe affine f mpa satisfying assumptions say f piecewise affine note definition convex function f must continuous f must singlevalued boundaries cells furthermore contrast work eaves 9 required correspond subdivided manifold definition 23 function representation let collection ncells ir n let f mpa function let oe ncell let b oe 2 ir let b oe theta n matrix said represent f oe f describe algorithm find zero mpa function g given collection cells assume representations cells map g already constructed basis algorithm construct piecewise affine homotopy mapping f x following properties 1 zero f x zero g 2 point direction 1 gamma1 known 1 0 f 0 algorithm uses method described eaves 9 trace zero curve f proceeding direction 1 gamma1 starting point prove algorithm finds solution finite number steps restrict case g coherently oriented definition 24 coherent orientation let g mpa map representation b oe b oe oe 2 say g coherently oriented nonzero constant oe since finite oe2m recoe oe intrecoe 6 choose gammad 2 intrecoe x 0 ir n sufficiently large x avi algorithm described cao ferris cell oe direction constructed finding extreme point x e set c cell given oe x e nc x e direction chosen gammad interior nc x e algorithm rather constructing cell direction rely instead fact since ir direction cell oe gammad 2 recoe note cell oe boundary recoe n intrecoe recoe lebesgue measure zero therefore since number cells finite oe2m recoe n intrecoe measure zero thus almost cell oe gammad 2 intrecoe thus x 0 point ir n sufficiently large x lie interior cell oe words cell chosen simply picking arbitrary proceeding direction gammad cell oe reached gammad recession cone oe almost excepting set lebesgue measure zero gammad interior recoe note however special cases construction extreme point may still preferable oe identified homotopy map constructed let b b representation g oe define function f note f x exactly assumption g coherently oriented since gammad 2 intrecoe exists 0 0 w 2 intoe 8 0 thus 0 choosing see f satisfies conditions needed homotopy map ready state algorithm given figure 1 note normalizing discussion unit vector start algorithm point constructed oe 1 oe comments algorithm age order 1 work algorithm step 8 direction end section theorem 213 show b rank1 matrix thus efficient implementation algorithm obtained keeping matrices b k factored form performing rank1 updates factors step algorithm 2 step 8 algorithm may one possible choice cells oe k1 however lexicographic ordering described eaves 9 section 15 used resolve ambiguity concerning cell choose use lexicographic ordering assumed convergence proof presented detail discussion preceding lemma 29 3 requirement arbitrarily chosen force choice k1 unique 4 requirement x guarantees zero curve f x contains ray therefore assures us loops fact useful convergence proof however shall also show assumption coherent orientation v k always negative guarantees figure 1 algorithm age given finite collection ncells mpa function g ir n let g representation b repeat 0g outputray termination return else outputsolution found x k1 return else determine oe k1 possibly using lexicographic ordering k1 v k1 k1 points oe k1 x k1 oe loops occur thus assumption coherent orientation necessary find ray start however future work prove convergence broader class problems case ray start requirement useful next pages devoted proving following convergence theorem theorem 25 let finite collection ncells whose relative interiors disjoint whose union ir n let g coherently oriented mpa function algorithm age using lexicographic ordering terminates finitely many steps zero x g proof outline three main parts proof first lemma 29 show algorithm terminates solution subdivision ir n see definition 26 second lemma 211 show even subdivision ir n refinement see definition 210 n subdivision finally show lemma 212 subdivision n refinement running algorithm using n generate exactly path would generated using thus fact algorithm terminates solution using n guarantees terminate solution using prove three lemmas mentioned point recommend impatient reader skip ahead theorem 213 proof technique based work eaves 9 eaves analysis relies heavily notion subdivided manifold definition 26 subdivided manifold let n set euclidean space let n finite countable collection ncells space oe2n oe let n collection faces elements n n n subdivided nmanifold 1 two ncells n either disjoint meet common 2 point n neighborhood meeting finitely many ncells n 3 n gamma 1cell n lies two ncells n n subdivided nmanifold subdivision n call n nmanifold call n subdivision n following lemma shows definition 26 redundant result proved robinson 22 proof proposition 24 robinsons proposition stated normal manifold proof valid general subdivisions ir n lemma 27 n collection cells whose union ir n n satisfies 1 2 definition 26 n subdivision ir n next step analysis prove algorithm works whenever subdivision ir n case defining foe theta ir joe 2 mg see subdivision ir n theta ir f spa starting point algorithm lies interior cell ray fx lies within j 1 let collection faces elements algorithm age seen equivalent algorithm described eaves 9 section 102 following relationships algorithms eaves algorithm algorithm age discuss behavior algorithm detail need definitions 9 definition 28 regularity let n n subdivided n collection ncells npa map point x n said degenerate otherwise regular x lies cell oe n dimf oe n value f n said degenerate value otherwise regular value f gamma1 contains degenerate point note regular value f gamma1 cannot intersect kcells k n assumption coherent orientation g onetoone every ncell thus since starting point algorithm interior j 1 regular point f according 9 theorem 1513 since finite algorithm generates finitely many steps either point boundary ir n theta ir ray f gamma1 0 different starting ray first case know boundary ir n theta ir ir n theta f0g follows earlier remarks x satisfies therefore guarantee algorithm finds solution need show cannot produce ray different starting ray first consider case 0 regular value f case 9 theorem 91 f gamma1 0 1manifold subdivided sets form j cannot intersect kcells k n point f gamma1 0 two n 1cells thus step 8 algorithm choice oe k1 welldefined difficulty would lies one n oe k1 could selected case would boundary point ir n theta ir thus algorithm would terminated step 5 direction path within n let g representation ncell oe k 9 lemma 123 curve index given constant everywhere along path since v starting direction g coherently oriented follows v k negative cell path enters means parameter decreases strictly cell thus finitely many steps must 0 degenerate value f f gamma1 0 may intersect kcell k n thus step 8 algorithm may multiple choices cell oe k1 enter next address problem lexicographic ordering used resolve ambiguities concerning cell path enter scheme conceptually equivalent solving perturbed problem describe n1 theta n matrix x 1 rank n1 define vector note superscripts refer exponentiation define algorithm age interior j 1 small enough ffl since gammad starting conditions needed apply algorithm perturbed problem given pffl f invertible n theta n matrix 9 lemma 142 pffl regular value ffl sufficiently small thus arguments given regular values using algorithm age solve perturbed problem finite number steps j produce point x j ffl gx j sequence points generated algorithm perturbed prob lem discussion 9 section 15 sequence matrices x k 2 ir n1thetan sequence points ffl points exactly sequence points generated algorithm solving unperturbed problem using lexicographic ordering since algorithm terminates j steps small ffl see j follows gx j thus using lexicographic ordering algorithm finds solution finite number steps proved following lemma lemma 29 let subdivision ir n coherently oriented mpa function algorithm age using lexicographic ordering terminates finitely many steps zero x g address case subdivision ir n begin proving refined produce subdivision definition 210 refinement let n finite collections ncells n said refinement cell oe union finite collection cells n cell n contained cell following lemma proved hudson 14 lemma 15 however using different nomencla ture particular term subdivision used place term refinement lemma 211 let fc g collection j 1 ncells covers ir n exists subdivision n ir n n refinement show using n algorithm follows path would using lemma 212 let g mpa function finite collection relatively disjoint ncells whose union ir n let n refinement n subdivision ir n algorithm age using lexicographic ordering find solution x finite number steps furthermore sequence points generated algorithm using subsequence points would generated using n proof consider first running algorithm using n instead lemma 29 algorithm terminate finite number steps j algorithm visit sequence n cells f k g ae n generate sequence points fx k k g directions fd k v k g unique cell contains 1 smallest index greater j igamma1 j unique cell contains let k j process defines sequence cells show algorithm run using sequence points f generated algorithm satisfies equation thus algorithm finds solution finite number steps sequence directions chosen algorithm using clearly since algorithm started point direction 1 gamma1 following true first cell visited algorithm oe 1 proceed induction assume using ith cell visited algorithm oe shall prove 1st cell visited algorithm oe i1 representation g oe also representation g k whenever thus step 8 algorithm using n direction entering cell k1 must satisfy coherently oriented b invertible earlier discussion v k1 negative thus direction uniquely determined representation particular clear x j i1 lies ray f boundary oe ray f j 0g contains point interior oe ray cannot extended past x j i1 without exiting oe thus x g words ray f j 0g contain interior point oe must resort lexicographic ordering prove x j relatively disjoint convex sets exists separating hyperplane h defined vector c scalar ff suppose run algorithm using n solve perturbed problem g ffl x defined 6 small enough algorithm visit sequence cells f k g visits unperturbed problem also earlier discussion algorithm generate sequence points fixed sequence matrices since 0 regular value g ffl dimg ffl k k thus g gamma1 ffl 0 contains one point k namely x k1 therefore direction k1 must point interior k1 similar arguments x j i1 lies ray f since k1 points interior j ray must contain point x interior follows c thus even unperturbed problem ray cannot extended past point x without crossing hyperplane h thereby exiting oe thus x finally note small ffl point x j i1 ffl regular point j i1 gamma1 j i1 ncells n contain x j i1 ffl thus oe oe i1 ncells contain x j i1 ffl thus small ffl algorithm using enter cell oe i1 next iteration means using lexicographic ordering algorithm enter cell oe i1 next solving unperturbed problem finally since representation g oe i1 identical representation g j i1 must lemma proved induction completes proof theorem 25 final task section establish claim made comment 1 following algorithm age theorem 213 hypothesis theorem 25 let foe k g sequence cells chosen step 8 algorithm age using lexicographic ordering let b rank 1 proof using lexicographical ordering algorithm choose cell oe k1 step 8 would solving perturbed problem small ffl however 0 regular value perturbed problem k oe k must dimension n gamma 1 two points thus dim 3 tmap tmap denoted f generalization normal map formed replacing projection operator c 3 resolvent operator specifically tmap given assume throughout maximal monotone operator case minty 17 showed p continuous singlevalued nonexpansive function defined ir n since image p domt contained domain f omegagamma3 follows f singlevalued function defined ir n 1 example 212 monotone therefore p monotone show solving gef equivalent finding zero f theorem 31 given maximal monotone multifunction defined 7 x zero f z p x solves gef conversely z solves gef x z gamma f z zero f proof suppose f conversely suppose gammaf z 2 z let x z gamma f z x far made assumptions maximal monotone focus case polyhedral definition 32 polyhedral multifunction polyhedral graph union finitely many polyhedral convex sets first task show polyhedral resolvent operator piecewiseaffine map lemma 33 singlevalued multifunction whose graph convex polyhedron affine domt proof assume domt 6 otherwise lemma true vacuously since graph polyhedron written nonnegative integer let k fija tg words k set row indices corresponding constraint active points first establish fact ker b f0g let h fiji 62 kg cardinality index set h note x convex combination points therefore also idelta since singlevalued definition k x conversely suppose 9y x means implies f0g thus shown finally since ker b left inverse r 2 ir mthetap thus x 2 domt affine function domt theorem 34 given maximal monotone polyhedral multifunction resolvent operator affine function ir n proof since polyhedral also polyhedral 19 therefore p finite collection polyhedral convex sets let c projection gamma onto domain p ie c defined ir n closed complement nm ir n n open thus nm either empty set nonempty interior nm ae thus nm interior words show p mpa needed show c 2 restriction p c affine however since p singlevalued graph p restricted c simply convex polyhedral set gamma lemma 33 p affine c corollary 35 polyhedral f affine tmap f defined 7 piecewise affine 4 affine generalized equations show apply algorithm section 2 construct algorithm solve affine generalized equation 2 ir nthetan 2 ir n maximal monotone polyhedral multifunction problem tmap given shown section 3 polyhedral piecewise affine respect finite collection ncells whose union ir n thus complete description algorithm affine generalized equations remains show generate representations task constructing dependent upon described example 22 taken normal cone nc polyhedral convex set c chosen normal manifold defined terms nonempty faces f c specifically cells normal manifold defined common value n f x 2 rif particular choice cells leads algorithm given 3 general assume described union finite collection polyhedral convex sets c describe p union sets g projecting onto domain p produce collection sets since know domp provide example process return case observe fxg theta n thus see nc union polyhedral convex sets follows process described yields normal manifold robinson 22 proposition 24 proved normal manifold subdivision ir n however general collection cells generated process subdivision demonstrated following example let let simply zero mapping thus maximal monotone multifunction however employing procedure constructing obtain oe since oe 1 face oe 1 see foe subdivision ir n since p singlevalued lemma 33 p affine cell oe 2 representation cell given 9 order workable description affine maps would appear necessary exploit underlying structure one case subject next section particularly important class affine variational inequalities set c rect angular ie c defined constraints l z u l u vectors ir n l problem class number features attractive pivotal algorithms similar algorithm age particular cells linearity normal map rectangular furthermore normal map takes simple form specifically affine function f z az matrix used represent normal map cell formed simply replacing columns corresponding columns identity matrix rectangular variational inequalities also attractive theoretical standpoint par ticular least one l u finite normal map coherently oriented respect c pmatrix definition 51 4 matrix said pmatrix principal minors positive note c rectangular nc extend notion rectangularity generalized equations requiring multifunction separable ie form maximal monotone polyhedral multifunction ir ir shall see cells linearity tmap rectangular begin looking resolvent operator note p continuous piecewise affine function follows continuous piecewise affine function ir ir let k number breakpoints strictly increasing sequence breakpoints f ij coefficients fd ij note since p monotonic nonexpansive 0 ij 1 breakpoint sequence defines subdivision ir given define subdivision ir n defined oe j 1 j 2 j n theta clearly p therefore mpa establishes earlier statement cells linearity rectangular cell oe j 1 j 2 j n define diagonal matrix j 1 j 2 j n define vector b j 1 j 2 j n represented j 1 j 2 j n tmap given deltan thus see matrix j 1 j 2 j n represents oe j 1 j 2 j n columns convex combinations columns corresponding columns set proving main result section namely pmatrix coherently oriented separable polyhedral maximal monotone multifunction first need prove two technical lemmas lemma 52 b n theta n matrices b rank1 deta 0 proof j 1 j n summation taken possible choices j either deltai b deltai since b rank1 determinants sum zero choices include least two columns b thus thus affine function positive thus positive 2 0 1 lemma 53 let n theta n matrix let fb collection rank1 n theta n matrices choices choices 2 0 1 proof induction lemma true suppose lemma true k shall prove lemma true suppose collection rank1 n theta n matrices choices 1 let b fb conditions lemma similarly two results see let b satisfy hypotheses lemma 52 thus 2 0 1 theorem 54 p matrix separable maximal monotone polyhedral multifunction tmap defined 9 property cell linearity matrix representing positive determinant particular coherently oriented proof let representation b ncell oe earlier discussion formed replacing columns convex combination columns corresponding columns identity matrix thus matrix form deltai observe b rank1 matrix since pmatrix matrix formed replacing arbitrary set columns corresponding columns identity matrix positive determinant thus matrices satisfy hypotheses lemma 53 thus lemma 53 det corollary 55 pmatrix separable maximal monotone polyhedral multifunction using lexicographic ordering algorithm age find solution finite number steps 6 piecewise linearquadratic programming conclude giving example well known problem mathematical programming solved using technique presented piecewise linearquadratic programming problem plqp given f1g convex piecewise linearquadratic defined definition 61 function f f1g piecewise linearquadratic domf closed convex exists finite subdivision domf oe 2 f joe quadratic function note domf polyhedral since cells subdivision closed f continuous function domf optimality conditions plqp stated relation h convex subdifferential operator defined appropriate constraint qualification ie riadomf ridomoe 6 follows thus optimality conditions satisfied must x 2 domf 2 oeax gammaa 2 fx 23 theorem 235 first statement equivalent oe conjugate oe optimality conditions thus define optimality conditions plqp stated generalized equation fact polyhedral shown 25 thus optimality conditions piecewise linearquadratic program expressed affine generalized equation solved using algorithm acknowledgement authors would like thank stephen robinson constructive comments suggestions pertinent references greatly improved presentation material given paper r operateurs maximaux monotones et semigroupes de contractions dans les espaces de hilbert pc matrices linear complementarity problem pivotal method affine variational inequalities linear complementarity problem robust solution mixed complementarity problems path solver nonmonotone stabilization scheme mixed complementarity problems pathsearch damped newton method computing general equilibria basic theorem complementarity short course solving equations pl homotopies computing stationary points computing stationary points equivalence lcp pls engineering economic applications complementarity prob lems piecewise linear topology generalized complementarity problem equilibrium points bimatrix games global convergence damped newtons method nonsmooth equations continuity properties polyhedral multifunctions generalized equations solution part basic theory generalized equations normal maps induced linear transformations convex analysis miles mixed inequality nonlinear equation solver monotropic piecewise quadratic programming note computing equilibria economies activity analysis models production tr