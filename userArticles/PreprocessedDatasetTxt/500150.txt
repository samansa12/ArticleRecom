motionbased segmentation contourbased classification video objects segmentation objects video sequences constitutes prerequisite numerous applications ranging computer vision tasks secondgeneration video codingwe propose approach segmenting video objects based motion cues estimate motion employ 3d structure tensor operator provides reliable results integrating information number consecutive video frames present new hierarchical algorithm embedding structure tensor multiresolution framework allow estimation large velocitiesthe motion estimates included external force geodesic active contour model thus stopping evolving curve moving objects boundary level setbased implementation allows simultaneous segmentation several objectsas application based object segmentation approach provide video object classification system curvature features object contour matched means curvature scale space technique database containing preprocessed views prototypical objectswe provide encouraging experimental results calculated synthetic realworld video sequences demonstrate performance algorithms b introduction video object segmentation required numerous applications ranging highlevel vision tasks secondgeneration video coding 25 mpeg4 video coding standard 10 provides functionality objectbased video coding video information encoded number arbitrarily shaped video object planes automatic content analysis indexing methods benet object segmentation algorithms instance possible summarize videos based occurrence activities video objects 14 algorithms highlevel vision tasks shapebased object recognition 26 19 2 depend information regard object outlines propose approach segmenting video object based motion cues motion estimation performed estimating local orientations spatiotemporal neighborhood 3d structure tensor thus information number consecutive frames exploited present new hierarchical algorithm embeds tensorbased motion estimation multiresolution framework allow calculation large displacements nal segmentation performed geodesic active contour model enabling simultaneous detection multiple objects furthermore provide video object classication system categorizes segmented video objects several object classes eg cars people classication system matches curvature features object contour database containing preprocessed views prototypical objects remainder paper organized follows summarizing related work section 3 describes segmentation approach section 4 introduces video object clas sication system section 5 presents experimental results finally section 6 oers concluding remarks 2 related work various approaches proposed eld motion estimation segmentation number optical ow techniques reviewed 3 4 18 mech wollborn 16 estimate change detection mask employing local thresholding relaxation technique regions uncovered background removed mask using displacement vector eld 13 edge map calculated interframe dif figure 1 left right frame 10 taxi sequence b optical ow lucas kanade ow 3d structure tensor ference image using canny edge detector 6 edge mapcontaining edge pixels framesis compared edge map current frame background reference frame nal segmentation achieved morphological operators additional lling algorithm meier ngan 17 propose two approaches first combine optical ow eld morphological operator second employ connected component analysis observed interframe dierence conjunction lling procedure paragios deriche 21 propose statistical framework based gaussian laplacian law detect moving objects boundary combination boundaries obtained current frame integrate motion detection tracking problems geodesic active contour model object classication contourbased techniques study long time overviews found 22 15 8 one promising contour analysis techniques curvature scale space method css introduced mokhtarian 20 19 still images contour already segmented object compared database containing representations preprocessed objects technique depend size rotation angle robust noise 2 modied css technique found cently richter et al 23 extended css technique include classication video objects 3 video object segmentation addition color texture information already available still images video sequence provides temporal information hard extract semantically meaningful objects based color texture cues motion cues facilitate segregation objects background consequently rst step approach choose appropriate motion detector various methods proposed estimate motion 3 4 18 however determine motion parameters basis two consecutive frames hence techniques sensitive noise require appropriate compensation methods figure 1 illustrates observation classical lucas kanade algorithm calculated optical ow frame 10 taxi sequence lucas kanade implementation used 3 parameters set 2 5 see 3 details motion vectors shorter pixelframe suppressed gure taxi sequence contains four moving objects taxi mid dle car left van right pedestrian upper left corner motion three main objects calculated reliably several misclassications occur due noise background note result improved signicantly preprocessing sequence 3d gaussian smoothing lter however drawback presmoothing elimination small structures eg pedestrian upper left corner taxi sequence cannot detected approach employ 3d structure tensor analyze motion 5 motion vectors calculated estimating local orientations spatiotemporal domain figure 1c depicts result structure tensor background noise eliminated without preltering reliable motion detection possible even small structures like pedestrian identied following section describe structure tensor technique present new algorithm embeds approach multiresoultion framework allow detection large velocities 31 tensorbased motion estimation within consecutive frames stacked top video sequence represented threedimensional volume one temporal z two spatial x coor dinates perspective motion estimated analyzing orientations local gray value structures 5 assuming illumination vary gray values remain constant direction motion thus stationary parts scene result lines equal gray values parallel time axis moving objects however cause isogray value lines dierent orientations figure 2 illustrates observation consequently moving static parts image plane determined direction minimal gray value change spatiotemporal volume direction calculated direction n much perpendicular gray value gradients 3d local neighborhood thus pixel position x z r3 x z denotes spatiotemporal gradi 9zxfigure 2 local orientation image structures left frame 169 top frame 39 bottom hall monitor sequence right slice corresponding spatiotemporal volume taken horizontal line marked white lines single frames ent threedimensional volume 3d neighborhood around pixel position x described 5 9 minimizing equation 1 equivalent determining eigenvector minimum eigenvalue 3d structure tensor j 4 jxx jxy jxz jxy jyy jyz jxz jyz jzz5 2 calculated within local neigh borhood z analyzing three eigenvalues 1 2 3 0 3 3 symmetric matrix classify local neighborhoods motion general eigenvalue 0 indicates gray values change direction corresponding eigenvector e figure 3 illustrates relationship local structures eigenvalues eigenvectors twodimensional case consider instance case 1 local neighborhood centered horizontal structure gray values within neighborhood change one direction consequently 1 0 eigenvector e1 gives direction gray value change within context threedimensional neighborhood following observations made three eigenvalues equal zero indicate area constant gray val ues therefore motion detected 1 0 one direction corresponds horizontal vertical structure moving constant velocity consequently due correspondence problem calculate normal velocity real motion calculated gray values remain constant one direction hence 1 0 2 0 occurs structure containing gray value changes two directions moves constant speed finally three eigenvalues greater zero figure 3 local structures eigenvalues eigenvectors two dimensions case 1 case 3 horizontal vertical structure gray values change one direction ie 1 0 case 2 corner gray values change one direction ie cannot determine optical ow due noise realworld video sequences however impractical compare eigenvalues zero since due noise sequence small gray value changes always occur thus introduce normalized coherence measures c cs quantify certainty calculations coherence measure c indicates whether reliable motion calculation possible dened exp c else 4 c 0 denotes contrast parameter areas j1 3 regarded almost constant local neighborhoods 27 value c near 10 indicates 1 3 therefore reliable motion calculation performed opposite true c value approaches zero coherence measure cs exp c else provides information whether normal real motion determined values near 10 allow calculation real motion otherwise normal velocities specied depicted figure 1c structure tensor allows reliable motion calculations suppresses background noise due integration several consecutive frames number frames used motion calculation determined size neighborhood setting instance means motion calculation pixel performed within spatiotemporal area 777 pixels 32 multiscale motion estimation motion detection approach described far exhibits problems sequences containing large velocities results xed size local neighborhood con sider image feature moves high velocity conse quently changes position large displacement one frame next displacement exceeds size local neighborhood motion feature cannot detected overcome limitation developed new hierarchical algorithm embeds structure tensor technique linear scalespace framework hence calculations performed coarsetone manner first gaussian pyramid l levels constructed video sequence let 1 x denote original sequence size n 1 coarser levels constructed recursively ie l calculated l 1 spatial smoothing spatial downsampling factor two position optical ow vector calculated calculations start coarsest level l position p l within level determined within local neighborhood centered position p l structure tensor j calculated corresponding eigenvalues evaluated described section 31 motion calculation feasible motion vector v determined position note due subsampling procedure large displacements reduced appropriately therefore captured within local neighborhood motion vector v l determined coarsest pyramid level l serves initial guess g l 1 next pyramid level l 1 since spatial dimensions double one level next adapt initial guess accordingly ie thus state know position p l image feature moves roughly according g l 1 goal level l 1 rene initial guess done 1 compensating motion vector within local neighborhood around p l 1 2 calculating displacement vector l 1 modied neighborhood hence motion vector level v l 1 emerges combination initial guess displace ment motion vector v l 1 used initial guess consecutive pyramid level algorithm repeats highest resolution reached crucial part algorithm motion compensation must performed level order allow displacement calculation remember calculations structure tensor elements eg element jxx spatial derivations calculated within spatiotemporal neighborhood around position x z consider patches three frames video sequence namely z 1 z z1 involved cal culations consider initial guess local neighborhood available previous pyramid level thus determine additional displacement rst necessary compensate guess consequently equation 6 changes ie frame z patch around position gy frame z 1 patch around frame z patch around x used obviously gx gy need integer values thus bilinear interpolation used determine image values subpixel level accordingly elements tensor j calculated motion compensation need motion compensation use bilinear interpolation techniques hierarchical algorithm clearly aect performance whole method order improve eciency useful eliminate positions 0 n 1 advance presumably reliable motion calculation possible structure tensor used spatial domain xy xy j 0 yy reliable indicator task remember twodimensional case see figure 3 eigenvalues 1 provide information texturedness local neighborhood eigenvalues larger zero indicate textured region respect motion estimation probable region identied consecutive frame consequently full motion vector calculated one eigenvalue greater zero area question contains horizontal vertical struc ture therefore motion direction gradient normal motion determined hand uniform region ie estimation motion possible results 1 2 0 thus shi tomasi 24 propose following reliability measure ie position x image contains good feature track lesser eigenvalue exceeds predened threshold however purpose slightly dierent want calculate kind motion occurring video se quence therefore modify reliability measure equa tion exclude uniform regions motion calculation exp c else small sum 1 2 result values near zero cases reliability measure adopts values near one 33 motionbased segmentation depicted figure 1c motion estimation approach able reliably identify regions interest though parts van left due low contrast ever tensorbased motion detection sucient provide accurate segmentation objects question observe two shortcomings inherent approach first due areas constant gray values within moving objects receive dense motion vector elds areas three eigenvalues close zero therefore motion cannot calculated however likely motion estimated spatial edges moving objects second tensor fails provide true object boundaries accurately since calculations within neighbor hood blur motion information across spatial edges consequently need 1 grouping step integrate neighboring regions objects closing gaps figure 4 tensordriven geodesic active contour left right contour 3000 6000 9000 12000 iterations constant force holes 2 contour renement based spatial edge information widely used within context active contour mod els basically planar parametric curve cs placed around image parts interest evolves smoothness control ternal energy uence image force external energy classical explicit snake model 11 following functional minimized ds 11 rst two terms control smoothness planar curve third attracts contour high gradients image obtain topological exibility allow simultaneous detection multiple objects employ geodesic active contours 12 7 basic idea embed initial curve zero level set function c represented set points x ux evolve function partial dierential equation using modied energy term results image evolution equation 12 7 denotes curvature level set r x spatial gradient c adds constant force faster convergence g represents external imagedependent force stopping function dening appropriate stopping function g integrate tensorbased motion detection model choosing smoothed version stops curve evolution positions reached coincide motion pixels note denotes 2d velocity available motion estimation step predened velocity threshold compared norm motion vector hence segmentation scheme assumesin current state static camera event moving camera global camera motion estimation performed rst possible compare motion vectors determined structure tensor vectors resulting global camera parameters 17 figure 4 depicts evolution tensordriven geodesic active contour contour succeeds splitting detecting four dierent moving objects order improve segmentation results employ renement procedure based motion information figure 5 contour renement left motionbased segmentation right motionbased segmentation contour renement 445 iterations gradient values within single frame seen figure 5 left motionbased segmentation detects regions slightly larger moving objects thus restart image evolution process using result motionbased segmentation zero level set however time stopping function g based spatial gradient used c contrast parameter diminishes inuence low gradient values figure 5 depicts performance renement procedure 4 video object classification system object classication consists two major parts database containing contourbased representations prototypical video objects algorithm match extracted objects database following summarize classication approach details see 23 41 curvature scale space representation curvature scale space css technique 1 20 23 based idea curve evolution ie basically deformation curve time css image provides multiscale representation curvature zero crossings closed planar contour consider closed planar curve u normalized arc length parameter u curve smoothed onedimensional gaussian kernel gu width deformation closed planar curve represented xu u denote components xu convolution gu b c figure construction css image left f object view smoothed contour 10 30 100 200 300 iterations small dots contour mark curvature zero crossings right resulting css image curvature u evolved curve computed using derivatives xuu xuuu yuuu css image iu dened shows zero crossings respect position contour width gaussian kernel number iterations see figure 6 deformation process zero crossings merge transitions contour segments dierent curvature equalized consequently certain number iterations ection points cease exist shape closed curve convex note due dependence curvature zero crossings convex object views cannot distinguished css technique signicant contour properties visible large number iterations result high peaks css image however areas rapidly changing curvatures caused noise produce small local maxima many cases peaks css image provide robust compact representation object views contour19 20 note rotation object view image plane accomplished shifting css image left right horizontal direction furthermore mirrored object view represented mirroring css image main drawback basic css techniquewhere two values position height represent peak css imageis occurrence ambiguities certain contours diering signicantly visual appearance nevertheless similar images due fact shallow deep concavities contour may result peaks height css image presents several approaches avoiding ambiguities raising computational costs signicantly extension 23 extract width bottom arcshaped contour corresponding peak width species normalized arc length distance two curvature zero crossings enframing contour segment represented peak css image peak css image three values stored position maximum value iteration width gaussian kernel width bottom arcshaped contour sucient extract signicant maxima certain noise level css image stance example depicted figure 6 assuming noise level four data triples stored matching algorithm described following section utilizes information peaks compare automatically segmented video objects prototypical video objects database 42 object matching objects matched two steps rst automatically segmented object sequence compared objects database list best matches built processing second step results accumulated condence value calculated based object class object sequence determined order nd similar object database compared query object sequence matching algorithm needed general idea compare peaks css images two objects based characterization triples height position width rst step best position compare two images determined might necessary rotate mirror one images peaks aligned best mentioned shifting css image corresponds rotation original object one css images shifted highest peaks css images aligned matching peak determined peak rst object two peaks may match position width within certain range highest peaks height also need within certain range matching peak found euclidean distance height position peaks calculated added dierence images matching peak determined height peak rst query object multiplied penalty factor added total dierence matching algorithm might return 1 eg adequate rotation could found highest maxima css images match within given tolerance range case two objects signicantly dierent top matches recognized used accu mulation object class percentage 75 considered class sequence 5 experimental results subdivide experimental results achieved algorithms three sections first demonstrate figure 7 left frame synthetic sequence right motion eld calculated hierarchical structure tensor approach better visibility ow image subsampled factor 4 performance multiscale structure tensor approach synthetic sequence containing large displacements sec ond provide segmentation results obtained tensor driven geodesic active contour respect two realworld sequences finally results calculated object classi cation algorithm presented 51 multiscale motion estimation results measure performance hierarchical approach described section 32 created simple synthetic video sequence displacements one frame next known figure 7 left shows frame sequence contains two moving squares upper square square 1 moves constant velocity 10 pixels per frame right left square square moves diagonally upwards velocity figure 7 right depicts result obtained multiresolution algorithm using 4 pyramid levels closer look motion vectors calculated algorithm reveals following observations 1 corners squares velocity could estimated exactly square 1 2 remember corner moving constant speed enough texture available allow calculation full image motion 2 account pyramidal structure velocities horizontal vertical structures approximate real image motion general full motion calculation possible points near corners coarsest pyramid level point horizontal vertical structure near corner specic example therefore initial full motion guess points calculated however consecutive pyramid levels full motion calculation longer possible since distance corners increases consequently displacements added initial guess rene motion estimation normal direction 3 pixels interior squares possible calculate image motion reliability measure described equation 10 eliminates points calculations results synthetic sequence indicate specic circumstancesthe proposed approach able estimate motion exactly even given existence large displacements object frame fp fn fp fn car 7 156 61 912 373 car car 9 208 car van 7 135 448 1077 2861 van 8 176 663 1504 4001 van 9 288 522 2215 3403 van 11 246 800 1954 4413 table 1 regionbased distance taxi se quence columns 3 4 false positives false nega tives columns 5 percentage mismatched pixels comparison entire number pixels manual segmentation object frame avg car 7 127 3812 3515 1436 1238 car 8 141 2727 3523 1818 1932 car 9 154 3382 2990 882 2745 car 11 139 3498 2906 1330 2266 taxi 9 144 4421 2895 684 2000 van 7 421 2059 1824 1000 5118 van 8 620 1136 1705 1136 6023 van 9 605 1118 1118 765 7000 van 11 743 995 942 785 7277 table 2 edgebased distance taxi sequence column 3 average edge pixel distance colums 47 percentages distances 0123n 52 segmentation results applied segmentation algorithm described two realworld sequences rst one hamburg taxi sequence widely used within computer vision community figure 8 illustrates performance segmentation approach sequence employed standard structure tensor described section 31 parameters set follows 1 size local neighborhood set 7 7 7 2 contrast parameter coherence measures set 5 positions coherence c 075 performed motion estimation positions c value rejected full motion vectors calculated positions cs 09 motion estimates integrated external force geodesic active contour model see section 33 faster convergence set external force value c greater zero forces curve shrink value smaller zero causes expansion finally employed contour renement step described section 33 addition visual results provide quantitative measures tables 1 2 first used regionbased distance measures fp fn compare automatic segmentation results manual segmentation fp contains number pixels incorrectly marked object pixels automatic segmentation false positives fn sums object pixels missed process false neg atives second employed edgebased distance mea sure contour pixel manual segmentation distance closest contour pixel automatic segmentation determined following conclusions drawn mea sures segmentations car taxi accept able number pixels detected automatic segmentation rather high miss rate fairly low fur thermore edgebased measure indicates edges automatic manual segmentation coincide however van could segmented accurately regionbased edgebased distance measures return high error rates second video sequence typical head shoul der sequence however due low sampling rate displacements moving person large hence employed multiresolution motion estimation four pyramid levels local neighborhood size 3 3 3 speed motion detection employed reliability measure provided section 32 ie positions reliability 09 rejected nal segmentation performed geodesic active contour model figure 9 depicts results motion estimation segmentation second sequence segmentation approach identies region interest correctly ever accuracy less taxi sequence especially areas containing strong static edges results hierarchical motion estimation blur across moving edges thus enlarging segmented region tables 3 4 underline observations especially percentages exactly matching edges rather small 53 classification results test database 23 consists object classes containing animals birds cars people miscellaneous ob jects object class collected 25 102 images clip art library clip arts typical representatives object class easily recognizable perspectives object class people contains objects 102 images contours humans dier greatly image sequences e g position arms legs makes great impact contour applied extended object matching algorithm automatically segmented cars hamburg taxi sequence see figure 8 person sequence see figure 9 css matching performed triples frame fp fn fp fn 34 336 77 655 158 table 3 regionbased distance person se quence columns 2 3 false positives false nega tives columns 4 5 percentage mismatched pixels comparison entire number pixels manual segmentation frame avg distance 34 120 2540 4198 2353 910 38 204 1261 3871 2493 2375 table 4 edgebased distance person se quence column 2 average edge pixel distance colums 36 percentages distances 0123n good bad rejected sequence matches matches frames car left cars 92 0 8 taxi center cars 68 misc 8 24 van right cars 29 animals 39 0 people 32 table 5 results automatically segmented objects taxi sequence matched objects database position height width peak css image table 5 shows result hamburg taxi sequence perspective segmentation car left object best suited recognition 68 taxi center object cannot recognized reliably van cannot recognized application last row figure 8 shows four best matches car left object frame 12 perspective car change frames show similar results figure 9 depicts classication results person sequence best matches frames 25 33 34 38 displayed last row 6 conclusions presented approach segmentation clas sication video objects motion segmentation step integrated 3d structure tensor geodesic active contour model structure tensor able estimate motion reliably presence background noise active contour groups neighboring regions closes holes gaps level setbased implementation allows simultaneous detection multiple objects account large displacements cannot handled standard structure tensor developed new multiresolution tensorbased algorithm contourbased video object classication system presented application robustness curvature scale space method allows correct classication even presence segmentation errors provided various experimental results results segmentation algorithm driven standard tensor encour aging segmentation obtained conjunction multiresolution algorithm less accurate nevertheless classication algorithm able calculate reasonable categorizations however several areas require de velopment first segmentation performance multiresolution approach improved second provide complete segmentation module necessary integrate tracking component 7 acknowledgments authors would like thank changick kim university washington provision person se quence website 8 r shape similarity retrieval enhancing cssbased shape retrieval objects shallow concavities performance optical ow techniques computation optical ow computational approach edge detection geodesic active contours isoiec 144962 active contour models conformal curvature ows phase transitions active vision fast robust moving object segmentation video sequences integrated scheme objectbased video abstraction survey shape analysis techniques noise robust method segmentation moving objects video sequences extraction moving objects contentbased video coding computation analysis image motion synopsis current problems methods robust e geodesic active contours level sets detection tracking moving objects review algorithms shape analysis good features track new trends image video compression tr computational approach edge detection multidimensional orientation estimation applications texture analysis optical flow performance optical flow techniques computation optical flow computation analysis image motion geodesic active contours geodesic active contours level sets detection tracking moving objects integrated scheme objectbased video abstraction shape analysis classification tensor approach precise computation dense displacement vector fields noise robust method segmentation moving objects video sequences ctr xinguo yu changsheng xu hon wai leong qi tian qing tang kong wah wan trajectorybased ball detection tracking applications semantic analysis broadcast soccer video proceedings eleventh acm international conference multimedia november 0208 2003 berkeley ca usa mayur jain nalin pradeep video surveillance system varying environmental conditions proceedings 24th iasted international conference signal processing pattern recognition applications p3237 february 1517 2006 innsbruck austria