convergence analysis pseudotransient continuation pseudotransient continuation psitc wellknown physically motivated technique computation steady state solutions timedependent partial differential equations standard globalization strategies line search trust region methods often stagnate local minima ptc succeeds many cases taking advantage underlying pde structure problem though widely employed convergence ptc rarely discussed paper prove convergence generic form ptc illustrate two practical strategies b introduction pseudotransient continuation psitc method computation steadystate solutions partial differential equations shall interpret method context methodoflines solution equation discretized space resulting finite dimensional system ordinary differential equations written x x discretized spatial derivatives contained nonlinear term f x marching steady state following physical transient may unnecessarily time consuming intermediate states interest hand newtons method f usually suffice initial iterates sufficiently near root usually available standard globalization strategies 12 17 25 line search trust region methods often stagnate local minima kfk 20 particularly case solution complex features shocks present initial iterate see 24 example psitc succeeds many cases taking advantage pde structure problem 11 basic algorithm simple form considered paper psitc numerically integrates initial value problem steady state using variable timestep scheme attempts increase timestep f x approaches 0 v nonsingular matrix used improve scaling problem typically diagonal approximately equilibrates local cfl number based local cell diameter local wave speed throughout domain multicomponent system pdes already version april 20 1997 north carolina state university department mathematics center research scientific computation box 8205 raleigh n c 276958205 tim kelleyncsuedu research author supported national science foundation grant dms9321938 z computer science department old dominion university norfolk va 235190162 keyescsoduedu icase ms 132c nasa langley research center hampton virginia 236810001 research author supported national science foundation grant ecs9527169 nasa grants nagi1692 nas119480 latter author residence icase properly nondimensionalized v might block diagonal matrix blocksize equal number components define psitc sequence fx n g f 0 jacobian frechet derivative infinitedimensional situation algorithmically algorithm 11 1 2 kf xk large solve ffi b c evaluate f x update ffi linear equation newton step solved step 2a discretization pde usually large typically solved iterative method terminates small linear residuals results inexact method 11 convergence theory psitc must account provide theory x 3 yet explained ffi updated explored reuse jacobian information previous iterations options must considered explain performance psitc practiced take x 3 order clearly explain ideas however begin analysis x 2 simple variant psitc possible solving 13 exactly extend results general situation method integration time psitc rosenbrock method 14 p 223 ffi fixed one may also think predictorcorrector method simple predictor result previous timestep newton corrector used see consider implicit euler step x n timestep z formulation z n1 would root finding root g newtons method would lead iteration take first newton iterate leaves open possibility taking corrector iterations would lead different form psitc given 12 may improve stability problems 16 pseudotransient continuation 3 12 time step control assume ffi n computed formula like switched evolution relaxation ser method named 21 used eg 19 24 33 simplest unprotected form ser increases timestep inverse proportion residual reduction relation 15 implies n 1 work 16 ffi n kept large finite bound ffi max sometimes ffi n set 1 called switchover steadystate form 13 computed value view practices allow somewhat generality formulation sequence fffi n g assume ffi 0 given n 1 choice 24 33 equation 15 oe choices could either limit growth ffi allow ffi become infinite finitely many steps formal assumption oe accounts possibilities assumption 11 1 2 either timesteps held bounded switchover steadystate form permitted finite number timesteps 16 timesteps based norms nonlinear residuals kf x n k norms steps policy risks small steps need imply small residuals accurate results however jacobians uniformly well conditioned small steps imply iteration near root formulae type used oe satisfies assumption 11 13 iteration phases divide psitc iteration three conceptually different separately addressed phases 1 initial phase ffi small x far steady state solution phase analyzed x 23 success phase governed stability accuracy temporal integration scheme proper choice initial data 2 midrange begins accurate solution x timestep ffi may small produces accurate x large ffi analyze x 22 allow ffi grow without loss accuracy x make linear stability assumption part 3 assumption 21 3 terminal phase ffi large x near steady state solution small part overall process usually requiring iterations aside attention must paid updating rules ffi iteration variation chord method 25 17 analyze terminal phase first easiest x 21 unlike two phases analysis terminal phase depend dynamics x x initial midrange phases considered x 23 midrange phase considered first motivate goals initial phase decomposition similar proposed gmres related iterations 22 supported residual norm plots reported 24 10 2 exact newton iteration section analyze three phases solver reverse order ordering makes clear output earlier phase must conform demands later phase 21 local convergence terminal phase terminal phase iteration analyzed without use differential equation lemma 21 let fffi n g given either 16 18 let assumption 11 hold let nonsingular f 0 lipschitz continuous lipschitz constant fl ball radius ffl x sequence defined 12 16 satisfies x proof let denote error standard 12 17 analyze convergence terms transition current iterate x c new iterate x must also keep track change ffi let ffi c ffi current new pseudotimesteps standard analysis chord method 17 p 76 implies ffl 1 ffl k c constant k c depends ffl 1 f x increase ffl 1 reduced let delta gamma1and ffl 1 small enough satisfy particular f increase needed pseudotransient continuation 5 denotes condition number equations 21 22 imply fffi n g computed 16 use following inequality 17 p 72 23 obtain 2 assumption 11 assumption 11 fffi n g computed 18 note hence either case therefore may continue iteration conclude least qlinearly qfactor 12 complete proof observing since superlinear convergence follows 21 following simple corollary 21 applies choice oe corollary 22 let assumptions lemma 21 hold assume oe 1 convergence fx n g x qquadratic 22 increasing time step midrange phase lemma 21 states second phase psitc produce large ffi accurate solution show happens initial phase provide accurate solution clarifies role second phase increasing timestep showing steady state problem stable solution psitc behaves well make assumptions involve nonlinear function also initial data dynamics ivp 11 assumption 21 1 f everywhere defined lipschitz continuously fr echet differentiable 2 root x f f 0 solution initial value problem converges x 1 3 ffl 2 analysis midrange uses part 3 assumption 21 important way guarantee stability method updating ffi important result theorem 23 let fffi n g given either 16 18 let assumption 11 hold let assumption 21 hold let ffi max large enough conclusions lemma 21 hold ffl 3 0 x proof let 1 lemma 21 ffl 2 part 3 assumption 21 note c 0 x kek ffl 1 hence reducing ffl 3 needed ffl 3 fi2c n 1 hence x n converges x qlinearly qfactor 1 convergence implies x 18 used result says iteration found sufficiently good solution either convergence happen iteration stagnate inf latter failure mode course easy detect moreover radius ffl 3 ball root theorem 23 depend inf ffi n 23 integration steady state initial phase theorem 23 requires accurate estimate x asks nothing timestep section show ffi 0 sufficiently small 16 used update timestep dynamics 11 tracked sufficiently well approximate solution found clear 18 allows theorem 24 let fffi n g given 16 let assumption 11 hold let assumption 21 hold ffi ffi 0 ffi n proof let trajectory solution 25 assumption 21 x satisfies assumptions 12 17 25 local quadratic convergence newtons method therefore ffl 4 ffl f suffice conclusions theorem 23 hold let show ffi 0 sufficiently small 17 long kf xk ffl f x k within ffl 4 trajectory let z solution 25 let consider approximate integration 25 12 set holds cannot happen n implies n therefore proof complete show note 12 may written 1 last term 29 satisfies sufficiently small k assumptions f finally 2 sufficiently small setting n 1 long ffi n sufficiently small long 27 holds implies consequently standard 14 15 using 28 completes proof problem application proof update given 18 bounds ffi like 27 follow update formula 3 inexact newton iteration section look psitc implemented practice two significant differences simple version x 2 realistic implementations 1 frechet derivative recomputed every timestep 2 equation newton step solved inexactly showing results x 2 affected differences provide detail motivation item 1 subtle one solving equation newton step direct method evaluation factorization jacobian matrix done every timestep common feature many ode dae codes 30 26 27 3 jacobian updating issue continuation methods 31 28 implementations chord shamanskii 29 methods general nonlinear equations 2 17 25 jacobian slowly varying function time continuation parameter sporadic updating jacobian leads significant performance gains one must decide evaluate factor jacobian using iteration statistics ode dae case estimates truncation error temporal truncation error interest us course seek steadystate solution continuation 9 16 jacobian corresponding lowerorder discretization residual used early phases iteration 19 context matrixfree newton method used preconditioner risks use inaccurate jacobian information termination decisions newton iteration decision reevaluate refactor jacobian related one misled rapidly varying illconditioned jacobians premature termination nonlinear iteration 30 32 18 case iterative methods item 1 interpreted mean preconditioning information incomplete factorization computed every timestep means equation newton step solved inexactly sense 11 instead given 13 step satisfies small j may change iteration progresses item 1 also viewed inexact newton method j reflecting difference approximate exact jacobians theory x 2 changed much inexact computation step allowed proof lemma 21 affected 21 must changed changes statement lemma lemma 31 let fffi n g given either 16 18 let assumption 11 let f x nonsingular f 0 lipschitz continuous lipschitz constant fl ball radius ffl x ffl 1 0 j n sequence defined 31 32 16 satisfies x corollary 22 becomes corollary 32 let assumptions lemma 31 hold assume oe 1 convergence fx n g x qsuperlinear locally qquadratic analysis midrange phase changes 26 obtain k j 0 means j must small enough maintain qlinear convergence fx n g phase inexact form theorem 23 theorem 33 let fx n g given 31 32 let fffi n g given either 16 18 let assumption 11 hold let assumption 21 hold let ffi max large enough conclusions lemma 21 hold ffl 3 0 j j n x inexact newton methods particular newtonkrylov solvers applied odedae solvers 1 5 4 6 7 9 context different nonlinear residual f x reflect error transient solution steady state solution analysis initial phase changes 210 must estimate hence assuming operators uniformly bounded 3 ks hence express 35 hence inexact form theorem 24 theorem 34 let fx n g given 31 32 let fffi n g given 16 let assumption 11 hold let assumption 21 hold assume operators uniformly bounded n let ffl 0 ffi j j n restrictions j theorem 34 seem stronger results midrange terminal phases consistent tight defaults forcing terms methods applied odedae context 1 5 6 7 9 4 numerical experiments section examine commonly used psitc technique switched evolutionrelaxation ser 21 applied newtonlike method inviscid compressible flow fourelement airfoil two dimensions three phases corresponding roughly theoreticallymotivated iteration phases x 2 may identified also compare ser different psitc technique based bounding temporal truncation error tte 20 tte slightly pseudotransient continuation 11 04 zoomed grid fig 41 unstructured grid around fourelement airfoil landing configuration nearfield view aggressive ser building time step particular problem behavior system qualitatively physical problem discretization algorithmic treatment nonlinear defect correction iteration newtonkrylovschwarz iteration well suitability parallel computation documented earlier papers recently 10 references therein description correspondingly compact unknowns problem nodal values fluid density velocities specific total energy n vertices unstructured grid triangular cells see fig 41 system f discretization steady euler equations r r r pressure p supplied ideal gas law fl ratio specific heats discretization based control volume approach control volumes duals triangular cells nonoverlapping polygons surrounding vertex whose perimeter segments join adjacent cell centers midpoints incident cell edges integrals 4143 control volumes transformed divergence theorem contour integrals fluxes estimated numerically upwind scheme roe type effective scaling matrix v psitc term diagonal matrix depends upon mesh boundary conditions correspond landing configuration conditions subsonic mach number 02 high angle attack 5 ffi full adaptively clustered unstructured grid contains 6019 vertices four degrees freedom per vertex giving 24076 algebraic dimension discrete nonlinear problem figure 41 shows nearfield zoom full grid whose farfield boundaries approximately twenty chords away initial pseudo gamma4 corresponds cfl number 20 pseudotimestep allowed grow six orders magnitude course iterations ultimately bounded guaranteeing modest diagonal contribution aids invertibility ffi initial iterate uniform flow based far field boundary conditions constant density energy constant velocity given angle attack solution algorithm hybrid nonlinear defect correction full newton method distinction requires discussion processes supply f x f 0 x within code form vectorvalued function f x determines quality solution always discretized required accuracy secondorder paper form approximate jacobian matrix f 0 x together scaling matrix v time step ffi determines rate solution achieved affect quality converged result therefore candidate replacement matrix convenient practice perform matrix inversion 12 krylov iteration requires action f 0 x series krylov vectors actual elements f 0 x krylov method restarted preconditioned 1cell overlap additive schwarz 8 subdomains following 5 8 use matrixfree frechet approximations required action however preconditioning solution 12 use economical matrix jacobian based true f x obtained firstorder discretization governing euler system decreases number elements preconditioner relative true jacobian also computation parallel context communication applying preconditioner also results numerically diffusive stable matrix desirable inversion price advantages preconditioning inconsistent true jacobian linear subiterations may required meet given linear convergence tolerance indirect feedback nonlinear convergence rate since limit work performed linear subiteration inexact newton sense previous work euler navierstokes equations 10 23 noted psitc method based consistent highorder jacobian stumbles around nonmonotonic steadystate residual norm outset nonlinear iterations typical convenient initial iterate far steadystate solution hand simple defect correction approach based regularizing firstorder discretization everywhere appears solution 12 preconditioning allows residual drop smoothly outset work employ hybrid strategy defect correction used residual norm fallen three orders magnitude inexact newton thereafter noted x 3 inexact fig 42 ser convergence history iteration based true jacobian iteration inconsistent jacobian gathered j 32 theory extends principal background turn attention fig 42 plotted logarithmic scale psitc iteration number steadystate residual norm jjf x n jj 2 beginning iteration norm update vector jjx pseudotimestep ffi n residual norm falls nearly monotonically norm solution update asymptotic convergence cannot expected quadratic superlinear since enforce 35 however linear convergence steep experience shows overall execution time increased many linear iterations employed order enforce asymptotically results shown section inner linear convergence tolerance set 10 gamma2 defect correction part trajectory 10 gamma3 newton part work also limited maximum 12 restart cycles 20 krylov vectors examination pseudotimestep history shows monotonic growth gradual defect correction phase ending rapidly growing asymptotically beginning show momentary retreats ffi max response refinement psitc strategy automatically cuts back pseudotimestep fixed factor nonlinear residual reduction less 3is achieved exhaustion maximum number krylov restarts previous step terminal newton phase close examination usually reveals stagnation plateau linear solver cost effective fall back physical transient proceed grind illconditioned linear problem glitches convergence jjf nonlinear origin another timestep policy common ode literature based controlling temporal truncation error estimates though need maintain temporal truncation errors low levels attempting follow physical transients may maintain high levels heuristic form stepsize control policy seems rare external aerodynamic simulations popular combustion community implemented 20 first fig 43 tte convergence history neglected term euler discretization x reasonable mixed absoluterelative bound error th component x n th step approximated taking 3and implementing strategy euler code place ser yields results fig 43 arrival ffi max occurs step ser arrival threshold jjf occurs one iteration earlier however convergence difficulties arrived slightly greater 5 conclusions though numerical experiments previous section confirm theory detail sense verify estimates hypotheses reassuring similarity exists observations numerics conceptual framework theory originally motivated similar observations literature fairly long induction phase initial iterate guided towards newton convergence domain remaining close physical transient relatively small timesteps terminal phase made rapid capability linear solver permits varies application application iterate newton convergence domain polished connecting two phase moderate length time step built towards newton limit ffi max starting reasonably accurate iterate division phases always clear cut though exogenous experience suggests becomes corrector x 1 iterated towards convergence time step plan examine pseudotransient continuation 15 region parameter space conjunction extension theory mixed steadypsitc systems analogs differentialalgebraic systems ode context future acknowledgments paper began conversation doe workshop iterative methods large scale nonlinear problems held logan utah fall 1995 authors appreciate efforts stimulus organizers homer walker michael pernice also wish thank peter brown rob nance dinesh kaushik several helpful discussions paper paper significantly improved comments thoughtful thorough referee r numerical solution initial value problems differentialalgebraic equations efficient algorithms solving systems nonlinear equations vode variable coefficient ode solver using krylov methods solution largescale differentialalgebraic systems hybrid krylov methods nonlinear systems equations pragmatic experiments krylov methods stiff ode setting numerical methods nonlinear equations unconstrained opti mization towards polyalgorithmic linear system solvers nonlinear elliptic problems numerical initial value problems ordinary differential equations analysis numerical methods robust linear nonlinear strategies solution transonic euler equations iterative methods linear nonlinear equations termination newtonchord iterations method lines aerodynamic applications newtonkrylovschwarz solvers parallelized elliptic solver reacting flows experiments implicit upwind methods euler equations convergence iterations linear equations application newtonkrylov methodology threedimensional unstructured euler code newtons method solver navierstokes equations iterative solution nonlinear equations several variables description dassl differentialalgebraic system solver description use lsode driven cavity flows efficient numerical techniques modification newtons method implementation implicit formulas solution odes error estimate modified newton method applications solution nonlinear twopoint boundary value problems accurate economical solution pressure head form richards equation method lines newton solution inviscid viscous problems tr ctr w k anderson w gropp k kaushik e keyes b f smith achieving high sustained performance unstructured mesh cfd application proceedings 1999 acmieee conference supercomputing cdrom p69es november 1419 1999 portland oregon united states coffey r j mcmullan c kelley mcrae globally convergent algorithms nonsmooth nonlinear equations computational fluid dynamics journal computational applied mathematics v152 n12 p6981 1 march gropp dinesh k kaushik david e keyes barry smith performance modeling tuning unstructured mesh cfd application proceedings 2000 acmieee conference supercomputing cdrom p34es november 0410 2000 dallas texas united states fengnan hwang xiaochuan cai parallel nonlinear additive schwarz preconditioned inexact newton algorithm incompressible navierstokes equations journal computational physics v204 howard c elman victoria e howle john n shadid ray tuminaro parallel block multilevel preconditioner 3d incompressible navierstokes equations journal computational physics v187 n2 p504523 20 may keyes lois curfman mcinnes tidriri globalized newtonkrylovschwarz algorithms software parallel implicit cfd international journal high performance computing applications v14 n2 p102136 may 2000 knoll e keyes jacobianfree newtonkrylov methods survey approaches applications journal computational physics v193 n2 p357397 20 january 2004