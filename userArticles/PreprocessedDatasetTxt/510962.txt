choose secret parameters rsatype cryptosystems elliptic curves recently contrary common belief rivest silverman argued use strong primes unnecessary rsa cryptosystem paper analyzes valid assertion rsatype cryptosystems elliptic curves analysis difficult underlying groups always cyclic previous papers suggested use strong primes order prevent factoring attacks cycling attacks paper focus cycling attacks rsa elliptic curvebased analogues length rsamodulus n typically therefore factoring attack succeed equal probability rsatype cryptosystems also prove cycling attacks reduce find fixed points derive factorization algorithm probably completely breaks rsatype systems elliptic curves fixed point found b introduction theory elliptic curves extensively studied last 90 years 1985 koblitz miller independently suggested use cryptography 9 19 breakthrough elliptic curvebased analogues rsa cryptosystem proposed 10 4 rsatype systems belong family publickey cryptosystems publickey cryptosystem pair public encryption function fk secret decryption k indexed key k representing permutation finite set messages particularity systems given encryption function fk computationally infeasible recover f gamma1 k moreover might suitable encryption function let message unchanged ie given message 2 want fk 6 known message concealing problem 3 simmons norris 29 exploited feature possibly recovering plaintext public information attack technical report ti3597 technische universitt darmstadt november 1997 called cycling attack relies cycle detection ciphertext later generalized williams schmid 31 see also 7 1 basically two ways compromise security cryptosystems first one find protocol failures 20 one directly attack underpinning cryptoalgorithm cycling attack generalizations fall second category important carefully analyze significance attack rsa rivest silverman 25 see also 16 concluded chance cycling attack succeed negligible whatever form public modulus n elliptic curvebased systems analysis difficult underlying group always cyclic actually give results valid groups rank mainly dwell security kmov demytkos system paper organized follows section 2 review kmov demytkos system extend messageconcealing problem elliptic curves section 3 show enables mount cycling attack kmov de mytkos system section 4 explain secret factors recovered thanks cycling attack section 5 finally section 6 give concluding remarks order help programmer implement secure rsatype cryptosystems 2 elliptic curves pq product two large primes p q let two integers b gcd4a 3 curve en b ring zn set points x 2 zn theta zn satisfying weierstra equation together single element called point infinity elliptic curve defined prime field f p well known chordandtangent rule 17 x 22 makes e abelian group algebraically p identity element ie 8p ii inverse gammay 2 otherwise points en b unfortunately form abelian group writing e en b group given direct product e since en b ae e en b add points en b chordandtangent rule large p q resulting point point en b high probability 10 useful introduce notations let defined kp denote pp delta delta b xcoordinate p denoted xp moreover since p 2 ycoordinate p required compute xcoordinate kp write k x p 1 xkp define analogue rsa public encryption key e chosen relatively prime secret decryption key chosen according ed j 1 mod nn encrypt point p 2 en b one computes ciphertext ep authorized receiver recovers p computing secret key problem imbed messages points given elliptic curve without knowledge secret factors p q first solution proposed koyama maurer okamoto vanstone 10 another one later proposed 21 kmov kmov cryptosystem uses family supersingular elliptic curves form main property system p q congruent 2 mod 3 whatever value parameter b therefore encrypt message chosen according ciphertext given em curve en 0 b plaintext recovered another possibility work elliptic curves form en q congruent 3 mod 4 first system based en 0 b p q j 2 mod referred type 1 scheme second one based en systems extended kuwakado koyama formfree primes 12 22 demytkos system demytkos system uses fixed parameters b particularity make use xcoordinate points elliptic curves relies fact number x xcoordinate point elliptic curve e p b xcoordinate point twisted curve defined set points x satisfying fixed quadratic nonresidue modulo p together point infinity nn given message encrypted e x recovered ciphertext c efficiency purposes original scheme see 4 presented message dependent decryption keys length decryption key divided factor 2 average however sequel use messageindependent description simplifies analysis concerned efficiency issues 3 concealingmessage problem 3 blakley borosh showed always least 9 messages unconcealable ie ciphertext message exactly cleartext rsa cryptosystem though problem wellknown rsa nothing appears literature elliptic curvebased analogues since unconcealed messages must avoided effective criteria needed evaluating concealing power latter systems analyzing number unconcealed messages elliptic curvebased systems first give general grouptheoretic results g abelian multiplicatively written finite group order g consider map g x 7 x k k permutes elements g gcdk theorem 1 let g abelian multiplicatively written finite group rank r whose generators g x 7 x k permutes elements g k exactly fixg r fixed points proof write rg equation solutions thus fixed points permutation map k let p q distinct primes let unconcealed message rsa mean message 2 zn e j mod n fixed integer e latter condition ensures exponentiation e permutation map equivalently rsa encryption permutation zn pq rsamodulus let e rsaencryption key number unconcealed messages rsa given proof since z since 0 always solution x e j x mod p theorem 1 tells gcde gamma fixed points z p moreover since chinese remaindering proof complete note since p q e odd integers least 9 unconcealed messages original rsa system exclude encrypt 0 sigma1 always unconcealable messages least 6 unconcealed messages elliptic curve e p b prime field f p abelian group rank 1 2 type n theorem 212 therefore 1 call xfixed point point given integer k theorem 1 becomes theorem elliptic curve prime field f p permutes exactly fixed points furthermore k exactly fix x xfixed points 2 number points order 2 proof first part follows immediately theorem 1 b p xfixed point psi ae since p points order 2 counted twice obtain eq 11 indeed kmov type 1 scheme based elliptic curves form e 3 underlying group isomorphic cyclic group z p1 type 2 scheme uses curves form e case underlying group also isomorphic z p1 quadratic residue modulo p isomorphic zp1phi z 2 otherwise eq 10 odd see given kmov elliptic curve e p b least 2 fixed points e p b cyclic least 4 fixed points otherwise points correspond point infinity together points order 2 noting encryption key e always odd kmov since point infinity used represent messages least 1 3 9 unconcealed messages given kmov elliptic curve en b consequently probability random message unconcealed least 1n compared 6n original rsa demytkos encryption works group form g p theta g j g 1 g 2 writing g define similarly g j q demytkos system makes use xcoordinate since point infinity never used encryption theorem 2 indicates messages 2 number may equal 0 cannot give general information minimal number unconcealed messages demytkos system efficiency purposes public encryption key e usually relatively small example common choices systems number unconcealed messages depends expressions form therefore maximal number unconcealed messages mainly bounded e sigma 1 2 encryption key equal 2 probability message unconcealed 10 gamma144 512 bit rsamodulus 10 gamma299 1024bit rsamodulus even number unconcealed messages small see next section turned active attack 4 cycling attack 41 previous results rsa ciphertext corresponding message e n public key find integer k satisfies equation obviously recover plaintext computing mod n note factor public modulus n might serious failure rsa cryptosystem attack firstly proposed simmons norris 29 later extended williams schmid 31 see also 7 following way let pt polynomial showed ciphertext c period integer g plaintext recovered 42 generalizing cycling attack generalize results previous paragraph abelian finite group g theorem 3 let g abelian multiplicatively written finite group let message e corresponding ciphertext gcde 1 3 find integer p c g plaintext recovered computing smallest integer g lagranges theorem j g since gcde implies j ep thus j p therefore z letting c call theorem generalized cycling attack theorem indicates kmov demytkos system also susceptible cycling attack detecting integer p equivalent problem finding polynomial pt integer pg moreover relation c equivalent denotes prime decomposition group order g since c divides g eq 16 reduced primes p dividing ordg c must check relations hold picking random polynomial pt random integer g means cycling attack depends distribution polynomial order ciphertext c roughly speaking order g smooth expect many elements c 2 g small order primes p eq 17 small polynomial p easily found consequently might desirable impose g contains least one large prime order make harder cycling attack analyze details assumption elliptic curvebased systems 43 application elliptic curve systems previously mentioned elliptic curve e p b prime field f p necessarily cyclic isomorphic zn1 phiz therefore analyzing cycling attack elliptic curves estimate number points e p b given order cyclic group number elements order given eulers totient function namely oed general case proposition elliptic curve prime field f p number elements order equal whereomega dn2 set primes power p appears prime decomposition n furthermore given prime factorization gcde p computed probabilistic polynomial time note take proof first part proposition proved appendix second part follows millers probabilistic polynomial time algorithm finding n 1 n 2 see 17 x54 derive lower bound number elements whose order divisible large prime factor order e p b proposition elliptic curve prime field f p suppose e p b exactly divisible prime factor l p f div l p denotes number elements order divisible l p l p proof see appendix b proposition indicates randomly pick element e p b order divisible l p probability oel p l l p large probability nonnegligible ie really nearly 1 rsatype cryptosystems elliptic curves constructed groups form en b considered e p b theta e q b chinese remaindering sequel suppose e p b resp e q b contains large prime factor l p resp l q high probability random point order divisible l p resp l q therefore random point p en b represented chinese remaindering order divisible l p l q high probability discussed paragraph 42 cycling attack reduced find polynomial p integer g c attack becomes find polynomial p integer g pgc ciphertext c 2 en b equivalently formulated expression form eq 17 since order ciphertext c supposed divisible l p l q high probability must mount successful cycling attack williams schmid 31 estimated relations rarely fulfilled except k thus take care whether similarly prime q letting ord l p e smallest integer satisfying eq 20 k must multiple ord l p e consequently cycling attack useless ord l p e large note 1 fast generation algorithm secure keys maurer 15 suggested verify e l p gamma1r ip 6j 1 mod l p p prime decomposition l p gamma 1 criteria implies ord l p e must large cycling attack applicable another method impose l contains large prime factor rp probability ord l p e divisible rp proof let l prime decomposition l p gamma 1 number elements z l p whose order divisible rp given rp rp rp l p known strong primes criteria section proven conditions preclude cycling attacks putting together theorem 4 cycling attack apply kmov secret prime p following properties p1 large prime factor l p ii ord l p e large similarly prime q theorem 5 cycling attack apply demytkos system elliptic curves f p following properties e p b large prime factor l p e p b large prime factor l 0 large similarly prime q 5 factoring rsamodulus 51 relation unconcealed message cycling attack given ciphertext c 2 en b cycling attack detects integer k satisfying equivalent messageconcealing problem message ciphertext instead cleartext e theorem 2 know fixen b e k unchanged ciphertexts c via encryption e k moreover eq 20 e k yields l p prime l p dividing e p similarly prime q number unchanged ciphertexts c larger l p l q suppose primes p q chosen e p b e q b contain large prime factor l p l q respectively may many ciphertexts c e k corresponding cleartexts covered means cycling attack really effective applicable prevent attack designer also verify ord l p e resp ord l q e large see theorems 4 5 52 factoring means fixed points section 4 explained cycling attack recover plaintext show knowledge unchanged ciphertext enables still ie completely break system factoring rsamodulus illustrated elliptic curve factoring method ecm 13 introduced lenstra basically described follows suppose n product two primes p q consider elliptic curve en b ring zn assume e p b e q b bsmooth define choose random p 2 en bnote rp en b e p b theta e q b p q unknown mentioned section 2 points realizable en b group computation rp step three situations oc cur r r cases ii denominator chordandtangent formulas see eq 2 nontrivial factor n n factored case iii rp correctly computed obtain n found reiterate process another point p parameters b let ord p p ord q p order point p e p b e q b spectively let prime write ord p hence know integer r form must en b f p 6 f q without loss generality f define r equivalently find nontrivial factor n similarly ecm messageconcealing problem cycling attack due presence fixed points p 2 en b messageconcealing problem cycling attack knowledge fixed point p gives r gamma conditions ecm rsamodulus factored probability follows step choose prime power factor r gamma 1 ie step 3 compute r 0 p en b error occurs ie eq 22 satisfied 4 n factored otherwise go step 2i go step 1 next theorem says probability factoring rsamodulus using one iteration method theorem 6 consider kmov demytkos system let e prime let fl denotes probability f p f q 2 know fixed point p 6 r gamma r gamma 1 divisible factor rsamodulus probability least fl proof see appendix c assume example 05 know point p 2 probable case algorithm find secret factors n probability least 15 otherwise reiterate algorithm another prime factor r gamma 1 53 remark efficiency reconsider cycling attack e k n eq 20 k must multiple ord l p e ord l q e apply attack however ultimately need factor modulus n find integer r 0 example q mod q see eq 22 equivalently q means cycling attack modulo p modulo q rather modulo primes simultaneously enables factor n therefore k needs multiple ord l p e ord l q e results higher probability success 6 concluding remarks section 4 proved conditions theorems 4 5 fulfilled cycling attacks useless elliptic curvebased rsa systems elliptic version wellknown strong primes criteria rsa rivest silverman 25 claimed criteria required said strong primes offer little protection beyond offered random primes analyze accurately valid assertion remains valid elliptic curvebased systems analogue theorems 4 5 original rsa theorem 7 let pq rsa modulus let e public encryption exponent cycling attack apply rsa secret prime p following properties large prime factor l p ii l large prime factor r p cf note 1 similarly prime q prime p satisfying conditions ii previous theorem said strong prime authors also recommend iii p 1 large prime factor condition iii required order protect algorithm 30 paper rivest silverman consider primes p q take account second condition theorem 7 5 analysis based previous work knuth trabbpardo 11 see also 22 pp 161163 rigorously calculated distribution largest second largest prime factors random numbers also tabulated table 1 proportion aeff large numbers n whose largest prime factor n 1ff ff 15 20 25 30 40 50 60 80 precisely quantify large means theorem 7 order prevent cycling attacks cycling attack remains find integer k mod n ciphertext c e public encryption key rsamodulus k plaintext corresponding c given mod n however noticed x53 suffices mount cycling attack modulo p instead modulo n factor rsamodulus rsa secret prime factors recovered follows suppose exists integer k c e k give p hence knowing p q secret key computed plaintext given eqs 17 20 l p denotes largest prime factor must probability multiple ord l p e apply cycling attack modulo thus k ord l p e probability least 1 gamma 1l p knuth trabbpardos results derive typical integer k look note average case analysis makes sense since distribution largest prime factor second largest prime factor monotone average size l p similarly average size largest prime factor r p l note suppose l behave like random numbers assumption confirmed experimental results using lidia package 14 1 000 000 random 100bit primes l p 423 smooth number proportion 0000423 10 gamma337 compared average size second largest prime factor r 0 p l divides see note 1 probability least 1 gamma 1l 512bit rsa modulus probability already greater greater modulus summary table 2 lower bound k typical value k c e k mod p tbit rsa modulus 512 bits 768 bits 1024 bits lower albeit high estimation bound k see table 2 quite pessimistic practice k much larger k cycling attack modulo p thus fewer chances effective indeed take account third largest prime r 00 p l p k r p r 0 probability least example 1024bit rsa modulus probability least importantly take account largest prime factor l p p second largest prime factor average size ciphertext c order divisible l p l 0 probability least 1 gamma 1l therefore eq 17 see also eq 20 k likely ie probability multiple lcmord l p e ord l 0 e largest prime factor p l 0 average size l 0 probability least 1 gamma 1p 0210 example 1024bit rsa modulus probability least 1 consequently k expected large cycling attack thus little chance successful hasses theorem 27 theorem 11 indicates e p b 2 p thus consider e p op p bitsize therefore theorems 4 5 previous discussion still applies elliptic curvebased cryptosystems conclusion rivest silverman remains valid ie use strong primes offers quasi additional security cycling attacks however remarked pinch 21 user might intentionally choose weak rsamodulus suppose user chooses public rsamodulus cycling attack possible case user repudiate document asserting intruder discovered chance probability cycling attack negligible weakness use strong primes imposed standards 8 arguments cannot used contesting documents court conclusion mathematical point view strong primes needed may useful purposes eg legal issues hand since generation strong primes little bit time consuming reason use acknowledgments grateful jeanmarc couveignes providing useful comments previous version work also thank markus maurer teaching us use lidia notes 1 oen eulers totient function denotes number positive integers greater relatively prime n 2 note expression slightly differs eq 11 eq 11 counts number xfixed points count number xcoordinates unchanged demytkos encryption 3 condition equivalent e g permutation map see lemma 1 4 r 0 p 6 op mod p r 0 5 see 25 p 17 suppose r divide orde mod n note also typo n replaced n 6 probability l p divides ord z c see note 1 r factoring via superencryption security number theoretic cryptosystems random attack new elliptic curve based analogue rsa strong rsa keys strong primes easy find critical remarks publickey cryptosystems international organization standardization elliptic curve cryptosystems new publickey schemes based elliptic curves ring zn analysis simple factorization algorithm efficient cryptosystems elliptic curves based product formfree primes lidia group fast generation secure rsamoduli almost maximal diversity fast generation prime numbers secure publickey cryptographic param eters elliptic curve public key cryptosystems handbook applied cryptography use elliptic curves cryptography protocol failures cryptosystems using carmichael numbers publickey encryption systems prime numbers computer methods factorization remarks proposed cryptanalytic attack critical remarks publickey cryptosystems strong primes needed rsa method obtaining digital signatures publickey cryptosystems arithmetic elliptic curves fast generation random preliminary comment remarks concerning tr strong primes easy find use elliptic curves cryptography fast generation secure rsamoduli almost maximal diversity prime numbers computer methods factorization 2nd ed new elliptic curve based analogue rsa method obtaining digital signatures publickey cryptosystems handbook applied cryptography new publickey schemes based elliptic curves ring zn using carmichael numbers public key encryption systems