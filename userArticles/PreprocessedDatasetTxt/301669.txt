modified cholesky algorithm based symmetric indefinite factorization given symmetric necessarily positive definite matrix modified cholesky algorithm computes cholesky factorization permutation matrix e perturbation chosen make ae positive definite aims include producing smallnormed e making ae reasonably well conditioned modified cholesky factorizations widely used optimization propose new modified cholesky algorithm based symmetric indefinite factorization computed using new pivoting strategy ashcraft grimes lewis analyze effectiveness algorithm theory practice showing algorithm competitive existing algorithms gill murray wright schnabel eskow attractive features new algorithm include easytointerpret inequalities explain extent satisfies design goals fact implemented terms existing software b introduction modified cholesky factorization widely used technique optimization used dealing indefinite hessians newton methods 11 21 computing positive definite preconditioners 6 20 given symmetric matrix modified cholesky algorithm produces symmetric perturbation e e positive definite along cholesky ldl factorization ae objectives modified cholesky algorithm stated follows 21 o1 suciently positive definite e zero o2 indefinite e much larger positive definite appropriate norm o3 matrix reasonably well conditioned o4 cost algorithm cost standard cholesky factorization highest order terms two existing modified cholesky algorithms one gill murray wright 11 section 4422 refinement earlier algorithm gill murray 10 algorithm schnabel eskow 21 purpose work propose alternative modified cholesky algorithm advantages existing algorithms outline approach compute symmetric indefinite factorization received editors april 26 1996 accepted publication revised form p gill june 4 1997 published electronically july 17 1998 research second author supported engineering physical sciences research council grant grh94528 httpwwwsiamorgjournalssimax19430289html department mathematics university manchester manchester m13 9pl england chengshmamanacuk nanhighamnanetornlgov p permutation matrix l unit lower triangular block diagonal diagonal blocks dimension 1 2 provide factorization f chosen f hence also e positive definite 1 approach new suggested sorensen 19 use factorizations computed bunchkaufman 3 bunchparlett 4 pivoting strategies however neither pivoting strategies conditions satisfied recognized 19 bunchparlett pivoting strategy requires 3 comparisons nn matrix condition o4 hold bunchkaufman strategy requires 2 comparisons dicult satisfy conditions o1o3 explain section 3 use new pivoting strategy symmetric indefinite factorization devised ashcraft grimes lewis 2 conditions o1o3 satisfied within factors depending n cost pivot searches usually negligible describe socalled bounded bunchkaufman bbk pivoting strategy properties next section two reasons algorithm might preferred gill mur ray wright schnabel eskow henceforth denoted gmw algorithm se algorithm respectively first pragmatic one make use available implementation symmetric indefinite factorization bbk pivoting strategy needing add small amount postprocessing code form modified cholesky factorization particular use ecient implementations dense sparse matrices written ashcraft grimes lewis 2 make extensive use levels 2 3 blas eciency highperformance machines contrast coding gmw se algorithms one must either begin scratch make nontrivial changes existing cholesky factorization code second attraction approach priori bounds explain extent conditions o1o3 satisfiedessentially l well conditioned excellent modified cholesky factorization guaranteed gmw se algorithms dicult describe circumstances algorithms guaranteed perform well 2 pivoting strategies interested symmetric indefinite factorizations computed following way symmetric matrix r nn nonzero find permutation integer chosen factorize ns strictly 12 cholesky factorization since allow f 2 2 diagonal blocks since blocks positive definite seems reasonable use term modified modified cholesky algorithm 1099 process repeated recursively n n schur complement yielding factorization 11 completion factorization costs n 3 3 operations cost cholesky factorization positive definite matrix plus cost determining permutations bunchparlett pivoting strategy 4 searches whole submatrix stage requiring total 3 comparisons yields matrix l whose maximum element bounded 2781 bunchkaufman pivoting strategy 3 used symmetric indefinite factorization lapack 1 linpack 7 searches two columns stage requires 2 comparisons total bunchkaufman pivoting strategy yields backward stable factorization 16 l unbounded even relative makes pivoting strategy unsuitable use modified cholesky algorithm reasons explained section 3 describe bbk pivoting strategy 2 suces describe pivot choice first stage factorization algorithm bbk bbk pivoting strategy algorithm determines pivot first stage symmetric indefinite factorization applied symmetric matrix r nn maximum magnitude subdiagonal entry column 1 nothing stage factorization 11 1 use 11 1 1 pivot else repeat r row index first subdiagonal entry maximum magnitude column r maximum magnitude odiagonal entry column r rr r use rr 1 1 pivot rows columns 1 r else use ii ri ri rr 2 2 pivot columns 1 2 r else pivot chosen repeat loop algorithm bbk searches odiagonal element ri simultaneously largest magnitude rth row ith column uses element build 2 2 pivot search terminates prematurely suitable following properties noted 2 readily verified using property 2 2 pivot satisfies ii ri ri rr 1 every entry l bounded max11 1 278 2 every 2 2 pivot block ii satisfies 2 ii 3 growth factor factorization defined way gaussian elimination bounded way bunchkaufman pivoting strategy namely 1 since value increases strictly one pivot step next search algorithm bbk takes n steps cost searching intermediate cost bunchkaufman strategy bunchparlett strategy matrices known entire remaining submatrix must searched step case cost bunchparlett strategy however ashcraft grimes lewis 2 found numerical experiments average less 25k comparisons required find pivot k k submatrix give probabilistic analysis shows expected number comparisons less ek 2718k matrices independently distributed random elements therefore regard symmetric indefinite factorization bbk pivoting strategy similar cost cholesky factorization recognizing certain rare cases searching overhead may increase operation count 50 symmetric indefinite factorization bbk pivoting strategy backward stable rounding error analysis bunchkaufman pivoting strategy applicable 2 16 modified cholesky algorithm next section corresponding analysis tied exclusively bbk pivoting strategy could use instead fast bunchparlett pivoting strategy 2 appears ecient bbk strategy implemented block form 2 mention passing block implementation se algorithm developed dayde 5 alternatively could use one pivoting strategies 8 9 3 modified cholesky algorithm begin defining distance symmetric matrix r nn symmetric matrices minimum eigenvalue min least 0 distances 2 frobenius norms perturbations achieve easily evaluated cf 12 thms 21 31 theorem 31 let symmetric matrix r nn spectral decomposition frobenius norm unique optimal perturbation 31 given modified cholesky algorithm 1101 2norm optimal perturbation frobenius norm perturbation 32 also optimal 2norm modified cholesky algorithm parameter 0 attempts produce perturbation 32 algorithm mc modified cholesky factorization given symmetric matrix r nn parameter 0 algorithm computes permutation matrix p unit lower triangular matrix l block diagonal matrix diagonal blocks dimension 1 2 ae symmetric positive definite symmetric positive semidefinite algorithm attempts ensure min min e 1 compute symmetric indefinite factorization pap using pivoting strategy 2 let minimum frobenius norm perturbation achieves min thus ii minimum frobenius norm perturbation achieves min ii extent algorithm mc achieve objectives o1o4 listed section 1 objective o4 clearly satisfied provided pivoting strategy require large amount searching since cost step 2 negligible objectives o1o3 satisfied need eigenvalues reasonably well approximated bunchkaufman pivoting strategy elements l unbounded eigenvalues dier greatly subject inertia easily shown example essential reason bunchkaufman pivoting strategy unsuitable use modified cholesky algorithm investigate objectives o1o3 make use theorem ostrowski 18 p 224 eigenvalues symmetric nn matrix ordered n theorem 32 ostrowski let r nn symmetric r nn nonsingular assuming first min 0 applying theorem e zero min certainly true next assume min negative apply theorems 31 32 obtain using theorem 32 34 yields final invocation theorem 32 gives e min min min hence e assess well objectives o1o3 satisfied satisfy objective o1 would like e zero min satisfy o2 would like e 2 much larger min positive definite sucient condition 33 e zero inequality 35 show conditions hold modulo factors maxmin inequality 36 bounds 2 ae expected reciprocal dependence terms maxmin conclusion modified cholesky algorithm guaranteed perform well far 1 note since l unit lower triangular e implies 1 bbk pivoting strategy furthermore using bound 15 thm 813 prob 85 upper bounds approximately attainable practice rarely approached particular upper bound 38 approached unlikely event subdiagonal elements l negative near maximal magnitude note causes subdiagonal element l i1i zero reduces likelihood l large analysis exploited fact extent eigenvalues agree bounded terms condition l l well conditioned singular values close moduli eigenvalues currently exploring application fact computation rankrevealing factorizations modified cholesky algorithm 1103 4 comparison gmw se algorithms gmw se algorithms carry steps cholesky factorization symmetric matrix r nn increasing diagonal entries necessary order ensure negative pivots avoided actually gmw algorithm works ldl factorization diagonal dierence irrelevant discussion hence algorithms produce cholesky factors p ep diagonal e theorem 31 note optimal perturbation objective o2 section 1 general full frobenius norm taken diagonal 2norm generally unique seems particular advantage making diagonal perturbation algorithm perturbs whole matrix general construction gmw se algorithms make perturbations e bounded priori functions n gmw algorithm produces perturbation e 0 tolerance u unit roundo 11 p 110 se algorithm perturbation bounded terms certain eigenvalue bound obtained applying gershgorins theorem tolerance suggested 21 chosen quantity satisfies n 42 smaller bound 41 factor n bounds 41 42 compared 35 algorithm mc bound 35 advantage directly comparing perturbation made algorithm mc optimal one defined 31 evaluated theorem 31 potentially much smaller bound 41 42 min max 2 large hand bound 35 much larger 41 42 2 large three algorithms satisfy objective o1 modifying suciently positive definite matrix though gmw se algorithms condition analogous 33 quantifies suciently terms min available bounds exponential n hold gmw se algorithms 21 true algorithm mc see 3638 summarize terms objectives section 1 modified cholesky algo rithm algorithm mc theoretically competitive gmw se algorithms weakness 2 large bound e 2 weak applied indefinite matrix gmw se algorithms provide information enables direction negative curvature matrix produced directions required certain algorithms unconstrained optimization order move away nonminimizing stationary points indefinite matrix algorithm mc provides immediate access direction negative curvature 1104 sheung hun cheng nicholas j higham computed step 1 l bounded direction satisfies conditions required convergence theory 19 finally consider behavior algorithms presence rounding errors algorithm mc backward stable underlying factorization 2 barring large element growth symmetric indefinite factorization bbk pivoting strategy algorithm produces ldl factors p constant although comments numerical stability given 11 21 simple argument shows gmw se algorithms backward stable apply either algorithm obtaining cholesky factorization p apply algorithm p aep need modify p aep return computed r factor since modification required algorithm must carried standard cholesky factorization since cholesky factorization backward stable process modified cholesky algorithm must backward stable 5 numerical experiments experimented matlab implementations algorithm mc gmw se algorithms mfile gmw algorithm provided wright sets tolerance value matlabs variable eps mfile se algorithm provided e eskow sets tolerance algorithm mc set ua aims experiments follows see well frobenius norm perturbation e produced algorithm mc approximates distance f defined 31 compare norms perturbations e condition numbers produced three algorithms measure perturbations e ratios f min dier normalization choice norm algorithm mc attempts make r f close 1 quantity r 2 used schnabel eskow compare performance gmw se algorithms since e diagonal algorithms r 2 compares amount added diagonal minimum diagonal perturbation makes perturbed matrix positive semidefinite first note experiments schnabel eskow 21 show se algorithm produce substantially smaller value r 2 gmw algorithm schnabel eskow also identified 4 4 matrix gmw algorithm significantly outperforms se algorithm 15383 2849 27066 give results matrix table 51 show algorithm mc also significantly outperform se algorithm ran set tests similar schnabel eskow 21 matrices form eigenvalues one modified cholesky algorithm 1105 table measures e 4 4 matrix 51 mc gmw se matrix n25 eig range110000 matrix c n25 eig range11 matrix eig range100001 matrix eig range110000 matrix n25 eig range11 f n25 eig range100001 fig 51 measures e mc three random uniform distributions 1 10 4 1 1 10 4 1 first range one eigenvalue generated range 1 0 ensure least one negative eigenvalue matrix q random orthogonal matrix haar distribution generated using routine qmult test matrix toolbox 14 implements algorithm stewart 22 eigenvalue distribution generated dierent matrices corresponding fresh sample q took 100 ratios r f r 2 plotted figures 5153 figure 54 plots condition numbers 2 condition numbers show similar behavior table 52 reports number comparisons used bbk pivoting strategy matrices n maximum number comparisons less n 2 case figure 55 report results three nonrandom matrices test matrix 1106 sheung hun cheng nicholas j higham matrix n50 eig range110000 matrix c n50 eig range11 eig range100001 matrix eig range110000 matrix n50 eig range11 matrix f n50 eig range100001 fig 52 measures e mc table number comparisons bbk pivoting strategy n mean 3439 14328 59984 toolbox clement tridiagonal matrix eigenvalues plus minus numbers n 1 n 3 n 5 1 0 dingdong symmetric nn hankel matrix whose eigenvalues cluster around 2 2 ipjfact hankel matrix conclusions experiments follows 1 none three algorithms uniformly better others terms producing small perturbation e whichever measure r f r 2 used three algorithms produce values r f r 2 significantly greater 1 depending problem 2 algorithm mc often achieves aim producing r f 1 produced r f eigenvalue distribution 1 n values 2 shown approximately 100r f case modified cholesky algorithm 1107 matrix n100 eig range110000 matrix c n100 eig range11 eig range100001 matrix eig range110000 matrix n100 eig range11 matrix f n100 eig range100001 fig 53 measures e mc however often r f order 1 large value 2 necessary condition sucient one poor performance algorithm mc words bounds section 3 weak 3 condition numbers 2 ae vary greatly among algorithms experience ua algorithm mc fairly consistently produces condition numbers order 100 u condition number predicted 36 much smaller random matrices eigenvalues range algorithm attempts perturb eigenvalues condition numbers produced gmw se algorithms vary greatly type matrix fact r f close 1 random matrices eigenvalues range 10 4 1 algorithm mc easily explained let negative definite algorithm mc computes p hence matrix n25 eig range110000 matrix eig range11 matrix c n25 eig range100001 fig 54 condition numbers 2 e gmw se mc using 37 r f exceed 1 tiny amount algorithm mc applied negative definite matrix irrespective 2 6 concluding remarks algorithm mc based symmetric indefinite factorization bounded bunchkaufman pivoting strategy merits consideration alternative algorithms gill murray wright schnabel eskow results section 5 suggest new algorithm competitive gmw se algorithms terms objectives o1o4 listed section 1 algorithm mc advantages extent satisfies objectives neatly although sharply described bounds section 3 implemented augmenting existing software small amount additional code since three modified cholesky algorithms fail produce unacceptably large perturbations natural ask failure detected done gmw se algorithms produce diagonal modified cholesky algorithm 1109 clementn1 c dingdongn dingdongn f ipjfactn1 fig 55 measures e three nonrandom matrices key gmw se mc perturbations explicitly trivial evaluate norms algorithm mc perturbation see would require operations form explicitly however estimate e using norm estimator 13 implemented lapack estimator requires formation products ex certain vectors x computed 2 operations estimate produced lower bound nearly always within factor 3 true norm three algorithms inexpensively test whether perturbation produced acceptably small unfortunately none algorithms obvious way improve modified cholesky factorization makes big perturbation whether improvement possible preferably cheaply open question course one always resort computing optimal perturbation computing eigensystem using formulae theorem 31 note approached problem modified cholesky factorization purely linear algebra perspective important test modified cholesky algorithm evaluate optimization code representative problems done schlick 20 gmw se algorithms plan algorithm mc future work finally mention generalization modified cholesky problem motivated constrained optimization analyzed detail 17 r accurate symmetric indefinite linear equation solvers stable methods calculating inertia solving symmetric linear systems direct methods solving symmetric indefinite systems linear equations society industrial applied mathematics factorization sparse symmetric indefinite matrices direct solution sets linear equations whose matrix sparse computing nearest symmetric positive semidefinite matrix fortran codes estimating onenorm real complex matrix test matrix toolbox matlab version 30 accuracy stability numerical algorithms stability diagonal pivoting method partial pivoting modifying inertia matrices arising optimiza tion matrix analysis modified cholesky factorizations sparse preconditioners new modified cholesky factorization tr