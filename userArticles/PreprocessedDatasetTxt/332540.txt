reconstructing distances physical maps chromosomes nonoverlapping probes present new method reconstructing distances probes physical maps chromosomes constructed hybridizing pairs clones socalled samplingwithoutreplacement protocol protocol simple inexpensive used successfully map several organisms equallength clones hybridized clonesubset called probes probes chosen sequential process designed generate pairwisenonoverlapping subset clones derive likelihood function probe spacings orders protocol natural model hybridization error describe reconstruct likely spacing given order objective using continuous optimization approach tested simulated data real data chromosome vi aspergillus nidulans simulated data recover true order close true spacing real data true order spacing unknown recover probe order differing significantly published one knowledge first practical approach computing globallyoptimal maximumlikelihood reconstruction interprobe distances cloneprobe hybridization data b introduction physical mapping molecular biology task reconstructing order location features biological interest along chromosome features may corresponding author department computer science university georgia athens ga 306027404 email kececsugaedu research supported national science foundation career award dbi9722339 department statistics university georgia athens ga 30602 email sanjaystatugaedu z department genetics university georgia athens ga 30602 email arnoldgeneticsugaedu sites restriction enzymes cut socalled sequence tagged sites identified short uniquelyoccurring sequences positions clones contain fragments chromosome diverse array approaches constructing maps features depending type data collected including mapping nonunique probes 2 18 mapping unique probes 1 11 12 mapping unique endprobes 7 mapping nonoverlapping probes 8 mapping restrictionfragment length data 10 13 radiationhybrid mapping 24 5 optical mapping 21 14 16 many probabilistic analyses various approaches 15 4 28 27 26 wide variety computational techniques employed suggested including greedy algorithms 18 simulated annealing 20 25 2 1 linear programming 7 12 8 semidefinite programming 6 paper develop maximumlikelihood approach type physical mapping known sampling withoutreplacement protocol protocol inexpen sive simple carry lab uses widelyavailable technology organisms mapped technique include schizosaccharomyces pombe 19 aspergillus nidulans 22 pneumocystis carinii 3 mapping projects progress using technique include neurospora crassa aspergillus flavus protocol library l consisting many overlapping clones sample fragment chromosome developed clones l sizeselected target length arrayed plate subset clones called probe set p obtained following sequential process initially l ith iteration process choose clone p random remove p add p hybridize p clones library extracting complementary dna ends washing dna arrayed plate recording clones library dna sticks remove clones library positive hybridization result p repeat process next iteration stopping becomes empty call final set p probe set set clone set results experiments summarized probeclone hybridization matrix h records outcomes hybridizations probes p clones c notice clone c overlaps probe p chromosome must overlap one ends p j probes clones length overlap corresponds portion dna common clone end probe absence error complementary dna end p j stick c hybridization test p j versus c positive result thus clone c removed set jth iteration implies absence error probe set p maximal nonoverlapping subset library suppose hybridization matrix h enough cloneprobe overlap structure represented recover order probes p across chromosome every consecutive pair probes p q der examine h presence linking clone c overlaps p q probe set p together linking clone every consecutive pair forms minimal set clones cover chromosome map giving order probes across chromosome useful since individually sequencing probes linking clones overlapping sequences order given map reconstruct dna sequence chromosome reality hybridization tests perfectly record overlap structure probes clones hybridization results contain random false positives false negatives probe also hybridize nonoverlapping clone due repeated dna chromosome general clones chimeric means sample two fragments chromosome contain deletions happens portions dna get spliced cloning mapping projects using protocol university georgia however clones produced cos mids small enough chimerism deletions significant problem treatment model false positives false negatives chimerism dele tions repeats hence false hybridizations due repeats treated series isolated false positives related work prior work mapping sampling withoutreplacement protocol cuticchia arnold timberlake 9 wang prade griffith timberlake arnold 25 mott grigoriev maier hoheisel lehrach 20 largely used localsearch heuristics simulated annealing try find probe order minimizes hammingdistance travelingsalesman objective minimizing objective known optimize natural measure goodness map xiong chen prade wang griffith timberlake arnold 27 shown certain assumptions distribution clones hammingdistance objective statistically consistent means number clones goes infinity exact algorithm hammingdistance traveling salesman problem would recover correct probe order probability one christof kececioglu 8 recently showed problem computing maximumlikehood probe order samplingwithoutreplacement protocol presence falsepositive negative hybridization error reduced problem finding minimum number ones change zeroes hybridization matrix h resulting matrix h 0 2 ones per row consecutiveones property rows showed formulate problem integer linear program developed branchandcut algorithm computing optimal maximumlikelihood probe order using ap proach able compute optimal probe orders realisticsized instances simulated data probe orders significantly fewer false positives real data bestpossible map obtainable hammingdistance travelingsalesman approach paper complement work 8 developing practical method computing globallyoptimal maximumlikelihood reconstruction interprobe distances given probe order plan paper next section give maximum likelihood formulation problem mapping samplingwithoutreplacement protocol presence false positive false negative error call mapping nonoverlapping probes problem unique goal reconstruct likely order spacing probes along map hybridization data section 3 derives likelihood function probe orders spacings formulation remarkably simple closed form section 4 explains tackle maximization function fixed probe order using continuous optimization section 5 presents results experiments preliminary implementation approach conclude several directions research 2 problem maximum likelihood formulation model sequential process choosing probes hence operate assumption probes form nonoverlapping set write fp1 png set set clones formulate problem follows task recover probe order probe spacing illustrated figure 1 given theta n cloneprobe hybridization matrix containing false positive false negative errors permutation gives names probes lefttoright order across chromosome vector x gives distance beween consecutive probes component x j distance left end p j right end p jgamma1 matrix 01 matrix ae hybridizes c 0 otherwise assume clones length probes nonoverlapping know ffl l length chromosome ffl length clone ffl ae probablility entry h corrupted false positive ffl j probability entry h false negative stated wellposed problem presence false positives negatives permutation ng positive vector x explanation data obtain welldefined problem invoke principle maximum likelihood says best reconstructed map x likely given rise h write p x probability x true order spacing given observed matrix h maximum likelihood reconstruction pair x maximizes p x j h take following definition problem mapping nonoverlapping probes mapping nonoverlapping probes problem fol lowing input cloneprobe hybridization matrix h chromosome length l clone length false positive probability ae false negative probability j output probe order probe spacing pair x maximize p x assumption probes collection nonoverlapping clones clones equal length left ends clones uniformly distributed across chromosome entries h independently corrupted false positive probability ae false negative probability j 2 derive function p x using bayes theorem equation ph j x probability observing h given x true order spac ing p x probability x occur na ture ph probability observing h 1 since e ex ph j e e x pe exdex denominator constant independent x ignored since names given probes spaces probes independent p names assigned probes completely randomly independent also ignored thus relevant quantities ph j x px probability density function px probe spacings uniform factor ignored well model considered yet know density function px appear uniform concentrate instead deriving function ph j x take maximizing objective differ truly maximizing p x according bias due px next derive function ph j x simplest process h generated x false positives negatives process three stages 1 clone thrown uniformly independently across chromosome 2 row hybridization matrix corresponding given clone probes clone overlaps get one column zeros placed everywhere else 3 ones zeros corrupted randomly independently probability j ae respectively 3 objective function derive ph j x model notice row h independent rows since clone thrown independently entry independently corrupted writing h ith row h suffices values taken underlying random variables pi x write p x shorthand x furthermore since discrete variable x continuous variable write p x joint probability density function discrete continuous random variable evaluated x work ph j x since 1im derive ph j x notice absence error three possible types overlaps occur given clone c illustrated figure 2 1 clone c overlaps probe left end clone c falls left ends probes p overlaps neither p j p c falls left p 1 overlap write 1 c falls right pn overlap write c 2 n 2 clone c overlaps exactly one probe overlaps probe p j write c overlaps exactly two probes overlaps probe p j p j1 appendix derive ph j x summing disjoint events c 2 n j note domain probe order permutation set permutations f1 domain r n spacing vector x set 1in summarize derivation following theorem theorem 1 objective function hybridization matrix 1im coefficients ij given equations 2 5 appendix define 1in fixed probe order given equation 1 2 words evaluate following objective function permutations recover minimizing x given reduce continuous problem maximizing ph j x discrete search permutation minimizes g 2 describe tackle evaluation g 2 note solve problem finding pair x maximizes p x j h objective f x missing term gamma ln px know density function px figure 1 problem reconstruct probe order permutation probe spacing vector cloneprobe hybridization matrix h probe set fp1 png chosen form nonoverlapping subset clones clones sizeselected length b c figure 2 three possible types cloneprobe overlaps c 2 n 4 evaluating objective fixed permutation section fixed let us write fx f x define 1im show f convex certain convex regions greedy procedure gradient descent find global minimum f region describe choose regions explain find direction greatest decrease f constrained region gradient descent procedure readable summary facts optimization use given lengauer 17 41 convexity recall set c r n convex set points p q c 0 1 point p 1gammaq c function r defined convex set c convex function points p q c 0 1 informally convex function bowlshaped let us call region c good points x 2 c 1 defined theorem 1 relevance good regions regions throughout fx differentiable good region c consider points ray traced moving point p 2 c direction along ray derivative f welldefined equal ds ds ds 1jn udelta denotes unit step function taking second derivative along ray yields ds ds 1im ds f x 0 implies every convex region c good function f convex key property convex functions local minimum convex function f convex set c global minimum f c 17 thus divide small number good convex regions suffices apply region algorithm guaranteed find local minimum best local minima global minimum f regions consider four regions d11 gamma1gamma1 regions correspond constraining interior distances probes forcing exterior distances x1 xn1 one side region intersection halfspaces hence convex set interior good region ray originating interior make appropriate choice derivative boundary derivative along ray continuous throughout region thus find global minimum four regions gradient descent described necessarily find global minimum f however notice function f spacing vector x modified trading distance two components way remain least value f unchanged suppose global optimum x x x component shrinking x stretching larger x 1 x n1 eventually transform x point one four regions without changing value f thus best minima four regions call ex global minimum global minima x x component x stretching x 1 x n1 shows suboptimality ex due error ex 1 ex n1 however linking clones estimate e x1 ex n1 hybridization data provides direct information reconstruct two exterior distances estimates regarded suspicion reconstruc tion thus biologist interprets output e x understanding ex component distance may exceed true map e x1 ex n1 may inaccurate reporting global optimum ex four regions reasonable 42 gradient descent gradient f point p vector grad fp xn fp kth component gradient partial derivative f respect xk evaluated udelta unit step function defined pn1 defined way xn1 basic fact multivariable calculus direction greatest decrease f p procedure known gradient descent 23 starts point p computes negative gradient direction v p moves point p 0 minimizes f along ray psv repeats stopping point reached gradient vanishes unconstrained problem minimizing f r n point local minimum since f convex gradient descent halts found global minimum unconstrained problem constrained problem however minimizing f region c r n negative gradient direction v point p boundary c may directed outside c case cannot move along v yet another direction v 0 p directed inside c may exist along f de creases albeit slower rate let us call direction v point possible move along v p remain c general feasible direction v greatest decrease f point p found follows boundaries region given constraints hyperplanes point negative gradient direction bounding hyperplanes tight let list tight hyperplanes v points outside halfspace given hyperplane h1 hk take v successively project v 0 onto h1 obtain v 1 project v 1 onto h2 obtain v 2 vector resulting final projection onto hk feasible direction greatest decrease p v p local minimum f c given feasible direction v greatest decrease compute largest value 0 f convex onedimensional problem minimizing f along p sv 2 0 solved form binary search known bisection 23 completes description approach evaluating g four regions compute global minimum constrained gradient descent using bisection take best four minima computing gradient given point takes time thetamn dominates time find best feasible direction successive projection also time compute derivatives step bisection reaching local minimum involve several gradient descent iterations iteration involve several bisection steps entire procedure expensive find good use localsearch heuristic known simulated annealing calling procedure evaluate g candidate probe order 5 preliminary results present preliminary results implementation approach written second author first experiments ran implementation simulated data parameters picked values identical chromosome vi fungus aspergillus nidulans mapped using samplingwithoutreplacement protocol 22 involved clone length chromosome length corresponds coverage nearly 13 false positive false negative probability used estimated error rates mapping project clones thrown random across chromosome uniform distribution probe set nonoverlapping clones chosen corresponding hybridization matrix h false positives false negatives generated first tested well approach recovered true spacing known simulated data running constrained gradient descent procedure true probe order summarized table 1 gradient descent started completely uniform initial spacing initial spacing obtained linear programming approximation described full pa per hope sophisticated method choosing initial spacing would lead faster convergence local minimum table 1 shows case starting uniform spacing took fewer iterations gradient descent fewer total bisection steps interesting approaches found final spacing better likelihood true spacing value 664932 measure error true spacing computed spacings used rootmeansquare error rms interestingly linear programming spacing greater initial error two exterior distances x1 xn1 wellestimated hybridization data uniform spacing happened give better estimates exterior distances computation time using either initial spacing around 5 minutes sun ultrasparc 1 167 mhz chip final rms error 37 kb roughly 9 clone length clearly limit accuracy one recover true spacing discrete data hybridization matrix essentially giving counts linking clones show every method recovering spacings must worst case rootmeansquare error least data ffl 62 kb comparison final error table 1 around 60 worstcase lower bound next tested well simulated annealing approach combined procedure evaluating f recovered true probe order started initial obtained greedy heuristic hammingdistance traveling salesman objective initial 6 breakpoints respect true initial likelihood 672845 12 hours machine simulated annealing procedure halted final equal true order final likelihood 647052 second experiments ran implementation real mapping data chromosome vi aspergillus nidu lans took around 12 hours machine computed probe order 36 breakpoints respect published order 22 obtained using simulated annealing hammingdistance traveling salesman objective 25 computed order clearly little common published order mapping data true order known 6 conclusion presented new maximumlikelihood approach reconstructing distances probes physical maps constructed hybridizing equalsized clones nonoverlapping clonesubset protocol used successfully map several organisms yields model whose likelihood function sufficiently simple permit closedform expression resulting formulation gives knowledge first practical method physical mapping hybridization data reconstruct globally optimal maximumlikelihood distances along maps table 1 recovering spacing data simulating chromosome vi aspergillus nidulans lpbased initial spacing uniform initial spacing bisection steps 185 177 gradient descent iterations 149 101 initial rms error 665 kb 566 kb final rms error 378 kb 369 kb final likelihood 661041 661053 research finding provably optimal objective appears formidable given f nonlinear attempting find good simulated annealing started random appears slow given g expensive eval uate following twostage approach may effective however 1 use combinatorial approach guaranteed performance find initial e optimizes simpler linear combinatorial objective eg 2 polish e original nonlinear objective g local search obtain final spacing x example eg could combinatorial 2consecutive ones objective christof kececioglu 8 corresponds likelihood model without probe spacings fact eg sufficiently accurate recover acceptable e one might use original objective f simply recover best spacing e suspect full f needed recover true probe order prac tice real utility likelihood function f infer probe spacings probe orders computed combinatorial methods numerical techniques used compute x 2 argmin x2d f x namely gradient descent bisection elementary would interesting investigate whether convergence x sped sophisticated numerical techniques taking f x objective equivalent maximizing ph j x p x j h implicitly assuming priori probability density function probe spacings px uniform unfortunately even distribution left ends clones uniform density function probe spacings would interesting work priori probe spacing density function natural model clone placement appears involved investigate whether inclusion likelihood objective improves recovery true spacing finally significant source error considered model repeated dna chromosome contains repeat r happens occur end probe p probe falsepositive hybridization every clone overlap p contains repeat r examination hybridization matrix chromosome vi aspergillus nidulans shows false positives appear occur completely independently across matrix appear occur frequently certain columns suggests repeats may present best incorporate repeats maximum likelihood objective interesting open problem clear appropriately model number repeat families number copies family r physical mapping chromosomes using unique probes physical mapping chromosomes combinatorial problem molecular biology constructing physical map pneumocystis genome genomic mapping anchoring random clones mathematical analysis constructing radiation hybrid maps geometric approach tweenness branchandcut approach physical mapping chromosomes unique endprobes computing physical maps chromosomes nonoverlapping probes branchandcut use simulated annealing chromosome reconstruction experiments based binary scoring algorithmic approach multiple complete digest mapping physical mapping sts hybridization algorithmic strategies challenge software evaluation algorithms computing integrating physical maps using unique probes mapping clones given ordering interleaving algorithms optical mapping genomic mapping fingerprinting random clones mathematical anal ysis estima tion restriction sites observed optical mapping using reversiblejump markov chain monte carlo combinatorial algorithms integrated circuit layout construction physical maps oligonucleotide fingerprint data 13 kb resolution cosmid map 14 mb fission yeast genome nonrandom sequencetagged site mapping algorithms software tools ordering clone libraries application mapping genome schizosaccharomyces pombe towards constructing physical maps optical mapping effective simple combinatorial approach vitro reconstruction aspergillus nidulans genome numerical recipes c building human genome maps radiation hy brids fast random cost algorithm physical mapping yond islands runs cloneprobe matrices consistency physical mapping method reconstruct chromosome vitro genome mapping nonrandom anchoring discrete theoretical analy sis tr combinatorial algorithms integrated circuit layout constructing radiation hybrid maps extended abstract algorithmic approach multiple complete digest mapping algorithms computing integrating physical maps using unique probes towards constructing physical maps optical mapping extended abstract building human genome maps radiation hybrids beyond islands extended abstract algorithms optical mapping estimation restriction sites observed optical mapping using reversiblejump markov chain monte carlo computing physical maps chromosomes nonoverlapping probes branchandcut construction physical maps oligonucleotide fingerprints data mapping clones given ordering interleaving physical mapping chromosomes using unique probes geometric approach betweenness