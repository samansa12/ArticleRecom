perturbation analyses qr factorization paper gives perturbation analyses q1 r qr factorization aq1r q1tq1i given real mtimes n matrix rank n general perturbations sufficiently small norm analyses accurately reflect sensitivity problem previous results condition numbers altered column pivoting used apq1r condition number r bounded fixed n standard column pivoting strategy used strategy also tends improve condition q1 computed q1 r probably greatest accuracy use standard column pivoting strategyfirstorder perturbation analyses given q1 r seen analysis r may approached two waysa detailed matrixvector equation analysis provides tight bound corresponding condition number unfortunately costly compute intuitive simpler matrix equation analysis provides results usually weaker easier interpret allows efficient computation satisfactory estimates actual condition number approaches powerful general tools appear applicable perturbation analysis matrix factorization b introduction qr factorization important tool matrix computations see example 4 given theta n real matrix full column rank exists unique theta n real matrix q 1 orthonormal columns unique nonsingular upper triangular n theta n real matrix r positive diagonal entries matrix q 1 referred orthogonal factor r triangular factor suppose tg unique qr factorization differentiate rt respect set given g linear equation upper triangular matrix r0 determines sensitivity rt core perturbation analysis qr factorization effectively involves use 11 determine bound r0 essentially two main ways approaching problem discuss together recent history xiaowen chang 1 2 3 first realize published results sensitivity factorizations lu cholesky qr extremely school computer science mcgill university montreal quebec canada h3a 2a7 changcsmcgillca chriscsmcgillca research first two authors supported nserc canada grant ogp0009236 department computer science institute advanced computer studies university maryland college park md 20742 usa stewartcsumdedu g w stewarts research supported part us national science foundation grant ccr 95503126 g w stewart weak many matrices originated general approach obtaining provably tight results sharp condition numbers problems call matrix vector equation approach qr factorization involves expressing 11 matrixvector equation form wr zr matrices involving elements r vecdelta transforms argument vector elements notation uvecdelta denotes variant vecdelta defined section 52 chang also realized condition many problems significantly improved pivoting provided first firmly based theoretical explanations g w stewart 11 3 stimulated changs work understand deeply present simple explanations going changs work used approach perturbation analyses factorizations call matrix equation approach keeps equations like 11 matrixmatrix form stewart 11 also see 3 used elegant construct partly illustrated low notation section 2 makes matrix equation approach far usable intuitive tool combined deep insights scaling produce new matrix equation analyses appealingly clear provide excellent insight sensitivities problems new matrix equation analyses general provide tight results like matrixvector equation analyses usually simple provide practical estimates true condition numbers obtained latter third author chris paige insisted writing brief history delineating exceptional contributions chang stewart requires combination two analyses provide full understanding cases examined interplay two approaches first revealed 3 hope convey even clearly qr factorization perturbation analysis qr factorization considered several authors first normbased result r presented stewart 9 modified improved sun 13 using different approaches sun 13 stewart 10 gave first order normwise perturbation analyses r first order componentwise perturbation analysis r given zha 17 strict componentwise analysis r given sun 14 papers also gave analyses q 1 recently sun 15 gave strict perturbation bounds q 1 alone purpose paper establish new first order perturbation bounds generally sharper equivalent results r factor 10 13 straightforward sharp result 15 q 1 factor section 2 define notation give result use throughout paper section 3 survey important key results sensitivity r q 1 section 4 give refined perturbation analysis showing simple way standard column pivoting strategy beneficial certain aspects sensitivity q 1 section 5 analyze perturbation r first straightforward matrix equation approach detailed tighter matrixvector equation approach give numerical results suggest practical condition estimators section 6 summarize comment findings section 7 perturbation analyses qr factorization 3 2 notation basics simplify presentation n theta n matrix x define upper lower triangular matrices upx general x symmetric x f gamma2 illustrate basic use show given n theta n nonsingular upper triangular r given n theta n symmetric equation form cf 11 always unique upper triangular solution u since ur gamma1 upper triangular see immediately ur gamma1 therefore u uniquely defined describe uses later perturbation bounds tighter bound separately perturbations along columns space along orthogonal complement thus introduce following notation real theta n let p 1 orthogonal projector onto ra p 2 orthogonal projector onto ra real theta n deltaa define 2 ffl 0 25 also define qr factorization use following standard result lemma 21 real theta n rank n real orthogonal projector onto ra 4 xiaowen chang chris paige g w stewart proof let qr factorization necessarily full column rank kq smallest singular value inequality 28 2 corollary 22 nonzero deltaa satisfies 28 ffl g defined 25 26 tg full column rank therefore unique qr factorization jtj ffl 2 3 previous normbased results section summarize strongest normbased results previous authors first give derivation essentially suns 13 stewarts 10 first order normwise perturbation result r since techniques results useful later theorem 31 13 let 2 r mthetan full column rank qr factorization real theta n matrix unique qr factorization proof let g j deltaaffl theorem trivial corollary 22 atg unique qr factorization jtj ffl notice easy verify q 1 rt twice continuously differentiable ffl algorithm qr factorization thus 11 see 24 linear equation uniquely defining elements terms elements q g upper triangular r0r gamma1 see 21 perturbation analyses qr factorization 5 23 since 25 27 kq taylor expansion rt combined 38 gives 32 2 proof shows key point deriving first order perturbation bound r use 35 give good bound sensitivity k obtained bounds directly 37 matrix equation analysis show recent perturbation result q 1 given sun 15 obtained present setting since analysis easily extended obtain refined result simple way note hypotheses following theorem theorem 31 use results latter theorem theorem 32 15 let 2 r mthetan full column rank qr factorization real theta n matrix holds deltaa unique qr factorization proof let g j deltaaffl theorem trivial corollary 22 atg unique qr factorization jtj ffl differentiating follows q 2 q 6 xiaowen chang chris paige g w stewart using 21 37 theorem 31 see 22 311 kgk 27 f taylor expansion kdeltaq 1 4 refined analysis q 1 note since q 1 orthonormal matrices 31 deltaq 1 small deltaq following analysis assumes n 1 results sun 15 give good possible overall bounds change deltaq 1 q 1 looking deltaq 1 distributed orthogonal complement following ideas theorem 32 able obtain result tight unlike related tight result 15 easy follow makes clear exactly illconditioning lies 314 square orthogonal key bound first term right separately second note 311 25 27 g chosen give equality given hence true condition number part deltaq 1 rq 2 part deltaq 1 rq 1 see 312 skew symmetric clearly zero diagonal let r j j denote leading blocks r respectively g j matrix first j columns g perturbation analyses qr factorization 7 j j1 elements upper triangular form r 42 ks ks f r ngamma1 equality obtained taking kr gammat follows bound tight true condition number part deltaq 1 rq 1 problems mainly interested change q 1 lying rq 1 result shows bound smaller previously thought particular one small singular value use standard column pivoting strategy computing qr factorization r ngamma1 quite wellconditioned compared r kr gamma1 5 perturbation analyses r section 3 saw key deriving first order perturbation bounds r qr factorization full column rank equation 35 general form finding bounding x terms given r f matrix equation upper triangular r nonsingular sun 13 stewart 10 originally analyzed using matrix equation approach give result theorem 31 analyze two new ways first stewarts 11 3 refined matrix equation approach gives clear improvement theorem 31 second changs 2 3 matrixvector equation approach gives improvement still provably tight bounds leading true condition number r r qr factorization approaches provide efficient condition estimators see 2 matrixvector equation approach nice results special case permutation matrix giving standard column pivoting derive matrix equation versions tighter complicated matrixvector equation analysis case pivoting given 2 results quoted 51 refined matrix equation analysis r proof theorem 31 used 35 produce matrix equation 37 derived bounds directly look approach closely first using general form 51 keep thinking clear see 8 xiaowen chang chris paige g w stewart let n set n theta n real positive definite diagonal matrices r note matrix b upbd hence define b r r gammat f r obvious notation upper triangular matrix bound use following result lemma 51 n theta n b 2 n 1ijn proof clearly cauchyschwarz theorem bound solution x 51 since true 2 n know upper triangular solution x defined 54 gives encouraging result 5 perturbation analyses qr factorization 9 comparing 35 51 see qr factorization 25 27 hence 39 change 511 never worse bounds theorem 31 use standard column pivoting strategy permutation matrix analysis leads nice result elements r r 2 nn diagonal r 1 59 follows 6 theorem 813 since k thus use standard pivoting strategy see sensitivity r bounded n remark 51 clearly potential candidate condition number r qr factorization 59 depends solely r true condition number nonsingular upper triangular r find f 51 giving equality 58 57 true every column f lies space right singular vectors corresponding maximum singular value r gammat restriction general strong 56 made equality well see lead 55 however class r possible r diagonal take first restriction f disappears let j g w stewart see least diagonal r bounds tight restricted case true condition number refined matrix equation analysis shows extent solution x 51 sensitivity r qr factorization dependent row scaling r term r gammat f 52 saw multipliers occurred j result obtained bounds rather equality minimum element comes maximum diagonal thus obtained full cancellation gamma1 first term right hand side 52 partial cancellation second gives insight r qr factorization less sensitive earlier condition estimator indicated illconditioning r mostly due bad scaling rows correct choice r give 2 near one time large r 510 much smaller pivoting always ensures exists fact gives 514 however use pivoting remark 51 suggests relatively small earlier elements diagonal r could correspond poor conditioning factorization return r seek practical estimates true condition number derive next section 52 matrixvector equation analysis r obtain provably sharp less intuitive results viewing matrix equation 51 large matrixvector equation matrix c nthetan denote c j vector first elements c j define u denotes upper c 1c 2delta c n vector formed stacking columns upper triangular part c one long vector analyze 35 consider general form 51 repeated clarity upper triangular r nonsingular saw via 24 unique upper triangular solution x upper lower triangular parts 51 contain identical information write upper triangular part matrixvector rather matrixmatrix format first j elements jth column 515 given r f jtf jtdelta f jt perturbation analyses qr factorization 11 rewriting see solve x j r r 1t r j gamma1t r r jt r jt dividing last row 2 gives 2 theta nn1 r 11 zr 2 r nn1 r 11 since r nonsingular wr also 516 r zr vecf remembering x upper triangular see r zr vecf k 2 nonsingular upper triangular r equality obtained choosing vecf lie space spanned right singular vectors corresponding g w stewart largest singular value w gamma1 r zr follows 518 tight 58 derived matrix equation approach 511 remark 52 usually first second inequalities strict exam ple let solving optimization problem remark 51 first inequality becomes equality r diagonal second also becomes equality r n theta n identity matrix upper bound tight structure wr zr reveals column wr one columns zr w gamma1 r zr nn 12 square identity submatrix giving remark 53 lower bound approximately tight n seen taking taking 510 see remark 51 results analysis section 4 q 1 lead new first order normwise perturbation theorem theorem 52 let qr factorization 2 r mthetan full column rank let deltaa real theta n matrix holds unique qr factorization wr zr 516 59 510 perturbation analyses qr factorization 13 proof corollary 22 deltaa unique qr factorization 522 35 515 517 g j deltaaffl 25 r zr vecq taking 2norm gives combining thus taylor series 39 rt 523 follows remaining results restatements 520 519 41 43 2 remark 54 524 know first order perturbation bound 523 least sharp 32 suggests may considerably sharper fact sharper arbitrary factor consider example remark 53 taking see first order perturbation bound 32 severely overestimate effect perturbation remark 55 take close upper bound shows relatively small early diagonal elements r cause poor condition suggests use pivoting significant chance condition problem approach upper bound least randomly chosen matrices use standard pivoting see 524 514 following tighter result shown 2 th 22 theorem 53 let 2 r mthetan full column rank qr factorization standard column pivoting strategy used 14 xiaowen chang chris paige g w stewart parametrized family matrices 2 0 2 r zr theorem 53 shows standard column pivoting strategy used r ap bounded fixed n matter large many numerical experiments strategy suggest r ap usually close lower bound one give extreme example section 6 use pivoting simple result r far see unreasonably expensive compute approximate r directly usual approach fortunately apparently excellent approximation r quite easy estimate need choose suitable r 510 consider next section 6 numerical experiments condition estimators section 5 presented new first order perturbation bounds r factor qr factorization using two different approaches defined r zr k 2 true condition number r factor suggested r could estimated practice r new first order results sharper previous results r least sharp q 1 give numerical tests illustrate possible estimators r would like choose r good approximation 59 show good estimate true condition number r procedure obtaining 2 condition estimator r qr factorization ie estimator r choose use standard condition estimator see example 5 estimate 2 gamma1 r take r 510 appropriate estimate well known result van der sluis 16 2 gamma1 r nearly minimal rows gamma1 r equilibrated could lead large 510 three obvious possibilities first one choosing equilibrate r precisely specifically take n second one choosing equilibrate r far possible keeping 1 specifically take n third one choosing computations show third choice sometimes cause unnecessarily large estimates give results choice specify diagonal matrix obtained first method second method 1 2 respectively following give three sets examples first set matrices n theta n pascal matrices elements 15 results shown table 61 without pivoting giving table 62 pivoting giving r note table 61 far worse true condition number r much greater lower bound 1 table 62 pivoting seen give significant improvement r bringing close lower bound course still also observe table 61 r 1 r 2 good estimates r latter little better former table 62 fact also good estimates r ap perturbation analyses qr factorization 15 table results pascal matrices without pivoting 7 66572e02 44665e03 42021e03 21759e05 21120e06 8 24916e03 18274e04 16675e04 27562e06 29197e07 9 94091e03 74364e04 66391e04 36040e07 41123e08 20190e06 19782e07 16614e07 12819e12 18226e13 14 77958e06 79545e07 66157e07 18183e13 26979e14 table results pascal matrices pivoting r 3 12892e00 21648e00 21648e00 12541e01 87658e01 6 22296e00 47281e00 47281e00 75426e03 15668e05 7 20543e00 51140e00 51140e00 84696e04 21120e06 8 26264e00 65487e00 65487e00 11777e06 29197e07 9 34892e00 88383e00 88383e00 14573e07 41123e08 14 36106e00 12386e01 12386e01 53554e12 26979e14 second set matrices 10 theta 8 j obtained random 10 theta 8 matrix produced matlab function randn jth column multiplied 10 gamma8 give j results shown table 63 without pivoting results pivoting similar 63 given close upper bound significantly smaller results expected since matrix r illconditioned due fact r jj small rows r already essentially equilibrated expect r much g w stewart better also first seven cases smallest singular value leading part r ngamma1 close r q 1 could much better even though r still illconditioned due fact r 88 small equilibrated becomes wellconditioned row scaling notice time close 1 r d1 r 2 therefore much better case smallest singular value r significantly smaller r ngamma1 thus q 1 condition number change q 1 lying range q 1 spectacularly better contrived example serves emphasize benefits pivoting condition q 1 r table pivoting 5 12467e08 31208e08 23992e08 39067e08 42323e08 6 88237e07 22252e08 16584e08 34710e08 39061e08 7 92648e07 21010e08 17127e08 44303e08 54719e08 8 22580e00 54735e00 49152e00 66109e00 62096e08 third set matrices n theta n upper triangular matrices introduced kahan 7 course condition numbers depend r interested results shown table 65 found list results corresponding 1 table results kahan matrices examples see r 1 r 2 gave excellent estimates r r 2 marginally preferable kahan matrices correspond correctly pivoted see extreme cases large enough n r large even pivoting bad result get perturbation analyses qr factorization 17 pivoting gets bit worse 0 r since kahan matrices parameterized family mentioned theorem 53 nevertheless r still estimate r excellently 7 summary conclusion first order perturbation analyses presented show sensitivity condition q 1 r qr factorization full column rank provide true condition numbers respect measures used sufficiently small deltaa well efficient ways approximating key normbased condition numbers derived part deltaq 1 ra see 41 part deltaq 1 ra see 43 r zr k 2 r see theorem 52 ffl estimate r j inf d2dn r r j condition numbers obey r see 524 numerical examples analysis case given suggest r chosen equilibrate subject 1 gives excellent approximation r general case special case orthogonal columns r diagonal remark 51 showed taking general use standard column pivoting strategy qr factor ization saw 514 2 result analyses see r certain sense q 1 less sensitive thought previous analyses true condition numbers depend column pivoting show standard pivoting strategy often results much less sensitive r sometimes leads much smaller possible change q 1 range q 1 given size perturbation matrix equation analysis section 51 also provides nice analysis interesting possibly general matrix equation 51 following approach stewart 8 th 31 see also 12 th 211 would straightforward detailed lengthy extend first order results provide strict perturbation bounds done 3 could also provide new componentwise bounds chose either order keep material basic ideas brief approachable possible condition numbers resulting bounds asymptotically sharp less need strict bounds new componentwise bound r given 2 g w stewart acknowledgement would like thank jiguang sun suggestions encouragement providing us draft versions work r phd thesis perturbation analysis r qr factorization new perturbation analyses cholesky fac torization matrix computations survey condition number estimation triangular matrices accuracy stability numerical algorithms perturbation bounds subspaces associated certain eigenvalue problems perturbation bounds qr factorization matrix perturbation lu perturbation lu cholesky factors matrix perturbation theory perturbation bounds cholesky qr factorization componentwise perturbation bounds matrix decompositions perturbation bounds qr factorization condition numbers equilibration matrices componentwise perturbation analysis qr decomposition tr ctr younes chahlaoui kyle gallivan paul van dooren incremental method computing dominant singular spaces computational information retrieval society industrial applied mathematics philadelphia pa 2001