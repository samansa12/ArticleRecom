augmented lagrangian sqp method class optimal control problems banach spaces augmented lagrangian sqp method discussed class nonlinear optimal control problems banach spaces constraints control convergence method investigated equivalence generalized newton method optimality system augmented optimal control problem method shown quadratically convergent optimality system standard nonaugmented sqp method strongly regular sense robinson result applied test problem heat equation stefanboltzmann boundary condition numerical tests confirm theoretical results b introduction consider augmented lagrangian sqp method alsqp method following class optimal control problems includes meaningful applications control problems semilinear partial dierential equations minimize subject setting u real banach spaces dierentiable mappings u ad nonempty closed convex bounded subset u operator continuous linear operator u general p nonconvex problem refer u control state past years application alsqp methods optimal control identication problems partial dierential equations made considerable progress list contributions eld already become rather extensive shall mention papers bergounioux kunish 6 ito kunisch 13 14 kaumann 15 kunisch volkwein 16 volkwein 25 26 supported sfb 393 numerical simulation massive parallel computers 2 parts work done third author visiting professor universite paul sabatier toulouse paper extend analysis alsqp method banach space setting generalization needed instance nonlinearities problem cannot well dened hilbert spaces application concern nonlinear mapping natural consequence extension contrast literature alsqp method deal well known twonorm discrepancy another novelty approach presence control constraints u 2 u ad p complicates discussion method resolve associated diculties rely known results convergence generalized newton method generalized equations one main goals paper reduce convergence analysis one main assumption checked particular applications strong regularity optimality system way hope shown general way perform convergence analysis alsqp method p concentrate particular type augmentation applied nonlinearity state equation splitting state equation z augment second equation type augmentation useful application parabolic boundary control problems convergence analysis conrmed numerical tests compared performed nonaugmented sqp method obtain following main results optimality system rst order necessary optimality conditions p strongly regular sense robinson alsqp method locally quadratic convergent natural assumptions result applied boundary control problem semilinear parabolic equation 23 convergence nonaugmented sqp method shown particular problem verifying strong regularity assumption way result immediately applicable obtain convergence augmented method application paper organized follows section 2 x general assumptions formulate rst order necessary second order sucient optimality conditions section 3 contains example semilinear parabolic control problem alsqp method presented section 4 show iterates well dened associated banach spaces convergence analysis developed section 5 basis newton method generalized equations last part paper reports numerical tests alsqp method general assumptions optimality conditions rst x assumptions spaces mappings banach spaces u mentioned introduction stand ones following holds f mapping class c 2 u r mapping class c 2 u several reasons among formulation sqp method sucient second order optimality conditions introduce real hilbert spaces 2 u 2 respectively u continuously densely imbedded 2 respectively u 2 moreover identify u 2 dual u therefore denoting u dual space u continuous imbeddings let us introduce product space endowed norm jjvjj jjujj u space endowed norm jjvjj notations shall denote rst second order derivatives f partial derivatives indicated associated subscripts f v f yu v etc notice denition f 0 v 2 v u open ball v centered v radius r denoted b v v r notation used banach spaces denote duality pairing u u resp reserved paper scalar product u 2 list main assumptions a1 linear continuous bijective operator 2 u 2 moreover restriction still denoted continuous bijective u addition assume u ad closed u 2 extension properties r 0 constant cr 0 v 2 v 21 21 follows f 0 v considered continuous linear operator v 2 r 0 considered continuous linear operator 2 u 2 since 00 belongs u u u term k 00 ful moreover f 00 v respectively 00 considered continuous bilinear operator v 2 respectively u second order derivatives shall write v cr 0 z 2 remainder terms let r f denote ith order remainder term taylor expansion mapping f point x direction h following ioe 11 maurer 18 assume kr 2 operator bijective 2 u 2 restriction still denoted bijective u belongs b b banach space continuously imbedded belongs u restriction continuous b u rst assumption concerns linearized state equation second third assumptions needed get optimal regularity adjoint equation indeed adjoint state corresponding dened study convergence sqp method need p belongs u since denition f u v belongs u condition f u v 2 u regularity condition f u v analysis generalized newton method need following additional regularity conditions a6 every 2 0 belongs lu mapping 7 0 locally class c 11 lu b every belongs lu b mapping locally class c 11 lu b a7 mapping v 7 f 0 v locally class c 11 v u 3 example control semilinear parabolic equa tion let us consider following particular case p z u u z subject n bounded domain boundary class c 2 0 0 2 2 u u b given xed function r r nondecreasing locally class c 21 choice ts setting let us verify problem e satises assumptions problem related p follows fy fy w 0 hilbert space dened dt space respectively 2 endowed norm kyk us check assumptions operator obviously continuous 2 u 2 bijective 2 u 2 see 17 also bijection u see 8 20 thus a1 satised continuous imbedding 8 20 verify mapping class c 2 u f mapping class c 2 u r moreover v f z z x tyx dsdt f u z thus derivative f v identied triplet 0 assumptions 21 23 easily satised verify assumption a5 let us introduce space b space identied subspace elements form 7 z z z calculations clear f v belongs b let dau solution equation operator u 7 dau continuous bijective u 2 2 17 u 8 20 rst part a5 satised prove second part let us consider adjoint equation u 2 u using green formula obtain z z z z z z therefore nothing else 0 j identity easily verify second part assumption a5 let us nally discuss properties second order derivatives second derivative interprete 00 element l 1 l 1 22 checked assumptions second order derivatives precisely 24 a4 also 4 optimality conditions section devoted discussion rst second order optimality conditions let u local solution p means holds v belong suciently small ball b v v satisfy constraints p theorem 1 let u local solution p suppose assumptions a1 a2 a5 satised exists unique lagrange multiplier hf u proof since f frechetdierentiable u class c 1 u surjective u exists unique 44 45 satised see 12 also theorem 21 1 variational equation 44 admits unique solution dened v due assumptions a5 follows p belongs u 2 next introduce lagrange function system 4445 equivalent shortening shall write adjoint equation 44 form f vp 0 thus rst order optimality system p hf follows derivatives l 0 l 00 refer variable v lagrange multiplier p let us assume also satises following ssc second order sucient optimality condition 0 holds satisfy linearized equation remark 1 condition ssc quite strong assumption consider active control constraints might occur u ad instance useful constraints type u concrete applications use associated second order assumption possible see example 23 however intend shed light main steps needed convergence analysis augmented lagrangian sqp method rather present dicult technical details connected weakening ssc shall adress issue section 6 let us complete section simple results follow second order sucient condition lemma 1 suppose assumptions a1a5 satised suppose addition v satises second order sucient condition ssc exists 0 every p given b v u u satisfy perturbed linearized equation proof brie explain main ideas quite standard result show dierent assumptions needed p suciently close p quadratic form l 00 p arbitrarily close l 00 u p ssc a2 a3 derive provided 0 analogous estimate shown solutions perturbed equation 411 0 taken write short b l 00 dene z unique solution z use rst part a5 assumptions a1 a3 a5 ensure estimate cky 4 c stands generic constant therefore 78 kz uk 2 follows 412 414 young inequality 0 taken arbitrarily small resubstitute z arrive similar estimates provided suciently small thus 410 proven 2 although shall directly apply next result state show dierent assumptions needed assumed deal well known twonorm discrepancy optimality system 47 p second order sucient condition ssc suppose assumptions a1a5 fullled constants 0 0 quadratic growth condition holds admissible proof rst order optimality system implies subtracting state equations analogously 413 nd 1 v h solves linearized equation 49 coercivity estimate ssc applied v h moreover a5 yields khk y2 c kr insert v h 416 write short b l 00 v p proceed similarly estimation bv 2 last proof ckv jr l g estimates assumptions a2 a3 used kv v v h k v 2 estimate h rst order remainder term r 1 inserted let quadratic growth estimate follows classical arguments 2 lemma shows second order condition ssc sucient local optimality u sense v whenever u solves rst order optimality system notice cannot show local optimality sense v 2 5 augmented lagrangian method 51 augmented lagrangian sqp method section introduce augmented lagrangian sqp method alsqp special type augmentation rst represent p equivalent form minimize subject z augmentation takes account nonlinear equation z alsqp method obtained applying classical sqp method problem minimize f subject z 0 given dene lagrange functional l p corresponding augmented functional l u 4 follows derivatives l 0 l 00 stand derivatives respect u z refer lagrange multipliers p remark concerns l let current iterate alsqp method consider linearquadratic problem qp minimize f 0 subject z n new iterate obtained taking solution qp exists multipliers p n1 n1 associated constraints respectively recover classical sqp method let us also introduce following problem qp subject problems qp qp equivalent sense precised theorem 2 let solution qp associated lagrange multipliers must solve problem qp n1 multiplier p n1 solution equation moreover z n1 n1 must satisfy z conversely n1 u n1 solution qp dened 53 n1 u n1 z n1 solution qp associated lagrange multipliers p n1 n1 proof let us rst assume n1 u show n1 u n1 solves qp n1 relations 5153 satised investigate following explicit form qp expand derivatives occuring problem qp write short k introduce convenience functional gy objective minimize qp n1 given minimization subject constraints z n reduction qp reduce dimension problem exploit second one equations 54 insert expression z z n 0 n functional j second fourth items denition j constant respect z u depend current iterate neglected minimization j associated functional minimized moreover delete second equation 54 inserting expression z rst one explains n1 u n1 solution qp necessary optimality conditions derive necessary conditions triplet lagrange functional conditions l u u u n1 0 u 2 u ad evaluation yields mention later use equations 54 belong optimality system qp update formulas p n1 n1 follow 55 56 shown one direction statement converse direction proved completely analogous manner qp n1 substitute z corresponding positions easy verify n1 u subject 54 n1 multiplier associated equation z n remark 2 update rules 52 53 imply lagrange multiplier coincides p iteration necessarily true initial values n p n therefore possible exception rst step constant objective functional qp n1 easily follows calculating l 00 formula 46 moreover justifed replace n p n variational equation 51 theorem 2 shows iterates alsqp method obtained solving reduced problem qp solutions qp exist question existence answered considering qp theorem 3 let p satisfy assumptions lemma 1 let suciently small qp n1 unique solution moreover dened 53 unique solution qp proof assume ky us prove existence qp view remark functional j taken instead j minimization qp quadratic part tends u since z n z yields objective functional qp n1 coercive set hence strictly convex set u ad nonempty bounded convex closed u u 2 well assumed a5 continuous u 2 2 2 particular therefore c nonempty convex closed bounded 2 u 2 existence uniqueness solution qp n1 standard conclusions moreover u ad u hence u n1 2 u regularity properties guarantee n1 2 z n1 2 u follows 53 existence uniqueness qp obtained theorem 2 2 update rules theorem 2 show p n1 n1 uniquely determined u 2 u 2 get even better regularity corollary 1 initial element taken u 4 iterates generated alsqp method uniquely determined belong u 4 proof existence uniqueness follows last theorem update rules 52 53 also know n1 u new result derive p n1 n1 remains u u well since verify p n1 2 u however follows instantly equation 51 know belong b assumptions a5 a6 a7 moreover holds 00 n n1 n therefore a5 ensures solution p n1 51 u 2 52 newton method optimality system p augmented sqp method considered computational algorithm solve rst order optimality system p generalized newton method equivalence tool convergence analysis optimality system p consists equations l w z unknown variable optimality system 58 p equivalent generalized equation see let us rst introduce following setvalued mappings f0 u g nu f0 u g f0 u consider f u 4 dened f u u p z yc c c c c c c c c c notice nu closed graph u u restriction u normal cone u ad point u denition normal cone refer 5 rst component f due a6 identify element belongs a5 a6 easily verify f takes values u 4 lemma 3 optimality system 58 p equivalent generalized equation proof calculating derivatives l 58 easily verify l w l w z l w u z yc c c c c c therefore denition f 510 equivalent third relation rewritten variational inequality 58 equivalence 58 510 veried 2 next recall facts generalized equations related convergence results generalized newton method gnm let w e banach spaces let open subset w let f dierentiable mapping e setvalued mapping pe closed graph consider generalized equation generalized newton method 511 consists following algorithm choose starting point solution generalized equation generalized newton method locally convergent assumptions stated equation 511 admits least one solution exist constants r c bw r denition 1 generalized equation said strongly regular 2 exist constants r c perturbed generalized equation unique solution theorem variant robinsons implicit function theorem 21 theorem 21 theorem 4 4 theorem 25 assume 511 strongly regular 2 c1 c2 fullled exist 0 k 0 mapping 0 bw bw every 2 bw 0 unique solution 513 following theorem extension generalized equation 511 well known newtonkantorovitch theorem direct consequence theorem 4 theorem 5 4 theorem 26 assume hypotheses theorem 4 fullled exists 0 starting point generalized newton method generates unique sequence k k convergent satisfying w k 1 apply results set generalized newton method generalized equation 510 abstract formulation optimality system p lemma 4 generalized newton method solving optimality system p dened 512 proceeds follows let w current iterate next iterate w solution following generalized equation proof iteration scheme conclusion iteration rule 512 applied concrete choice 59 f computations straightforward mention following equivalent transformation nally leads 514 515 due concrete expression f given 512 rst two relations inserting 518 519 520 obtain 514 515 2 apply theorem 5 concrete generalized equation 510 need 510 strongly regular conditions c1 c2 satised assumption strong regularity w must assumed checked particular application general verication strong regularity requires detailed analysis case optimal control parabolic partial dierential equations refer discussion sqp method troltzsch 23 strong regularity associated generalized equation proved means result l 1 lipschitz stability 22 associated semilinear elliptic case studied unger 24 conditions c1 c2 veried assumptions a6 a7 lemma 5 mapping w 7 f w class c 11 u 4 b u 4 proof statement immediate consequence a6 a7 2 theorem 6 let u local solution p let p associated adjoint state assume generalized equation find u p 2 u 2 strongly regular p generalized equation find strongly regular p proof let z perturbation b u 4 linearized generalized equation 522 point associated perturbation e f yy z e f uy f yy stands f yy u notations used mappings obtain two rst equations 523 refer system 519 520 insert w replace left hand side perturbation since z straightforward calculations easily prove system 523 equivalent f yy e f uy observe rst third fourth relation 524 form subsystem depend z u p given subsystem z uniquely determined remaining two equations let us set e subsystem 524 rewritten form generalized equation f uy generalized equation 526 linearization generalized equation 521 p associated perturbation e since 521 assumed strongly regular p exist r ry p 0 mapping u se unique solution 526 e r u show 522 strongly regular w e let e given 525 exists r 0 e belongs 0 r dene mapping b b 0 r b ce z 3 e se clearly unique solution 523 easily nd c 0 proof complete 2 theorem 6 shows convergence analysis standard non augmented lagrangenewtonsqp method done proving strong regularity associated generalized equation analysis repeated analyzing convergence augmented method discussed augmented sqp method generalized newton method separately shall show methods equivalent equivalence used obtain convergence theorem augmented sqp method theorem 7 let u local solution p satises together associated lagrange multiplier p second order sucient optimality condition ssc dene suppose generalized equation 521 strongly regular w exists w 0 starting point neighbourhood bw w r alsqp method dened according theorem 2 generalized newton method dened lemma 4 generate sequence iterates w n moreover constant c q w estimate satised proof first mention simple decisive fact w satises optimality system p since p satisfy optimality system p fore makes sense determine w generalized newton method let w arbitrary current iterate identical alsqp method generalized newton method gnm w n1 2 w found unique solution 514518 concerns alsqp method obtained unique solution qp determined 52 therefore satises associated optimality system 54 5557 obviously identical 514518 clear methods deliver new iterate w n1 2 w remaining statements theorem follow convergence theorem 5 2 6 numerical results 61 test example apply augmented sqp method following onedimensional nonlinear parabolic control problem stefanboltzmann boundary condition z subject u ut example particular case problem e considered section 3 take 0 make associated modication boundary condition early phase work studied numerical behaviour sqp method without augmentation compare methods performed numerical tests following particular data lemma 6 pair u dened e 23 e 13 locally optimal solution 627 c0 0 l 1 0 associated adjoint state lagrange multiplier given cosx triplet second order sucient optimality condition ssc proof proof split four steps step 1 state equation easy see regard boundary condition left hand side holds right hand side since step 2 adjoint equation equations easy check remains verify boundary condition obvious right hand side boundary condition value since step 3 variational inequality must verify trivial well known holds e 23 e 13 p 01 denotes projection onto 0 1 obviously veried step 4 second order sucient condition lagrange function given r r l r ty x 0 tp0 r ty x r therefore since p negative l 00 p coercive whole space u hence ssc theorem 8 pair u global solution e proof let u admissible pair e due rst order necessary condition py u2 z z positivity p 00 independently follows fy u fy u 2 next discuss strong regularity optimality system p theorem 9 optimality system e strongly regular p proof triplet p satises ssc moreover e ts general class optimal control problems semilinear parabolic equations considered 23 follows theorem 52 22 theorem 53 23 ssc ensures strong regularity generalized equation abstract formulation associated optimality system apply result problem 627 2 remark 3 study 23 reveals convergence standard sqp method proved arbitrary dimension assuming weaker form ssc requires coercivity l 00 smaller subspace considers strongly active control constraints weaker assumption helpful proving convergence augmented sqp method well shall discuss since technical eort increase considerably obtain theorem 7 following result corollary 2 augmented lagrangian sqp method e locally quadratically convergent towards p 62 algorithm convenience reader let us consider problem qp corresponding test example simplifying get minimize2 subject 6 one specic diculty solving problem 627629 partially related control constraints main diculty appears also unconstrained case large linear system solved let us consider moment unconstrained case solution problem 627628 optimal triplet satises 628 adjoint equation practice solve qp discretization optimality system result taken solve qp discretized version equation 631 corresponds largescale linear system solve system need solutions corresponding discretization two coupled parabolic equations state adjoint equations clear accuracy augmented lagrangian sqpmethod depends one solving linear system consequently numerical methods partial dierential equations example state adjoint equations solved using secondorder nite dierence scheme crancknicholson scheme appropriately modied boundary maintain second order approximation linear system solved using cgm conjugate gradient method step length given polakribiere formula let us take account constraints 629 optimality condition 631 replaced management restrictions based 632 projection method bertsekas 7 see also 9 10 method successfully applied precisely following algorithm vector representing iterate corresponding xed grid let xed positive numbers let f1 mg index set associated w n dimension vector w n depends discretization u n denote vector representing iterate corresponding solution 630 sets strongly active inequalities vector representing u n j 2 b solve unconstrained problem 627628 w j remaining components xed due 4 denote v n vector representation solution denotes projection onto u go 2 otherwise stop iteration 63 numerical tests numerical tests focused interest aspects concerning convergence dierent values initial data penalty parameters rate convergence programs written matlab let us rst summarize general observations example augmented lagrangian algorithm performed well particular graphs exact solution numerical solution almost identical compared sqp method corresponding 0 augmented lagrangian sqp advantage global behavior moreover less sensitive startup values signicantly faster sqp method points graphical correction computed controls precisionof optimal value digits obtained taking discretization parameters respect time space equal 200 xed data number iterations cgm augmented sqp turned independent mesh size sequel set ku ku u z vectors respectiveely corresponding exact solution e numerical solution e solution qp moreover denote n n x discretization parameters respect time space optimal controls determined following pairs n x 200200 400400 run 1 sqp method rst test corresponds rates e n n u n p n z given table 1 table 1 100 17782e06 25347e06 16610e06 02372 03653 10575 13886 200 13725e06 29337e06 10724e06 02472 03663 10585 09980 sqp method shows good convergence initial point 4 iterations needed get result run 2 alsqp method second test corresponds point 05 05 05 z table 2 100 15391e06 26824e06 15013e06 14459e06 00150 10004 22378 200 12318e06 38783e07 52251e07 55521e07 00149 09256 10015 alsqp method good convergence choice convergence could always achieved xing using values z 0 however number iterations speed method depend choices shown table 3 three iterations alsqp method needed instead four sqp method number iterations cgm sqp alsqp methods independent meshsize exact value cost functional table 3 give values cost functional corresponding dierent steps table 3 sqp method iter f n cgm iter alsqp method iter f n cgm iter u2 u1 u3 u4 u2 u3 figure 1 controls run 1 run 2 figure 2 states run 1 run 2 p3 p4 p2 p3 figure 3 adjoint states p run 1 run 2 figures 1 2 3 compare behavior control state adjoint state obtained taking 1 clear case alsqp method second iteration gives good approximation optimal control optimal state optimal adjoint state run 3 last test corresponds initial point given table 4 100 99421e06 27989e06 40979e06 30853e06 200 11864e05 47523e06 50999e06 23842e06 400 12167e05 52817e06 53307e06 22146e06 200 00404 03975 13537 11471 initial point sqp method corresponding converge alsqp method converges many choices z 0 tests point gives best result given z 1 choice 4 iterations needed 2 5 6 9 cg steps dierents rates given table 4 behavior solution shown figure 4 remark 4 numerical results stated table 1 2 reft3 obtained xed meshsize xed grid however also implemented alsqp method adaptative mesh size ie started coarse grid used obtained results startup values u2 u3 u4 p3 figure 4 controls states adjoint states run 3 next ner grid method signicantly faster delivers essentially results r lagrange multiplier theorem control problems state constraints lagrangenewton method nitedimensional optimization prob lems lagrange newton method discretization mesh independence newtons method generalized equations analysis control nonlinear augmented lagrangian techniques elliptic state constrained optimal control problems projected newton methods optimization problems simple constraints pontryagins principle stateconstrained boundary control problems semilinear parabolic equations numerical solution constrained control problem phase augmented lagrangiansqp methods nonlinear optimal control problems tracking type augmented lagrangiansqp methods hilbert spaces application control coecients problems augmented lagrangiansqp techniques approxi mations linear quasilinear equations parabolic type first second order su hamiltonian pontryagins principles control problems governed semilinear parabolic equations strongly regular generalized equations hinreichende optimalit distributed control problems burgers equation tr multiplier methods nonlinear optimal control secondorder sufficient optimality conditions class nonlinear parabolic boundary control problems augmented lagrangiansqp methods nonlinear optimalcontrol problems tracking type augemented lagrangian techniques elliptic state constrained optimal control problems pontryagins principle stateconstrained boundary control problems semilinear parabolic equations lagrangenewtonsqp method optimal control semilinear parabolic equations meshindependence augmented lagrangiansqp method hilbert spaces distributed control problems burgers equation ctr hans mittelmann verification secondorder sufficient optimality conditions semilinear elliptic parabolic control problems computational optimization applications v20 n1 p93110 october 2001