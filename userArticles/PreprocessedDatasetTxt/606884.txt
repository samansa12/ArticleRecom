robust optimal service analysis singleserver reentrant queues generalize analysis ja ball mv day p kachroo mathematics control signals systems vol 12 pp 307345 1999 fluid model single server reentrant queue approach solve hamiltonjacobiisaacs equation associated optimal robust control system method staged characteristics generalized ball et al 1999 construct solution explicitly formulas developed allowing explicit calculations skorokhod problem involved system equations formulas particularly important numerical verification conditions boundary nonnegative orthant optimal control server strategy shown linearindex type daitype stability properties discussed modification model new customers allowed specified entry queue considered 2 dimensions optimal strategy found case well b figure 1 reentrant server much current interest developing optimal service strategies queueing systems volume kelly williams 9includes several articles addressing although queueing models generally integervalued stochastic dai 4and others developed connections stability date november 30 2001 research supported aspires program research graduate studies millennium program college artsand sciences virginia tech stochastic queuing systems deterministic fluid limits thus optimal strategies fluid models recognized significant stochastic models fluid models large class queueing systems described equations general form 5 introduced section 2 pursue robust control approach 2for models much present development ideas paper particular section 21 gives explicit representations velocity projection map x v skorokhod reflection mechanism comes play one queues empty section 3 develops construction value function control problem 2 construction proceeds without regard skorokhod dynamics boundary nonnegative orthant general multiple server examples skorokhod dynamics play decisive role even solution construct must shown satisfy various inequalities associated optimality respect skorokhod dynamics boundary provide deductive proof inequalities rely instead system numerical confirmation individual test cases section 4 explicit representations x v important optimality argument section 5 version argument given improves one 2in applies admissible strategies state feedback form model allows new arrivals unserved departures form exogenous load qitforeach xi see 1 queueing applications feature would inappropriate instance typical reentrant lines new arrivals occur specified entry queue departures service completed designated final queue section 6 look 2dimensional case model restrictive assumption exogenous arrivals allowed entry queue x1 requires number changes calculations find change model eect resulting optimal service policy 2 model approach optimal control describe section general model formulation performance criteria use fluid models large class queueing systems described equations nominal form 1 xtqt gut state variable ndimensional x x1xn rn queueing models xt must remain nonnegative orthant k 4 purpose couple 1 skorokhod problem dynamics resulting 5 term qtistheload system due new arrivals unserved departures qit 0 service allocation specified control function ut whose values taken finite set u0 rm possible service control settings purposes adequate existence theory solutions 5 relax allow ut taken convex hull 2 u convu0 singleserver examples willsimply take standard unit vectors rnthus 1 matrix g converts ut appropriate vector contributions x case considered figure 1 g lower triangular matrix sn1 0 si 0 parameters specify service rates respective queues thus utek kn eect gut 1 drain queue xk rate sk served customers entering xk1 rate multiple server examples easily modeled 1 5 well consider example 2server reentrant line figure 2 would natural use first two columns g correspond service allocation server second two server b u u0 correspond 4 dierent combinations server chooses x1 x3 server b chooses x2 x4 x3 figure 2 2server reentrant line 21 skorokhod problem dynamics denote k nonnegative orthant rn faces k interior normal ik standard unit vector use denote set coordinate indices x k ixi denote set indices zero coordinate values essential feature queueing models xt remains k one could simply impose constraint control functions ut loads qt considered admissible although constraints load reasonable find much natural general couple 1 dynamics skorokhod problem face ik specify constraint vector di solution 1 attempts exit k ik idea add positive multiple di right side 1 prevent exit precise formulation following given x0 k qtut assume locally integrable let problem find continuous function xt k measurable function rt rn nondecreasing function 0 satisfy following 0 0t rt iixt idi 0 0t 1xsk ds imposing normalization unique solution provided k di satisfy certain conditions dupuis ishii 5and dupuis ramanan 7provide substantial body theory skorokhod problems general particular show using velocity projection map x v skorokhod problem expressed dierential system velocity projection map form appropriate choice 0 see 6 result coupling 1 appropriate skorokhod problem expressed holding almost surely appropriate constraint vectors di determined structure system figure 1 x ik server active ui 0 applied service rate siui exceeds inflow qi xi according 1 x would exit k ik actual network system could really use full service capacity siui allocated xi instead service would take place lower level exactly balances inflow outflow queue xi mathematically achieved adding positive multiple column gei g right side system 1 bringing xi 0 producing correct reduction throughput xi xi1 next queue take di s1 gei normalization 1 prescription appropriate example figure 2 take di unique column g positive entry row normalized ni di 1 point wish highlight fact restrictions utandqt needed keep xt nonnegative orthant 5 determine state trajectory xt k regardless thus always instruct server work full capacity skorokhod dynamics viewed automatically reducing service rates levels actually implemented model allows separate load term qit queue reentrant queues one typically would want allow entry queue reentrant sequence figure 1 instance would natural assume nice feature single servers respect l2 performance criteria section 24 optimal strategy loads regardless coordinates might zero queueing applications one also naturally assumes qi 0 however argued 2that purposes vehicular trac instance reasonable consider qi 0 would correspond customers leave system without waiting receive service way reasonable consideration applications however hard conceive realistic interpretation qi 0 xi 0 even 5 still yield mathematical solution eect additional idi terms x q gu might seen reductions service rates transference reducing influence qi 0 empty xi queues xj along sequence fluid xj would drawn backwards system satisfy external demand due qi 0atpreviousxi di defined face important technical issue existence regularity properties skorokhod problem issue treated detail 5and 7 treatments consider general convex polyhedron place k particular choice nonnegative orthant falls within scope earlier work 12 let dibe matrix constraint vectors columns case q q subdiagonal matrix entries assuming q nonnegative entries spectral radius less 1 clearly satisfied us 12 provided direct construction solution skorokhod problem 7it shown conditions 12fall within scope general set sucient conditions existence lipschitz continuity skorokhod map x drawing ideas 12 give direct construction x v appearing dierential formulation 5 skorokhod problem x k v rn show characterized using linear complementarity problem subject following constraints ix iix constraint wi consider implicit let using q rewriting 6 easy see complementarity problem equivalent saying fixed point xof defined coordinatewise notation refers usual positive part fixed point representation particular case general fixed point representation variational inequalities chapter 1 10 first observe existence unique fixed point argument 12is observe linear change variables contraction nonnegativity spectral radius assumption mentioned however even simpler particular q x reduces determine sequentially iteration x initial converge fixed point n steps makes particularly simple see v thus v x v continuous evaluate x v numerically indeed x v lipschitz v fixed x jointly continuous x vifx restricted ix constant easily check x v defined complementarity problem indeed velocity projection map identified 5 first following observation 3 check y0yis discrete projection map assumption 31 5 indeed k clearly complementarity problem 0yyforyk 0yy form 0and dw dx set reflection directions defined 5 3 next suppose x k v rn let wsolve complementarity problem claim suciently small imply characterization x vin553 since wsolve 6 follows diwe want see satify complementarity conditions 7 associated first consider ix since xi 0wehave prodiuct 9 next consider iix provided h0 suciently small also confirms product condition verifies 11 desired purposes calculations characterizations x v lemma 1 useful j n use nj njjj dj djjj denote matrices whose columns normal vectors nj constraint directions dj j j given v corresponding described let complementarity problem know f0 l ix using f0 f l values f determined setting wi 0i f 6 words solve f iif directly consequently rf reflection matrix simply take precisely fact wi 0forif equivalent suppose dont know f0 l outset take arbitrary f ix calculate v construction wi 0fori f 0forif item 3 complementarity problem satisfied item 1 satisfied f say item 2 holds ix f say say fact x v discussion proves following lemma lemma 1 given x k v rnandf ix following equivalent 1 x vrf v 2 following hold bf v 0 3 l f l ix following hold bf v0 b nlf rf v 0when c nitxlrf v0 notice strict inequality 3 simply identifies f 22 optimal control policy goal design feedback control strategy x prescribing value extended control set u x k using utxt produces optimal performance system criteria used determine optimality based 0 parameter roughly speaking control keep integrated cost 14 small xt remains small compared load qt timeaveraged sense give precise formulation section 24 running cost 1 x2 2 q2 14 roots classical h control attractive broad familiarity success wide range control applications choices might appropriate particular queueing applications associated optimal draining timetoempty criteria see 18and 1 however considerations favor l2 trac setting given total customer population l2 norm favors balanced queue lengths situation queues empty others full customer person wait queue cost structure minimized using excessive waits small class customers would considered unacceptable optimal policy easy identify naive considerations point order minimize given qt one would minimize 1 xt2 one would naturally try choose uttominimize 1 interior k 1 applies suggests optimal u maximizes x gu u uonk x given 5 makes finding u minimize potentially dicult however assume qi 0 skorokhod dynamics aect minimizing u see consider x k suppose u umaximizes xgu easy see sup x gu 0 observe ix since odiagonal entries g nonpositive x gei 0 thus icoordinate u must 0 conclude ni gu 0 since qi 0 hypothesis see ni q gu 0 ix means x q guq gu also ixwehavex di 0 coordinate di positive therefore u uwe say thus policy u obvious candidate optimal service policy see indeed optimal sense made precise section 24 several comments made point first observe x setvalued inherent discontinuities x optimum u jumps among extreme points u replace ut xt 5 want resulting feedback system good existence properties addressed using filippov theory dierential inclusions important x closed graph convex setvalued notion closed graph often called lower semicontinuity setvalued functions easy see 15 properties another important point make naive reasoning suggests xt us actually imply achieves smallest possible value 1 xt2 given q target time titis conceivable might better forgo pointwise minimization 1 xt2 order drive xt dierent region section boundary larger reductions xt could achieved sort dynamic programming argument hamiltonjacobi equation developed section 3 needed adequately address global optimality issues although may much practical import one might ask whether allowing qi 0 xi 0 might aect choice u uwhich minimizes xx q gu indeed qi 0 large enough eect skorokhod dynamics produce cases ux minimizes x x q gu consideration would lead enhanced optimal policy agrees x interior k depends q x x k although longer statefeedback enhanced control would expect produce lower values 14 negative loads qt described eect drawing customers backwards system even enhanced control would improve performance system worst case sense dierential game formulated section 24 theorem 1 assert 23 minimum performance criteria strategy expressed state feedback form given load q associated control function ut would results solving system system combination dierential inclusion sense filippov skorokhod problem described discussion 2 section 14outlined arguments 6can adapted establish existence solution proof uniqueness elusive usual filippov uniqueness condition would l xa xb q gua q gub xa xb gub gua lxa xb2 immediate using since definition xa gub xb gua xb gua xb gub ua xa ub xb however noted 2 coupled skorokhod dynamics 16 unable conclude uniqueness based existing results literature issue addressed must allow possibility multiple solutions 16 uniqueness question essential main result theorem 1 however simply need formulate statement way strategies allowed produce one control function ut given load qt general service strategy maps pair x0q one control functions u write utx0qt although notation quite proper actually one u associated x0qby rather formulating cumbersome notation accommodate simply use phrases like utx0qt refer possible ut strategy produce one control functions x0 k load function q locally squareintegrable insist strategy nonanticipating sense qsqs utx0qs utx0 qs usus tgiven x0 q resulting ut general existence uniqueness properties skorokhod problem eg 5 provide unique state trajectory xt k call strategy nonidling nonnegative load qit 0 0 utx0qt resulting state trajectory xt property uit 0 occur simultaneously words service eort allocated nonempty queues unless queues empty particular strategy 15 nonidling x k index largest nonzero coordinate x one features single servers figure 1 nonnegative loads nonidling strategy never invoke skorokhod dynamics k reaches indeed xt k 0 nonidling property means 0 structure g implies ni gut 0 since qit 0 conclude ni qt gut 0 thus unless multiple servers property case figure 2 instance service eort b wasted skorokohd dynamics definitely come play regardless x1 x3 skorokhod dynamics thus stronger influence design optimal strategies multiple server models considering fluid models arise limits discretestochastic queueing systems stability criterion dai 4is important purposes positive recurrence stochastic model setting load qt typically constant 1qi equal mean time new arrivals queue xi stability property 4is simply x0 k state xt reaches finite 0 single server model nonidling strategies equivalent respect see consider vector observe g 1 1 1 u uwe 1 nonnegative load qt ut resulting form nonidling strategy interval prior first time xt xtqt gut dt said another way wx x sort universal lyapunov function nonidling controls thus first time depend choice nonidling control depends load qt constant nonnegative loads qt q dai stability property simply boils moreover q q1 0 0t reduces familiar load condition 4 19 q1 1 figure 3 illustrates stability property taken optimal strategy x model subjected system constant disturbance qt 4 0 parameters find 2 1 q load condition 18 indeed satisfied figure illustrates resulting trajectories 16 xt reaches ray origin direction solution 16 fillipov sense uses averaged control value takes xt origin finite time directly along ray one may check ray consists x xu multiplevalued theorem 1 considers optimality respect strategies satisfy following minimum performance criterion given x0 k x0 1 exists 1 whenever q nonnegative load satisfying qt 1 utx0qt resulting state trajectory satisfies xt 0 clear discussion every nonidling control satisfies minimum performance criterion simply take 24 robust control problem want define carefully sense service strategy x optimal follow general approach soravia 14to formulate dierential game based 14 focus value function form dt x k outer infimum strategies inner supremum locally square integrable loads q utx qt bounded time intervals 0t xt resulting solution 1 x1 figure 3 controlled trajectories qt 4 0 gain parameter 0 customary robust control formulations however structure problems scales game 19 natural way see consider particular load qt control ut solution xt 5 make change variables xt xs k cone x q gux q gu thus xs solves 5 new ds time scale ds v v1 value 19 implies vx3v 1x point forward simply take instead v expect v x hold bounded region see imagine load qt large initial interval 0 drive state large value x qtischosenfor tsso maintain xtx ts qtgut x supuu gu integral 19 grows without bound producing infinite value must exclude scenarios definition game turns region v x finite described using vector 17 restrict 19 xt remains 0 qualification state turn requires us place limitations strategies considered well need exclude controls cheat encouraging xt run quickly outer boundary force early truncation integral 19 controls could achieve artificially low value actually destabilized system exclude policies insist control strategies satisfy minimum performance criterion stated end section 22 qualifications state precisely optimality properties feedback strategy x theorem 1 let x defined suppose boundary verifications section 4 successfully completed using control xforx define supremum loads qt resulting control functions utx qt controlled state control strategy satisfying minimum performance criterion qualifications supremum proof assertions discussed section 5 qualification regarding boundary verifications section 4 explained last paragraph section 31 3 construction value function staged characteristics proof section 5 theorem 1 based showing function v x 21 solves hamiltonjocobiissacs equation associated game 19 hamiltonian function complicated special reflection eects k essential property strategy x proof given x point supq infu defining hx dv x 24 given u x specific minimum value u uis 0 achieved maximum value q rn 0 achieved q together imply 23 primary task produce v xand establish property general 23 must considered viscosity sense lions 13considers viscositysense formulation general class problems involving skorokhod dynamics k instead working h 24 viscosity sense solutions described using interior form hamiltonian 27 together special viscosity sense boundary conditions k case turn solution v actually classical one find direct formulation terms h natural development construct desired solution v x working interior k complicating eects x v present x vv infhux p uu hu refers individual hamiltonian u u supremum achieved also observe u uto achieve infimum 27 means simply u maximizes p gusoforx k 23 saddle point conditions 25 26 simply reduce statement u x uu turn construction v x generalized method characteristics cover family paths xt described idea point gradient dv xt given costate trajectory pt accompanies xt thus simple covering family paths determine values dv x knowing v region itemize essential features family xtpt 3033 explain relation hamiltonjacobiisaacs equation saddle point property begin paths must solve system odes piecewise constant ut u value ut may change one time interval another time require optimality condition uu given initial condition depending x0 x p reach origin lastly 0 tt require observe 30 hamiltonian system p intimately connected propertyt ptdv xt solution hu x dv return issue near end section 32 explaining manifold x p formed solution family truly graph gradient also 0 formula 28 hu shows 34 indeed satisfied 32 general property hamiltonian systems 30 value hu xtpt constant respect property 31 implies jumps ut produce discontinuities respect 34 therefore 34 follows consequence 30 32 thus 34 31 give us 29 ut particular construction xtpt section 32 show ut xt extends u xt provide saddle point conditions 29 interior equation hx dv many solutions one property particular solution want v associated stable manifold 30 accord general approach van der schaft 15 16 17to robust nonlinear control see convergence origin another important property end notice formula 28 individual hamiltonian together 34 impliess ptdv xt 33 saying dt stipulate v 35 one may wonder insisted 32 observe 33 limit 0 implies necessary family xtpt described give us function v x desired saddle point properties interior points however x k 25 26 complicated nontrivial structure x v claim v x constructed fact satisfy saddle point conditions 25 26 x k well give mathematical proof instead developed scheme numerical confirmation applied test claim specification si described section 4 also note requirement 32 xt 0 tt given follows verify whenever xt ik ni p gu 0 rely numerical tests fact well see discussion 52 section 4 based success tests numerous examples conjecture 25 26 true general reference boundary verifications section 4 theorem 1 indicates validity result depends success tests 31 identification properties invariant control vectors construct family xtpt generalizing development 2 key look solutions approach origin 32 using constant control u solution 30 constant conditions xt0ptis observe 0 2 values sint 1 cost positive consider 31 requires 38 uu finite number provide key explicit representation family solutions xtpt desire call gu satisfying 39 invariant control vector simplify discussion let denote columns g general models gi would extreme points gu say gu means convex combination gi 1 consider set indicies follows 39 every j j achieves maximum value gi n therefore construction v x depends fact unique associated every nonempty subset j n existence j depends properties particular set gi uniqueness present uniqueness argument separately following lemma lemma 2 suppose gi 1 nonzero vectors rn j 1 nonempty exists vector j described 40 unique suppose j j exist j jthen proof establish 41 first without assuming uniqueness suppose exists 40 follows suppose j j exist j j reasoning implies 41 regarding uniqueness suppose j case 41 implies 42 implies gj j means orthogonal span gj since also span forced conclude dicult determine whether j exists given j values must nonnegative solution linear system nonnegative solution recover j check 40 observation prove j exists j n singleserver model theorem 2 assume specific g u0 model see section 2 every nonempty j n exists unique invariant control vector j moreover j j j 40 strictly positive proof let gj gjjj matrix whose columns gj j j observe 43 simply says j jjj must solve gtj gj j 1j existence nonnegative j 43 enough show gtj gj invertible entries inverse nonnegative consider diagonal matrix let note mj nothing gj particular case enough show mjt mj 1 exists nonnegative entries observe mjt mj block diagonal ak1 0 b tridiagonal form 121 121 one may check explicit calculation denoting size c 1 since entries positive cases follows entries mjt mj 1 hence gtj gj 1 nonnegative desired since rows identically 0 positive 43 therefore respective j 0 always found next need show gj j gi j ij j j first observe gj constant j j also note know j 0 ij therefore gi j 0 every ijandgj j gi j lemma 2 gives uniqueness observe 17 scalar multiple n indeed notation proof follows n n n particular 20 alternately described fundamental construction existence uniqueness following representation x using nested sequence invariant control vectors theorem 3 assume specific g u0 model every nonzero x unique representation form 0 aj aj 1 j1 jk n moreover proof consider nonzero x first solve g reader check g1 nonnegative entries implies 0 therefore every x k written next let consider invariant control vector consider j ajgj choice implies j j however one j jj aj 0 induction number positive coecients 47 possible write j simply taking completes induction argument next notice since ji 2 hypothesis x conclude aj 1 consider j1 45 j j j1 j j ji 40 tells us however j j1 j j1 i1 gj ji gj ji depending whether j ji conclude gj xgj x proves j1 set j gj x takes largest possible value claimed regarding uniqueness since g nonsingular uniquely determined jk last term 45 necessarily j since jk1 jk k1 j akjgj still must nonnegative coecients j akj j jk1 positive hence j implies ak well thus jk ak uniquely determined repeating argument k1 ajjjgives uniqueness ajjj following lemma records two facts used lemma 3 assuming g u0 model coordinates n positive b x k theorem 3 xi 0 ij1 proof already observed 17 proves next suppose follows x gi 0 hand exist j x gj 0 take j largest xj 0 instance thus set j1 j include important realize single server reentrant queue studied special unique j defined every j n case multiserver systems example consider reentrant line two servers figure 2 gi gui ui u0 3 simple test calculations reveal many j j exists moreover turns gi linearly dependent points representable 45 account 3dimensional subset k 32 construction characteristic family exhibit desired family solutions 30 consider nested sequence j1 j2 jk parameters coecient functions aitanditacordingtotheformulas 48 use denote positive part k 0 aitandit nonnegative claim provide solution 3033 derivation 48 based calculations 2 simply present direct calculation possible end consider partial sums appearing left 48 consider one intervals 1 iwe taking pairwise dierences see using 49 find 1 thus 30 satisfied 1 using confirm property 31 interval observe since jt0forj know 46 pt gu maximized u uat u j j coordinates positive particular implicit construction function defined means 49 starting x express x 45 determine pxusing ijiwhere partial sums determined ai according 0 2 gradient map pxdv x solution 23 several facts record px proceeding theorem 4 map px described locally lipschitz continuous satisfies strict inequality x x 0 see first consider call maximal sequence j1 j2 jn ie ji precisely elements n consider x representable 45 particular maximal sequence maps x ai ai p linear maps ai simply lipschitz long ai remains bounded 1 since ai n see px indeed lipschitz compact subset constrained x associated fixed maximal sequence ji 45 relax positivity assumption ai 0 include additional ji every x associated one maximal sequence ji lipschitz continuity argument extends x associated given maximal sequence way finish continuity assertions theorem need consider x boundary regions associated distinct maximal sequences uniqueness assertion theorem 3 means nonzero terms representations agree implies corresponding terms expressions p also agree thus px continuous across boundaries regions associated dierent maximal sequences follows local lipschitz continuity assertion theorem valid argument px2 x2 2 pg 334 335 strict inequality comes fact equality occurs n 1 notice x x sinn 1 implies px argument given 2that px indeed gradient function v x x also generalizes present context brief standard reasoning method characteristics applied individual hamiltonians hu see dv xpx region associated given maximal sequence ji continuity across boundaries regions allows us conclude indeed c1 function v dv xpx taking v implies v x virtue discussion 35 finally return connection 31 x 29 since u convex x consists precisely u convex hull ej j j1 j1 45 x px iji positive corresponding ai positive see x alternate description u particular ut 31 belongs xt moreover pxgu value u x desired 29 4 verification conditions boundary completed construction v x satisfying 29 interior consider assertion x k resulting v remains solution h 27 replaced h 27 u x saddle point 25 26 specifically want confirm given x k associated u x following hold since know hu x imply 25 52 54 imply 26 together imply 23 validation 52 54 consists extensive numerical testing opposed deductive proof describe computational procedures test calculations performed numerous examples see section 44 confirming 52 54 within machine precision case gives us confidence theoretical validity 52 54 deductive arguments presented theoretical validity must considered conjectural 41 inactive projection given x corresponding u x 52 equivalent statement ni p gu 0 ix would easy check direct calculation given x however second part following lemma provides equivalent condition even easier check lemma 4 following equivalent 1 ni px gu 0 x k x 0alu xandi ix 2 pxi 0 x k ix 3 pxi 0 x 0in interior proof clearly 2 follows 3 continuity px see 2 implies 1 recall discussion section 22 fact nonidling policy ni gu 0 u x therefore 2 implies ni p gu pi 0 finally observe 1 implies characteristic curves 49 exit k forward time x0 interior xt remains k time follows pix 0 x interior 42 control optimality consider approach checking 53 given x k associated u x want check u minimizer u u observe virtue 52 since pgu value u x suces consider single u x show gives minimum px pguoveru u since continuous function u u compact know exist minimizing u moreover f ix ps pguprf pgu according 13 given f identify u maximizer p rf gu subject constraints lemma 1 part 2 53 false exception u would occur solution constrained minimization problem f ix exception 53 case solves standard linear programming problem subject u u bf p gu 0 u exception 53 feasible maximizer uf 55 verify 53 computationally invoke standard linear programming algorithm 55 nonempty subset f ix feasible maximizer found check note ixi singleton need check case sucient check directly j 1 n see first observe last constraint 55 satisfied vacuously since bf p gu 0 must hold u usuciently close u follows u gives local maximum p rf gu u since u convex must global maximum therefore u must convex combination ej p rf observe since constraint bf p guni p gu 0 scalar constraint must therefore satisfied one ej p rf means ej also solves 55 hence ix singleton suces check ej candidates u rather invoking linear programming algorithm 43 load optimality 52 confirmed know u x x q guq gu respect q x q guq gu maximal value 0 verify 54 need sure u x q x q gu q gu since x v continuous piecewise linear since x compact set follows exist u x q maximizes 56 q rn u x derive necessary conditions contingent specification subset f ix x q gurf q gu using part 3 lemma 1 know u uand q qsatisfy consider ane set q satisfying 58 since inequalities strict 57 q near q satisfying 58 must also x q gurf q gu thus q qis local maximum of59 p rf q gu q2 subject constraint nltf rf q gu0a simple calculation shows implies plf orthogonal projection onto kernel nltf constraint 58 vacuous take substituting back 59 considering result function uit follows u uis local hence global convexity solution quadratic programming problem subject u x bf plf rft p gu 0 verify 54 computationally consider pairs subsets f l ix invoke standard quadratic programming algorithm find feasible maximizer u exists u found take check direct calculation whether exception 54 56 consider f l ix find exceptions 54 confirmed x p note quadratic programming calculation skipped cases x q guq gu know exceptions 54 thus need considered secondly suppose ixi singleton case check case exception 54 q must maximize satisfy follows latter inequality simplifies ni p gu di p moreover since di ni ni1 equivalent ix means ij1soni gu 0 u x 61 would imply pj 0 jif already checked p 0 accord lemma 4 confirmation 52 sure exceptions 54 occur ix singleton thus need appeal quadratic programming calculations two xi zero 44 test cases begin test 3033 specific choice parameters s1 sn calculating invariant control vectors j face ik rectangular grid points x ik x n n n constructed grid point x compute representation 45 associated according 51 check pi 0 accord lemma 4 carry constrained optimization calculations described possible f l ix obviously amount computation involved prohibitive number dimensions n significant however modest n calculations completed reasonable amount time carried computations numerous examples including following s1 sn1 1 1 exceptions 5254 found 5 proof optimality theorem 1 turn proof optimality assertions theorem 1 hypothesis v x constructed section 32 saddle point conditions 25 26 confirmed well equivalent conditions lemma 4 know satisfies minimum performance criterion section 24 explained v x 0 x load q argument 2 theorem 21shows respect interval 0ton xt remains dt given x0 let xtpt particular path constructed according 30 xt0 know ut xt xt controlled path produced response load qt along 36 therefore dt establishes 21 next consider arbitrary strategy satisfying minimum performance criterion would like produce load qt related resulting state trajectory xtbyqtdv xt 2 theorem 23this accomplished limiting statefeedback strategies appealing existence result filippov solutions dierential inclusion 2 223 approximate load taking advantage properties x argument limited statefeedback strategies need filippov existence result given x show 0 exists load qt satisfying qit 0andqt 1 t0 utx qt holds dicult question existence closed loop system arbitrary strategy easily resolved introducing small time lag system solved incrementally sequence time intervals tn1tnwhere tn1tnthe values qt determined xt previous interval tn2tn1 basic existence properties system subject prescribed qt insure existence xtandqt let utx qt associated control function since qt always value dv x x know qit 0andqt 1 minimum performance hypothesis insures xt remains compact subset xt 1 must explain time lag leads term 62 observe x vrf v one finite number possible matrices rf uniform upper bound x consequently xt xt etbet next subset x x dv x lipschitz see theorem 4 follows constant c1 independent observed previously x v lipschitz v follows constant c2 0 know follows integrating sides 0tand replacing c2 yields 62 qt hand remainder argument proceeds 2 exists sequence xtn 0 v xtn 0 62 implies dt suppose sequence exists addition xt 1 know xt approach 0 must remain compact subset 0 63 dt wealsoknowfromtheorem4that1 x2 1 dv xt2 positive lower bound therefore right side 64 infinite thus 64 holds either case since 0 arbitrary 22 follows 6 example restricted entry section reconsider model modified exogenous load applied queue x1 illustrated figure 4 system equations qt scalar control matrix control values u uand constraint directions di remain carry general approach constructing v x outlined beginning section 3 details analysis dierent several regards significant shows general approach exclusive structural features sections 31 32 find optimal policy xas given 15 higher dimensions n2 interesting speculate whether optimal policy would likewise remain unchanged removed exogenous loads qit i1 however present explored 2 dimensions figure 4 reentrant loop single input queue presence 65 changes individual hamiltonian p1 first coordinate p p1p2 supremum achieved p1 corresponding hamiltonian system given u uis calculate invariant control vector described section 31 additional j consider simplify notation drop subscript n first place find significant dierence previous analysis calculation solution hamiltonian system associated analogous 38 previously using determined construction missing p2 term x2 equation 66 must use gut dierent time dependent seek solution xtatptt atandt nonnegative function 0 1 overbar x p distinguishes special solution others encountered light p equation terminal conditions 32 solution seek must form function 0 scalar multiple right side x equation must also scalar multiple since implies relationship tandt works using reduce 67 single second order dierential equation tat1 constant solution initial conditions convenient rest discussion fix one consequence fixing given x t0 xtx depends x 0 confirm 0 1 0andat 0 wished desired solution special solution provides final stage family paths xtpt 3033 section 3 adjustment contrast section 3 utt 1tt varies continuously instead piecewise constant means pay closer attention 34 satisfied virtue terminal conditions calculate dt hutxt pt one term automatically drop dt since p scalar multiple know g2 indeed find hutxt pt 0 analogue 33 example q2 x2 p1t2 xt2 qtpt also note taking advantage fact hu x verify 33 along x p particular simply observe since positive excepting following xit pit refer individual coordinates particular solution special solution xt pt provides final stage t1 0 solutions family described beginning section 3 initial stage tt1 0 solution 66 either e1 e2 joins x p t1 0 xt1xt1 pt1pt1 words solve 66 backwards xt1 pt1for appropriate choice u turns using produces part family covers region line x first quadrant using xt cover region x illustrated figure 5 parameter values s1 4s2 1 note region covered family hence domain v x longer simple polygon 2014106020 figure 5 characteristics restricted entry loop need verify resulting family indeed satisfies conditions outlined section 3 verifications discussed confirmed implies optimal control x produces e1 x line xt e2 x line u uif x line although produce explicit construction x p section 3 still find optimal control uu 61 interior verifications already discussed properties 3033 section 3 final stage family solutions xtxt ptptfort1 0 however still need verify 31 68 initial segment tt1 section 32 followed properties j rather explicit formulae xtandpt terms developed elaborate general structure instead resort direct evaluation needed inequalities solving 66 xt1xt1 pt1pt1 obtain formulas lower half family tt1 0 t1 0 valid tt1 first time x1t either reaches horizontal axis reaches outer boundary curves appearing figure bt1 1t1 formula 1 easily obtained expressions 69 value identified point determinant jacobian x1 respect vanishes explicit formula possible b well brevity omit formulas thus valid points horizontal boundary 2k x11t1 t1 bt1 1t1 analogous formulas upper half family obtained solving 66 xt1xt1 pt1pt1 obtain following expression tt1 0 time given t1 0 valid range tt1 slightly dierent turns x2t always reaches outer boundary time prior contacting vertical boundary 1k explicit formula b obtained setting jacobian 70 equal 0 thus given t1 0 70 valid vertical boundary traced solution t1 0 x valid b0 0 availability formulas makes possible check inequalities need 31 33 31 want verify 73 turns certainly positive tt1 resort numerical calculation confirm 72 already noted 33 replaced 68 xit2 pit2 0for 1 2 straightforward task prepare short computer program given values s1s2 evaluates 72 68 large number tt1 pairs extending full range possibilities way confirmed inequalities numerically 62 horizontal boundary finally must consider influence projection dynamics points x k confirming section 4 remains saddle point x v taken account entails checking three facts 52 54 53 consider two faces k separately reflection matrix 2k x v observe independent q since follows x mq gu mq gu 52 reduces 72 moreover independence q also implies 54 since know saddle point absence projection dynamics next consider 53 u uare note corresponds 1 53 want show minimum occurs little algebra shows 0 s1s2s2 s1s2s2 1wehaven2 mp1 gu 0 thus function 75 piecewise linear two segments slope right segment s2 1 already know negative virtue work checking 72 thus establish 53 need check value greater 0 equivalent p g1 0 confirmed numerically evaluating various choices s1s2 t1 throughout range 63 vertical boundary recall along 1k 71 know thus x mq gumq gu confirming 52 reflection matrix 1k already know q x mq g2mq g2 need consider possibility global maximum among q x mq g2r1mq g2 namely q n1 mq g2q 0 however maximized maximum q 0 must occur confirms 54 finally turn 53 since u 74 therefore little algebra minimized corresponds verifies 53 r introduction variational inequalities applications queueing systems theory applications reflected brownian motion orthant neumann type boundary conditions hamiltonjacobi equations nonlinear state space h1 control theory optimal draining reentrant fluid lines department mathematics tr