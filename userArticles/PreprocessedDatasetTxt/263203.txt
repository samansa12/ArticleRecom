matrix sign function method computation invariant subspaces perturbation analysis shows numerically stable procedure used compute matrix sign function competitive conventional methods computing invariant subspaces stability analysis newton iteration improves earlier result byers confirms illconditioned iterates may cause numerical instability numerical examples demonstrate theoretical results b introduction 2 r nthetan eigenvalue imaginary axis matrix sign function signa may defined z 1 fl simple closed curve complex plane enclosing eigenvalues positive real part sign function used compute eigenvalues invariant subspaces 2 4 6 13 14 solve riccati sylvester equations 9 15 16 28 matrix sign function attractive machine computation efficiently evaluated relatively simple numerical methods surveyed 28 particularly attractive large dense problems solved computers advanced architectures 2 11 16 33 beavers denman use following equivalent definition 6 13 let jordan canonical decomposition matrix eigenvalues imaginary axis let diagonal part j given matrix invariant subspace corresponding eigenvalues positive real part let invariant subspace corresponding eigenvalues negative real part let skew projection onto parallel skew projection onto parallel using contour fl 1 projection p resolvent integral representation 23 page 67 2 z 2 appear siam journal matrix analysis applications university kansas dept mathematics lawrence kansas 66045 usa partial support received national science foundation grants int8922444 ccr9404425 university kansas grf allocation 3514200038 z tuchemnitzzwickau fak f mathematik d09107 chemnitz frg partial support received deutsche forschungsgemeinschaft projekt la 76732 follows 1 2 matrix sign function introduced using definition 1 roberts 1971 technical report 34 published 1980 35 kato 23 page 67 reports resolvent integral 2 goes back 1946 12 1949 21 22 concern numerical stability numerical methods based upon matrix sign function 2 8 19 paper demonstrate evaluating matrix sign function illconditioned computational problem problem finding bases invariant subspaces v section 3 nevertheless also give perturbation error analyses show least newtons method computation matrix sign function 8 9 circumstances accuracy competitive conventional methods computing invariant subspaces analysis improves perturbation bounds 2 8 18 24 section 2 establish notation clarify relationship matrix sign function schur decomposition next two sections give perturbation analysis matrix sign function invariant subspaces section 5 gives posteriori bounds forward backward error associated corrupted value signs section 6 stability analysis newton iteration throughout paper k delta k denotes spectral norm k delta k 1 1norm column sum norm k delta k f frobenius norm k delta k set eigenvalues matrix denoted open left half plane denoted c gamma open right half plane denoted c borrowing terminology engineering refer invariant subspace matrix 2 r nthetan corresponding eigenvalues c gamma stable invariant subspace subspace corresponding eigenvalues c unstable invariant subspace use skew projection onto v parallel v gamma skew projection onto 2 relationship schur decomposition suppose schur form k 11 12 solution sylvester equation solution 4 integral representation z fl closed contour containing eigenvalues positive real part 29 36 stable invariant subspace range column space qr factorization column pivoting 1 17 q r partitioned obvious way columns q 1 form orthonormal basis subspace q orthogonal pi permutation matrix r upper triangular r 1 nonsingular difficult use singular value decomposition show follows 4 sep defined 17 3 effect backward errors section discuss sensitivity matrix sign function subject perturbations perturbation matrix e give first order estimates e terms submatrices powers kek based frechet derivatives kenney laub 24 presented first order perturbation theory matrix sign function via solution sylvester equation mathias 30 derived expression frechet derivative using schur decom position katos encyclopedic monograph 23 includes extensive study series representations perturbation bounds eigenprojections section derive expression frechet derivative using integral formulas let oe min oe min smallest singular value gamma ii quantity da distance nearest complex matrix eigenvalue imaginary axis practical numerical techniques calculating da appear 7 10 e small perturb eigenvalue across imaginary axis follows kek da signae stable unstable invariant subspaces smooth functions e consider relatively simple case block diagonal lemma 31 suppose block diagonal partition perturbation e 2 r nthetan conformally f 12 f 21 satisfy sylvester equations 22 f proof hypothesis implies eigenvalues 11 negative real part eigenvalues 22 positive real part definition 1 choose contour fl enclose neither particular complex numbers z lying contour e nonsingular e z z e z partitioning f conformally e f 11 2i z z z f 22 2i z 6 f 12 f 21 solutions sylvester equations 11 12 29 36 contour fl encloses eigenvalues 11 inside fl f first prove f 22 0 case 22 diagonalizable say z component integral form r constant c integral residue free holomorphic function hence vanishes j 6 k z c z c general case follows taking limits diagonalizable case using dominated convergence theorem following theorem gives general case theorem 32 let schur form given 3 partition e conformally satisfies 4 e satisfies sylvester equation 22 proof 11 12 follows lemma 31 left side sq h right side equation easy verify gammai gammai theorem follows gammai da small relative kak ky k large relative kak hypothesis kses may restrictive however small value da indicates near discontinuity signa large value ky k indicates small stable invariant subspace illconditioned 37 39 course theorem 32 also gives first order perturbations projections corollary 33 let schur form given 3 let e 13 hypothesis theorem 32 projections p e statement theorem 32 taking norms theorem 32 gives first order perturbation bounds next corollary corollary 34 let schur form given 3 e 13 first order perturbation matrix sign function stated theorem 32 bounded first examination corollary 34 discouraging suggests calculating matrix sign function may illconditioned finding bases stable unstable invariant subspace matrix whose schur decomposition appears 3 perturbed e stable invariant subspace rangeq 1 perturbed 34 following example show signae may indeed differ signa factor ffi gamma3 may much larger kekffi example 1 let matrix already schur form e p difference perturbing ae indeed perturb matrix sign function factor ffi gamma3 course rounding error example 1 stable invariant subspace ae also stable invariant subspace signae particular evaluating exactly done damage perturbing stable invariant subspace 0 stable invariant subspace e general small perturbation matrix e angle order larger o1j 17 37 39 matrix sign function projections may significantly illconditioned stable unstable invariant subspaces nevertheless argue paper despite possible poor conditioning matrix sign function invariant subspaces usually preserved accurately native conditioning permits however perturbation e large enough perturb eigenvalue across imaginary axis stable unstable invariant subspaces may become confused cannot extracted e may occur even invariant subspaces wellconditioned since sign function defined case geometric terms situation within distance kek matrix eigenvalue zero real part fundamental difficulty method identifies two invariant subspaces signs real parts corresponding eigenvalues 4 perturbation theory invariant subspaces matrix sign func tion section discuss accuracy computation stable invariant subspace via matrix sign function easy first observation computed value signa exact value signae perturbation matrix e exact stable invariant subspace e also invariant subspace e let schur form 3 let e perturbation matrix partitioned conformally 13 let q 1 first k columns q q 2 remaining columns stable invariant subspace invariant subspace ffl 39 singular values w tangents canonical angles particular canonical angles order o1 unfortunately general cannot apply backward error analysis ie cannot guarantee computed value signa exactly value e perturbation e consider instead effect forward errors let f represents forward error evaluating matrix sign function let schur form 3 partition q h signaq q h fq q unitary factor schur decomposition 3 solution 4 assume let oe perturbing signa changes invariant subspace 8 oe 21 since obeys bounds 4oe 21 comparing 19 20 see error bound 20 greater twice error bound 19 loosely speaking small relative error signa size ffl might perturb stable invariant subspace much twice much relative error size ffl therefore stable unstable invariant subspaces signa may less illconditioned never significantly illconditioned corresponding invariant subspaces fundamental numerical instability evaluating matrix sign function means extracting invariant subspaces however numerical methods used evaluate matrix sign function may may numerically unstable example 1 continued illustrate results give comparison perturbation bounds bounds given 3 matrix sign function invariant subspaces case example 1 distance nearest illposed problem ie smallest singular value leads overestimation error 3 since da j gamma2 bounds given 3 respectively oj gamma4 matrix sign function oj gamma2 invariant subspaces 5 posteriori backward forward error bounds priori backward forward error bounds evaluation matrix sign function remain elusive however difficult derive posteriori error bounds backward forward error need following lemma estimate distance matrix signs lemma 51 2 r nthetan eigenvalue zero real part k signss proof let matrices f signs commute implies taking norms using kfs lemma follows clear proof lemma 51 asymptotically correct k signs gamma sk tends zero bound lemma tends overestimate smaller values k signs gamma sk factor two suppose numerical procedure evaluating signa applied matrix 2 r nthetan produces approximation 2 r nthetan consider problem finding small norm solutions e 2 r nthetan f 2 r nthetan course uniquely determine e f common algorithms evaluating signa like newtons method square root guarantee nearly square root 19 ie close approximation signs following theorem arbitrarily taken theorem 52 k signss perturbation matrices e f satisfying proof matrices f ae commute underdetermined consistent system equations e terms es let gammai schur decomposition signs whose unitary factor u whose triangular factor righthandside 24 partition u h eu u h au conformally righthandside 24 11 12 21 22 multiplying 23 left u h right u partitioning gives 21 gammaa one infinitely many solutions e given choice e theorem follows lemma 51 theorem 52 agree well intuition order assure small forward error must good approximate square root addition assure small backward error signs must nearly commute original data matrix newtons method root tends good job 19 note general newtons method makes poor algorithm find square root matrix square root special case see 19 details particular hypothesis k signss usually satisfied matrix sign function computed newton algorithm signs quantity k ss gamma1j ss gamma1j k makes good estimate righthandside 21 bound 22 easily computed estimated known values however expressions prone subtractive cancellation significant digits quantity ke 21 k related 18 perturbations stable invariant sub space bounds 21 22 fortiori bounds ke 21 k 1 2 block 25 suggests tend pessimistic overestimates ke 21 k ksk ae 1 6 newton iteration computation matrix sign func tion several numerical methods computing matrix sign function 2 25 among simplest commonly used newtonraphson method root starting initial guess easily implemented using matrix inversion subroutines widely available high quality linear algebra packages like lapack 1 2 extensively studied many variations suggested 2 4 5 9 18 27 25 26 28 algorithm 1 newton iteration without scaling eigenvalues imaginary axis algorithm 1 converges globally locally quadratically neighborhood signa 28 although iteration ultimately converges rapidly initially convergence may slow however initial convergence rate numerical stability may improved scaling 2 5 9 18 27 25 26 28 common choice scale x k 1j detx k j 1n 9 theorem 32 shows first order perturbation signa may large relative uncertainty uncertainty ffl least large roundoff unit finite precision arithmetic thus reasonable stop newton iteration ad hoc constant c chosen order avoid extreme situations eg choice c works well numerical experiments shows furthermore often advantageous take extra step iteration stopping criterion satisfied example 2 example demonstrates stopping criterion algorithm 1 implemented matlab 41 hp 71533 workstation floating point relative accuracy constructed random unitary matrix r upper triangular matrix diagonal elements parameter ff k k position zero everywhere else chose ff norm k signak 1 varies small large typical behavior error goes becomes stationary behavior shown figure 1 cases stopping criterion 26 satisfied 1000n 8th step 7th step taking one extra step would stop 9th step 8th step exact arithmetic stable unstable invariant subspaces iterates however finite precision arithmetic rounding errors perturb subspaces numerical stability newton iteration computing stable invariant subspace analyzed 8 give improved error bound let x x respectively computed kth 1st iterate newton iteration starting 11 12 fig 1 2 number iterations log10xks1 alpha0 suppose x x form successful rounding error analysis must establish relationship e assume stable algorithm applied compute inverse newton iteration precisely assume x constant c note nontrivial assumption ordinarily gaussian elimination partial pivoting used compute inverse error bound shown hold column separately 8 38 better inversion algorithms applied typical matrices satisfy assumption 38 p 151 difficult determine always case 31 pp 2226 20 p 150 write ex ez following theorem bounds indirectly perturbation stable invariant subspace theorem 61 let x ez 27 28 31 32 if2 c 29 30 proof start 28 fact relationship e 21 applying explicit formula inverse x c c c c c c using neumann lemma kbk 1 following inequalities established similarly 22 k 22 kke 22 k inserting inequalities 33 obtain bound theorem 61 stronger bound byers 8 follows 19 theorem 61 rounding errors step newton corrupt stable invariant subspace one might expect perturbation e 21 27 term sepx 22 dominated sep guarantee rounding errors newton iteration little damage factors bound theorem 61 kx gamma1 22 k kxk small enough roughly speaking numerical stability throughout algorithm neither 22 k kxk much larger 1 following example 4 demonstrates numerical instability traced violation inequality 34 example 3 let 11 6 6 6 6 4 real matrix let 22 gammaa form 11 12 orthogonal matrix q chosen unitary factor qr factorization matrix entries chosen randomly uniformly distributed interval 0 1 parameter ff taken two eigenvalues close imaginary axis left right side entries 12 chosen randomly uniformly distributed interval 0 1 entries e 21 chosen randomly uniformly distributed interval 0 eps gamma16 machine precision table evolution ke example 3 r 3 12093e07 25501e08 16948e00 5 73034e08 54025e09 20000 6 73164e08 27012e09 20000 7 72020e08 13506e09 20000 8 71731e08 67532e10 20000 9 71866e08 33766e10 20000 13 71934e08 21151e11 20000 14 71938e08 10646e11 20000 19 71937e08 17291e12 20000 example shows evolution ke newton iteration starting respectively e 21 27 norm taken 1norm ka gamma1k 1 violated first step newton iteration starting matrix shown first column table newtons method never recovers remarkable however newtons method applied r directly seems recover loss accuracy first step second column shows although gamma7 first step reduced factor 12 every step reaches 17 theta 10 gamma12 approximately observe case perturbation e 00 ez 28 zero dominated 1ke 22 surprising see second step kx gamma1 22 k 1 small eps since gamma1 11 gamma1 22 explicitly appear term x gamma1 22 first step analysis suggests newton iteration may unstable x k ill conditioned overcome difficulty newton iteration may carried shift along imaginary line case use complex arithmetic algorithm 2 newton iteration shift end real parameter fi chosen oe min fiii small example 2 fi taken 08 analysis computed invariant subspace guaranteed accurate 7 conclusions given first order perturbation theory matrix sign function error analysis newtons method compute analysis suggests computing stable unstable invariant subspace matrix newton iteration circumstances yields results good obtained schur form 8 acknowledgments authors would like express thanks n higham valuable comments earlier draft paper z bai p benner helpful discussions r design parallel nonsymmetric eigenroutine toolbox design parallel nonsymmetric eigenroutine toolbox inverse free parallel spectral divide conquer algorithms nonsymmetric eigenproblems accelerated convergence matrix sign function method solving lyapunov computational method eigenvalues eigenvectors matrix real eigenvalues regularity result quadratically convergent algorithm computing l1 norm numerical stability instability matrix sign function based algorithms solving algebraic riccati equation matrix sign function bisection method measuring distance stable matrix unstable matrices systolic algorithm riccati lyapunov equations perturbations des transformations autoadjointes dans lespace de hilbert matrix sign function computations systems spectral decomposition matrix using generalized sign matrix generalization matrixsignfunction solution algebraic riccati equations parallel algorithms algebraic riccati equations matrix computations computing polar decomposition applications newtons method matrix square root survey error analysis convergence perturbation method convergence perturbation method perturbation theory linear operators polar decompositions matrix sign function condition estimates rational iterative methods matrix sign function scaling newtons method polar decompositions matrix sign function matrix sign function theory matrices condition estimation matrix sign function via schur decomposition software roundoff analysis matrix algorithms schur complement statistics parallel algorithm matrix sign function linear model reduction solution algebraic riccati equation use sign function linear model reduction solution algebraic riccati equation use sign function perturbation bounds subspaces associated certain eigenvalue problems introduction matrix computations matrix perturbation theory tr ctr daniel kressner block algorithms reordering standard generalized schur forms acm transactions mathematical software toms v32 n4 p521532 december 2006 peter benner maribel castillo enrique quintanaort vicente hernndez parallel partial stabilizing algorithms large linear control systems journal supercomputing v15 n2 p193206 feb12000