geometric computation curvature driven plane curve evolutions present new numerical scheme planar curve evolution normal velocity equal fkappa kappa curvature f nondecreasing function f00 either xmapsto fx3 lipschitz lipschitz constant less equal 1 fxxgamma gammageq 13 scheme completely geometrical avoids drawbacks finite difference schemes particular special parameterization needed scheme monotone curve initially surrounds another one remains true evolution guarantees numerical stability prove consistency convergence scheme weak sense finally display numerical experiments synthetic real data b introduction paper investigate evolution closed smooth plane curve point curve moves normal velocity depending curvature curve point precisely study evolution curve c obeying equation ns inner normal vector curve point parameter evolution time equations type 1 model phenomena physics material science also play important role digital image analysis indeed proved 1 image analysis process satisfying reasonable properties invariance essentially causality stability invariance respect isometries contrast changes described equation type 1 precisely corresponding grey level evolution described scalar equation considered viscosity sense 6 equation x z email moisancmlaenscachanfr x mail adress cmla enscachan 61 avenue du president wilson 94 235 cachan cedex france phone curvature level line passing x equation 2 means level lines u move respect equation 1 case f convention f ff 2 r x 2 r particularly interesting since contrast invariant equation also commutes affine transformations preserving area set named special affine group composed mappings type x 7 ax linear transformation det 1 case f extensively studied 8 9 existence regularity vanishing finite time proved affine invariant case f x 13 also studied 2 22 23 results exposed 25 equivalence curve motion contrast invariant smoothing proved 7 paper focus possible numerical algorithm solving 1 according 7 u continuous realvalued function r 2 solve equation 2 applying algorithm level lines u course implies level lines must intersect evolution thus require like equation 1 algorithm satisfies inclusion principle meaning order respect inclusion respected among first attempts solve equation 1 osher sethian 19 24 solve 2 introducing signed distance function curve time unfortunately algorithm satisfies neither inclusion principle rotation invariance addition evolution priori depends chosen distance function since scalar algorithm contrast invariant moreover data thus cpu time becomes rapidly huge high precision requested attempts curves finite difference schemes also made 15 16 interesting results nongeometric nature scheme still prevents inclusion principle satisfied moreover evolution driven power curvature larger 1 discretization curves enclined becoming sparser around points high curvature thus preventing good accuracy contrary completely different scheme implemented 17 18 affine invariant case fully geometrical also satisfies inclusion principle implying numerical stability 11 theoretical algorithm moving hypersurface power gauss curvature also studied generalize implement algorithm plane nonconvex curves general functions curvature mention numerical approach curves advantage resolution limited pixel size allows high precision moreover computation time far shorter scalar approach hand topology changes eg single curve breaking two connected components automatically handled scalar approach real problem plane curves evolution since likely topological changes occur proved least 9 mean curvature flow 2 affine curve evolution contrary known topology changes occur higher dimension addition seems difficult least trivial generalize algorithm higher dimensions even hypersurfaces three dimensional space paper follows first give section x2 preliminary definitions introduce operators sets provides operators curves boundaries sets operators consistent curvature dependent differential operators satisfy monotonicity continuity properties allowing extend real valued functions prove consistency results give proof convergence without entering much details since prefer focus numerical applications x3 adapt operator previously defined special case evolution driven power curvature x4 give algorithm scaling covariance properties curve scale space show x5 numerical experiments convex case well nonconvex case 2 definition properties first give notations previously used 18 let c semiclosed curve r 2 oriented simple curve dividing plane exactly two connected components k interior c bounded component r 2 nc c closed suppose c oriented k lies left c positively described rigorously assume plane counterclockwise oriented inner normal tangent vector inner normal form orthonormal direct basis assume smooth parameterization defined c example piecewise c 1 chord segment form cs ct intersect point c parameter chord set c st connected set enclosed chord cs ct curve cs say c st oechord set oechord l 2 c st area chord set strictly included c st strictly less oe denote k oe c set oechord sets oechord k c st associated oechord set call chord arc distance c c st number ffics cs ct ffi hausdorff semi distance particular commutative defined x r 2 also denote ffi st x signed distance x oriented line cs ct r 2 denote x determinant 2 theta 2 matrix columns x also denote k oe c sets positive oechords ie chordsets c st satisfying way define oe set negative chord sets remark positive chord sets chordarc distance nothing sup ffi st x x 2 cs negative chord sets chordarc distance finish notations set define mapping set plane sets shall assume piecewise regular sake simplicity let g nondecreasing 1lipschitz function defined r k set r 2 whose oriented boundary assume l 2 k oe c st chord set k chordarc distance h write oe c st ae oe 23 oe sequel shall briefly say oe c st modified chord set remark righthand term inequality nonnegative lipschitz assumption g hence modified oechord set always included associated oechord set figure 1 represent oechord modified chord modified oechord set filled psfrag replacements oe oe 23 g h figure 1 oechord set transform k interior piecewise c 1 semiclosed curve define oe 4 refer e oe erosion operator e oe k eroded k scale oe remark 2 algorithm 18 corresponds remark 3 generalize definition 1 sets several connected components applying erosion component lemma 4 let k convex set r 2 e oe k also convex proof write kn oe proves e oe k convex intersection convex sets intersection k half plane lemma 5 k smooth compact set e oe k compact set proof obvious since k intersection compact sets proposition crucial theoretical point view well numerical one since necessary obtain stable numerical algorithm proposition 6 inclusion principle let k 1 ae k 2 assume g nondecreasing 1lipschitz proof assume x 2 k 2 x 62 e oe k 2 prove x 62 e oe k 1 x 62 k 1 assume x 2 k 1 assumption exists oe 0 chord k 2 denote c oe 0 oe x belongs modified chordset lipschitz condition g implies x also belongs oe 0 chord set oe 0 chord delimits k 1 unique chordset containing x let oe 00 area oe 00 oe 0 thus oe 00 oe suffices prove chord excludes x e oe k 1 consider situation illustrated figure 2 chordarc distances c k 1 k 2 chordarc distances associated modified chords iii l difference length k 1 k 2 direction orthogonal chords ie enough prove l l 1 l 2 know l oe 23 g h 2 1lipschitz conclude psfrag replacements l l 1 l 2 x oe 00 figure 2 inclusion principle proposition 7 assume class c 2 let 2 c curvature c equal 0 lim oe 23 positive part defined proof assume c concave curvature strictly negative neighborhood oe small enough oechord 2 cs strictly negative oechord hence 2 e oe k proposition follows assume c strictly convex thus neighborhood chord parallel tangent enclosing oechord set containing chordarc distance h satisfies easily established parabola regular curve approximation see 18 example result follows 3 4 imply oe 23 fact g continuous following property continuity property allowing extend e oe plane set define operator acting functions real values proposition 8 continuity let k n sequence compact smooth sets let assume k also smooth set proof since k ae k n n monotonicity also first part equality order prove reverse inclusion assume family k n nonincreasing without loss generality also suppose k n converges k hausdorff distance compact sets assume x 62 e oe k definition chord area oe modified chord excludes x since oe k closed complementary open set thus assume area c st strictly less oe k n also defines chord n large enough area chord also less oe using convergence measures moreover k n tends k hausdorff distance chordarc distance also converges since g continuous implies chord excludes x k n n large enough hence x 62 e oe k n ends proof remark 9 compactness assumption proposition far necessary suffices example boundary sets locally convex concave ensures erosion local oe small conclude kind arguments note also continuity property allows define erosion closed set approximating closed sets smooth closed sets extend e oe realvalued functions r 2 first u r define usual level set value set applying theorem matheron see 14 yields following f set real valued functions r 2 level sets elements f compact smooth extend e oe elements f setting equivalent define e oe u level sets uniquely defines monotone translation invariant operator commuting nondecreasing continuous functions also define dual operator oe called dilation operator subscript designing complementary set r 2 operator satisfies properties e oe except consistency result positive part curvature replaced negative part standard arguments 4 10 20 derive following consistency result operator acting functions proposition 11 let u c 3 function x point dux 6 0 ux 6 0 proof whole proof difficult bit technical long thus enter details shall skip points aim prove e oe u depends local features u choose ff oe oe tends 0 note incompatibility choose r oe 14 instance using translation invariance contrast invariance assume proof following r small enough curvature level lines u strict sign d0 r consequence oechord estimate chordarc distance equation 5 moreover kind approximation made circle parabola shows length chord order oe 13 hence oechord intersecting d0 r asymptotically included d0 r1 choice r assume first u0 0 define u u gamma u elsewhere replace infinite value large numbers global inequalities enough level lines u uniformly strictly concave d0 r thus positive oechord level sets u gamma u intersecting d0 r hence r assume 0 define d0 r d0 r elsewhere constant k chosen oe small enough psfrag replacements figure 3 case 0 left level set u gamma oriented boundary bold line level set bounded connected component delimited curve dashed line boundary eroded set right level set u boundary bold oriented line level set unbounded component cases positive oechord set intersecting d0 r hence erosion effect possible since assumed u c 3 monotonicity yields v w trivial level sets d0 r quite easy estimate image e oe use consistency result proposition 7 trick level lines u v parabola canonical form nevertheless arguments led back situation 4 10 20 computation eroded level sets v w drawn figure 4 longer difficult prove constants depending 2 u0 apply result dilation operator oe obtain second part proposition next proposition first extend g make odd x 0 set gammaggammax proposition 12 let u c 3 function suppose dux 6 0 ux 6 0 proof follows fact 1 e oe oe monotone commute addition constants 2 near point gradient curvature different zero arguments developed previous proposition uniform order complete give without proof simple introducing affine erosion operator 18 lemma controlling behavior e oe critical points psfrag replacements figure 4 case 0 left level line v oriented bold line eroded line dashed line right thing w lim oe 23 limit taken oe tend 0 independently consistency result allow deduce convergence result enounce see 21 denote theorem 14 let u 0 bounded uniformly continuous r 2 oe 0 let define r 2 theta r r oe tends 0 u oe converges locally uniformly unique viscosity solution equation usual definition viscosity solution 6 longer valid possible singularity operator critical points extended notion solution defined 3 solution still exists unique 3 curvature power 31 approximation power functions section show previous study adapted particular case power functions f 1lipschitz whole real line define largest positive number power function x 3fl derivative less 1 g 1lipschitz apply e oe function could think scheme consistent motion curvature power indeed curvature large fixed oe may happen chord arc distance also large erosion given linear part g nevertheless shall see adequate scaling g evaluated linear part slightly change notations definition e oe simplify statements case power functions oeset c st set oe c st still define erosion operator oe 23 scale tends 0 h also tends 0 g taken linear part fact get operator consistent power function due homogeneity properties power functions implies except power functions new definition erosion operator makes sense adapt proof inclusion principle 6 prove modified erosion operator e oe still satisfies inclusion principle consistency curves circles enough easy establish continuity problem well thus using matherons theorem extend erosion operator operator acting functions following proposition asserts operator consistent power curvature proposition 15 let u c 3 function let x dux 6 0 u0 6 0 moreover consistency locally uniform proof usual assume first time assume u0 0 use locality argument first proof consistency chapter since curvature u small ball radius r 0 bounded positive constant say level sets u positive oechord d0 r set use locality argument first proof consistency oe small enough level sets u gamma positive oechord d0 r thus erosion effect upon u gamma d0 r using monotonicity result proved case 0 let us come difficult case assume cxy taylor expansion u origin parameter let r chosen small enough vx ux d0 r extending v gamma1 d0 r remains true everywhere moreover assume curvature level lines v still strictly negative indeed value value origin want approximate e oe v0 let j 0 also small curvatures level lines v larger part proof curvatures negative hence circle small curvature also small radius invoke locality property erosion case curve strictly negative curvature know chordarc distance equal ooe 23 length chord deduce oechord sets containing 0 must included ball radius ooe 13 small computation shows modified corresponding oechord sets included ball radius ooe fl constant terms clearly uniform curvature bounded negative constant particular depend j let x d0 r call c gammagammaj x disk curvature tangent level line v x side vx x comparison curvatures still assume r small enough inclusion since erosion operator local also assume e oe v0 definition means 0 62 e oe u using inclusion principle deduce 0 62 e oe c gammagammaj x point level line v value find unique point x x normal x colinear due strict convexity level lines theorem intermediary values point also characterized fact distance origin tangent level line minimal hence modified oechord set c gammagammaj also contains origin let coordinates x simple calculation gives since x dux colinear using consistency disks jx finally deduce approximated jdvx j p ooe 2fl term analysis performed since eventhough constant explicited already stress depend upon j deduce let search upper bound e oe u0 repeat arguments since similarity research lower bound approximate u taylor expansion define 2cxy u w small ball radius r enough curvature level lines w smaller also chosen negative r small enough locality oechords still holds define c j x radius equal r small enough x level set wx w included c j x inside d0 r rest proof still application comparison principle asymptotic behavior erosion disks assume e oe w0 means particular implies x 3fl use characterization 24 x deduce must since true 0 j 0 also obtain pass limit since o1 term uniform j since curvatures may taken bounded strictly negative constant thus 0 case 0 gives result case dilation deduced relation oe gammau uniform consistency follows fact oechords uniformly bounded ball radius ooe 23 constants terms bounded soon curvature absolute value strictly positive constant uniform consistency yields consistency alternate operator corollary critical points need describe behavior erosion following manner let r c 2 function tends 0 lemma sequence points x n tending 0 lim oe 2fl limit taken n oe tends respective limit independently h designs either e oe oe oe lemma easily established finding estimates radius circle erosion prove following convergence theorem theorem 3 let alternate dilationerosion curvature power function x fl let u 0 bucr 2 define u oe oe tends 0 u oe tends locally uniformly unique viscosity solution equation initial value u 0 soon power fl 1 usual notion viscosity solution appropriate since elliptic operator jdujcurv u fl singular critical points ishii souganidis proved 12 existence uniqueness still true test functions restricted class functions flat critical point flatness given conditions previous lemma point apart scheme proof standard explicit new point previous lemma case test functions stationnary case lemma directly gives solution leave rest proof reader 32 scale covariance denote h dilation ratio h evolution semigroup curve evolving according equation 25 solution exists unique least short times smooth initial data see 25 semigroup satisfies relation indeed let c 1 evolving curve defined simple check c 1 satisfies equation 25 initial condition h c0 exactly equation 26 asserts erosion operator e oe satisfy covariance property thus define modified operator 2 oe positive parameters depending upon possibly c want satisfy covariance property 26 like true soon oeh c also want consistent convex set k c 3 boundary term ot measured hausdorff distance also use abusive notation denoting k set whose boundary k using consistency result see oe must linked relation assume oe 0 fixed chosen large enough oe chord k chordarc distance h inequality ff fl 30 holds modified chordarc distance given g near origin equation 21 involved precisely 2 k smooth boundary consistency writes notice interesting take smallest possible value given case equality 30 order get largest possible scale step 29 summarize results following proposition 19 let ha denote chordarc distance chord operator defined 27 sup gamma3fl 3fl gamma1 delta 12fl 32 consistent 25 satisfy scaling property 26 remark 20 error analysis order obtain consistency necessary h ff fl oe instance fix define 27 29 still consistency since inequality 30 holds oe small enough however oe satisfy 30 difference c c magnitude since equation21 involved contrary difference ot 2 oe satisfy 30 consistency 5 4 algorithm 41 general method iteration operator defined involves three parameters scale step viewed time step erosion area oe saturation length three quantities satisfy 32 leaves one degree freedom usual numerical scheme would consider free parameter time step related required precision define oe present case would good choice two reasons first defined explicit function oe implicit function suggests oe may better least simpler free parameter second geometrical interpretation scheme defined contrary oe corresponds way scale look curve particular oe constrained numerical precision curve known roughly speaking c approximated polygon precision corresponding example hausdorff distance must oe ae 2 order effect erosion iteration overcomes effect spatial quantization reasons choose fix oe free parameter compute using 32 scale step obtained way large simply adjust reducing oe keeping value propose following algorithm evolution convex set k final scale area precision oe 1 let 2 oeset k compute chordarc distance set maximal value distances decrease oe order keep previous equality apply operator k yielding k tffit increment ffi practice course impossible deal oechords fact curve polygonal line take chords end point equal vertex polygon 42 computation erosion boundary k included envelop modified chords obtain approximation set explicitly determine position unique point chord belonging envelop result generalization middle point property exposed 18 lemma 21 middle point property let k strictly convex set let 1 oeset k oechord c 1 let 2 another oeset let c 2 oechord dh tends 0 intersection point c 1 c 2 tends middle point c 1 proof quoted 18 let geometrical angle c 1 c 2 1 2 close enough c 1 c 2 intersect point call also call r 1 r 2 length part chord c 2 side since c 1 c 2 oechords psfrag replacements figure 5 middle point property implies limr 1 tends 0 boundary k included envelop modified oechords case chords oechords values fl longer true compute position intersection closer closer chords purpose proposition 22 let k strictly convex set oechord k consider p farthest point cs c l h coordinates p direct orthonormal referential whose origin middle point c whose first axis directed ctcs contribution modified chord arising c either void unique point coordinates referential proof examine situation figure 6 let c oechord making angle c search coordinates intersection point modified chord c c tends 0 set x abscissa point middle point property know modified chord c distance two chords chordarc distance c let l h0 coordinates common point c 0 c 0 elementary bit fastidious geometry proves psfrag replacements figure modified middle point property implying limit point looking coordinates given 33 remark 23 case general function curvature without introducing scaling preventing saturation phenomenon coordinates point oe 23 oe 23 precised proposition limit point may belong boundary k indeed k general strictly included envelop modified oechords general envelop even boundary convex set nevertheless know c convex curve simple decide whether point kept comparing position adjacent modified chord hence remove bad points obtain convex set example figure 7 display envelop modified oechords square set corner explicit computation made shows behavior corner figure 7 eroded set obtained removing parts cusps corners square 5 numerical experiments finish display numerical experiments first case convex sets change scale variable implemented approximation equation rescaling scale space homogeneous precisely maps c ct equation check figure 7 envelop modified oechords square 2 result convex bold line kept 51 closed convex curves first example case circles radius explicitly computable scale space since remark extinction scale circle initial radius r0 r0 fl figure 8 display evolution circle radius 10 9 figure 8 evolution circles displayed scale 0 1 9 fast computation table 1 give theoretical computed radius several values fl circle initial radius equal 10 performed two sets experiments different precisions give cpu time pentium ii 366mhz number performed iterations final obtained radius figures 9 10 display evolution convex closed polygons figure display scales different values fl 52 unclosed curves evolution studied evolution compact convex sets boundary sets closed convex curve possible make nonclosed convex curves evolve fixing end points 5 equivalent symmetrize periodize curve steady state evolution segment two ends disjoint equal singularity fast computation slow computation r theo r comp iter cpu 20 647 639 112 122 645 421 27 30 765 756 108 138 764 400 28 100 966 962 100 119 966 214 15 table 1 shortening scale 9 initial circle radius 10 considered different values fl give theoretical value final radius r theo corresponding values obtained different precisions fast slow computation number performed iterations used cpu time figure 9 evolution triangle upleft occurs finite time evolution displayed figure 11 nonclosed convex curve several values fl derived 8 9 2 c moves equation 25 locally graph function satisfies equation use equation determine whether convex curve distinct fixed end points becomes straight line finite time proposition 24 let u 0 strictly convex function gamma1 1 u figure 10 evolution pentagon upleft solution identically zero finite time fl 1 steady state attained infinite time proof equation 37 deduce u subsolution following equation hand derive equation 37 equation u 0 equation also parabolic maximum principle supremum u 0 attained time u supersolution equations 38 39 compute separable solutions type gtfx functions f g satisfy ordinary differential equation explicitely solvable g expressed terms elliptic functions f check time components becomes null finite time fl 1 order conclude suffices bound u 0 fromabove 1 fl 1 adequate f spatial part separable solution apply maximum principle figure 11 evolution angle different powers curvature 20 displayed curves correspond scales integer multiples fixed value let us interpret experiment terms image processing imagine process filtering grey level image applying 25 level lines done 13 smoothing effects particular one expect remove pixellization effects periodic structure corresponding initial state figure 52 staircase line corresponding discretization perfect straight line oriented 45 ffi evolution scale increases infinite staircase smoothed eventually becomes perfect straight line finite time fl 1 natural question arises choose fl order smooth staircase effects smallest possible damaging effects image terms power curvature regularizes discrete lines shortest time previous proposition asserts powers smaller 1 straigthen staircase finite time experiments figure 52 corroborate result indicate straightening time increases fl result counterbalanced following smoothing image would like remove small undesirable details keeping rest image unchanged results experiments circles figure 8 tend prove large powers better way small powers ie circle initial radius 9 disappears scale radius 10 less changed large values fl 53 generalization nonconvex sets algorithm nonconvex curves proposed 18 affine erosion apply method general case consists splitting curve convex concave components decomposition unique well defined method find inflexion points inflexion segments define inflexion point middle point inflexion segment apply erosion operator convex components fixing end points inflexion points defined done gather parts form new curve reapply decomposition erosion new curve notice near inflexion point ending segments joining convex components stay parallel general thus inflexion points reason stay still practically observe moreover fl increases seem move slowly also seems logical figures 12 13 display result algorithm nonconvex curves nevertheless strict justification convex component decomposition displacement inflexion points studied carefully acknowledgements authors would like thanks jeanmichel morel valuable conversations advice figure 12 scale space shape curves displayed evolution scale left right top bottom fl 04 1 2 3 cpu times respectively 5 9 23 figure 13 scale space hand curve curves displayed evolution scale left right top bottom initial curvefl 04 1 2 cpu times respectively 6 r axioms fundamental equations image processing affine heat equation nonconvex curves convergence approximation schemes fully nonlinear second order equations partial differential equations mathematical morphology scale space possible users guide viscosity solution second order partial differential equations motion level sets mean curvature heat equation shrinking convex plane curves heat equation shrinks embedded plane curves round points partial differential equations image iterative filtering approximation scheme gauss curvature flow convergence generalized motion noncompact hypersurfaces velocity arbitrary growth curvature tensor geometric multiscale representation numerical images random sets integral geometry solution nonlinear curvature driven evolution plane convex curves traitement numerique dimages et de films affine plane curve evolution fully consistent scheme fronts propagating curvature dependent speed algorithms based hamiltonjacobi formulation approximation de propagation de fronts avec ou sans termes locaux approximation viscosity solution morphological filters affine invariant scale space affine plane curve evolution curvature evolution fronts generalized curve shortening problem tr ctr l alvarez ap blanc l mazorra f santana geometric invariant shape representations using morphological multiscale analysis journal mathematical imaging vision v18 n2 p145168 march