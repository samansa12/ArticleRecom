exploiting discontinuities optical flow optical flow estimation techniques substantial difficulties dealing flow discontinuities methods simultaneously detect flow boundaries use detected boundaries aid flow estimation produce significantly improved results current approaches implementing methods still important limitations however demonstrate three problems errors due mixture image properties across boundaries intrinsic ambiguity boundary location short sequences considered difficulties insuring motion boundary aids flow estimation surface attached without corrupting flow estimates occluded surface side first problem fixed basing flow estimation image changes edges second requires analysis longer time intervals third aided using boundary detection mechanism classifies sides boundaries occluding occluded time boundaries detected b introduction discontinuities optical flow normally viewed serious impediment producing accurate estimates flow due ambiguous nature flow within small spacetime neighborhoods image sequence methods estimating flow either explicitly implicitly assume sort spatial andor temporal continuity assumption often violated surface boundaries paper points important shortcomings one class methods estimating possibly discontinuous optical flow indicates improvements made two general approaches dealing flow discontinuities found literature first explicitly allows mixed distribution near boundaries marr poggio 1977 barnard thompson 1980 basing analyses prominent modes possible disparities local neighborhoods using currently popular terminology modes acted robust estimator dominant disparity neigh borhood though neither paper explained ef fect years later prazdny 1985 made idea explicit scotts principal component approach scott 1988 schuncks constraint line clustering schunck 1989 utilized con cept recently black anadan 1990 explicitly used robust estimation determining optical flow near boundaries bergen et al 1990 used specialized approach one dominant motion found first used produce new image sequence found motion nulled allowing second motion thompson easily estimated flow estimated using approaches relatively straightforward find flow discontinuities thompson 1985 second approach make discontinuities explicit thus avoiding need deal mixed distributions methods follow basic structure geman geman 1984 blake zisserman 1987 common approach utilizes markov random field mrf formulation explicit line processes murray buxton 1987 gamble poggio 1987 hutchinson et al 1988 koch et al 1989 konrad dubois 1992 heitz bouthemy 1993 interacting region line processes involved region processes combine information local neighborhoods reduce ambiguity improve reliability individual flow es timates line processes estimate locations discontinuities act keep points opposite sides interacting region processes estimation discontinuities greatly assisted independent information possible surface boundaries available particular papers referenced allow assertion boundary element locations likely correspond contrast edges paper addresses optical flow estimation using explicit discontinuity detection provide evidence three claims ffl line processes usually implemented completely remove undesirable interactions surfaces either side motion boundary ffl intrinsic ambiguity localization motion boundaries resolved multiple frame pairs ffl distinguishing occluding occluded sides optical flow boundary aid flow estimation process ways exploiting observations demonstrated using simple flow estimation pro cedure easily incorporated complete flow estimation systems 2 estimating optical flow presence discontinuities existing flow estimation techniques involve explicit motion boundary detection suffer two deficiencies applied image sequences textured backgrounds interactions surfaces either side boundary still oc cur degrading accuracy estimated flow furthermore motion boundary detection subject localization ambiguity single frame pair analyzed time 21 mixed image properties near boundary clearly optical flow cannot determined based single spacetime image point methods estimating optical flow use image properties must computed neighbor hoods gradientbased techniques eg fennema thompson 1979 horn schunck 1981 require estimation spatial temporal derivatives using form finite difference regionbased methods eg anandan 1989 compare local neighborhoods around selected points frame spacetime filtering methods eg adelson bergen 1986 heeger 1988 fleet jepson 1990 implemented using fir filters finite spatial temporal extent image properties often computed form prefiltering kearney et al 1987 barron et al 1994 also involving operations finite spatial andor temporal extent addition many flow estimation methods impose explicit flow continuity constraints eg fennema thompson 1979 barnard thompson 1980 horn schunck 1981 various mrf algo rithms line processes used deal flow discontinuities mrflike methods fact affect imposition explicit flow continuity con straints image properties associated points one side asserted boundary still effected intensity patterns side boundary derivatives estimated using finite differences prefiltering substantial errors vicinity motion boundaries particularly surfaces one sides highly textured similar effect occurs spa exploiting discontinuities optical flow 165 tiotemporal filters line processes stop direct interactions estimated flow either side surface boundary flow estimates still highly inaccurate done systematic manner use adaptive window sizes reduce effects mixed image properties boundaries kanade oku tomi 1994 nagel 1995 alternate easily implemented solution base flow estimates correctly chosen sparse image features features must lines points necessarily occur either well away surface boundaries occur exactly boundary localization significantly effected image structure either side boundary moravec interest operator barnard thompson 1980 extrema difference gaussians mutch thompson 1983 corner detectors ranagrajan et al 1988 methods based contrast edges hildreth 1983 waxman et al 1988 satisfy property 22 ambiguity surface boundary location many methods detecting flow discontinuities based looking large magnitude values flow gradient unless location flow discontinuity already known methods allow multiple motions near boundaries used estimated flow smoothed near boundary figure 1 illustrates problem estimated flow magnitude plotted position along axis perpendicular surface boundary away boundary flow estimates reasonably accurate also accurate occluding surface nearby texture actual boundary position flow maximum rate change flow fig 1 optical flow gradients sufficient accurately locate flow boundaries near boundary since boundary sufficient structure allow flow estimation moving occluding surface occluded side however flow estimates wont accurate observed sufficiently far boundary allow moving texture occluded surface dominate effects associated surface boundary moving different optical flow maximum rate change flow typically noticeably offset actual boundary whatever flowbased boundary detection method used intrinsic localization ambiguity associated instantaneous flow cannot overcome without either nonmotion cues boundary location analysis longer time intervals thompson barnard 1981 1 consider pattern shown left figure 2 three bars ff fi fl moving left three bars b c moving right assuming occlusion boundaries likely associated contrast edges edge occluding surface either along right side bar fl left side bar c additional information way resolve ambiguity next time step shown right figure apparent lighter colored bars left occluding darker colored bars right true occlusion boundary edge bar fl problem affects boundary detection based flow gradients also methods based appearance disappearance surface texture kaplan 1969 mutch thompson 1985 methods allow multiple motions within local neighbor hood methods attempt recognize occlusion boundaries using properties similarity surfaces eg anandan 1989 method deciding possibility bar fl bar c newly appeared bar really corresponds surface boundary described section 321 3 algorithm flow estimation presence discontinuities section outlines optical flow estimation algorithm effectively addresses problems discussed section 2 similarities thompson b b c occlusion boundary c occlusion boundary fig 2 intrinsic ambiguity boundary location one instant time method presented heitz bouthemy 1993 though differs number important regards algorithm correctly deals mixed image properties near surface boundaries uses complete classification boundary types able resolve boundary ambiguities textured backgrounds present algorithm utilizes explicit line processes avoid undesirable interactions across motion discontinuities manner analogous mrf methods using much simpler formulation important features algorithm added existing flow estimation approaches remainder paper analysis excludes motions consisting exclusively rotations revolute objects around axis perpendicular line sight corresponding axis symmetry object particular situation introduces additional ambiguities resolution still largely open question thomp son et al 1992 thompson painter 1992 31 dealing discontinuities flow discontinuities effective flow estimation methods must avoid smoothing flow across boundary must also keep image properties associated surface one side boundary corrupting flow estimation surface side deal second problem basing flow estimation solely image features relatively unaffected mixture image properties particular base flow calculations image properties edges long temporal prefiltering performed spatial contrast edges either close approximations surface boundaries far enough away surface boundaries local image properties near edge largely unaffected image regions part surfaces additional advantage minimizing difficulties due apparent misregis trations contrast motion edges due localization errors separate image primitives used standard horn schunck 1981 method utilized modified spatial temporal image gradients used spatial edges image locations flow estimated using interpolation properties intrinsic method given information location surface boundaries straightforward avoid flow computation interactions across boundaries gaussseidel method used basic horn schunck algorithm bases flow estimates given pixel particular iteration step average values neighboring pixels previous itera tion necessary make sure average include pixels side motion discontinuity discontinuity detection based analysis flow differences across contrast edges potentially signal surface boundaries possi ble surfaces either side detected boundary classified occluding occluded using boundary flow constraint states flow associated occluding surface immediately adjacent boundary equal flow boundary thompson et al 1985 violations boundary flow constraint used identify occluded disoccluded surfaces exploiting discontinuities optical flow 167 fig 3 surface left optical flow different boundary hence occluded surface since moving away boundary fact disoccluded shown figure 3 without need know camera object motions involved relationship useful differences across boundary component flow normal boundary flows either side boundary parallel boundary possible determine side occluding without additional information camera motion sheer boundaries still indicate occlusion however detect classify motion boundaries flow associated every point contrast edge compared flow either side flows either side separated components normal edge orientation f f parallel edge f kand f k detection classification proceeds first checking see one surface progressively occluding disoccluding sheering surfaces checked maxd 1 side 1 occluded side 2 occluding else side 1 occluding side 2 occluded else j f sides 1 2 sheer method less elegant detection classification scheme described thompson et al 1985 reliable note particular f f separately compared normal flow edge rather taking difference important increases sensitivity edge detection effects described section 22 difference flow normal edge attributable one surface moving relative another concentrated additional differences flow normal edge arise due smooth variations flow occluding side edge various noise effects result basing detection j f gamma f j increase classification error rate flow estimation boundary pixel neither affects affected flow pixels occluding side boundary interactions occluding side however allowed since boundary part surface conservative approach taken sheer boundaries flow estimation boundary isolated flow values either side interact estimation values along bound ary complete algorithm interleaves flow estimation boundary detection enough gaussseidel iterations done get reasonable estimate flow values boundaries detected classified better flow estimates obtained performing additional iterations using formation process repeated necessary 32 improving boundary localization time optical flow estimation sequences longer single frame pair improve efficiency iterative algorithms providing reasonably accurate initial values improve accuracy many methods using form temporal coherence reduce effects noise turns longer sequences also key resolving localization ambiguity described section 22 321 boundary projection surface boundaries persist time boundaries found one time step position easily predicted next time step done taking point detected occlusion boundary looking contrast edge future frame corresponding location offset flow boundary point substantial efficiency achieved starting iterations next time step using predicted boundary loca tions even importantly time actual thompson surface boundaries maintained detected boundaries fact correspond surface texture near true boundaries disappear see consider figure 2 time step 0 interleaved iterate classify algorithm end finding potential occlusion boundaries right bar fl left bar c flow estimates assigned region bars likely muddle time step 1 bar appeared flow new texture element initially propagate left right since surface boundary indication associated bar flow propagation approaches bar c differential flow across false boundary left side c reduced leading reclassification edge nonoccluding sides never get classified occluding since flow consistent edge motion blocked boundary fl propagating towards situation shown figure 2 extreme full texture element appears single time step practice texture element spacing usually much larger interframe motions effect described takes place gradually 322 flow projection horn schunck suggest improving efficiency algorithm using results obtained one time step initialize iterations next time step simply using flow obtained pixel one time step initialize estimates pixel next time step adequate smooth sur faces actually lead worse results occlusion boundaries default zero flow used initialization flow associated disoccluded surface region typically different flow surface previously occluding improvement obtained projecting flow estimates one time step pixels next time step manner takes account flow value fails however provide initial estimates flow occluded regions multiple flow values project point disocclusion regions flow values previous time step project black anandan 1990 effective projection flow occluded disoccluded regions next time step pos disoccluded region region flow zero occluded occlusion boundary occlusion boundary zero flow fig 4 projecting flow occlusion disocclusion regions sible occlusion boundaries detected classified current time step figure 4 shows simplified situation occlusion boundary stationary occluding surface left occluded surface right motion occluded surface normal boundary two possibilities exist occluded surface moving either towards away boundary case pure sheer motion occlusion disocclusion regions ex ist movement away boundary causes disocclusion gray area left figure 4 indicates region next time step correspond surface visible first time flow close occluded side boundary movement towards boundary causes occlusion gray area right figure 4 indicates region next time step flow vectors two different surfaces project best estimate actual flow flow boundary either case region oc clusiondisocclusion runs boundary line found adding flow vector occluded surface point nearest boundary point boundary point location general case moving boundaries region oc clusiondisocclusion runs projection boundary next time step line found adding flow vector occluded surface point nearest boundary point projected boundary point location flow filled regions either flow boundary flow nearest occluded surface point depending classification boundary exploiting discontinuities optical flow 169 fig 5 original image sequence frames note principal goal improve efficiency implement sort temporal continuity constraint temporal consistency also used improve accuracy flow esti mation though constraint lead problems occlusiondisocclusion regions murray buxton 1987 thus approach described preceding paragraph might extended better exploit temporal continuity near boundaries 4 experimental results section presents results controlled experiments run synthetic data implementation details results real imagery presented thompson 1995 limitations using synthetic data well known way fair quantitative comparisons alternate approaches accuracy estimated flow measured using interframe angular deviation described barron 1994 measure useful evaluating results controlled experiments described absolute magnitudes flow errors compared obtained circumstances tests reported flow estimation error occurs flow discontinuities correspond substantial number pixels test sequences case image sequences used bar ron 1994 error magnitude comparisons dissimilar image sequences dominated number pixels near discontinuities least much quality flow estimation algorithms applied evaluating results also important note performance methods described depends particular motion analysis algorithm used quality static edges based order provide grounds comparing algorithms simple edge detector used manipulations test sequences structured avoid perturbations edge detector performance ex ample subpixel motions avoided since edge detector results would affected antialiasing scheme used generate synthetic images nonintegral motions get best possible performance would desirable quantitative comparisons done competing methods sophisticated edge detector used figure 5 shows first four images 120 160 pixel synthetically generated sequence textured rectangle moving across textured background rectangle moving four pixels right two pixel per frame background moving two pixel sheer boundaries occluding sides side side occluded occluded fig 6 true boundary classifications moving rectangle test sequence thompson fig 7 flow estimation using standard horn schunck method first four frame pairs fig 8 flow estimation using horn schunck explicit boundary detection first four frame pairs left per frame figure 6 shows true occludedoccluding sheer boundaries sequence subsequent figures sheer boundaries marked light gray pattern either side dark line occludedoccluding boundaries marked darker gray pattern occluded side edge figure 7 shows optical flow estimated standard horn schunck algorithm applied first four frame pairs moving rectangle sequence errors flow estimation particularly near boundaries moving rectangle obvious figure 8 demonstrates results adding explicit boundary analysis basic horn schunck algorithm final flow estimates boundary classifications time step shown flow estimates improved substantial error remains due mixing image properties across boundaries seriously distorts gradient computations figure 9 uses algorithm figure 8 except image properties contrast edges used flow computations minimizes effects image property mixing surfaces results four frame pairs shown flow estimates improved ambiguity detecting classifying boundaries background texture appears near occluding contours manifested figure missing extraneous boundary segments still affecting accuracy however figure 10 shows effect using boundary projection initialize processing next time step boundary classification errors largely eliminated flow estimates correspondingly improved table 1 lists quantitative average errors associated algorithms exploiting discontinuities optical flow 171 fig 9 edgebased flow estimation using explicit discontinuity detection fig 10 flow estimation using explicit discontinuity detection projection table 1 flow errors different estimation algorithms frame basic horn schunck 1338 horn schunck boundary detection 1131 edgebased flow estimation boundary detection 755 edgebased flow est boundary detection projection 755 next set experiments tests value classifying surface boundaries labeling sides occluding occluded test sequence consisting uniform intensity disk moving tex thompson fig 11 moving disk image sequence table 2 flow errors using symmetric asymmetric boundary classification frame symmetric boundary classification 675 asymmetric boundary classification 555 table 3 flow errors total iterations reduced frame boundary projection flow projection 2199 copied flow 2199 projected flow 2199 boundary projection copied flow 2199 boundary projection projected flow 2199 tured background used foreground background motions previous tests fig ure 11 insure convergence given large uniform brightness area 600 iterations run every time step occludingoccluded boundary classification allow motion disk boundary propagate otherwise featureless interior disk clear table 2 accuracy improved final set experiments address issue well projecting estimated flow one time step initialize computations next time step helps flow determination image sequence used shown figure 5 total iterations run time step compared 150step results shown figures 710 five cases examined resulting errors shown table 3 first case algorithm employing boundary classification boundary projection used figure 10 reduced number itera tions second case boundary projection done flow time step first initialized copying values obtained previous time step boundaries projected frame frame boundary detection classification used within time exploiting discontinuities optical flow 173 step reduced iteration initializing flow estimates clearly valuable initializing boundary estimates third test boundary projection flow estimates initialized using projection method described section 322 substantial improvement accuracy last two cases use boundary projection flow initialized either copying projecting values previous time step flow projection clearly superior simple copying 5 summary paper examined number important issues affecting accuracy optical flow estimates made algorithms explicitly take account flow discontinuities theoretical experimental evidence presented showing line processes typically used keep flow smoothness constraints corrupting estimates across boundaries still allow image properties associated surface one side boundary improperly influence flow computations side boundary second problem affecting flow estimation intrinsic ambiguity boundary localization textured environments two frames considered time effect clearly demonstrated using one particular flow estimation algorithm occurs independent algorithm used experimentation shown value distinguishing occluding occluded sides surface corresponding flow discontinuity information used improve flow estimates important projecting flow estimates future time steps reduce computational require ments finally shown line processes used mrf formulations estimating optical flow also used conceptually simpler horn schunck algorithm techniques described improving flow estimation boundaries easily implemented algorithms horn schunck mrf methods applied across spectrum approaches optical flow esti mation example area correlation algorithm described smitley bajcsy 1981 viewed utilizing something akin line process matching image regions acknowledgements work supported national science foundation grant iri9112267 notes 1 evidence human vision system resolves ambiguity favoring whichever possible boundary strongest nonmotion edge properties yonas 1990 r extracton spatiotemporal energy human machine vision computational framework algorithm measurement visual motion disparity analysis images performance optical flow techniques computing two motions three frames model detection motion time visual reconstruction velocity determination scenes containing several moving objects computation component image velocity local phase information visual integration detection discontinuities key role intensity edges stochastic relaxation optical flow estimation using spatiotemporal filters ieee trans measurement visual motion determining optical flow computing motion using analog binary resistive networks stereo matching algorithm adaptive window theory experiment kinetic disruption optical texture perception depth edge optical flow estimation error analysis gradientbased methods local optimization computing optical flow resistive networks primate visual system bayesian estimation motion vector fields cooperative computation stereo disparity scene segmentation visual motion using global optimization hierarchical estimation spatial properties motion analysis accretion deletion boundaries dynamic scenes optical flow estimation interaction measurement errors adjacent pixel positions international journal computer vision detection binocular disparities optimal corner detection image flow segmentation estimation constraint line clustering local global interpretation moving images stereo processing aerial exploiting discontinuities optical flow dynamic occlusion analysis optical flow fields qualitative constraints structurefrommotion convected activation profiles measurement visual motion abstracts investigative ophthalmology visual sci ence tr