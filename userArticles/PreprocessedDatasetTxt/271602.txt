cartesian grid projection method incompressible euler equations complex geometries many problems fluid dynamics require representation complicated internal external boundaries flow present method calculating timedependent incompressible inviscid flow combines projection method cartesian grid approach representing geometry approach body represented interface embedded regular cartesian mesh advection step based cartesian grid algorithm compressible flow discretization body near flow uses volumeoffluid representation redistribution procedure used eliminate timestep restrictions due small cells boundary intersects mesh projection step uses approximate projection based cartesian grid method potential flow method incorporates knowledge body volume area fractions along certain integrals mixed cells convergence results given projection timedependent algorithm two dimensions method also demonstrated flow past halfcylinder vortex shedding b introduction paper present numerical method solving unsteady incompressible euler equations domains irregular boundaries underlying discretization method projection method 22 5 discretizations nonlinear convective terms lagged pressure gradient first used construct approximate update velocity field divergence constraint subsequently imposed define velocity pressure new time irregular boundary represented using cartesian mesh approach 58 ie intersecting boundary uniform cartesian grid irregular cells appearing adjacent boundary extension basic projection methodology cartesian grid setting exploits separation hyperbolic elliptic terms method 5 allow us use previous work discretization hyperbolic elliptic pdes cartesian grids treatment hyperbolic terms based algorithms developed gas dynamics closely follows algorithm pember et al 56 57 cartesian grid projection uses techniques developed young et al 72 full potential transonic flow discretize elliptic equation used enforce incompressibility constraint overall design goals method able use highresolution finite difference methods based higherorder godunov methods advective terms presence irregular boundaries effectively add potential flow component solution cartesian grid methods first used purvis burkhalter 58 solving equations transonic potential flow see also 71 40 62 72 clarke et al 23 extended methodology steady compressible flow see also 30 29 28 52 zeeuw powell 74 coirier powell 24 coirier 25 melton et al 51 aftosmis et al 1 developed adaptive methods steady euler navierstokes equations timedependent hyperbolic problems primary difficulty using cartesian grid approach lies treatment cells created intersection irregular boundary uniform mesh restrictions boundary intersects cartesian grid unlike stair step approach defines body aligned cell edges result cells arbitrarily small volumes created standard finitevolume approach using conservative differencing requires division volume cell unstable unless time step reduced proportionally volume although projection method convective differencing used hyperbolic terms momentum equation base methodology incompressible flow experience gained compressible flow handling small cells addition wish update quantities conservatively major issues designing method maintain accuracy stability conservation irregular cells fluidbody interface using time step restricted cfl considerations using regular cell size alone refer small cell problem noh 54 early work area used cell merging techniques redistribution leveque 42 43 berger leveque 12 developed explicit methods use large time step approach developed leveque 41 overcome small cell problem berger leveque 13 14 also studied approaches small cell problem avoided use rotated difference scheme cells cut fluidbody interface large time step rotated difference schemes globally secondorder better firstorder less secondorder fluid body interface cell merging techniques also used chiang et al 20 bayyuk et al 4 quirk 60 59 overcome small cell problem results method suggest globally second order accurate first order boundary two approaches unsteady compressible flow based fluxvector splitting choi grossman 21 statevector splitting oksuzoglu 55 gooch oksuzoglu 31 neither approaches avoids small cell problem advection step method presented uses different approach handling irregular cells based ideas previously developed shock tracking chern colella 17 bell colella welcome 8 extended pember et al 56 57 approach boundary viewed tracked front regular cartesian grid fluid dynamics boundary governed boundary conditions stationary reflecting wall basic integration scheme hyperbolic problems consists two steps first step reference state computed using fluxes generated higherorder godunov method fluidbody boundary essentially ignored second step correction computed state irregular cell stable nonconservative portion correction applied irregular cell conservation maintained variation algebraic redistribution algorithm 17 distributes remainder correction regular irregular cells immediate neighbors irregular cell redistribution procedure allows scheme use time steps computed cfl considerations uniform grid alone adapt scheme advection step projection method projection step requires solution elliptic equation irregular grid finiteelementbased projection developed almgren et al 3 regular grid extended accommodate embedded boundaries using techniques developed young et al 72 approach young et al defines approximating space using standard bilinear elements enlarged domain includes nodes mixed cells lying outside domain quadratures weak form restricted actual domain define discretization resulting linear system readily solved straightforward extension multigrid secondorder cartesian grid projection method developed recently tau 67 incompressible navierstokes equations formulation velocities defined staggered grid incompatible cellcentered form godunov method tangential velocity must vanish boundaries ie formulation extensible euler equations comments results 67 indicate accuracy method general firstorder boundary globally second order mention made small cell problem advecting quantities momentum addition approach taken two basic approaches treatment irregular domains locally bodyfitted grids obtained mesh map pings unstructured grids bodyfitted structured blockstructured grids compressible flow literature quite extensive typical examples include 37 35 16 11 27 7 65 68 9 61 73 primary objection mapped grids difficulty generating complex geometries particularly three dimensions number approaches making mapped grids flexible using combinations unstructured structured grids 69 70 49 64 53 36 48 multiblockstructured grids 2 66 63 overlapping composite grids 10 19 34 topic unstructured grids refer reader 39 38 45 46 50 compressible flow lohner et al 44 developed unstructured finite element algorithm highreynolds number inviscid incompressible flows comparison approaches discussed advantages cartesian grid approach include requiring special grid generation techniques fit arbitrary boundaries ability use standard timestepping algorithm cells additional work cells near boundary ability incorporate efficient solvers elliptic equation serious disadvantage loss accuracy boundary numerical results show reduction firstorder accuracy boundary loss secondorder accuracy boundary indicates cartesian grid approach ideal calculations designed resolve viscous boundary layers satisfactory flows primary effect boundary introduce potential flow component velocity corresponding effect nonormal flow condition boundary problems case include flows large containers utility burners boilers atmospheric flows irregular orography next section review basic fractional step algorithm introduce notation cartesian grid method subsequent two sections contain descriptions advection step projection step respectively flows embedded boundaries final two sections present numerical results conclusions results detailed discussion two spatial dimensions extension three dimensions straightforward presented later work 2 basic algorithm 21 overview fractional step formulation incompressible euler equations written convective form r alternatively 21 could written conservative form projection method fractional step scheme solving equations composed advection step followed projection advection step cells entirely flow domain solve discretization 21 deltat intermediate velocity u small cells adjoining body modify velocity update using conservative formulation nonlinear terms see section 3 pressure gradient ngamma 1 computed previous time step treated source term 24 advection terms 24 namely u delta ru 2 approximated time 2 secondorder space time using explicit predictorcorrector scheme construction described section 3 velocity field u general divergencefree projection step algorithm decomposes result first step discrete gradient scalar potential approximately divergencefree vector field correspond update pressure gradient update velocity respectively particular p represents projection operator deltat deltat deltat note pressure gradient defined time time derivative velocity therefore halftime levels 22 notation first introduce notation used describe body intersects computational domain volume fraction ij cell defined fraction computational cell b ij inside flow domain area fractions 1 2 j ij 1specify fractions respectively lie inside flow domain label cell entirely within fluid full cell fluid cell cell entirely outside flow domain body cell cell partially fluid 0 mixed cell small cell mixed cell small volume fraction note possible area fraction edge fluid cell less one fluid cell abuts body mixed cell method presented state fluid time n defined u n ij velocity field cell b ij time n p ngamma pressure node igamma 2 gp ngamma 1ij pressure gradient cell b ij time construction nonlinear advective terms n 1 velocities also defined edges full mixed cells n 1 process requires values velocity pressure gradients cells either side edge n must therefore define time step extended states body cells adjoining mixed full cells volumeweighted fashion u ext pressure gradient extended manner nbhdb ij defined neighborhood b ij refers eight cells two dimensions share edge corner 3 advection step 31 momentum algorithm predictorcorrector method similar used 5 modifications discussed 6 details current version without geometry given 3 simplicity assume normal velocity embedded boundary zero treatment general dirichlet boundary condition inflow straightforward predictor extrapolate velocity cell edges n 1 using secondorder taylor series expansion space time time derivative replaced using 21 edge u nlim extrapolated b ij u nlim extrapolated analogous formulae used predict values edges cell evaluating terms firstorder derivatives normal edge case u nlim x evaluated using monotonicitylimited fourthorder slope approximation 26 limiting done components velocity individually modifications discussed cells near body transverse derivative terms vu case evaluated 6 first extrapolating construct edge states using normal derivatives choosing states using upwinding procedure defined particular define deltay u nlim u nlim u nlim limited slopes direction similar formulae lower edge b ij upwinding procedure first define normal advective velocity edge suppress spatial indices bottom top states next equation upwind b u based b u ij 1 constructing b similar manner use upwind values form transverse derivative 31 2deltay b v adv u use similar upwinding procedure choose appropriate states u 1 given left right states u n 1l u follow similar procedure construct u igamma 1 general normal velocities edges divergencefree order make velocities divergencefree apply mac projection 6 construction convective derivatives equation solved oe full mixed cells ij 1v n 1ij 1gamma deltax deltay note regions full cells mac g mac stencil simply standard fivepoint cellcentered stencil laplacian edges within body needed corrector step mac gradient linearly extrapolated edges lie partially fully fluid example edge lies completely within body edges lie least partially within fluid define possible could lead instabilities none yet observed numerical testing solve linear system using standard multigrid methods see 15 specifically vcycles jacobi relaxation corrector step form approximation convective derivatives 21 2deltay v mac intermediate velocity u time n 1 defined full mixed cells upwind method explicit difference scheme requires timestep restriction cells full cells linear constantcoefficient analysis shows stability require deltay oe cfl number timestep restriction upwind method used set time step overall algorithm mentioned earlier incompressible flow two forms momentum equation 23 analytically equivalent flows without geometry successfully used convective difference form equations 24 contrast could use conservative form equations deltat r delta f n 1 2 evaluate conservative update r presence embedded boundaries convective update form equations stable even small cells update calculated cell full cell ie doesnt see body macprojected normal advection velocities modification limited slopes discussed end section compute conservative update however one ignores entirely portion cell fluid integrates flux along parts edges cell lie within fluid thus presence body correctly accounted using conservative form requires time step approach zero cell volume goes zero smallcell time step restriction seek avoid solution case use weighted average convective conservative updates effectively allowing much momentum pass small cell time step keep scheme stable momentum pass small cell redistributed neighboring cells maintain conservation advection step approach modeled algorithm 57 56 based algebraic redistribution scheme chern colella 18 algorithm follows 1 first cells construct reference state e u defined e using advective algorithm described full cells 2 mixed cells construct alternative e e u using conservative u ij 1f deltay fluxes defined solution enforces noflow across boundary body necessarily stable define difference ffim u u 3 conservative solution written e e u u however solution stable 1 define instead b u u ffim ij mixed cells b u u ij full cells allows mixed cell state keep fraction ffim keep scheme stable given time step set fullcell cfl constraint redistribute remaining fraction ffim mixed cell amount fluid mixed cells among eight neighbors b ij volumeweighted fashion since redistribute extensive rather intensive quantity eg momentum rather momentum density resulting redistribution form c c u u ij 5 subtract pressure gradient term solution full mixed cells treating source term u second modification algorithm cells near boundary slope calculations based principle state information cells entirely within body used calculating slopes despite use extended states creation edge states slope calculation uses state information full mixed cells mixed full cell fourthorder stencil would require using extended state slope calculation reduces secondorder monotonicitylimited formula secondorder formula would require extended state slope set zero effect adding dissipation scheme slopes throughout domain set zero method would reduce firstorder two comments algorithm order first note use extended states seems loworder approach representing body numerical results show adequate maintain firstorder accuracy boundary alternative extended states socalled thin wall approximation 57 approximation extended states defined rather upwinding always chooses values coming fluid side rather body side fluidbody interface numerical testing however found extended states version algorithm performs slightly better second unable provide proof redistribution algorithm stable extensive numerical testing redistribution algorithm compressible flow see 57 32 47 stability problems observed none observed incompressible flow calculations clear algorithm removes original smallcell stability problem replacing division arbitrarily small volume fractions division one step 3 redistribution algorithm amount redistributed cell proportional volume cell feature combined observation calculations values ffim small relative values u mixed cells gives heuristic argument redistribution would stable 32 passive scalars algorithm advecting momentum extends naturally linear scalar advection third numerical example shown paper passive scalar enters domain inflow boundary advected around body briefly describe scalar advection routine assuming scalar conserved quantity ie first time step extended states defined passive scalar velocity predictor extrapolate scalar cell edges n 1 using secondorder taylor series expansion space time edge deltat extrapolated b ij n 1r deltat extrapolated analogous formulae used predict values edges cell velocity derivatives normal edge case nlim x evaluated using monotonicitylimited fourthorder slope approximation 26 modifications due geometry transverse derivative terms vc case defined using c use similar procedure choose n 1i 1j given n 1 u mac n 1r u mac corrector step full cells update conservatively deltat deltax deltat deltay v mac corrector step mixed cells follow three steps 1 construct reference state e using convective formulation deltat deltat 2deltay v mac 2 construct e e using conservative formulation 1j u mac deltax ij 1u mac deltay define difference ffis ij construct b finally redistribute remaining fraction ffis mixed cell amount full mixed cells among eight neighbors b ij volumeweighted fashion full cells adjacent mixed cells set n1 projection step since u defined cell centers projection used enforce incompressibility time must include divergence operator acts cellcentered quantities unlike mac projection projection use approximate ie p 2 6 p operator well motivation using approximate rather exact projection described detail 3 outline algorithm case noflow physical boundaries geometry case embedded boundaries basic approach embedded boundaries utilizes discretization used young et al 72 full potential transonic flow necessary modifications inflowoutflow conditions described 3 use demonstrated numerical examples projection based finite element formulation particular consider scalar pressure field c 0 function bilinear cell ie pressure x space polynomials degree x direction cell c continuity xedges velocity space define x discontinuous linear function cell similar form v mixed cells think representations defined portion cell within flow domainomega although spaces implicitly define extension solution entire cell note integral used define projection see 43 domain integration limited actual flow domain integrate portion mixed cells outside domain use predictor corrector velocity pressure gradient considered average values cell vector space v h contains additional functions represent linear variation within cell additional degrees freedom make large enough contain roe oe 2 h establish correspondence two representations introducing orthogonal decomposition v h particular define piecewise constant component v variation v cell b ij r construction two components orthogonal l 2 used define decomposition v h two subspaces represent cell averages orthogonal linear variation respec tively decomposition v h induces decomposition roe oe 2 h namely define weak form projection v h based weak divergence v h particular define vector field v v h divergencefree domainomega zomega using definition 42 project vector field v gradient roe weakly divergencefree field v vanishing normal velocities boundaries solving z z setting v define standard basis functions h namely 1j 1x piecewise bilinear function node values i12j12 purposes fractional step scheme wish decompose vector field deltat approximately divergence freepart deltat update pressure since finitedifference advection scheme designed handle cellbased quantities considered average values cell quantity goe discarded end projection step makes projection approximate ie dv practice solve system defined 43 using standard multigrid techniques vcycles jacobi relaxation set z approximation u n1 gammau n deltat 25 see 3 details lefthandside equation 43 discrete form ninepoint stencil approximating laplacian oe right hand side standard fourpoint divergence stencil without embedded boundaries method reduces constant coefficient difference stencils divergence gradient laplacian operator stencils dv letting dgoe body cells contribute nothing integrals 43 mixed cells integrals computed portion cell lies fluid calculation optimized precomputing following integrals mixed cell integrands result products gradients basis functions 43 define z z z omega functions defined cell x 0 center sigma12 left right edges b ij sigma12 top bottom edges b linear combinations integrals form coefficients used divergence gradient laplacian operators example divergence barred vector becomes dv deltay let goe full goe would defined cell full cell mixed cell average gradient fluid portion cell full b full full laplacian operator requires third integral c quadratic terms results inner products oe 1j 1and oe k1212 leave derivation reader note full cell stencils mixed cells reduce full cells note solving 43 defines oe 1j 1at node support intersects fluid region thus pressure defined even nodes contained body region long within one cell fluid region 5 numerical results section present results calculations done using cartesian grid representation bodies andor boundaries domain first two sets results convergence studies first tests accuracy projection alone second tests accuracy full method euler equations cases results presented form tables show norms errors well calculated rates convergence error calculation grid spacing h defined difference solution grid averaged solution calculation grid spacing h2 first convergence study column 128256 refers errors solution 128 2 grid calculated comparing solution 128 2 grid solution 256 2 grid similarly 256512 errors computed pointwise calculation l 1 l 2 l1 norms errors calculated convergence rates method estimated taking log 2 ratio norms provides heuristic estimate convergence rate assuming method operating asymptotic range present two separate measures error first compute norms entire domain cells second examine error interior subdomain order measure errors away boundary subdomain selected region covered full cells 128 2 grid full 128 cells first convergence study tests accuracy projection alone domain unit square three bodies placed interior circle centered 75 75 radius 1 ellipses centered 25 625 5 25 axes 15 1 respectively boundary conditions inflow noflow boundaries study initial data inside numerical domain u data projected define velocity field approximately divergencefree region domain covered bodies pressure gradient used correct initial data represents deviation potential flow solution uniform flow tables 1 2 present results convergence study almostsecond order convergence l 1 norm firstorder convergence l1 norm approximately h 15 convergence l 2 norm would expect solution secondorder domain firstorder boundaries consistent observation maximum absolute error mixed cells order magnitude higher maximum error full cells finer grids figure 1 shows contour plot magnitude error 256 2 calculation second convergence study flow diverging channel case evaluate velocity field time order demonstrate order complete algorithm flow smooth near mixed cells problem domain 4 x 1 fluid restricted flow curves top bot defined 3 3 x 4 calculation run cfl number 09 flow initialized potential flow field corresponding inflow velocity 1 left edge computed initial projection tables 3 4 show errors convergence rates velocity components 128256 refers errors solution 128x32 grid calculated comparing solution 128x32 grid solution 256x64 grid similarly 256512 compute errors full domain subdomain defined region covered full cells 128x32 grid case norms scaled appropriate area domain see rates corresponding global secondorder accuracy firstorder accuracy near boundaries figures 2ab contour plots log 10 error velocity components error clearly concentrated along fluidbody boundaries sake figures defined errors less 1 maximum error including values body cells equal 1 maximum error ten contour intervals figure spanning two orders magnitude time error advects along contaminate interior flow note particular flow velocity field near boundary essentially parallel boundary general case might expect see contamination interior flow note however maximum error less 3 magnitude velocity third example present flow past halfcylinder extensive experimental computational literature subject flow past cylinder infinite domain low moderate reynolds number see example 33 61 recent experimental computational results respectively since methodology presented inviscid flow compute flow past halfcylinder rather full cylinder force separation point occur trailing edge however present calculation demonstrate type application cartesian grid methodology would useful calculation one might interested flow features away body ie shed vortices downstream cylinder requires presence body order generate modify features resolution calculation 256 x 64 domain 4 x 1 diameter halfcylinder 25 inflow velocity left edge boundary conditions outflow right edge noflow boundaries top bottom initial conditions potential flow uniform inflow calculated initial projection combined small vortical perturbation break symmetry problem shown snapshots vorticity figure 3a passively advected scalar figure 3b late enough time flow periodic perturbation advected domain scalar advected center inflow edge strouhal number calculated approximately du1t observed period vortex shedding cylinder diameter freestream ie inflow velocity one would expect value 2 4 see 33 references cited seems reasonable value given limitations comparison cells full 128 cells table 1 errors convergence rates xcomponent pressure gradient cells full 128 cells table 2 errors convergence rates ycomponent pressure gradient cells full 128 cells l1 236e3 80 135e3 128e3 108 604e4 table 3 errors convergence rates xcomponent velocity cells full 128 cells table 4 errors convergence rates ycomponent velocity 6 conclusion presented method calculation timedependent incompressible inviscid flow domain embedded boundaries approach combines basic projection method using approximate projection cartesian grid representation ge ometry approach body represented interface embedded regular cartesian mesh adaptation higherorder upwind method include geometry modeled cartesian grid method compressible flow discretization body near flow uses volumeoffluid representation redistribution procedure approximate projection incorporates knowledge body volume area fractions certain integrals mixed cells convergence results indicate method firstorder near body globally secondorder away body method demonstrated flow past halfcylinder vortex shedding shown give reasonable strouhal number method presented two dimensions extension r gamma z three dimensions variable density flows inclusion representation adaptive mesh refinement algorithm incompressible flow developed techniques developed also modified use general low mach number models particular using methodology model low mach number combustion realistic industrial burner geometries represent terrain anelastic model atmosphere acknowledgements would like thank rick pember many conversations subtleties cartesian grid method r adaptation surface modeling cartesian mesh methods techniques multiblock domain decomposition surface grid generation numerical method incompressible navierstokes equations based approximate projection simulation technique 2d unsteady inviscid flows around arbitrarily moving deforming bodies arbitrary geometry secondorder projection method incompressible navierstokes equations efficient secondorder projection method viscous incompressible flow adaptive mesh refinement moving quadrilateral grids conservative fronttracking inviscid compressible flow projection method viscous incompressible flow quadrilateral grids flexible grid embedding technique application euler equations automatic adaptive refinement euler equations adaptive cartesian mesh algorithm euler equations arbit rary geometries progress finitevolume calculations wind fuselage combinations conservative front tracking method hyperbolic conservation laws conservative front tracking method hyperbolic conservations laws composite overlapping meshes solution partial differential equations simulation unsteady inviscid flow adaptively refined cartesian grid numerical solution navierstokes equations euler calculations multielement airfoils using cartesian grids accuracy assessment cartesianmesh approaches euler equ ations direct eulerian muscl scheme gas dynamics cartesian euler methods arbitrary aircraft configurations adaptive multigrid applied supersonic blunt body flow euler calculations wings using cartesian grids adaptive multifluid interfacecapturing method compressible flow complex geometries experimental study parallel oblique vortex shedding circular cylinders fourthorder accurate method incompressible navierstokes equations overlapping grids inviscid viscous solutions airfoilcascade flows using locally implicit algorithm adaptive meshes transonic potential flow calculations using conservative form improvements aircraft euler method calculation inviscid transonic flow complete aircraft large time step generalization godunovs method systems conservation laws multidimensional numerical simulation pulse combustor hybrid structuredunstructured grid method unsteady turbomachinery flow compuations solutionadaptive hybridgrid method unsteady analysis turbomachinery accurate multigrid solution euler equations unstructured adaptive meshes 3d applications cartesian grid euler method finite difference solution euler equations nonbody fitted grids cel timedependent prediction critical mach number store config urations cartesian grid approach hierarchical refinement compressible flows fractional step solution method unsteady incompressible navierstokes equations generalized coordinate systems zonal implicit procedure hybrid structuredunstructured grids computations unsteady viscous compressible flows using adaptive mesh refinement curvilinear bodyfitted grid systems general decomposition algorithm applied multielement airfoil grids secondorder projection method incompressible navierstokes equations arbitrary domains boundary fitted coordinate systems numerical solution partial differential equations review threedimensional struc turedunstructured hybrid navierstokes method turbine blade rows mixed structuredunstructured meshes aerodynamic flow sim ulation method solving transonic fullpotential equations general configurations locally refined rectangular grid finite element method application computational fluid dynamics computational physics fractional step method timedependent incompressible navierstokes equations curvilinear coor dinates adaptively refined cartesian mesh solver euler equations tr ctr caroline gattibono phillip colella anelastic allspeed projection method gravitationally stratified flows journal computational physics v216 august 2006 yuheng tseng joel h ferziger ghostcell immersed boundary method flow complex geometry journal computational physics v192 december jiunder yu shinri sakai james sethian coupled quadrilateral grid level set projection method applied ink jet simulation journal computational physics v206 n1 p227251 10 june 2005 xiaolin zhong new highorder immersed interface method solving elliptic equations imbedded interface discontinuity journal computational physics v225 n1 p10661099 july 2007 r ghias r mittal h dong sharp interface immersed boundary method compressible viscous flows journal computational physics v225 n1 p528553 july 2007 stphane popinet gerris treebased adaptive solver incompressible euler equations complex geometries journal computational physics v190 n2 p572600 20 september anvar gilmanov fotis sotiropoulos hybrid cartesianimmersed boundary method simulating flows 3d geometrically complex moving bodies journal computational physics v207 august 2005 p kirkpatrick w armfield j h kent representation curved boundaries solution navierstokes equations staggered threedimensional cartesian grid journal computational physics v184 n1 p136 marella krishnan h liu h udaykumar sharp interface cartesian grid method easily implemented technique 3d moving boundary computations journal computational physics v210 n1 p131 20 november 2005