efficient techniques accurate modeling simulation substrate coupling mixedsignal ics industry trends aimed integrating higher levels circuit functionality triggered proliferation mixed analogdigital systems magnified noise coupling common chip substrate made design verification systems increasingly difficult task paper present fast eigendecomposition technique accelerates operator application bem methods avoids densematrix storage taking substrate boundary effects account explicitly technique used accurate efficient modeling substrate coupling effects mixedsignal integrated circuits b introduction industry trends aimed integrating higher levels circuit functionality resulting emphasis compactness consumer electronic products widespread growth interest wireless communications triggered proliferation mixed analogdigital systems single chip mixedsignal designs combining digital analog blocks built common substrate provide reduced levels power dissipation smaller package count well smaller package interconnect parasitics design systems however becoming increasingly difficult task owing various coupling problems result combined requirements highspeed digital highprecision analog components noise coupling common chip substrate caused nonideal isolation provided common substrate identified significant contributor coupling problem mixedsignal designs 3 2 11 1 fast switching logic components inject current substrate causing voltage fluctuation affect operation sensitive analog circuitry bodyeffect since transistor threshold strong function substrate bias perhaps common way deal problems resort costly trial error techniques clearly methodology requires ability fabricate multiple version design relies heavily expertise experience designer adequate face rising fabrication costs increasing demands shorter design cycle times 1 several approaches presented past attempt quantify effects noise coupling substrate order account deal without need expensive redesigns multiple fabrication runs methods based appropriate formulation substrate electromagnetic interactions rely detailed numerical analysis general reliable accurate examples 3d techniques include finite element fem finite diference fd numerical methods computing currents voltages substrate 2 3 4 5 6 techniques perform full domain discretization large bounded substrate easily handle irregular substrates wells doping profiles etc unfortunately methods impractical anything simple problems since number unknowns resulting discretization large volumemeshing entire substrate device simulators medici pisces also used task however general slow since meant simulate driftdiffusion phenomenon semiconductors interested simple resistive effects thus methods efficient versatile enough implementation standard cad systems boundaryelement bem methods applied success problem modeling substrate coupling bem methods appealing solution type problems requiring discretization relevant boundary features dramatically reduce size matrix solved 7 greens function twolayer substrate without backplane used effect approach amounts analyzing chip infinite dimensions lateral directions 8 distinct approach taken point point impedances precomputed used find admittance matrix describes contacts configuration interpolation process used fit preprocessed impedance values computed various contact distances power series distance contacts order avoid edge effects authors also assume infinite lateral chip dimensions technique efficient numerical acceleration techniques applied speedup computation impedance matrix coefficients accuracy compromised due assumption infinite lateral dimensions contacts placed near physical walls substrate 10 substrate greens function derived takes account actual properties domain problem repeated evaluation greens function performed order obtain accurate substrate model however direct computation substrate greens function avoided instead computation performed means 2d dct discrete cosine transform turn efficiently computed fft despite improvements computational effort involved computing model using approach still considerable method difficulty handling problems large number contacts matrices produced bem methods dense limited usage methods small medium size problems however substrate coupling general global problem effect cannot accurately predicted analyzing small subsets layout therefore speeding computations encountered bem formulations paramount importance accurate models large substrate coupling problems obtained paper present novel eigendecomposition method used krylov subspace solver eliminates densematrix storage speeds operatorvector application significantly method used speedup computations necessary computing substrate models bem formulation allows extraction substrate models problems containing several hundred surface unknowns section 2 present background problem modeling substrate coupling specifically bem methods section 3 present algorithm based functional eigendecomposition substrate current voltage operator show use speed substrate extraction show resulting model form makes easy incorporate standard circuit simulators spice spectre perform coupled circuitsubstrate simulation section 4 include examples illustrate efficiency accuracy techniques described finally section 5 present conclusions work background 21 problem formulation typical mixedsignal circuits operating frequencies gigahertz substrate behaves resistively 11 8 assuming electrostatic approximation substrate therefore usually modeled stratified medium composed several homogeneous layers characterized conductivity shown figure 21a top stack layers number ports contacts defined correspond areas designed circuit interacts substrate examples contacts include possible noise sources receptors contacts substrate wells supply lines drainsourcechannel areas transistors etc figure 21b exemplifies typical model assumed substrate examples contact areas terminals contacts substrate top usually assumed planar bidimensional bottom substrate either attached large contact fixed voltage usually ground left floating substrates backplane connectors known provide better isolation coupling also expensive 3 electrostatic case governing equations reduce well known laplace equation inside substrate volume oe electrostatic potential oe substrate con ductivity assumed constant layer application greens theorem assuming modified greens function g accounts problems boundary conditions gives potential observation point r due unit current injected source point r 0 z aer b figure 1 crosssection substrate showing 3d model homogeneous multilayered system b layered model points contact circuit substrate ae source current density case source observation points substrate contacts top substrate assumed bidimensional volume integral thus reduces surface integral z ae ae surface current density usage mediums greens function greatly simplifies problem implicitly taking account boundary conditions making unnecessary discretize boundaries substrate greens function previously computed analytical form shown 11 fmn cmn cos mx b substrate lateral dimensions fmn computed help recursion formulas order keep description simple refrain reproducing exact formulas somewhat cumbersome exact expressions derivation see 10 11 22 computing resistive model greens function known eqn 3 used compute potential point current distribution substrate contacts given set contacts seek model relates currents contacts c voltage distribution v c practice reasons accuracy necessary discretize contacts series panels set equations relating currents potentials panels system formulated entry impedance matrix form z z surface areas panels j respectively using 4 directly compute elements z leads doubly infinite series exhibits slow convergence therefore computationally expensive 10 shown computation performed efficient way truncating series noticing resulting equation rewritten matrix elements obtained careful combinations appropriate terms twodimensional dct since dct efficiently computed fft techniques leads significant speedup computation time overall algorithm proceeds follows one contacts j placed one volt others contacts set zero volt implies panels contained contact j set voltage one volt ground eqn 5 solved obtain corresponding current distribution appropriately adding current corresponding panels contact one obtains equivalent contact currents procedure equivalent computing one column admittance matrix c defined repeating procedure every contact j problem substrate admittance model c readily constructed noted model given eqn 7 simple resistive network contacts network nodes entry conductance nodes j thus inclusion model standard circuit simulator spice spectre trivial task method outlined quickly become computationally costly number panels large also cost storing dense matrices resulting discretization problem anything small problems one dominant factors computational cost solving system eqn 5 times gaussian elimination ie lufactorization used cost 3 overwhelming typical values n methods speeding solution problem however well known fact applied substrate extraction 8 iterative algorithms namely krylovsubspace algorithms used speedup computation 5 example methods generalized minimum residual algorithm gmres 12 gmres solves linear system minimizing norm residual r p iteration k iterative process major cost algorithms computation matrixvector product required iteration thus number iterations grow rapidly kept small total cost obtaining substrate admittance model os kg average number gmres iterations per solution 8 cost decreased os k p n acceleration matrixvector product using hierarchical multipole algorithm 13 however possible due simplifications assumed computing z specifically translation invariance implied greens function case thus general procedure therefore general methods devised accelerate computation eqn 5 order able handle problems involving several hundreds substrate contacts high accuracy 3 sparsification via eigendecomposition extraction algorithm propose paper computing substrate model based method computing admittance representation substrate iterative algorithm gmres used solve eqn 5 direct computation matrixvector product zi k p avoided operation corresponds essence computing set average panel potentials given substrate injected current distribution readily done means eigenfunction decomposition linear operator relates injected currents panel potentials shall see computation performed efficiently means 2d dcts 31 computation operator eigenpairs first step method discretize substrate top surface small rectangular panels small means current flows across considered uniformly distributed one considering top substrate 2d surface discretization leads theta n set panels cells usually since substrate square sake generalization derivation allow different discretizations axis approximation current distribution n panels represented following equation remainder use notation q current instead usual due obvious parallel capacitive problem electrostatic case q mn total current panel n x squarebump function 0 value throughout plane except rectangle defined gammaa2m gammab2n gammaa2m b2n a2m gammab2n a2m b2n takes constant amplitude mnab unit volume essence serves averaging function let us assume current distribution function qx represented decom posed sum functions form functions ij coefficients decomposition eigenfunctions linear operator l takes us currents potentials definition potential written eigenvalues l therefore eigenpairs eigenfunctions eigenvalues operator l implied poissons equation known eigendecomposition injected substrate currents obtained 9 potentials trivially obtained 10 substrate problem eigenfunctions impedance operator l derived poissons equation knowledge boundary conditions fact since first derivative potential across lateral boundaries must 0 cosines good candidates represent current distribution particular form functions would cos see functions indeed eigenfunctions l substitute current distribution equation find potential written 10 since panels top substrate current distribution contacts represented along z axis delta function z 0 poissons equation written dy 2 amn mn x oe potential function x z 3d potential mn z evaluated eigenvalues l substituting 13 12 computing derivatives multiplying sides cos cos integrating x 0 0 b finally get second order differential equation eigenvalues mn z mn mn oe solution eqn 14 readily obtained mn 6 0 oe l fl mn fi l coshfl mn l number layers substrate profile resistivities oe thickness oe l fi l values gamma l fi l computed recursive manner 10 come surprise derivations fairly similar given definition greens function however 10 used evaluate greens function two panels use directly expand global functions defined entire substrate point shown candidate functions introduced eqn 11 indeed impedance operators eigenfunctions substrate problem furthermore computed eigenvalues operator given 16 17 32 eigendecomposition representation panel potentials given information go back eqn 9 obtain eigenfunction decomposition current distribution end need determine ij easily multiplying sides 9 kl x followed integration x 0 0 b yields z az bqx cos cos dxdy 18 since qx constant rectangles given 8 replacing obtain algebra cos abj sin abi sin sin potential distribution top substrate given eqn 10 known average potential panel easily computed fact average potential panel obtained taking inner product eqn10 squarebump function supported given panel result operation easily shown phi pq x cos j sin sin sin numerical evaluation average panel potential amounts truncating eqn 21 order compute finite number products size summation controlled number coefficients ij available therefore number cosine modes used eigendecomposition 33 efficient computation panel potentials equation 21 allows us compute average panel potentials given arbitrary current distribution top substrate order accomplish task one compute individual ij coefficients using 19 multiply appropriately operators eigenvalues compute double summation indicated 21 inspection eqn 19 reveals coefficients ij result 2d type2 dct set q mn operation efficiently performed means fft furthermore multiplication eigenvalues computation average potentials 21 assuming truncation summation amounts scaling factor computation inverse 2d type2 dct set c point becomes necessary increase accuracy potential computation standard way accomplish refine substrate discretization however directly affects number panels system would increase total computation time storage method higher accuracy obtained without refining discretization increasing size eigendecomposition ie employing cosine modes apparently alternative would preclude usage efficient fft algorithm eqn 19 since would ij coefficients panels ie q mn coefficients however using symmetry properties dct shown ij related first mn cosines modes process termed unfolding thus simple computation dct implied 19 possible obtain arbitrary number cosine mode coefficients without incurring substantial extra cost similar argument refolding coefficients performed obtain average panels potentials 21 specifically cos 2d dct q mn seen 19 sin 2 sin 2 ab 4 sin 2 sin 2 similarly appropriate number terms used 34 memory cost comparison eigendecomposition algorithm described extremely efficient terms memory usage terms computational cost compared greens function based algorithm similar accuracies without loss generality order simplify description assume discretization substrate number panels direction memory requirements eigendecomposition method ok 2 space store eigenvalues system dct coefficients vectors necessary computation gmres algorithm os 2 final admittance model assuming contacts used requirements compared greens function based methods storage requirements methods op size 2d grid used dct resulting panel discretization n number panels number contacts usually n ae p n ae 10 indicated z need explicitly computed thus reducing memory requirements however done expense increasing computation cost elements repeatedly assembled result 2d dct sequence interesting case consider density contacts large common typical designs area major concern case n large percentage p 2 maximum number contacts defined p theta p grid typically p comparable magnitude reasons accuracy even though saw eigendecomposition method one increase accuracy increasing even assuming p comparable n 20p 2 fact small density contacts storage requirements greens function methods op 2 large enough p last term dominate storage cost greens function method require substantially space eigendecomposition method whose cost always op 2 albeit large constant computational cost methods also compared greens function method cost o2p 2 logp first term corresponds 2d type1 dct second term corresponds stenciling z matrix multiple system solutions gmres used easily seen second term always dominates total cost eigendecomposition method total cost o2m 2 logm ke experience shows ke kg average number gmres iterations per contact method comparable thus difference cost two methods rely comparison 2 logm n saw previously even sparse designs number contacts ff 1 n 2 ae 2 implies eigendecomposition method almost always much efficient 4 experimental results section present examples show accuracy efficiency substrate coupling extraction algorithm presented paper use example layout simple mixedsignal circuit figure 4a shows layout example problem substrate contacts marked numbered seen figure example 52 contacts would fit category small medium size problem two experiments using different substrate profiles conducted example layout order test versatility accuracy efficiency extraction algorithm profiles used taken 10 described figure 4b highresistivity substrate used various bicmos processes lowresistivity substrate used cmos due latchup suppressing properties substrate profiles extraction performed resistive model obtained form matrix relating resistance every contact every contact291113 28 29 43 44 ptype 01 ohmcm ptype 15 ohmcm ptype 1 ohmcm backplane backplane b figure 2 example problem showing significant number substrate contacts mixedsignal design symbolic layout b substrate crosssections used profiles low high resistivity substrates table 1 shows selected set relevant resistances computed using method based direct application substrate greens function eigendecomposition based method case lowresistivity profile seen table accuracy methods comparable similar accuracies noted highresistivity profile employed would like point fact possible obtain methods exact values machine precision using uniform discretization seen figure 4a contacts problem varying dimensions typical mixedsignal designs accuracy constraints limit discretization employed producing set panels describe problem example substrate profiles usage uniform discretization greens function method would produce problem many panels computation time memory requirements would overwhelming therefore efficient nonuniform discretization algorithm devised employed problem results table 2 show discretization using algorithm produces name contact 1 contact 2 greens func eigendecomp nonunif disc unif disc r400 9 21 555422e06 746023e06 table 1 selected set extracted resistances example layout using lowresistivity substrate node numbers refer respective contact numbers node called refers example grounded backplane contact relatively small number panels important observation implies efficient discretization algorithm developed greens function method applied extraction hand eigendecomposition method described section 3 requires uniform discretization easier implement shall see imply loss efficiency although perhaps advantageous point view comparison seems fair closer reality table 2 summarizes relevant parameters obtained extraction applied low highresistivity profile examples number panels obtained memory used cpu time necessary etc examples shown order compute solution using greens function based method gmres used solve eqn 5 since usage lu factorization would take long also order maintain similar accuracy methods minimal discretization used method different particular larger dct necessary greens function based method however cost computing dct relevant relative total cost seen table 2 seen table 2 memory requirements shown highresistivity case eigendecomposition algorithm much smaller factor almost 6 obtained terms memory savings lowresistivity profile similar results expected terms computational cost factor 6 speedup obtained lowresistivity substrate profile speedup almost 15 recorded highresistivity substrate leads harder numerical problem point greens function method z matrix relating direct couplings panels explicitly computed stored lowresistivity profile highresistivity profile value greens func eigendecomp greens func eigendecomp nonunif disc uniform disc nonunif disc uniform disc number contacts 52 52 52 52 number panels 2547 17764 2547 17764 average panelscontact 50 341 50 341 size dct 512 theta 512 256 theta 256 512 theta 512 256 theta 256 memory usage 1446mb 255mb number gmres iterations 1238 1868 8030 2930 average per contact 23 35 154 56 computation times seconds ultra sparc 1 discretization 006 054 006 054 greens function dct 1290 na 1033 na total setup time 142415 125 142411 992 solve cost gmres 166568 41114 107278 645005 total extr time 309655 49949 123630 840564 table 2 summary relevant parameters obtained extraction example problem substrate profiles inefficient terms memory savings computational time compensate compromise taken seen tables cost computing matrix dominates total setup cost values shown nontrivial specially lowresistivity substrate either case significant speedup obtained using eigendecomposition method coupled efficient memory usage makes appealing method medium large highdensity substrate extraction problems conclusions paper reviewed commonly used techniques extracting generating accurate models substrate coupling amenable efficient circuit level simulation new eigendecompositionbased technique perform extraction presented examples show relevance accuracy efficiency substrate coupling extraction algorithm presented speedup 15 obtained comparing new extraction method direct usage problems greens function substrate profiles result coupled significant reductions memory usage make method presented interesting problem r deal substrate noise analog cmos circuits chip substrate resistance modeling technique integrated circuit design experimental results modeling techniques substrate noise mixedsignal integrated circuits methodology rapid estimation substratecoupled switching noise addressing substrate coupling mixedmode ics simulation power distribution systems extraction circuit models substrate crosstalk verification techniques substrate coupling application mixedsignal ic design modeling analysis substrate coupling integrated circuits modeling analysis substrate coupling integrated circuits modeling analysis substrate coupling integrated circuits gmres generalized minimal residual algorithm solving nonsymmetric linear systems fast capacitance extraction general threedimensional structures tr gmres generalized minimal residual algorithm solving nonsymmetric linear systems mixedsignal switching noise analysis using voronoitessellated substrate macromodels extraction circuit models substrate crosstalk ctr joo paulo costa mike chou l miguel silveira efficient techniques accurate extraction modeling substrate coupling mixedsignal ics proceedings conference design automation test europe p84es january 1999 munich germany