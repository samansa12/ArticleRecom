band ordering lossless compression multispectral images abstractin paper consider model lossless image compression band multispectral image coded using prediction function involving values previously coded band compression examine ordering bands affects achievable compressionwe present efficient algorithm computing optimal band ordering multispectral image algorithm time complexity on2 nband image naive algorithm takes time n slight variant optimal ordering problem motivated practical concerns shown nphard hence computationally infeasible cases except trivial possibilityin addition report experimental findings using algorithms designed paper applied real multispectral satellite data results show techniques described hold great promise application realworld compression needs b introduction multispectral satellite images require enormous amounts space nasas project eos earth observing system data generated unprecedented rate estimates terabyte 10 12 bytes data generated every day eos satellites multispectral image data largely due fact lot attention recently focussed compression multispectral images 1 2 3 4 5 however compression methods exploit spectral well spatial redundancy lossy compression algorithms archival storage certain applications important use lossless compression order preserve data collected one notable exception work roger cavenor 4 extensively study various prediction coding methods used lossless compression aviris data table 1 lists current widely used multispectral sources acronyms full names basic properties data sensors used study paper study lossless compression multispectral images spectral redundancy extracted coding band multispectral image making use second prediction band much way standard singleimage lossless compression separated two separate components prediction coding divide lossless compression multispectral images three components band ordering prediction coding new stage band ordering refers selecting permutation bands bands coded first act good predictors later bands ordering band ordering phase independent phases compressor computational problems associated phase identified studied paper particular given particular predictor coder paper studied roger cavenor 4 give efficient algorithm computing optimal ordering bands compression performance nband multispectral image algorithm runs 2 time vast improvement obvious timing tests performed dec alpha workstation algorithm computed optimal ordering input matrices see section 2 12 band image 1100 second whereas naive algorithm took 87 minutes dramatically algorithm took approximately 7 seconds find optimal ordering 210 bands aviris data set whereas naive algorithm would take considerably time universe existence cases however optimal ordering may practical archival format large numbers bands see section 3 information consider natural restriction band orderings overcomes problem refer restricted ordering optimal compression order bounded prediction unfortunately new problem shown nphard except trivial case computationally infeasible next examine various possibilities prediction phase multispectral data predictors image data use form linear prediction use fixed coefficients prediction take coefficients small set possibilities lossless jpeg compression 6 multispectral images vital linear prediction coefficients chosen adaptively different methods discussed section 4 coder multispectral images simplest part discussed section 5 investigate use various configurations arithmetic coder using data within current band previous prediction band context coder finally section 6 present experimental results using techniques algorithms presented paper real multispectral data obtained nasa experiments show compression methods developed substantial practical impact compression performance addition experiments show using fixed precomputed band ordering achieve almost optimal performance large class data therefore using precomputed band ordering give fast highperformance compression system multispectral images 2 terminology notation singleimage data represented twodimensional array sx data multispectral image represented threedimensional array entry b x representing pixel band b row x column traditional singleimage compression coding pixel sx previously coded neighboring pixels may used predict value current pixel likewise coding pixel b x multispectral image previously figure 1 sample b matrices thematic mapper data bands 14 coded neighboring pixels may used prediction also allow neighboring pixels come previously coded band words band b choose prediction band pb use pixel values band pb encoding b x compression methods described paper code pixels band scan order point time pixel b x compression algorithm predicting coding called current pixel comes current band band b mentioned also designate separate band pb prediction band current band singleimage compression pixel values used prediction must coded current pixel including pixel values prediction band thus may use prediction bands pixel location corresponding current pixel ie pb x band pb coded band b clearly ordering bands determines bands may selected prediction band current band determining ordering bands maximizes compression possible orderings fundamental problem given predictorcoder pair two bands b 1 b 2 define following two values compressed size band b 2 band b 1 used prediction b 1 x used prediction b 2 x words compressed size band b 2 using prediction even band b 2 encoded band b 1 compressed size band b 2 band b 1 used prediction current pixel location band b 1 used prediction compressed size possible band encoded band b 1 represent b values multispectral image matrices see figure 1 example b matrices obtained bands 14 thematic mapper data washington dc area next section examine various ways choosing band ordering given matrices b 3 determining band compression order section examine following problem order compress bands multispectral image achieve best compression example band 2 acts good predictor band 1 substantial savings may achieved compressing band 2 first show given matrices defined previous section optimal ordering bands found efficiently multispectral data small number bands result shows optimal ordering simple practical however data large number spectral bands 210 band aviris data optimal ordering computed may desired particular given compressed file containing 210 bands aviris data may desirable able extract one particular band compressed data unfortunately band dependencies optimal ordering may single long chain would mean bands would uncompressed order uncompress last single band chain good solution problem would partition bands small sets containing b bands compressing one band bands may used prediction within set method b bands would uncompressed order extract single band compressed file particular partition size bound b call optimal solution problem optimal compression order bounded prediction show finding optimal compression order bounded prediction easy nphard hence computationally intractable b 3 31 unconstrained optimal ordering section consider problem finding optimal compression order constraints many bands necessary uncompression single band ordering best possible ordering encoding bands practical either small number bands 5 bands czcs data 7 bands tm data extraction single band never needed archive aviris data may require uncompression 210 bands accessed transform problem finding optimal compression ordering problem weighted directed graphs known efficient solution directed graph e constructed edge e ij corresponding weight w ij represents compression savings attainable compressing band band j construct graph define b minj 1in represents minimum compressed size band j current pixel location used band particular compressed size b minj attainable band j regardless order bands compressed course bands ordered band encoded band j current pixel location band used predict current pixel band j cases resulting compressed size may substantially smaller size attainable without considering ordering define edge weights graph terms savings possible encoding band j using current pixel location band prediction particular problem finding optimal compression order equivalent problem finding maximum weight directed spanning forest g resulting spanning forest defines partial order vertices since spanning forest maximum weight partial order represents maximum compression savings band ordering optimal compression order bands multispectral image known maximum weight directed spanning forest also known optimal branching found ojv j log jej jej time sparse graphs ojv j 2 time dense graphs 7 8 follows optimal compression order found 2 time graph g derived sample b matrices figure 1 shown figure 2 dashed solid lines represent graph edges solid lines edges part maximum weight directed spanning forest thus solid lines describe optimal compression ordering four bands band 2 coded first band 1 coded using band 2 prediction band 3 coded using band 2 prediction band 4 coded using band 3 prediction course one arbitrarily chosen ordering consistent partial order defined spanning tree total weight selected spanning forest 45257 meaning band ordering save 45257 bytes orderingindependent coding scheme summarize result section following theorem theorem 31 given values ij b ij pairs bands j nband multispectral image optimal compression ordering computed 2 time figure 2 graph derived sample b matrices spanning tree edges solid lines 32 optimal ordering bounded prediction mentioned beginning section optimal ordering always practical particular necessary able extract uncompress single band image efficiently optimal compression ordering always make possible consider case directed spanning tree obtained previous subsection actually long directed path 210 band data set would possible band 210 coded using band 209 prediction band 209 coded using band 208 etc thus order extract band 210 209 bands would uncompressed addition band 210 data sets large number bands reasonable approach would partition bands small sets containing say b bands compress set using optimal compression ordering case single band needs extracted bands set requested band possibly need uncompressed call ordering optimal compression order bounded prediction prove following theorem regarding complexity computing ordering theorem 32 given values ij b ij pairs bands j nband multispectral image problem finding optimal compression order bounded prediction nphard b 3 computed 3 2 show problem finding optimal compression order bounded prediction nphard b 3 show following decision problem npcomplete compression order bounded prediction cowbp input problem matrices b compressed size bound c problem decide whether exists partitioned compression ordering bands partition contains 3 bands total compressed size c problem clearly np show npcomplete reduce partition paths length two piplt cowbp piplt known npcomplete 9 takes undirected graph vertices input asks whether exists partition graph paths length two given graph e input piplt problem convert graph instance cowbp setting inputs follows next show partitioned compression ordering satisfying conditions instance cowbp original graph g partitioned paths length two first assume g partitioned paths length two paths given triples define partition cowbp input bands compressed coding v i2 using v i1 without current pixel v i1 using v i2 current pixel v i3 using v i2 current pixel resulting compressed size set partition therefore b v i1 v i2 since 3 sets partition total compressed size bands exactly 4 original problem piplt computed problem cowbp next assume computed problem cowbp partitioned compression ordering total compressed size 4 3 n choose optimal partitioned compression ordering band compressed using current pixel band j current pixel required since b furthermore assume two bands partition connected component ordering since case could split partition smaller independent partitions desired property let c number sets partition size 1 3 assumptions compressed size set size 1 2 set size 2 3 set size 3 4 total compressed size way 3 c 3 partitions must exactly 3 bands must correspond paths length two original graph therefore computed problem cowbp original problem piplt completes npcompleteness proof simple padding argument shows cowbp remains npcomplete generalized allow partition contain sets size two smaller ie 2 encoding size bands j set would result compressed size exactly create complete undirected graph weights w finding maximum weight matching graph gives optimal partitioning bands sets size 2 also gives us exactly optimal compression ordering bounded prediction b 2 known since 1976 matching found 3 time 10 noted algorithms matching known take advantage input instances bounded integral weights edges beat 3 time bound slightly better asymptotic results 11 without explicit bounds compressed size bands multispectral image impossible state results terms improved algorithms refer interested reader algorithm reference 11 4 prediction multispectral images vast majority lossless image compression algorithms made prediction stage pixel values predicted coding stage difference actual pixel value predicted value coded recent examples see 12 6 predictor typically uses linear function predict current pixel value based values previously coded pixels neighborhood current pixel compression algorithms code pixels 2neighborhood b 4neighborhood figure 3 neighboring pixels used prediction phase scanorder neighborhood usually subset 4neighborhood shown figure 3b current pixel marked solid circle example may predict current pixel computing average two nearest neighbors ac2 lossless jpeg scheme 8 different possible linear prediction functions b c free use eight 6 since relationship different bands multispectral image known ahead time must find good prediction function examining image data particular experiments consider 2neighborhoods 4neighborhoods pairs bands see figure 3 use actual image data determine coefficients linear function neighborhood values minimizes variance prediction error determining coefficients way similar although exactly standard linear prediction methods see example 13 done using least squares approximation algorithms experiments paper done predictor finds linear coefficients 2neighborhood 4neighborhood current pixel location values current band prediction band used prediction function 2neighborhood 4neighborhood used second pass data using computed coefficients whichever resulted smaller compressed size reported program computes coefficients without current pixel location prediction band resulting compressed sizes used b matrix values respectively 5 coding multispectral images coder responsibility turning predicted values output bitstream various approaches taken different compression systems including huffman coding rice coding arithmetic coding variants qcoding good explanation coding general including huffman coding arithmetic coding found 14 rice coding described 15 similar golumb coding described 16 huffman coding performs poorly small alphabets prediction phase produces small low entropy errors rice coding performs poorly small errors errors generated according laplacian distribution distribution errors usually close laplacian discovered experiments czcs data produced markedly nonlaplacian error distributions sensors produced prediction errors less laplacian final choice coder adaptive arithmetic coder three neighboring prediction errors used context coder two nearest neighbors current band current pixel location prediction band possible actual prediction errors could easily used neighboring pixels band prediction error current location prediction band estimated using simple singleimage linear prediction formula prediction band pixel current location c neighboring pixels prediction band defined figure 3a prediction errors bucketed similar 17 zero small 12 medium 38 large 9 sign error also used context since context computed 3 prediction errors 7 possible values coder uses 343 contexts actual prediction errors encoded first encoding tag denoting negative positive zero error encoding error magnitude two bits time method substantially reduces amount storage required maintaining error frequency statistics since frequency tables need maintained 4 symbol alphabet 2bit blocks example image pixels error range 65535 65535 directly coding prediction error would require 131071 frequency counts per context total almost 45 million counts contexts hand keeping statistics error sign twobit blocks error magnitude requires 35 frequency counts per context total 12005 frequency counts contexts significant note errors laplacian distributed majority cases encoding errors significantly efficient way fully efficient keeping separate frequency counts possible error values furthermore errors laplacian distributed czcs data method greatly outperforms true laplacian coders rice coder performs almost data set optimal order paired code independent jpeg compress czcs 2951 2611 2371 2461 2021 486x1536x5 271 306 337 325 397 neworl 2681 2581 2471 2491 1871 512x512x7 298 310 324 322 429 ridgely 2781 2591 2501 2491 1911 468x368x7 287 309 320 321 419 washdc 2581 2451 2321 2301 1861 512x512x7 310 326 344 348 431 aviris 3531 3211 2981 2901 2071 avhrr1 2771 2761 2771 2501 1531 avhrr2 2611 2611 2611 2401 1471 table 2 results first experiment top line compression ratio bottom line bits per pixel well arithmetic coder full frequency counts 6 experimental results performed many experiments using algorithms described paper real multispectral satellite data experiments show band reordering substantially improve compression performance certain data sets using fixed precomputed band ordering works well entire classes data giving fast highquality compression system multispectral images data experiments came four types sensors listed table 1 first set images representing crosssection image sources contains tm data neworl ridgely washdc 5 bands czcs data czcs avhrr data avhrr1 avhrr2 aviris data set denoted aviris data sets available anonymous ftp site chrpalggsfcnasagov available researchers comparison purposes compute b matrices entries computed parallel cm5 parallel computer values computed b matrices fed implementations algorithms described section 3 finding optimal band ordering finding optimal paired ordering results given terms compression ratio encoded bits per pixel table 2 compression ratios shown graphically figure 4 compression ratio using prediction coding phases interband prediction czcs neworl ridgely washdc aviris avhrr1 avhrr224 compression optimal order paired coding independent coding lossless jpeg compress figure 4 results compression ratio first experiment shown independent coding meaning bands coded independently bands addition compression ratios found using lossless jpeg band coded independently others unix compress command included comparison purposes performance lossless jpeg compares well best lossless singleimage compressors unix compress results included since many installations currently choose method compressing multispectral data sets results emphasize poor choice seen table 2 figure 4 effect band ordering depends heavily source data particular large gains seen selecting optimal band ordering aviris czcs data moderate gains seen tm data sets almost nothing gained bandordering avhrr data suggests individual bands avhrr data independent bands sensors supported technical specifications sensor interesting note data sets band ordering made difference performance paired ordering moderate improvement independent coding implies band dependencies global nature pairs bands light proof computing optimal partitioning blocks size three nphard seems blocking method compression ratio blocking optimal order 3531 blocks 5 adjacent bands 3391 optimal partitioning 2band blocks 3211 independent coding 2981 table 3 partitioning band position without regard content closetooptimal performance possible without using absolute optimal ordering risking long dependence chains examine importance selecting good partitioning divided 210 bands aviris data blocks 5 adjacent bands per block without regard content bands words blocks consisted bands 15 bands 610 bands 1115 etc within block bands optimally ordered reason believe chosen blocks bear resemblance optimal partitioning results shown table 3 seen table 3 simply picking blocks adjacent bands partitioning seems work well aviris data compression ratio quite match performance optimal ordering added benefit allowing efficient extraction single band compressed archive may worth sacrificing compression next experiment conducted determine much band ordering depends sensor much depends individual data sets test obtained seven independent data sets single sensor czcs ran previous tests addition following test particular data set optimal compression ordering six data sets computed ordering used data set tested results last type test labeled precomputed order shown table 4 figure 5 seen results cases order computed images gave compression ratio competitive optimal order computed specifically image suggests least czcs data band ordering function sensor individual image therefore reasonable approach take production compression package would compute optimal ordering large representative set images hardcode band ordering compressor compress multispectral image approach bandordering computed b matrices need computed compression efficient results last experiment show approach yield almost optimal compression optimal ordering czcs data computed seven data sets optimal data set optimal ord precomp ord paired code ind jpeg compress czcs1 3341 3271 2921 2711 2921 2121 970x1968x6 240 244 274 296 274 377 czcs2 2391 2371 2181 2021 2151 1681 962x1968x6 335 337 367 396 371 477 czcs3 3281 3281 3001 2801 3021 2391 970x1968x6 244 244 266 285 265 335 czcs4 3431 3431 3111 2821 2991 2411 970x1968x6 234 234 257 284 267 332 czcs5 2761 2671 2531 2361 2401 1711 850x1968x6 290 299 316 338 334 469 czcs6 2751 2751 2521 2261 2351 1871 970x1968x6 291 291 317 354 341 428 czcs7 2511 2511 2271 2061 2121 1701 970x1968x6 318 318 352 389 377 471 table 4 results czcs experiments top line compression ratio bottom line bits per pixel compression optimal order precomputed order paired coding independent coding lossless jpeg compress figure 5 results compression ratio czcs experiments czcs data band 6 alone band 1 using band 6 band 2 using band 1 band 3 using band 2 band 4 using band 3 band 5 using band 1 tm data band 2 using band 1 without current location band 1 using band 2 band 3 using band 2 band 7 using band 3 band 5 using band 7 band 6 using band 7 band 4 using band 5 table 5 globally optimal band orderings tm czcs sensors ordering tm data computed data sets washdc neworl shown table 5 conclusions paper extensively studied benefits problems associated reordering bands multispectral image performing lossless compression reasonable model interband prediction shown efficiently compute optimal compression band ordering addition formalized restrictions arise bands need extracted individually compressed archive shown computing optimal ordering restrictions nphard except simple case experiments show certain data sources czcs aviris imagery band ordering algorithms paper substantially improve compression performance inter estingly data sources avhrr data benefit techniques paper implying bands independent treated separately data multispectral image computing band ordering described paper evaluating compression results easy determine band reordering going substantial benefit particular data set computing optimal band ordering may efficient ie polynomial time certainly fast requiring pairs bands tested predictioncoding pairs alternative compute fixed band ordering class data use fixed ordering coding data sets class instance fixed czcs ordering could precomputed used czcs data sets ordering computed way sample data given section 6 benefit extremely fast similar speed simply ignoring interband furthermore experiments shown czcs data results almost indistinguishable optimal ordering results thus last approach using fixed band reordering seems promising lossless multispectral compression method acknowledgments author would like thank doreen revis help various aspects cm5 jim tilton manohar mareboyana gene feldman mary james supplying test data sarah blanton providing helpful comments presentation results r multispectral kltwavelet data compression landsat thematic mapper images feature predictive vector quantization multispectral images multispectral image compression algorithms lossless compression imaging spectometer data reversible image compression bounded noise jpeg still compression standard finding optimum branchings note finding optimum branchings computers intractability guide theory npcompleteness efficient implementation edmonds algorithm maximum matching graphs faster scaling algorithms general graphmatching prob lems new methods lossless image compression using arithmetic coding linear prediction tutorial review englewood cliffs practical universal noiseless coding techniques optimal source codes geometrically distributed integer alphabets parameter reduction context selection compression grayscale images tr ctr amitabha bagchi ankur bhargava torsten suel approximate maximum weight branchings information processing letters v99 n2 p5458 31 july 2006 amel benazzabenyahia jeanchristophe pesquet jamel hattay hela masmoudi blockbased adaptive vector lifting schemes multichannel image coding journal image video processing v2007 n1 p66 january 2007