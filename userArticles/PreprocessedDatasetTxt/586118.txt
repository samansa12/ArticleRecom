efficient dosresistant secure key exchange internet protocols describe jfk new key exchange protocol primarily designed use ip security architecture simple efficient secure sketch proof latter property jfk also number novel engineering parameters permit variety tradeoffs notably ability balance need perfect forward secrecy susceptibility denialofservice attacks b simplicity resulting protocol must simple possible within constraints requirements security requirement obvious enough use security model 7 8 rest however require discussion pfs property perhaps controversial pfs attribute encrypted communications allowing longterm key compromised without affecting security past session rather assert must perfect forward secrecy costs treat amount forward secrecy engineering parameter traded necessary functions efciency resistance denialofservice attacks fact corresponds quite nicely reality days internet systems compromise existence security association reveal plaintext ongoing transmissions protocol forward secrecy interval security associations protected compromises occur outside interval specically allow party reuse secret difehellman exponents multiple exchanges within time period may save large number costly modular exponentiations privacy property means protocol must reveal identity participant unauthorized party including active attacker attempts act peer clearly possible protocol protect initator responder active attacker one participants must always go rst general believe appropriate choice protect initator since initator typically relatively anonymous client responders identity may already known conversely protecting responders privacy may much value except perhaps peertopeer communication many cases responder server xed address characteristics eg wellknown web server one approach allow protocol allows two parties negotiate needs identity protection jfk decided unclear metric used determine party receive identity protection furthermore negotiation could act loophole make initiators reveal identity rst instead propose two alternative protocols one protects initator active attack another protects responder memorydos computationdos properties become important context recent internet denialofservice attacks photuris24 rst published key management protocol dosresistance design consideration suggest properties least important today efciency property worth discussing many proto cols key setup must performed frequently enough become bottleneck communication key exchange protocol must minimize computation well total bandwidth round trips round trips especially important factor communicating unreliable media using protocols two roundtrips needed set working security association considerable saving comparison existing proto cols ike nonnegotiated property necessary several reasons negotiations create complexity round trips hence avoided denial service resistance also relevant partiallynegotiated security association consumes resources simplicity property motivated several factors ef ciency one increased likelihood correctness another motivation especially colored experience ike even protocol dened correctly must implemented correctly protocols become complex implementation interoperability errors occur often hinders security interoperability design follows traditional design paradigm successful internetworking protocols keep individual building blocks simple possible avoid large complex monolithic protocols consciously chosen omit support certain features felt adding support would cause increase complexity disproportional benet gained protocol design extent engineering activity need provide tradeoffs different types secu rity tradeoffs made protocol design others forward secrecy computational effort left implementation user eg selected parameters conguration session negotiation 2 protocol definition present two variants jfk protocol variants take two roundtrips ie four messages provide level dos protection rst variant denoted jfki provides identity protection initiator even active attacks identity responder protected type protection appropriate clientserver scenario initiator client may wish protect identity whereas identity responder server public discussed section 4 protocol uses basic design iso 97983 key exchange protocol 20 7 modications guarantee properties discussed introduction second variant jfkr provides identity protection responder active adversaries furthermore protects sides identities passive eavesdroppers type protection appropriate peertopeer scenario responder may wish protect identity note considerably easier mount active identityprobing attacks responder initiator furthermore jfkr provides repudiability key exchange since neither side prove third party peer fact participated protocol exchange contrast jfki authentication nonrepudiable since party signs others identity along sessionspecic information nonces protocol uses basic design signandmac sigma protocol 28 appropriate modications 21 notation first notation hkm keyed hash eg hmac29 message using key k assume h pseudorandom function also implies h secure message authentication places make somewhat stronger assumption relating h discrete logarithms see details within fmgkea encryption using symmetric key ke followed mac authentication symmetric key ka message mac computed ciphertext prexed literal ascii string r depending message sender initiator responder digital signature message private key belonging principal x initiator responder assumed nonmessagerecovering signature message components used jfk ipi initiators network address gx difehellman dh exponentials also identifying groupid initiators current exponential mod p gr responders current exponential mod p ni initiator nonce random bitstring nr responder nonce random bitstring idi initiators certicates publickey identifying information idr responders certicates publickey identifying information idr0 indication initiator responder authentication information eg certicates latter use hkr transient hash key private responder sa cryptographic service properties security association sa initiator wants establish contains domainofinterpretation jfk stands applicationspecic bitstring sa0 sa information responder may need give initiator eg responders spi ipsec kir shared key derived gir ni nr used protecting application eg ipsec sa keka shared keys derived gir ni nr used encrypt authenticate messages 3 4 protocol grpinfo groups supported responder symmetric r algorithms used protect messages 3 4 hash function used key generation parties must pick fresh nonce invocation jfk protocol nonces used sessionkey computation provide key independence one parties reuse dh exponential session key different independent runs protocol long one nonces exponentials changes hkr global parameter responder stays protocol runs change periodically 22 jfki protocol jfki protocol consists four messages two round trips hhkr grnrni ipi keys used protect messages 3 4 ke ka computed hgir ni nr 1 hgir ni nr 2 respec tively session key passed ipsec application kirishgir ni nr 0 note may difference number bits hmac number produced raw difehellman exchange 512 leastsignicant bits gir used key case key used ipsec longer output hmac key extension method ike used generate keying material message 1 straightforward note assumes initiator already knows group generator acceptable responder initiator reuse gi value multiple instances protocol responder responders accept group long wishes forward secrecy interval discuss initiator discover groups use later section message also contains indication id initiator would like responder use authenticate idr0 sent clear however responders id message 2 also sent clear loss privacy message 2 complex assuming responder accepts difehellman group initiators message rejections discussed section 25 replies signed copy exponential group also mod p information secret key algorithms acceptable next message random nonce identity certicates string identifying public key authenticator calculated secret hkr known responder authenticator computed sponders exponential two nonces initiators network address responders exponential may also reused regenerated according responders forward secrecy inter val signature exponential needs calculated rate responders forward secrecy interval exponential changes finally note responder need generate state point cryptographic operation mac calculation responder heavy load pfs deemed important responder may generate new exponential corresponding signature use ex change course would require keeping state secret part responders difehellman computation message 3 echoes back data sent responder including authenticator authenticator used responder verify authenticity returned data authenticator also conrms sender message 3 used address message 1 used detect counter cookie jar dos attack1 valid authenticator indicates responder roundtrip completed messages 1 2 3 message also includes initiators identity service request signature computed nonces responders identity two exponentials latter information encrypted authenticated keys ke ka already described encryption authentication use algorithms specied grpinfo responder keeps copy r recentlyreceived messages 3 corresponding message 4 receiving duplicate replayed message 3 causes responder simply retransmit corresponding message 4 without creating new state invoking ipsec cache messages reset soon hkr changed responders exponential gr resent initiator responder may generating new gr every new jfk protocol run eg arrival rate requests threshold important responder deal repeated messages 3 described responders create new state repeated message 3 open door attacks protocol andor underlying application ipsec note signature protected encryption necessary identity protection since everything signed public except sa often guessable attacker could verify guesses identities signature encrypted message 4 contains applicationspecic information responders ipsec spi signature nonces exponentials initiators identity everything encrypted authenticated ke ka used message 3 derived ni nr gir encryption authentication algorithms specied grpinfo r 23 discussion design follows requirements respect communication efciency observe protocol requires two round trips protocol optimized protect responder denial service attacks state computation initia 1the cookie jar dos attack involves attacker willing reveal address one subverted host acquire valid cookie number cookies used large number subverted hosts launch ddos attack using valid cookies tor bears initial computational burden must establish roundtrip communication responder latter required perform expensive operations time protocol designed limit private information revealed initia reveal identity sure responder retrieve active attacker replay old message 2 response initiators initial message cannot retrieve initiators identity message 3 cannot complete difehellman computation initiators rst message message 1 straightforward difehellman exponential note assumed encoded selfidentifying manner ie contains tag indicating modulus base used nonce ni serves two purposes rst allows initiator reuse exponential across different sessions different responders within initiators forward secrecy interval ensuring resulting session key different secondly used differentiate different parallel sessions case assume underlying transport protocol ie udp handle demultiplexing using different ports initiator message 2 must require minimal work responder since point idea whether initiator legitimate correspondent eg forged message denial service tack round trip yet occurred initiator therefore important responder required point perform expensive calculations create state responders cost single authentication operation cost hmac dominated two invocations cryptographic hash function plus generation random nonce nr responder may compute new exponential gb mod p interaction expensive option however times high load attack would inadvisable nonce prevents two successive session keys even initiator responder reusing exponentials one case sides may reuse exponentials initiator lowpower device eg cellphone responder busy server simple way addressing dos periodically eg every seconds generate r grhhkr grsrgr tuple place fifo queue requests arrive particular valid messages 3 processed rst entry fifo moved thus long valid requests arrive generation rate pfs provided exchanges rate valid protocol requests exceeds generating rate jfk implementation reuse last tuple fifo notice scheme gr may reused different sessions sessions inter leaved violate pfs security properties protocol responder willing accept group identied initiators message exponential must group oth erwise may respond exponential group choosing eld grpinfo lists groups responder r nds acceptable initiator wish restart proto col provides simple mechanism initiator discover groups currently allowed responder eld also lists encryption mac algorithms acceptable next two messages negotiated responder right decide strength encryption necessary use services note responder creates state sending mes sage fraudulent initiator nonexistent intent perpetrating denialofservice attack responder committed storage resources message 3 initiator echoes content responders message including authenticator authenticator allows responder verify roundtrip communication legitimate potential correspondent initiator also uses key derived two exponentials two nonces encrypt identity service request initiators nonce used ensure session key unique even initiator responder reusing exponentials responder forgotten change nonces initiator validate responders identity sending identifying information ignoring public key signature sent encrypted privacy protected passive active attackers active attacker replay old message 2 response initiators initial mes sage cannot retrieve initiators identity message 3 cannot complete difehellman computation service request encrypted since disclosure might identify requester responder may wish require certain strength cryptographic algorithm selected services upon successful receipt verication message responder shared key party known initiator responder knows service initiator requesting point may accept reject request responders processing receipt message 3 requires verifying authenticator successful performing several public key operations verify initiators signature cer ticate chain authenticator requiring two hash opera tions sufcient defense forgery replays however could cause considerable computation defense cache corresponding message 4 duplicate message 3 seen cached response retransmitted responder create new state notify application eg ipsec key looking messages 3 cache authenticator prevents dos attacks attacker randomly modies encrypted blocks valid message causing cache miss thus processing done responder authenticator veries problem message eg certicates verify responder cache authenticator along indication failure actual rejection message avoid unnecessary processing may part dos attack cache messages 3 authenticators purged soon hkr changed since authenticator longer pass verication caching message 3 refraining creating new state replayed instances message 3 also serves another security pur pose responder create new state send new message 4 new sa0 replayed message 3 attacker compromised initiator could replay recent session responder replaying message 3 recent exchange initiator responder attacker could establish session responder sessionkey would identical key previous session took place initiator yet compromised could compromise forward security initiator risk however keeping message cached long responders machine compromised pe riod perfect forward secrecy compromised tune changing mac key hkr frequently cache reset new hkr chosen message 4 responder sends initiator responder specic application data eg responders ipsec spi along signature nonces exponentials ini tiators identity information encrypted authenticated using keys derived two nonces ni nr difehellman result initiator verify responder present participating session decrypting message verifying enclosed signature 24 jfkr protocol using notation jfki jfkr protocol jfki keys used protect messages 3 4 ke ka respectively computed hgir ni nr 1 hgir ni nr 2 session key passed ipsec application kirishgir ni nr 0 parties send identities encrypted authenticated ke ka respectively providing parties identity protection passive eavesdroppers addition party rst reveals identity initiator way responder required reveal identity veries identity initiator guarantees active identity protection responder remark essentially impossible current technology assumptions tworoundtrip protocol provides dos protection responder passive identity protection parties active identity protection initiator informal argument proceeds follows dos protection place responder must able send rst message computes shared key since computing shared key relatively costly operation current technology means responder cannot send identity second message without compromising identity protection passive eavesdroppers means responders identity must sent fourth last message protocol conse quently initiators identity must sent responders identity sent 25 rejection messages instead sending messages 2 4 responder send rejection instead message 2 rejection grounds accept group initiator used exponential accordingly reply indicate groups acceptable since message 2 already contains eld grpinfo indicates groups acceptable explicit rejection message needed efciencys sake group information could also responders longlived certicate initiator may already message 4 rejection several reasons including lack authorization service requested could also caused initiator requesting cryptographic algorithms responder regards inappropriate given requester initia tor service requested possibly information available responder time day initiators location indicated network cases responders reply list acceptable cryptographic algorithms initiator would send new message 3 responder would accept anew responder create state successful message 3 receipt 3 jfk avoids intent jfk certain things worth enumerating stimulate discussion whether certain protocol features ever appropriate jfk missing features omitted design interests simplicity 31 multiple authentication options obvious omission form authentication certicate chains trusted party make provisions shared secrets tokenbased authentication certi cate discovery explicit crosscertication pkis view best accomplished outboard protocols initiators wish rely form legacy authentication use protocols dened ipsra41 sacred1 14 ietf working groups mechanisms add extra round trips expense amortized across many jfk negotiations sim ilarly certicate chain discovery beyond minimal capabilities implicit idi idr accomplished protocols de ned purpose excluding protocols jfk exclude security analysis interface two certicate chain denition standalone secure object also eliminate negotiation generally favor ukases issued responder responder providing service entitled set requirements service cryptographic primitive mentioned responder acceptable initiator choose wishes thus eliminate complex rules selecting best choice two different sets also eliminate need state kept responder initiator either accept responders desires restart protocol 32 phase ii lack thereof jfk rejects notion two different phases discussed section 5 practical benets quick mode limited furthermore agree frequent rekeying necessary underlying block cipher sufciently limited bar longterm use one key proper solution replace cipher example 3des inadequate protection high speed transmissions probability collision cbc mode becomes high encryption 232 plaintext blocks using aes instead 3des solves problem without complicating exchange phase ii ike used several things regard necessary one generating actual keying material used security associations expected done several times amortize expense phase negotiation second reason permit frequent rekeying finally permits several separate security associations set different parameters think apply first modern ciphers aes need frequent key changes aes keys long enough brute force attacks infeasible longer block size protects cbc limitations encrypting many blocks also feel jfk efcient enough avoiding overhead full key exchange required rather adding new sas existing phase sa suggest full jfk exchange initiated instead note initiator also choose reuse exponential wishes trade perfect forward secrecy computation time state already exists initiator responder simply check difehellman exponentials result previous exponentiation reused long one two parties uses fresh nonce new protocol exchange resulting cryptographic keys fresh subject related key similar attack discuss section 33 similar performance optimization used certicatechain validation second major reason phase ii deadpeer detection ipsec gateways often need know end security association dead free resources avoid black holes jfk done noting time last packet received peer wishes elicit packet may send ping hosts may decline proposed security associations permit ping packets third reason phase ii general security association control particular sa deletion desire wrong prefer burden basic key exchange mechanism extra complexity number possible approaches requires jfk endpoints implement following rule new negotiation species spd identical spd existing sa overwrites extent removes need delete sa black hole avoidance concern simply negotiate new sa delete sa without replacing negotiate new sa null ciphersuite 33 rekeying negotiated sa expires shortly jfk protocol run application select appropriate sa use among many valid ones case ipsec implementations switch using new sa outgoing trafc would still accept trafc old sa long sa expired address performance considerations point properly implemented rekeying requires one signature one verication operation direction parties use difehellman exponentials case cached result reused certicates receiver id payload compares hash cached id payloads received peer implementation detail natural location cache past id payloads along already established sas convenient fact rekeying likely occur existing sas allowed expire id information readily available match found result expired yet need revalidate certicate chain previously veried certicate chain considered valid shortest crl revalidate time certicate expiration time ocsp result validity time etc certicate chain one value associated time one components becomes invalid needs checked notice implementation need cache actual id payloads needed hash expiration time said reason fast rekeying needed application domain done separate protocol 4 towards proof security section briey overviews security analysis jfk protocol full details deferred full analysis paper currently two main approaches analyzing security protocols one formalmethods approach cryptographic components protocol modeled ideal boxes automatic theoremverication tools used verify validity highlevel design assuming ideal cryptography cryptographic approach accounts fact cryptographic components imperfect may potentially interact badly security protocols proven based underlying computational intractability assumptions hardness factoring large numbers computing discrete logarithms modulo large prime inverting cryptographic hash function formalmethods approach automated advantage less susceptible human errors oversights analysis hand cryptographic approach provides better soundness since considers overall security protocol particular accounts imperfections cryptographic components analysis follows cryptographic approach welcome additional analysis particular analysis based formal methods would useful complement analysis described separate analysis core security protocol rather tricky analysis added security features dos protection identity protection much straightforward rest section concentrates core security protocol dos identity protection discussed previous sections 41 core security use modeling treatment 7 turn based 6 see references comparisons analytical work roughly core security key exchange protocol boils two requirements 1 party generates key ka associated session identier peer identity b party b generates key kb associated session identier peer 2 attacker distinguish key exchanged session two unbroken parties truly random value holds even attacker total control communication invoke multiple sessions told keys generated sessions stress rough sketch requirement full details see 7 8 show jfki jfkr satisfy requirement protocols run perfect forward secrecy security based standard intractability assumption dh problem plus security signature scheme security mac pseudorandom function party reuses dh value security based stronger intractability assumption involving dh hmac pseudorandom function rst analyze protocols restricted case parties reuse private dh exponents multiple sessions bulk work techniques demonstrating security two protocols quite different 411 jfki basic cryptographic core protocol iso 97983 protocol analyzed proven secure 7 protocol briey summarized follows salient point protocol party signs addition nonces two public dh exponents identity peer peers identity signed protocol completely broken jfki inherits basic core security addition jfki adds preliminary cookie mechanism dos protection results adding one ow protocol responder jfki play role encrypts last two messages order provide identity protection initiator finally note jfki enjoys following additional prop erty whenever party p completes jfki exchange peer q guaranteed q initiated exchange p aware ps existence property essential context ipsec indeed jfkr enjoy property nonetheless may use contexts 412 jfkr basic cryptographic core protocol follows design sigma protocol 28 also serves basis signature mode ike sigma analyzed proven secure 8 basic protocol briey summarized follows hka nanbb neither party signs identity peer instead party includes mac keyed key derived gab applied identity concatenated na nb jfkr enjoys basic core security protocol addition jfkr adds preliminary cookie mechanism dos protection results adding one ow protocol responder jfkr play role encrypts last two messages order provide identity protection identity protection passive adversaries covers parties since identities sent last two messages next step analysis generalize case private dh exponents reused across sessions done making stronger still reasonable computational intractability assumptions involving dh problem hmac pseudorandom function defer details full analysis paper 5 related work basis key agreement protocols based publickey signatures station station sts11 protocol simplest form shown figure 1 consists difehellman exchange followed public key signature authentication step typically using rsa algorithm conjunction certi cate scheme x509 implementations second message used piggyback responders authentication infor mation resulting 3message protocol shown figure 2 forms authentication may used instead public key signatures eg kerberos37 tickets preshared secrets typically applicable constrained environments short version protocol proven efcient13 terms messages computation suffers obvious dos vulnerabilities 51 internet key exchange ike internet key exchange protocol ike15 current ietf standard key establishment sa parameter negotiation initiator responder initiator diffiehellman public value responder diffiehell public value initiator rsa signature certificates responder rsa signature certificates figure 1 4message station station key agreement protocol ike based isakmp 33 framework provides encoding processing rules set payloads commonly used security protocols oakley protocol describes adaptation sts protocol use ipsec2 publickey encryption modes ike based skeme 27 ike twophase protocol rst phase secure channel two key management daemons established parameters authentication method encryptionhash al gorithms difehellman group negotiated point set parameters called phase sa using infor mation peers authenticate compute key material using difehellman algorithm authentication based public key signatures public key encryption preshared passphrases efforts extend support kerberos tickets37 handheld authenticators also noted ike support key establishment mechanisms besides difehellman although none proposed yet3 furthermore two variations phase message ex change called main mode aggressive mode main mode provides identity protection transmitting identities peers encrypted cost three message roundtrips see figure 3 aggressive mode provides somewhat weaker guarantees requires three messages see figure 4 result aggressive mode susceptible untraceable4 denial service dos attacks computational memory main mode also susceptible untraceable memory exhaustion dos attacks must compensated implementation using heuristics detection avoidance wit 2we remark however actual cryptographic core ikes signature mode somewhat different oakley oakley peer authentication guaranteed party explicitly sign peer identity contrast ike guarantees peer authentication party mac identity using key derived agreed difehellman secret method peer authentication based signandmac design 28 3there ongoing work still early stages ietf use ike transport mechanism kerberos tickets use protecting ipsec trafc 4the attacker use forged address sending rst message exchange initiator responder initiator diffiehellman public value responder diffiehell anadn cpeurbtilficicvataeluse responder rsa signature initiator rsa signature certificates figure 2 3message station station key agreement protocol responder create state upon receiving rst message initiator since phase sa information exchanged point allows dos attack responders memory using random sourceip addresses send ood requests counter responder could employ mechanisms similar employed countering maintains state receiving rst message initiator willing go rst message roundtrip thus identify address cause responder difehellman exponential generation well secret key computation reception third message protocol initiator could fth message protocol including large number bogus certicates responder blindly veries signatures jfk mitigates effects attack reusing exponential across different sessions second phase ike protocol commonly called quick mode results ipsec sas established two negotiating parties threemessage exchange parameters ip security protocol use espah security algo rithms type trafc protected etc negotiated stage since two parties authenticated established shared key phase quick mode messages encrypted authenticated using information possible derive ipsec sa keying material shared key established phase difehellman ex change extent multiple ipsec sas two hosts needed twophase approach results faster lightweight negotiations since authentication information keying material reused unfortunately two hosts typically establish sas protecting trafc limiting benets twophase protocol lightweight rekeying pfs desired benet diluted another problem twophase nature ike manifests ipsec used negrained access control network services mode credentials exchanged ike protocol used authorize users connecting specic ser vices complete phase ii exchange done connection generally trafc class pro initiator responder initiator cookie proposed phase1 sa responder cookie accepted phase1 sa initiator diffiehellman value nonce responder diffiehellman value nonce initiator signature certs identity responder signature certs identity figure 3 ike main mode exchange certicates tected since credentials public key certicates exchanged phase ike protects identities initiator responder eavesdroppers5 identities include public keys certicates information would allow eavesdropper determine principals trying communicate identities independent ip addresses ike daemons negotiating eg temporary addresses acquired via dhcp public workstations smartcard dongles etc however since initiator identity rst message 5 main mode attacker pose responder point protocol attackers cannot complete protocol since possess responders private key determine initia tors identity attack possible responder since verify identity initiator revealing identity message 6 main mode however since responders would correspond servers rewalls web servers etc identity protection provided seems useful protecting initiators identity6 fixing protocol provide identity protection initiator would involve reducing 5 messages responder send contents message 6 message 4 positive sideeffect reducing number messages breaking message symmetry protocol modularity finally thanks desire support multiple authentication mechanisms different modes operation aggressive vs main mode phase ii distinction protocol specication implementations tend bulky fairly complicated undesirable properties critical component ipsec architecture several works including 12 26 25 point many decien cies ike protocol specication common implemen 5identity protection provided main mode also known protection mode aggressive mode provide identity protection initiator 6one case protecting responders identity useful peertopeer scenarios initiator responder initiator cookie proposed phase 1 sa diffiehell value responder cookie accepted phaisde1nstiaty responder diffiehell anavnadluceertificates responder signature initiator signature certificates figure 4 ike aggressive mode exchange certicates tations suggest removing several features protocol eg aggressive mode public key encryption mode etc restore idea stateless cookies protect initiators instead responders identity active attacker also suggest features oneway authentication similar common practice using ssltls10 web major modications would bring ike protocol closer jfk although would completely address dos issues measure complexity ike found analyses done 34 36 less 13 different subprotocols iden tied ike making understanding implementation analysis ike challenging analysis reveal attacks would compromise security protocol identify various potential attacks dos otherwise possible valid interpretations specication implementation decisions work done towards addressing least ex amining dos problems found ike31 32 gener ally public key authentication protocols30 21 various recommendations protocol design include use client puzzles23 3 stateless cookies39 forcing clients store server state rearranging order computations protocol18 use formal method framework analyzing properties protocols respect dos attacks35 advantages state less least beginning protocol run recognized security protocol context 22 2 latter presented 3message version ike similar jfk provide level dos protection jfk identity protection 52 ikev2 ikev216 another proposal replacing original ike protocol cryptographic core protocol shown figure 5 similar jfkr main differences ikev2 jfkr ikev2 implements dos protection optionally allowing responder respond message 1 cookie sender include new message 1 normal conditions exchange would consist 4 messages shown however responder detects dos attack start requiring extra roundtrip one claimed benet extra roundtrip ability avoid memorybased initiator responder initiator kcoeoykinieg aterial phase sa aterial phase 1 sa responder keying responder cookie initiator authentication phase ii sa traffic selaencdtocresrtiidfiecnatietiess responder authentication andracfefrictifsicealetectsors accepted phase ii sa figure 5 ikev2 protocol exchange dos attacks fragmentationreassembly part networking stack briey idea behind attack attacker send many incomplete fragments reassembly queue responder denying service legitimate initiators ikev2 large messages last two exchange possible implementation instruct operating system place fragments received peers completed roundtrip separate reserved reassembly queue ikev2 supports phase ii exchange similar phase iphase ii separation original ike protocol supports creating subsequent ipsec sas single roundtrip well sateardown using phase ii ikev2 proposals contain multiple options combined arbitrary ways jfk contrast takes approach using ciphersuites similar ssltls protocols10 ikev2 supports legacy authentication mechanisms par ticular preshared keys jfk design support authentication mechanisms discussed section 3 easy variant jfkr without loss security feel added value compared incurred complexity justify inclusion feature jfk apart main differences number super cial ones eg wire format matter taste difference protocol design philosophy authors two proposals helped create joint draft19 submitted ietf ipsec working group draft set design options reecting differences two protocols presented working group concurrent writing paper based draft unied proposal written unied proposal combines properties jfk ikev2 adopts approach setting security association within two round trips providing dos protection responder particular allowing responder almost completely stateless sending message 2 receipt message 53 protocols predecessor ike photuris24 rst introduced concept cookies counter blind denial service attacks protocol 6message variation station station protocol similar ike message layout purpose except sa information moved third mes sage rekeying twomessage exchange used request unidirectional spi thus completely rekey 4 messages needed photuris vulnerable computationbased dos attack ike mentioned nonetheless one variants protocol 4 messages provided dos protection via stateless cookies skeme27 shares many requirements jfk many aspects design adopted ike serves set protocol building blocks rather specic protocol instance depending specic requirements key management protocol blocks could combined several ways interesting aspect skeme avoidance digital signatures public key encryption used instead provide authentication surances reason behind allow parties protocol able repudiate exchange skip5 early proposal ipsec key management mechanism uses longterm difehellman public keys derive longterm shared keys parties used distribute session keys two parties distribution session occurs inband ie session key encrypted longterm key injected encrypted packet header scheme good synchronization properties terms keying base version lacks provision pfs later provided via extension 4 however authors admit extension detracts original properties skip identity protection provided since certicates used verify difehellman public keys design publicly available sourcedestination master identities contained packet receiver retrieve senders difehellman certicate latter used mount dos attack receiver forcing retrieve verify dife hellman certicate compute difehellman shared secret host uses cryptographic public keys host identiers introduces set protocols establishing sas use ipsec hip protocol fourpacket exchange uses client puzzles limit number sessions attacker initiate hip also allows reuse dife hellman value period time handle high rate ses sions rekeying hip packet protected existing ipsec session used hip provide identity protection depends existence outofband mechanism distributing certicates extra hip messages exchanging information thus message count effectively 6 even 8 common usage scenarios 6 conclusion years many different key exchange protocols proposed security aws others met certain requirements jfk addresses rst issue simplicity proof correctness full details deferred analysis paper submit proof techniques advanced enough new protocols deployed without anal ysis also note details jfk protocol changed order accommodate proof tossing protocol wall theoreticians recipe success even proof correctness substitute simplicity design apart chance errors formal analysis complex protocol implies complex implementation attendant issues buggy code interoperability problems requirements issue less tractable possible foresee threat models operational needs change time thus sts suitable environment denial service attacks concern another comparativelyrecent requirement identity protection precise need whose identity protected threat model still unclear hence need jfki jfkr finally perhaps important show attributes often touted necessities fact susceptible costbenet analysis everyone understands cryptographic primitives arbitrarily strong cost considerations often used deciding algorithms key lengths block sizes etc show dosresistance perfect forward secrecy similar character istics possible improve aspects protocol notably number round trips required treating others parameters system rather absolutes 7 acknowledgements ran atkinson matt crawford paul hoffman eric rescorla provided useful comments discussions hugo krawczyk proved useful dan harkins suggested inclusion ipi authenticator david wagner made useful suggestions format message 2 jfki design jfkr protocol inuenced sigma ikev2 protocols 8 r tls protocol version 10 cryptographic evaluation securely available credentials credential server framework internet key exchange ike proposal ikev2 protocol attack class address spoo enhancing resistance features proposed successors ike proofs work bread pudding protocols scalability client puzzles cryptographic countermeasure connection depletion attacks analysis ike skeme versatile secure key exchange mechanism internet ikesigma protocol httpwww comments 2104 towards network denial service resistant protocols international information security conference ifipsec resolution isakmpoakley modied aggressive mode internet security association key management protocol analysis internet key exchange protocol using nrl protocol analyzer ieee symposium security privacy formal framework evaluation method network denial service computer security foundations workshop open issues formal methods cryptographic protocol analysis information survivability conference exposition kerberos authentication authorization system host protecting key exchange management protocols resource clogging attacks ifip tc6 tc11 joint working conference communications multimedia security cms analysis denial service attack tcp ieee security privacy conference ikeisakmp considered harmful tr authentication authenticated key exchanges entity authentication key distribution stateless connections enhancing resistence provably secure key agreement protocol denialofservice attack security analysis ikes signaturebased keyexchange protocol analysis keyexchange protocols use building secure channels towards network denial service resistant protocols dosresistant authentication client puzzles protecting key exchange management protocols resource clogging attacks proofs work bread pudding protocols formal framework evaluation method network denial service scalability flexibility authentication services analysis denial service attack tcp ctr steven bellovin matt blaze ran canetti john ioannidis angelos keromytis omer reingold fast keying key agreement hostile internet acm transactions information system security tissec v7 n2 p242273 may 2004 suratose tritilanunt colin boyd ernest foo juan manuel gonzlez nieto costbased timebased analysis dosresistance hip proceedings thirtieth australasian conference computer science p191200 january 30february 02 2007 ballarat victoria australia kui ren wenjing lou kai zeng feng bao jianying zhou robert h deng routing optimization security mobile ipv6 computer networks international journal computer telecommunications networking v50 n13 p24012419 15 september 2006 theodore diament homin k lee angelos keromytis moti yung dual receiver cryptosystem applications proceedings 11th acm conference computer communications security october 2529 2004 washington dc usa changhua john c mitchell analysis 80211i 4way handshake proceedings 2004 acm workshop wireless security october 0101 2004 philadelphia pa usa kanonymous secret handshakes reusable credentials proceedings 11th acm conference computer communications security october 2529 2004 washington dc usa zhiguo wan robert h deng feng bao akkihebbal l ananda access control protocols twolayer architecture wireless networks computer networks international journal computer telecommunications networking v51 n3 p655670 february 2007 martn abadi bruno blanchet cdric fournet fast keying pi calculus acm transactions information system security tissec v10 n3 p9es july 2007 heng yin haining wang building applicationaware ipsec policy system proceedings 14th conference usenix security symposium p2121 july 31august 05 2005 baltimore md martn abadi cdric fournet private authentication theoretical computer science v322 n3 p427476 6 september 2004 martn abadi bruno blanchet analyzing security protocols secrecy types logic programs journal acm jacm v52 n1 p102146 january 2005 angelos keromytis janak parekh philip n gross gail kaiser vishal misra jason nieh dan rubenstein sal stolfo holistic approach service survivability proceedings acm workshop survivable selfregenerative systems association 10th acm conference computer communications security p1122 october 3131 2003 fairfax va heng yin haining wang building applicationaware ipsec policy system ieeeacm transactions networking ton v15 n6 p15021513 december 2007 robert c chalmers kevin c almeroth security architecture mobilityrelated services wireless personal communications international journal v29 n34 p247261 june 2004