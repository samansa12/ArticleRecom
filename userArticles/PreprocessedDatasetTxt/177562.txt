piecewiselinear interpolation polygonal slices paper present new technique piecewiselinear surface reconstruction series parallel polygonal crosssections important problem medical imaging surface reconstruction topographic data applications reduce problem previous works series problems piecewiselinear interpolation pair successive slices algorithm uses partial curve matching technique matching parts contours optimal triangulation 3d polygons resolving unmatched parts minimum spanning tree heuristic interpolating non simply connected regions unlike previous attempts solving problem algorithm seems handle successfully kind data allows multiple contours slice hierarchy contour nesting avoids introduction counterintuitive bridges contours proposed earlier papers handle interpolation multiply connected regions experimental results various complex examples involving actual medical imaging data presented show good robust performance algorithm b introduction problem reconstructing boundary solid object series parallel planar crosssections attracted much attention literature past two decades main motivation problem comes medical imaging applications crosssections human organs bones tumors tissues obtained ct computerized tomog raphy mri magnetic resonance imaging appa work paper authors supported grant gif germanisraeli foundation scientific research development work paper second author also supported national science foundation grant ccr9122103 grants usisraeli binational science foundation israel science fund administered israeli academy sciences school mathematical sciences telaviv university telaviv 69978 israel algotec systems ltd raanana israel z school mathematical sciences telaviv university telaviv 69978 israel courant institute mathematical sci ences new york university new york ny 10012 usa rata crosssections hereafter called slices basis interpolating boundary surface organ interpolated object displayed graphics applications recently even manufactured nc numerically controlled rp rapid prototyping machine another motivation problem nondestructive digitization ob jects object scanned echographic xray apparatus obtained slices used reconstruction original object yet another motivation reconstruction 3dimensional model terrain topographic elevation contours many solutions suggested pure raster terpolation usually handle two raster images pixel either white black assigned greylevel taken fixed range interpolation produces one intermediate raster images smoothly locally turn first image second one bounding surface detected using methods edge detection techniques identifying places transition inside outside object grey level case methods include thresholding mechanism decides levels inside object cline et al 6 attempted convert directly voxel data polyhedral surface suggesting marching cubes technique produced small triangles whose size roughly input voxels many solutions including approach taken paper assume interpolation preceded edgedetection process invoked slices thus slice assumed represented hierarchy noncrossing contours closed simple jordan curve represent boundaries material nonmaterial ar eas general depth breadth hierarchy restricted contour may enclose number contours may enclose contours practice contour given discrete circular sequence points along thus regard simple closed polygonal curve whose vertices given points finally may also assume exterior unbounded region planar slice represents nonmaterial model assumed bounded thus problem face given series parallel planar slices assume parallel xyplane consisting collection noncrossing possibly nested closed simple polygonal curves properties want reconstruct polyhedral solid model whose cross sections along given planes coincide input slices natural simplification problem also taken earlier works consider single pair successive parallel slices construct solid model within layer delimited planes slices interpolates given slices union rather concatenation models give us solution model full problem continuing remark solution uniquely defined measure goodness figure 1 contour association tiling proposed solution rather subjective intu itive course two slices consists single contour contours roughly sit expect solution single drumlike polytope whose boundary consists circular sequence triangles wrapping around two contours see figure 1a however even simple case one contour slice xyprojections two contours far away clear better solution construct highly slanted pipe connects contours figure 1b regard lower contour top cover pillarlike solid upper contour bottom cover another pillarlike solid figure 1c choice solution become much arbitrary involved cases first briefly review fairly extensive literature problem earlier works studied variant slice contains one con tour sequel denote onetoone case opposed onetomany manytomany cases studies either sought global optimization objective function settled local tiling advancing rule tiling starting points two contours somehow determined eg closest pair vertices contours full version review works de tail since inferior solution cannot handle arbitrary data omit review works keppel 19 fuchs et al 9 sloan painter 28 cook et al 7 christiansen sederberg 5 shantz 25 batnitzky et al 2 sloan hrechanyk 26 ganapathy dennehy 10 wang aggarwal 29 good survey works cited far given sloan painter 27 decompose method building blocks compared various methods accordingly also describe testbed evaluating comparing techniques zyda jones hogan 32 made attempt handle manytomany case method could handle branching cases produced unsatisfactory results partially overlapping contours figure 4 limitations involved specific geometries however suggested solutions limitations might help certain cases required interaction user boissonnat 3 presented totally different approach constructed delaunay triangulation slice projected one triangulation onto obtained collection tetrahedra aiming maximize sum volumes considerable step towards handling case slice multiple contours boissonnat mentioned three typical examples standard method failed produce good sults thus requiring special treatment first example contained two overlapping contours considerable differences geometry second example consisted two similar contours one also contained hole polygon last example showed branching problem without contour overlaps algorithm handles successfully eas ily bad examples boissonnat suggested correction scheme either changed geometry one slices constructed one two intermediate slices original ones idea developed boissonnat geiger 4 11 recent works also attempted handle general cases kehtarnavaz de figueiredo 17 kehtarnavaz simar de figueiredo 18 ekoule peyrin odet 8 meyers skinner sloan 22 welzl wolfers 30 however treatments suffered variety problems treated certain restricted cases worked favorable situations two slices closely resemble finally gitlin orourke subramanian 12 prove always possible find interpolating polyhedron two polygons lie two parallel planes attempted interpolation produces selfintersecting surface result holds interpolating triangles assumed connect two polygons vertices ie two vertices taken one polygon third polygon assume approach indeed get nonintersecting interpolation apply algorithm example two comprehensive reviews many works reconstructing 3d objects crosssections given schumaker 23 hagen muller nielson 14 first review restricted piecewiselinear constructions based polygonal slices also refers parametric tensor representations contours describes volumetric surface approaches propose new approach interpolation prob lem algorithm handles well slices multiple contours rely resemblance slices accept slices contain number contours arbitrarily different geometries xyprojections contours different slices may arbitrarily overlap make distinction treatment contours fully overlap partially overlap overlap many previous works 19 9 26 10 either prohibit creation triangles slice specifically define steps action allowed make distinction triangles connect two slices totally lie within single slice generally speaking algorithm based analysis resemblance two slices thus separately treat similar contour portions matched two slices treat remaining portions match refrain creating artificial bridges contours might conflict geometry slice already noted 25 others case construct bridges guaranteed conflict geometry slice ie intersect projection contour introduce intermediate slices recap algorithm appears overcome technical difficulties hampered performance previous solutions treats data full generality extensive experimentation conducted indicates performs well complicated largesize data figure 2 matching contour portions regard algorithm significant step solution problem illustration performance algorithm reallife examples see figures 17 18 brief overview algorithm first match similar contour portions two slices eg upper arcs pq p 0 q 0 figure 2 stitch tile pair matched contour portions sequence adjacent triangles forming band portions care take union original contours new bands cancel duplicate edges obtain collection closed spatial polygonal curves may composed pieces contours slices edges connecting triangles moreover matching procedure essentially guarantees xyprojections curves pairwise disjoint although may nested within nesting occurs simply triangulate spatial polygons using simple dynamic programming approach roughly aims minimize total area triangula tion nesting occurs take one polygon p polygons whose xyprojections directly nested within p apply minimum spanning tree procedure introduces edges connecting polygons yielding xyprojection simply connected proceed triangulate resulting polygonal curve see figure 3 illustration details steps given later paper purpose identifying matching portions contours use partial curve matching technique first suggested kalvin et al 16 schwartz sharir 24 technique uses socalled geometric hashing method originally solved following curve matching problem given two curves plane one slight deformation proper subcurve find translation rotation subcurve yields best leastsquares fit appropriate portion longer curve technique extended used computer vision automatic identification partially obscured objects two three dimensions important problem robotics applications computer vision attracted much attention see hong wolfson 15 wolfson 31 kishon hastie wolfson 20 simplified variant technique recently used barequet sharir 1 totally different problem detecting repairing gaps boundary polyhedron problem often arises creation polyhedral approximations cad models variant used 1 well one used paper motion one curve relative allowed technique becomes considerably simpler paper organized follows section 2 give precise definition problem present overview algorithm detailed one given later sections describe detail certain phases algorithm section 3 describes matching contour portions section 4 describes actual surface reconstruction section 5 briefly analyze complexity algorithm present experimental results end section 6 concluding remarks 2 overview algorithm input algorithm described intro duction pair parallel planar slices parallel xyplane slice consisting list closed simple polygonal contours intersect containment hierarchy contours may omitted case compute using simple linesweep technique contours even nesting level starting 0 labels external contours interior sufficiently small neighborhood contour material contours odd level whose interior sufficiently near nonmaterial orient contour viewing contour material lies right contour thus evenlevel contours oriented clockwise direction viewed oddlevel contours oriented counterclockwise direction necessary reorient contours consistent directions remark need compute contour hierarchy obtain consistent orientation contours hierarchy used algorithm proposed algorithm consists following steps 1 data acquisition orient contours slice consistent directions explained input include information compute contour nesting hierarchy slice use obtain desired orientations 2 matching contour portions discretize contour polygon cyclic sequence vertices arc length pair consecutive vertices equal small given parameter b vote contour matches pair distinct vertices discretized contours one slice whose mutual horizontal distance threshold pa rameter contributes one vote vote match two contours appropriate shift maps one vertices c transform resulting votes collection candidates partial contour matches 3 reconstructing surface stitch together pair contour portions matched step adding triangles connect portions new triangles oriented consistently contours b combine remaining contour edges spatial cycles denoted clefts obtained taking union contour edges slices edges stitching triangles canceling duplicate oppositelyoriented edges projected onto xy plane cycles intersect find nesting hierarchy cleft c construct necessary system straight bridges connect c holes immediate children hi erarchy turn single cycle replaces cleft c c triangulate resulting 3d clefts using 3d min figure 3 different steps algorithm imum area triangulation technique various steps algorithm illustrated figure 3 figure 3a shows pair slices branching situation lower slice contains one contour de noted 1 upper slice contains three contours denoted 2 figure 3b shows tiling three matches found two slices figure 3c shows remaining clefts form shallow hierarchy nested polygons figure 3d shows clefts hole elimination step minimumarea triangulations shown figure 3e final surface reconstruction shown figure 3f matching contour portions lack space omit detailed description data acquisition step already briefly described anyway fairly straightforward 31 contour discretization contour polygon refined discretized cyclic sequence points done choosing sufficiently small arc length parameter generating equallyspaced points distance apart along polygon boundary need choose much smaller length original edge contour b minimum straight distance pair contour points lie different contours slice lie contour distance along contour sufficiently large 32 voting contour matches first try match pairs portions contours portion pair belongs different slice matches aim detect regions similarity boundaries interpolating object along two slices naturally contour portions similar two slices must similar sequences footprints thus next goal search pairs sufficiently long subsequences closely match approach two subsequences said closely match chosen parameter 0 number indices k kp sufficiently close norm k delta k euclidean distance xyprojections points perform following voting process votes given good pointtopoint matches contours given cyclic ordered sequences vertices break arbitrarily make linear sequence vertices lower slice preprocessed rangesearching vertex v upper slice efficiently locate vertices lower slice lie neighborhood xyprojections v used simple heuristic projection method range searching reduces search pair 1dimensional searches may inefficient worst case works well practice positions along contour sequence c whose length c numbered 0 c gamma 1 assume querying vertex v position contour sequence c 1 vertex retrieved query position j contour sequence c 2 contributes vote match contours c 1 c 2 shift equal j gamma mod c2 obviously matches long portions contours reflected large number votes appropriate shift matching contours thus collect shifts large number votes identify roughly starting ending points corresponding match possibly also remove small portions matches near endpoints also shared matches note procedure match contour portions consistently oriented important since guarantees material region lies side two contours thus implying stitch gap two contours get proper portion boundary possible interpolating solid also note parameter rangesearching queries function input rather priori estimation physical size difference similar contour portions two slices cases small portions contours included one candidate match usually happens connection two different matches involving contour one slice different contours simply eliminate portions common one significant candidate match 33 accepting match candidates match given score score may also reflect addition number votes appropriate shift quality measures closeness vertices two matching contour portions setting scoring function described section 5 crucial property matches achieve tuning parameters control detection matches every intersection xyprojections pair contours one slice lead match corresponding figure 4 intersecting contours long matching portions contours although might short ensure least one match pair overlapping contours namely contours intersecting xyprojections even relative amount overlap small reason given shortly achieve accepting short match candidates even length 2 3 long quality fits bounds make sure discretization parameter sufficiently small respect voting threshold respect smallest contour feature size described order miss contour intersections extreme example shown figure 4 four short matches indeed found two contours 4 reconstructing surface 41 stitching matches match consists two directed polygonal chains whose xyprojections close arbitrarily choose one end match merge two chains sorted lists numbers step merge pointers current vertices u v two chains make decision chain advanced say v advances new vertex w add new triangle 4uvw boundary constructed polyhedron advance current vertex v w along appropriate chain reach last vertex one chain may advance one process terminates reach last vertices chains triangles create oriented consistently contours achieve invert orientation contour polygons one slice say lower one orient triangle edge shares contour oriented oppositely contour see figure 5 illustration directions tiling triangles orientation guarantees reconstructed solid boundary oriented consistent manner several advancing rules examined following simplest one proved best assume current vertices two chains v 1 j followed v 1 jv 1 j1 j advance first chain otherwise advance second chain 1 bears close resemblance merging advance newly added triangle smaller perimeter actually program efficiency eventually used squares distances equally good results figure 5 tiling match figure match clefts near intersection contours two sorted lists turns produce reasonably looking triangulated boundary patches matched contour portions figure 5 shows tri angulation alternative advancing rules described christiansen sederberg 5 ganapathy dennehy 10 42 filling clefts tiling matching contour portions remain unmatched portions combined extreme edges tiling sequences form collection closed 3d polygons refer clefts finding clefts straightforward first recall already inverted orientation contour polygons lower slice consider contour polygons two slices inverted lower slice upper slice well tiling triangles formal sum directed edges add polygons convention e cancellations resulting sum consists desired clefts since polygon participates formal sum directed cycle resulting sum easily seen represent collection pairwise edgedisjoint directed cycles collection 3d polygonal cleft cycles property projected onto xyplane two cycles intersect already detected projected contour intersections matching phase extreme tiling edges triangulation match likely degenerate almost degenerate projection situation illustrated figure 6 way property violated extreme tiling edge crosses another edge contour happen either extreme edge must highly slanted contour must sharp turns avoided appropriate fine tuning discretization matching threshold parameters case face situation comprehensive experiments involved fairly complex rather adversary data recap rare worstcase figure 7 orientations scenarios projected cleft cycles might intersect assume follows occur xyprojections cleft polygons might form hierarchy polygon nesting check possibility invoking linesweeping procedure used data acquisition step time polygons guaranteed correctly oriented figure 7 illustrates situation figure 7a shows branching case lower slice contains one con tour upper slice contains two contours tiling detected match inverting lower slice canceling opposite edge occurrences two nested cleft cycles remain already oriented consistently shown figure 7b let c cleft whose immediate children hierarchy define undirected weighted complete graph g vertex g one cycles weight edge connecting two cycles minimum distance xyprojections cycles assume contour discretization dense enough minimum vertextovertex distance actually computed serves sufficiently good approximation actual minimum distance compute minimum spanning tree g form bridge pair cycles connected edge bridge straight segment connecting two nearest vertices cycles easily verified xyprojections bridges cross also cross xyprojection cycle create two oppositelyoriented copies bridge add given cycles eliminates replaces whole configuration single composite selftouching otherwise simple polygonal cycle emphasize bridge assembly significant obstacle previous works used tool reducing branching situation simple one toone case bridge one slice could conflict geometry slice projection intersect contour shown figure 8b noted face problem note procedure required complicated cases presented section 5 practical instances clefts tend nested case hole elimination step left collection closed polygonal cleft cy cles property xyprojections enclose pairwisedisjoint regions next goal triangulate cleft cycle since many triangulations possible seek triangulation minimizes total area triangles precisely want solve following problem given 3dimensional closed polygonal curve p objective function f defined triangles called weight sequel find triangulation p ie figure 8 bridges simple branching cases collection triangles spanned vertices p edge p incident exactly one triangle triangle edges incident two triangles minimizes total sum f triangles purpose closely follow dynamic programming technique klincsek 21 finding polygon triangulation plane minimizes total sum edge lengths let given polygon let w ij 0 denote weight best triangulation polygonal curve v apply straightforward dynamic programming approach initializes w ii2 fv computes w k omit easy details actual value fu v w used weighted average several terms significant one area triangle see section 5 details finally interpolation involves uppermost lowermost slice given sequence also add reconstructed object boundary regions material slice close volume object 5 experimental results implemented whole algorithm digital decstation 5000240 sun sparcstation ii c experimented algorithm several data files obtained ct mri scan ners obtained good results practically cases input usually consisted fifty one hundred crosssections 05 mm 20 mm apart tuning parameters discretization length size neighborhood geometric hash ing robust large variation parameters produced nearly identical results usually used 10 mm discretization parameter 30 mm voting threshold human organs whose global size 5 20 cm di mensions allowed two successive point mismatches along match pointtopoint match contributed amount 1d 01 match score xy distance two points considered match candidates received 4 votes whose scores 150 discretization sufficiently dense choice still captured contour overlaps objective function f clefttriangulation taken figure 9 synthetic example figure 10 synthetic branching example 085a area triangle p perimeter r ratio largest smallest three edges parameters user defined modifying achieve better results measure complexity algorithm terms four variables k total number input points along contour edges two consecutive slices n total number points arc length discretization step number clefts h size biggest cleft holeelimination step usually k considerably smaller n number clefts could worst case large thetak 2 practice smaller least comparable number contours c typically much smaller k due lack space give formal analysis complexity algorithm analysis produces terms may large example cleft triangulation step based dynamic programming takes oh 3 time oretically complex situations also pragmatically expensive portion algorithm entire algorithm runs practical instances average specific examples performance algorithm figure 9 shows simple case similar first problematic example boissonnat 3 slice example contains exactly one contour tiled match appears white whereas triangulated cleft appears black figure shows synthetic branching example lower slice contains two contours whereas upper slice contains one contour two long matches found tiled white trian gles remaining cleft appears two matches triangulation appears black figure 11 shows complicated synthetic exam ple lower slice contains one contour upper slice contains three contours figure 11a shows top view situation whereas figure 11b shows isometric view figure 11c shows surface reconstruction tiling single match appears white remaining cleft consists one cycle encloses two cycles two bridge constructions compose three polygons single one b reconstruction c reconstruction figure 11 synthetic complicated example reconstruction b reconstruction figure 12 simple case triangulation appears black next several figures show typical performance algorithm observed execution series crosssections human jaw bone figure 12 shows reconstructed surface two slices tiles matches appear white triangulations two remaining clefts appear black figure 13 shows two slices branching region match tiles appear white whereas cleft triangulations appear black figure 14 presents consider reconstruction b reconstruction figure 13 simple branching case reconstruction b reconstruction figure 14 complicated branching case reconstruction b reconstruction figure 15 multiple branching case reconstruction b reconstruction figure case ably complicated situation reconstruction turns intuitively correct figure 14a shows lower slice contains contour two hole contours upper slice contains one contour mostly lies material region lower slice surface reconstruction shown figure 14b three match tiles appear white cleft triangulations appear black reader may verify two nonmaterial pillars represented two hole contours lower slice connected unbounded nonmaterial region upper slice similar complex examples given figures 15 16 reconstruction whole jaw bone whose figure 17 fully reconstructed human jaw bone b c figure put consisted 96 slices shown figure 17 result valid polyhedral description contained 60000 triangles reconstructed jaw contained 209 3d cavities fully enclosed outer 3d reconstructed boundary experimentations mostly performed medical imaging data however mentioned introduction reconstruction problem applications well one application reconstruction terrain elevation contour data topographic maps application much simpler xymonotonicity terrains exam ple contours cannot overlap case although nested figure 18 shows reconstruction terrain zikhronyaakov area israel figures show elevation contours top view isometric view data contained seventeen levels 10 meters apart starting 20 ending meters see level levels consisted model synthetic jaw bone slices 2 96 layers 1 95 contours total 30 4170 per slice 15 43 vertices total 1430 176460 per contour 477 423 matches total 20 3300 per layer 20 35 clefts total 10 2750 per layer 10 29 time seconds stitching 007 1250 triangulation 013 3712 total per layer 020 052 table 1 performance algorithm contours made 5329 edges figures 18cd show full reconstruction terrain top view isometric view finally measured performance implementation two examples described time measurements taken digital decstation 5000240 table 1 summarizes performance algorithm simple branching case shown figure 10 whole jaw bone shown figure 17 note data jaw bone accumulated 95 layer reconstructions therefore data averaged per layer note medical data least data experimented successive slices tend differ lot geometries therefore many clefts created relatively timeconsuming triangulations affect total running time algorithm 6 conclusion proposed paper algorithm solving practical problem polyhedral interpolation parallel polygonal slices problem many medical geographic applications also appears fairly basic interesting problem computer graphics solid modeling method produces relatively smooth boundary due contour discretization situations addition new vertices desired eg due data explosion system uses discretization matching step tiling following minimumarea triangulation performed contours containing original points feel technique reconstructed boundary various organs intuitively appealing manner one might say algorithm demonstrated understanding underlying problem results adequate even extreme cases tiling two seemingly totally different slices plan continue experimentation al gorithm test performance limits see data instances algorithm might perform well thus requiring calibrations enhancements view experimentation far doubt anything really problematic arise acknowledgment wish thank haim wolfson helpful discussions concerning geometric hashing technique emo welzl barbara wolfers helpful discussions concerning solid reconstruction problem providing us data files comprehensive bibliography problem jeandaniel boissonnat bernhard geiger supplying us data files r filling gaps boundary polyhedron shape reconstruction planar cross sec tions three dimensional reconstruction complex shapes based delaunay triangula tion conversion complex contour line definitions polygonal element mo saics two algorithms threedimensional reconstruction tomograms triangulation algorithm arbitrary shaped multiple planar contours optimal surface reconstruction planar contours new general triangulation method planar contours construction et utilisation des modeles dorganes en vue de lassistance au diagnostic et aux interventions chirur reconstructing polyhedra parallel slices primitives manipulation general subdivisions computation voronoi diagrams improved modelbased matching method using footprints boundary matching using footprints framework surface reconstruction 3d contours syntacticsemantic technique surface reconstruction crosssectional contours approximating complex surfaces triangulation contour lines minimal triangulations polygonal mains surfaces con tours correspondence branching problems reconstructing 3d objects cross sections partially obscured objects two three dimensions matching noisy characteristic curves surface definition branching contourdefined objects surface reconstruction sparse data contours surfaces testbed initial results pessimal guesses may opti mal counterintuitive search result surface reconstructionand representation 3d scenes surface reconstruction simple polygons via angle criteria ieee transactions pattern analysis machine intelligence surface construction planar contours tr surface reconstruction representation 3d scenes contours surfaces testbed initial results twodimensional modelbased boundary matching using footprints partially obscured objects two three dimensions matching noisy characteristic syntacticsemantic technique surface reconstruction crosssectional contours framework surface reconstruction 3d contours shape reconstruction planar cross sections pessimal guesses may optimal curve matching triangulation algorithm arbitrary shaped multiple planar contours primitives manipulation general subdivisions computation voronoi optimal surface reconstruction planar contours surface reconstruction simple polygons via angle criteria ctr takeo igarashi satoshi matsuoka hidehiko tanaka teddy sketching interface 3d freeform design proceedings 26th annual conference computer graphics interactive techniques p409416 july 1999 matthew dickerson scott mcelfresh mark montague new algorithms empirical findings minimum weight triangulation heuristics extended abstract proceedings eleventh annual symposium computational geometry p238247 june 0507 1995 vancouver british columbia canada takeo igarashi satoshi matsuoka hidehiko tanaka teddy sketching interface 3d freeform design acm siggraph 2006 courses july 30august 03 2006 boston massachusetts gill barequet daniel shapiro ayellet tal history consideration reconstructing polyhedral surfaces parallel slices proceedings 7th conference visualization 96 p149ff october 2829 1996 san francisco california united states daniel cohenor amira solomovic david levin threedimensional distance field metamorphosis acm transactions graphics tog v17 n2 p116141 april 1998 james fix richard e ladner multiresolution banded refinement accelerate surface reconstruction polygons proceedings fourteenth annual symposium computational geometry p240248 june 0710 1998 minneapolis minnesota united states f hurtado noy j urrutia flipping edges triangulations proceedings twelfth annual symposium computational geometry p214223 may 2426 1996 philadelphia pennsylvania united states nina amenta marshall bern surface reconstruction voronoi filtering proceedings fourteenth annual symposium computational geometry p3948 june 0710 1998 minneapolis minnesota united states