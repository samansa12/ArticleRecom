exact selection minimally unsatisfiable subformulae minimally unsatisfiable subformula mus subset clauses given cnf formula unsatisfiable becomes satisfiable soon clauses removed selection mus great relevance many practical applications expecially holds propositional formula encoding application required welldefined satisfiability property either satisfiable unsatisfiable selection mus hard problem general show classes formulae problem solved efficiently done using variant farkas lemma solving linear programming problem successful results realworld contradiction detection problems presented b satisability problem sat consists determining whether exists truth assignment truefalse variables f evaluates true extensive references found chandru hooker 1999 gu et al 1997 kleine buning lettman 1999 truemper 1998 generally instance f encodes system structure one must design f welldened solution property either satisable unsatisable f unsatisable satisable would like modify underlying system order make f satisable conversely f unsatisable underlying system needs redesigned would like keep f unsatisable rst problem sometimes c kluwer academic publishers printed netherlands approached solving maximum satisability problem maxsat see eg battiti protasi 1998 consists nding truth assignment variables maximizing number clauses cj evaluates true far satisability restored removing underlying system elements corresponding clauses could satised however approach desirable many practical cases often fact cannot delete part system need functionalities contained part instead would like locate understand problem basing information redesign small part system causing problem second problem typically would like know part underlying system changed one modied possibly removed problems approached looking minimally unsatisable subset clauses mus within unsatisable f see sect 2 algorithm selecting approximation mus proposed bruni 2002 problem deciding whether cnf formula contains minimally unsatisable mu subformula xed deciency proved npcomplete kleine buning zhao 2002 related works eld propositional formulae decomposition cnf maximal deciency k k constant union mus intersection maximally satisable subformulae polynomial time kullmann 2000 recognition mu formulae xed deciency polynomial time fleischner et al 2002 problem selection irreducible infeasible subsystem iis analogous mus case systems linear inequalities studied regard infeasibility analysis amaldi et al 1999 chinneck 2001 tamiz et al 1996 case systems linear inequalities real variables problem approached means heuristics chinneck 2001 exact algorithms gleeson ryan 1990 case systems linear inequalities integer variables computationally demanding problem approached means additive subtractive heuristics guieu chinneck 1999 procedure exact selection mus presented sect 4 based farkas lemma sect 3 adapted linear binary case selection mus hard problem general show sect 5 classes formulae done eciently solving linear programming problem depends structure polytope dened linear relaxation sat compendium studies structure instance chandru hooker 1999 procedure applied realworld data mining exacttex 1042003 1440 p exact selection minimally unsatisable subformulae 3 problems sect 6 logical rules encoded clauses bruni sassano 2001 contradiction set rules corresponds set clauses jointly unsatisable checking rules inconsistencies produces series mus selection problems conicting rules located would help deleting 2 minimally unsatisable subformulae denition 1 minimally unsatisable subformula mus cnf formula f set clauses following properties mfin sense clausesubset ie cj cj f mis unsatisable every proper clausesubset satisable clearly f contains mus f unsatisable therefore problem deciding whether formula f contains mus co npcomplete since sat wellknown npcomplete mus may proper subformula f coincide f sometimes litera ture adverb minimally replaced meaning adjective minimal denition 2 given cnf formula fthemus selection problem consists nding minimally unsatisable subformula mfor proving subformula exist general case one mus contained f overlap sense share clauses cannot fully contained one another formally collection mus f clutter relations structures maxsat solution mus investigated bruni 2002 note mus selection problem dierent although closely related minimal unsatisable subformula problem deciding whether cnf formula contains subformula muk see kleine buning zhao 2002 besides empirical experience suggests nding mus typically requires much time solving sat problem like nding iis requires much time solving feasibility system linear inequalities guieu chinneck 1999 problems depicted sect 1 correspond problem selecting mus follows case want restore satisability exacttex 1042003 1440 p locating small part underlying system causing problem actually solved locating mus redesign part another issue typically requires work original human designer system postinfeasibility analy sis fact often needs cooperation algorithmic engine human intelligence chinneck dravnieks 1991 process could need repeated mus removed formula conversely case unsatisability kept modifying underlying system solved locating mus part system changed 3 linear case case systems linear inequalities interested realvalued solutions following result infeasibility holds theorem 1 farkas lemma 1894 let h k real matrix let b real hvector exists real kvector x 0 yt b 0 real hvector yt 0 proof instance schrijver 1986 geometrically means hvector b belong cone generated hvectors a1ak columns exists linear hyperplane separating b a1ak several equivalent forms farkas lemma convert one suitable purposes put alternative feasibility two linear systems requiring yt b0 instead yt b 0 moreover removing limitation x 0 alternative system yt finally asking ax b alternative system 0 details see eg bertsimas tsitsiklis 1997 following variant therefore obtained given amatrixa ir hk vector b ir h consider system linear inequalities new system linear inequalities obtained former one b0 2 exactly one two following possibilities holds exact selection minimally unsatisable subformulae 5 1 feasible ie exists x ir k verifying inequalities 2 feasible ie exists ir h verifying inequalities irreducible infeasible subsystem iis subset inequalities infeasible system infeasible proper subset feasible clearly constitutes analogous mus case systems linear inequalities iis selected within 1 solving following new system support vertex denotes indices nonzero components respectively denote vectors zeroes ones appropriate dimension theorem 2 gleeson ryan 1990 consider two systems linear inequalities form 1 3 3 infeasible 1 feasible contrary 3 feasible 1 infeasible moreover iis 1 given support vertex polyhedron 3 proof based polyhedral arguments using properties extreme rays see gleeson ryan 1990 therefore checking feasibility 1 infeasible identifying one iis becomes problem nding vertex polyhedron 4 propositional formulae general case case propositional formulae wellknown clause expressed linear inequality using n binary variables xi 0 1 corresponding propositional variables false true dening incidence mvectors set positive literals b one negative literals b equivalently denoting number negative literals clause rewritten denote b 0 1mn matrix whose rows correspond clauses shown element 1 corresponding propositional variables positive 1 negative 0 otherwise denote also bthemvector j following system linear inequalities binary variables represents cnf propositional formula order use results given linear case let us consider linear relaxation system suppose formula always contains least unit clause ie clause containing single literal since absence linear relaxation 7 always feasible note practical applica tions assumption generally veried system 7 form 1 rst group inequalities type 5 called clausal inequalities particular matrix 0 1m2nn vector b zm2n composed follows therefore system plays role 3 written exacttex 1042003 1440 p exact selection minimally unsatisable subformulae 7 far following result couple systems 6 8 holds restriction support vertex clausal inequalities denote indices nonzero components among corresponding clausal inequalities theorem 3 consider two systems linear inequalities form 8 case 8 feasible 6 infeasible restriction support vertex polyhedron 8 clausal inequalities contains mus 6 contrary 8 infeasible 7 feasible cannot decided whether 6 feasible proof rst prove restriction support vertex 8 clausal inequalities contains mus 6 assume 8 feasible let v1 vertex found therefore 7 infeasible theorem 2 iis 7 called iis1isgivenby support v1 iis1 general composed set ci 1 clausal inequalities inequalities type 5 set bc1 possibly empty box constraints ones imposing 0 xi 1 set inequalities ci 1 0 1 solutions since removing iis1 imposing strict integer constraints ic1 ones imposing xi 0 1 keeps iis1 unsatisable therefore mus contained clauses corresponding ci 1 mus still subset clauses corresponding ci 1 though imposing strict integer constraints make ci 1 ic1 minimal hand mus 6 obtained procedure 8 infeasible 7 feasible theorem 2 imposing strict integer constraints instead box constraints however nothing said feasibility 6 example consider f1 composed four following clauses b easily obtained following manner therefore system solved form 8 following mus f1 given set clauses c1c2c3 f1 proved unsatisable practical point view motivations reported interested mus composed small number clauses moreover may happen clauses equally preferable composition mus selecting evaluated cost cj taking clause cj mus selected assigned costs cj clauses corresponds costs variables system 8 therefore cost hvector com puted rst components correspond clausal inequalities last 2n components correspond box constraints far solution following linear program produces mus desired clause composition result theorem 3 completely analogous linear case order obtain analogy let us dene following property integral point denote point integer components integralpoint property class polyhedra nonempty contain least one integral point integralpoint ip property theorem 4 polyhedron 7 linear relaxation 6 integralpoint property following holds 8 infea sible 6 feasible contrary if8isfeasible6isinfeasible exacttex 1042003 1440 p exact selection minimally unsatisable subformulae 9 mus given restriction support vertex polyhedron 8 clausal inequalities proof rst prove 8 infeasible 6 feasible 8 infeasible 7 feasible theorem 3 since assumed ipproperty holds 7 contains least one integral point since box constraints hold 7 integer point must 01components hence 6 feasible prove 8 feasible mus 6 given restriction support vertex 8 clausal inequalities denote set clausal inequalities ci1 denote also bc1 ic1 respectively box constraints integer constraints variables appearing ci1 already proved 8 feasible ci1 corresponds unsatisable subset clauses prove contradiction set clauses corresponding ci 1 minimal assuming ci 1 ic1 minimal smaller set clausal inequalities ci 1 ci 1 ci 1 ic 1 infeasible hand ci theorem 2 set inequalities ci 1bc1 must feasible however assumed ipproperty holds 7 contains least one integral point 01components contradiction therefore ci1 corresponds mus far ip property holds solving linear programming problem solves mus selection problem several classes formulae linear relaxation 7 denes polyhedron integralpoint property discussed next section following table reports number known classes propositional cnf whether property holds table integralpoint property hold class propositional formulae ip property horn dowling gallier 1984 scutella 1990 yes renamable horn lewis 1978 aspvall 1980 yes qhorn boros et al 1990 extended horn chandru hooker 1991 yes balanced conforti cornuejols 1995 truemper 1998 yes quadratic aspvall et al 1979 extended nested knuth 1990 hansen et al 1993 slur solvable schlipf et al 1995 matched franco van gelder 2002 yes linear autarkies van maaren 2000 kullmann 2000 considered already known easy cases satisability problem surprisingly easy classes mus selection problem known easy classes satisability problem appear since mus selection gives answer sat would easy class sat well however considerable research eort spent searching easy classes sat last two decades hence discovering entirely new ones seem easy task 5 special classes propositional formulae two interesting classes propositional cnf formulae verify integral point property formulae extended horn include horn renamable horn formulae balancedmoreovertwo classes formulae share ip property incomparable ones rst class matched formulae franco van gelder 2002 second class satisable quadratic cnf consequently satisable qhorn etc since quadratic formulae renamable horn satisable however last two classes always satisable practical interest respect mus selection problem extended horn formulae characterizable follows theorem 5 rounding theorem chandrasekaran 1990 given system ax b x 0witha h k integral matrix b integral hvector exist k k matrix exact selection minimally unsatisable subformulae 11 t1 integral row t1 one negative entry 1 row at1 one negative entry 1 x fractional solution system t1tx proof chandrasekaran 1990 based properties polyhedra integral largest element case cnf particularized follows chandru hooker 1991 consider satisability problem written using inequalities form 4 denote 0 1mn matrix whose rows correspond clauses elements 1 corresponding propositional variables positive 1 negative 0 otherwise opportune righthandside mvector linear relaxation put form theorem 5 becomes 1 conditions required theorem 5 case cnf formulae translate follows row t1 one 1 one 1 adding new 0 1 column vector r t1whose values 0 1n1n matrix t1r exactly one 1 one 1 per row obtain arcsnodes incidence matrix direct graph nodes correspond columns t1r digraph rooted arborescence ie rooted directed tree arcs point away root rarcsof digraph corresponds variables formula rows ie clauses interpreted ows dened digraph positive negative literal unit ow going along opposite arc corresponding variable ow socalled extended starchain property chandru hooker 1991 partitioned possibly empty set unit ows going root extended star possibly empty unit ow one chain conditions theorem 5 veried cnf called extended horn therefore 11 fractionary solution 10 integral solution extended horn formulae verify ip property recognition extended horn formulae known solvable polynomial time problem arborescence realization arise swaminathan wagner 1986 however formulae build order extended horn checking linear time new clause denes acceptable ow arborescence chandru hooker 1991 therefore entire procedure mus selection done polynomial time application supports designed testing new clause accepting extendedhorn second class composed balanced formulae dened denition 3 0 1 matrix balanced every square submatrix exactly two nonzeroes entries row column sums multiple four class balanced matrices contains classes totally unimodular matrices network matrices see truemper 1998 note property balancedness general property sense requires matrix represent cnf formula property veried matrix representing cnf formula form 10 equivalently form 6 following result holds theorem 6 conforti cornuejols 1995 matrix representing cnf instance form 10 balanced polytope integral ie integral extreme points proof immediate developed using polyhedral theory problem recognition balanced matrix polynomialtime com plexity algorithm solves based decomposition results proceeds decomposing given matrix checking obtained submatrices balanced conforti et al 1994 therefore entire procedure mus selection requires polynomial time balanced matrices one observe another procedure nd mus could based additive subtractive lters methods would rst test formula f unsatisable additive methods would generate new formula f adding clauses form f f unsatisable far f selected iis algorithm proposed bruni 2002 evolution additive methods subtractive methods would instead remove f clause cj needed unsatisability testing formula remains unsatisable removing cj remains f selected iis methods therefore guarantee nd mus exists however require solve exacttex 1042003 1440 p exact selection minimally unsatisable subformulae 13 times base problem satisability mus selection feasibility iis selection done polynomial time whole procedure would theoretically polynomial however similar brute force approach recognized quite computationally demanding chinneck dravnieks 1991 gleeson ryan 1990 moreover proposed approach allows powerful manner choosing clause composition selected mus using cost function 9 example consider following cnf formula f2 suppose also following t1 matrix could obtained abcd r rooted arborescence corresponding t1 follows ow corresponding rst second clause given shorter arrows drown arcs ow corresponding third forth clause given shorter arrows drown arcs ows extended starchain property therefore although neither horn renamable horn f2 extended horn conditions theorem 4 suppose unable obtain suitable t1 matrix case following matrix corresponding f2 form 10 must exacttex 1042003 1440 p tested balancedness easy see every square submatrix two nonzeroes per row per column sums 0 hence balanced assured conditions theorem 4 far b built follows since ip property veried mus selection problem completely solved solving following system system infeasible hence guaranteed mus present f2 therefore satisable 6 implementation computational experience many problems error detection classication large datasets solved using rules fellegi holt 1976 encoding rules clauses inconsistencyorcontradiction set rules exacttex 1042003 1440 p exact selection minimally unsatisable subformulae 15 corresponds set clauses jointly unsatisable bruni sassano 2001 since rules free contradiction one cases resulting logic formula satisable therefore checking rules inconsistencies produces mus selection problems note conicting rules located would help deleting particular detection partial inconsistencies inconsistencies eect values data produces series instances similar cnf generated validation rules used realworld census considered proposed algorithm implemented c runs pentium iv pc initial routine converting rules clauses generating cnf formulae procedure composes shown matrix vector b 8 adding opportune objective function problem form 9 passed standard routine solving linear programming ilog cplex 1 implementing simplex algorithm vertex found support used produce mus given output although simplex method exponentialtime complexity polynomialtime complexity methods solving problem eg barriers method nding vertex former alternative generally reckoned faster practice see instance bertsimas tsitsiklis 1997 description problem form 9 infeasible either check one described special classes check depending problem case mus exist need solve satisability problem original cnf formula however considered real problems 9 infeasible original formula turn satisable table ii reports number variables n number clauses original formula selected mus addition computational times seconds report instances corresponding partial inconsistencies hence formulae containing mus results intended give example application rather exploring computational possibilities proposed procedure since latter focus present paper information available wwwcplexcom table ii realworld contradiction detection problems original formula selected mus name nmnmtime majority cases one mus present cnf means one inconsistency present set rules however repairing found inconsistency new cnf still contains mus another inconsistency well repaired independently whole procedure according human experts charge writing rules turn satisfactory tool design contradictionfree set rules 7 conclusions problem mus selection formally dened problem computationally hard arises several applicative elds typically happens application encoded propositional formula welldened satisability property either satisable unsatisable procedure solving mus selection problem presented special conditions proposed procedure able exactly solve problem simply solving linear programming problem done polynomialtime simplex based algorithms known classes cnf formulae studied respect verication special conditions largest classes cnf formulae verifying conditions result extended horn balanced formulae computational experience realworld data mining problems encouraging exact selection minimally unsatisable subformulae 17 acknowledgements author whish thank carlo mannino helpful discussions r recognizing disguised nr1 instance satis linear time algorithm testing truth certain quanti approximate algorithms heuristics maxsat introduction linear optimization time inference valid implications horn related formulae approximating minimal unsatis detection correction large scale data collecting integer programming problems simple rounding type algorithm works extend horn clauses propositional logic optimization methods logical inference fast heuristics maximum feasible subsystem problem locating minimal infeasible constraint sets linear programs perspective certain polynomial time solvable classes satis computers intractability minimally infeasible subsystems inequalities algorithms satis ability sat problem survey analyzing infeasible mixedinteger integer linear programs informs journal computing 11 1 extension nested satis nested application matroid theory sat problem renaming set clauses horn set short note tractable cases satis finding solutions extended horn formulas theory linear integer programming arborescencerealization problem note dowling gallier detecting iis infeasible linear programs using techniques goal programming tr ctr ric grgoire bertrand mazure cdric piette localsearch extraction muses constraints v12 n3 p325344 september 2007