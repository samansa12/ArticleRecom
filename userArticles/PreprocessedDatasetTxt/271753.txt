influence interface conditions convergence krylovschwarz domain decomposition advectiondiffusion equation several variants schwarz domain decomposition differ choice interface conditions studied finite volume context krylov subspace acceleration gmres paper used accelerate convergence using detailed investigation systems involved minimize memory requirements gmres acceleration shown krylov subspace acceleration easily built top already implemented schwarz domain decomposition iteration makes krylovschwarz algorithms easy use practice convergence rate investigated theoretically experimentally observed krylov subspace accelerated algorithm quite insensitive type interface conditions employed b introduction consider domain decomposition twodimensional advectiondiffusion equation application boundary conforming finite volume incompressible navierstokes solver mind see 27 6 20 therefore interests practical theoretical advantage boundary conforming approach structures systems equations arise known beforehand enables us develop efficient iterative solvers vectorized relative ease disadvantage boundary conforming approach suitable domains topologically rectangular domain decomposition used overcome problem name krylovschwarz refers methods schwarz type domain decomposition iteration accelerated krylov subspace method cg gmres see preface 17 equivalently krylovschwarz means schwarz domain decomposition used preconditioner krylov subspace method paper use gmres method nonsymmetry discretized advectiondiffusion equation applied analysis group delft university technology mekelweg 4 2628 cd delft netherlands ebrakkeemathtudelftnl applied analysis group delft university technology mekelweg 4 2628 cd delft netherlands pwildersmathtudelftnl schwarz domain decomposition considered uses minimal overlap coarse grid correction algebraically algorithm formulated block iteration applied possibly augmented matrix see 14 page 372 25 theory 28 experiments 9 show constant overlap physical space coarse grid correction needed obtain constant iteration count mesh refined number subdomains increases examples constant overlap physical space found 15 22 30 however despite large overlap gives better convergence rates minimal overlap typically leads lower computing times see 13 11 9 even large illconditioned problems reason minimal overlap less duplication work overlap regions methods small overlap also much easier implement practical complicated problems coarse grid correction 18 8 1 2 quite effective improving convergence domain decomposition however noted 23 pp 188 small numbers subdomains additional cost forming solving coarse grid problem outweighs reduction number iterations gives moreover large codes used engineering computations coarse grid correction difficult implement similar 12 25 24 study influence interface conditions convergence rate unified treatment nonoverlapping neumanndirichlet schwarz methods minimal overlap straightforward example analytic level found 23 page 207 examples algebraic level 25 24 complicated augmentations discretization matrix needed paper unifies neumanndirichlet schwarz methods simpler way premultiplying discretization matrix socalled influence matrix simple structure acceleration method differs 12 use relaxation gmres ac celeration 25 24 good convergence obtained unaccelerated schwarz algorithm using optimized interface conditions instead use optimization investigate effect simple strategies choosing interface conditions convergence rate krylovschwarz domain decomposition algorithm find accelerated method quite insensitive types interface conditions used wellknown gmres requires much storage vector length large standard krylovschwarz algorithms full vector length used show subdomain problems solved accurately one reduce vector length gmres fact gmres solves reduced system consists equations unknowns near interfaces discretization consider 2d advectiondiffusion equation written general coordinatesx u equation 1 obtained boundaryfitted coordinate transformation rectangular interested 1 realistic model momentum equations occurring computational fluid dynamics incompressible flows discretize 1 using either cellcentered vertexcentered finite volumes central approximation advection terms uniform grid mesh sizes h 1 h 2 leads 9point discretization molecule resulting system discretized equations denoted 3 domain decomposition practice complicated flow domains used one needs complete freedom decomposing domain subdomains however present model study investigate rectan gular rectangular array nonoverlapping subdomains see figure 1 difference cellcentered vertexcentered finitevolumes latter case nodal points interfaces subdomains following 25 unknowns nodal points copied subdomain see figure 2b means nodal points interface doubled left right unknown cross points four copies present respective equation repeated copied unknown adding zeroes discretization matrix positions associated copies domains contrast 25 coefficients discretization also adapted latter mechanism leads subdomain problems desired types boundary conditions interfaces opposed 25 use premultiplication influence matrix see analysis description algorithm restrict two nonoverlapping details multidomain case given omega 9 omega 6 figure 1 decomposition domainomega 3 theta 3 domains 6 theta 6 cells global grid uniform find following way describe domain decomposition convenient replace 2 matrix 3 called influence matrix used obtain various types coupling conditions interfaces section 31 describes detail use matrix leads 12 point molecule first layer points near interface see figure 2 define disjoint index sets j 2 j u definition j also valid vertexcentered case unknowns interface doubled case f partitioned blocks according index sets 1 2 eq 3 becomes 11 12 21 22 schwarz domain decomposition block gaussseidel jacobi iteration applied 4 22 21 gives block gaussseidel jacobi algorithm 5 schwarz domain decomposition algorithm minimal oh overlap following 14 p 370 classify algorithm nonoverlapping gaussseidel variant corresponds multiplicative schwarz jacobi variant suitable parallelization corresponds additive schwarz section 33 describes krylov subspace acceleration schwarz algorithm 31 influence matrix purpose influence matrix introduced 3 give unified framework treat classical schwarz neumanndirichlet algorithms different types interface conditions obtained varying parameters study uses oneparameter coupling extensions parameters also possible b figure 2 interface variables cellcentered vertexcentered b let denote index set variables let j subset containing indices two rows variables near interface see figure 2 variables called interface variables play important role next sections let k denote subset j containing indices variables first layer either side interface gamma influence matrix takes linear combinations discretization molecules associated unknowns k thus influences discretization points k influence matrix defined follows 1 2 correspond subdomain furthermore restrict allowing nonzero ij points j directly opposite respect interface means omit tangential dependencies consider single normal dependencies leads 1parameter coupling situation two subdomains figure 2 matrix two nonzero entries row 2 k one ii 1 subscript shows may vary along interface parameter ij depends coupling strategy used course also invertibility influence matrix ensured condition general multidomain case crosspoints occur crosspoints corner points influence matrix three nonzero entries one interface ij 2 interesting choices neumann dirichlet normal mesh peclet number defined coordinate direction corresponding normal direction present model study vertical interfaces depending subdomain corresponds means normal mesh peclet numbers seen different blocks always opposite signs 7 choices listed 9 worked detail constant coefficients case case discretized subdomain problems identical ones obtained imposing neumann n ij dirichlet conditions interface discretizing using finite volume method 0 use dirichlet condition required obtain wellposed subdomain problems however corresponding ij singular gamma2 therefore omitted study choice use ij instead vertexcentered case avoid problem taking leads relation first layer left right unknowns equivalent direct dirichlet update way get vertexcentered finite volume version neumanndirichlet algorithm studied 19 taking general one wants vary type interface condition depending local flow parameters choose parameter vary along interface basic schwarz iteration obtained choice 14 referred schwarzschwarz ss algorithm neumannschwarz ns obtained ae case transition discontinuous robinschwarz rs method uses smooth transition paper takes p 2 note three strategies domain decomposition 14 15 16 reduce schwarz iteration applied poisson equation 32 interface equations krylovschwarz algorithm corresponds krylov subspace method solving following preconditioned system n block lower triangular block diagonal matrix 6 show reduce system 17 smaller system concerning interface unknowns u see figure 2 let denote vector interface variables let remaining variables following injection operators trivial injection operator w u defined else 18 trivial injection operator v u defined ae following theorem provides useful information structure matrix theorem 1 matrix satisfies following property theta j 20 ordering u system 17 becomes p f proof f premultipling n gamma1 get premultiplying result theta p q get f f ordering components u pre scribed 2 since influence matrix nonzero entries first layer unknowns near interface discretization 9point molecule shown matrix n gamma nonzero elements positions theta j proof omitted therefore matrices n paper satisfy conditions theorem 1 block form 21 shows v principle solved independently w solving system interface equations numerical example 24 found 16 small onedimensional poisson problem note assume accurate subdomain solution corresponding domain inaccurate subdomain solution get 2 j violates assumption theorem 1 21 see matrix n 17 eigenvalue equal number noninterface variables eigenvalues shared interface equations 24 property means interface equations 24 spectrum preconditioned system 17 apart 1 hence 24 need preconditioned approach strongly related schur complement method typical finite element methods subdomain problems solved exactly domain decomposition also amounts solving interface problem 4 10 shown multiplicative overlapping schwarz method equivalent schur complement method appropriate block preconditioner 29 different proof given nonoverlapping method present paper interface problem somewhat different arising schur complement methods terminology interface unknowns reside interface furthermore method general applied finite volumedifference methods well 33 krylov acceleration schwarz method since domain decomposition methods general tend converge slowly acceleration technique needed use gmres 21 krylov subspace method solve interface equations 24 solve 24 required method compute interface matrixvector product q v similar methods based schurs complement see instance 3 necessary form matrix interface equations explicitly turns single iteration unaccelerated algorithm 5 used obtain interface matrixvector product q aq enables stepwise implementation accelerated domain decomposition major importance complicated cfd codes also required vector length gmres quite small small system interface equations must solved makes approach practical large problems given implementation unaccelerated domain decomposition 5 compute f u given property theta j f furthermore introduce u get f injection q restriction q easily implemented subroutines computation given v easy define f problem solved rewritten given initial guess v 0 gmres acceleration proceeds follows 1 compute righthand side 2 solve problem q using gmres initial guess product computed q 3 final inner subdomain solutions collected vector u computed last domain decomposition iteration computed interface solution v f theoretical background theoretical analysis possible simplified conditions equation 1 assume field 1 2 0 boundary conditions periodic ydirection left boundary inflow prescribe dirichlet condition right boundary outflow homogeneous neumann condition take h split domain two parts vertical interface middle obtain convergence estimates gmres accelerated domain decomposition use theorem 5 21 follows gmres without restart k number eigenvalues b nonpositive real parts eigenvalues enclosed circle centered c 0 radius r c practice formula 26 may give crude upper bound convergence especially spectrum evenly distributed consists clusters eigenvalues see 26 however turns problems 26 good estimate using fourier analysis ydirection obtain eigenvalues iteration matrix multiplicative block gaussseidel algorithm straightforward tedious calculations give eigenvalues e closed difficult analyze form see 7 appendix brevity omit details eigenvalues matrix coincide n apart multiple eigenvalue leading estimate ae formula 26 compare ss ns rs nd vertexcentered algorithms compute theoretical convergence rates different ranges flow magnitudes flow angles flow magnitude given dimensionless meshpeclet number jaj magnitude velocity diffusion coefficient flow angle given ff ae h pmax sin ff 27 flow normal interface flow tangential interface average theoretical convergence rates 1 p listed tables 1 2 cellcentered results table 1 show peclet range ss ns rs table 1 average theoretical convergence rates corresponding number iterations brack ets multiplicative algorithm solve relative accuracy 10 gamma4 different mesh peclet ranges averaged flow angles cellcentered discretization small flow magnitudes neumannschwarz algorithm approximately twice fast schwarzschwarz robinschwarz algorithms advantages neumannschwarz algorithms much smaller larger flow magnitudes results indicate neumann schwarz best choice poisson equation however symmetry equation certain sides interfaces neumann conditions must imposed problem becomes important small flow magnitudes p ij changes sign along interface peclet range ss ns rs nd table 2 average theoretical convergence rates corresponding number iterations brack ets multiplicative algorithm solve relative accuracy 10 gamma4 different mesh peclet ranges averaged flow angles vertexcentered discretization vertexcentered results table 2 show much smaller differences different methods cellcentered results table 1 vertexcentered discretization differences also small small flow magnitudes neumanndirichlet method 19 similar convergence neumannschwarz method low flow magnitudes however larger flow magnitudes neumanndirichlet worse convergence rate next section compares theoretical results experiments 5 numerical experiments section presents numerical experiments compares influence interface conditions schwarzschwarz neumannschwarz robinschwarz neumanndirichlet convergence krylov subspace accelerated schwarz domain decomposition 1 ns algorithm modified also flow tangential interface neumann schwarz conditions used instead ss algorithm use relative stopping criterion r residual iterations defined experimental convergence rate aem computed care must taken interpreting convergence rates large differences convergence rates necessarily indicate large differences number iterations instance reach relative accuracy 10 gamma4 ae 01 need 4 iterations ae 02 need iterations hand ae close 1 small differences important difference ae 098 ae 099 factor two iteration count experiments take initial guess v use sparse 2 solver solving subdomain problems results section multiplicative method experience converges twice fast additive method restarted gmres20 used krylov subspace acceleration schwarz domain decomposition 51 convergence function flow magnitude angle results given divided two blocks vertical interface uniform mesh 40 theta 40 cells onomega used numerical results dirichlet condition enforced left lower boundaries ofomega neumann condition enforced right upper boundaries righthand side f 1 coefficients 1 assumed constant k section 4 compute experimental convergence rate function flow magnitude pmax angle ff similar section 4 modified neumannschwarz method neumann schwarz conditions always used block 1 2 respectively even flow tangential interface different description neumannschwarz 15 enables comparison effect different coupling conditions convergence demonstrate quality theoretical prediction convergence rates figure 3 shows example comparison experimental theoretical convergence rates multiplicative neumannschwarz algorithm theoretical convergence rates agree well experimental ones note convergence rate zero along curve pmax cos 2 property domain decomposition algorithm discretization since central discretization used advective terms discretization reduces first order upwind discretization mesh peclet numbers equal 2 compare ss ns rs nd methods use averaging procedure described section 4 average convergence rate computed ranges flow magnitude flow angles tables 3 4 show results results similar theoretical results section 4 also neumannschwarz method performs best low flow magnitudes comparison schwarzschwarz neumannschwarz methods cellcentered vertexcentered larger flow magnitudes differences almost negligible note differences methods even smaller theoretical analysis weak periodic boundary conditions theoretical analysis replaced angle angle rc experimental theoretical figure 3 experimental theoretical convergence factors gmres accelerated neumann schwarz algorithm peclet range ss ns rs table 3 average experimental convergence rates corresponding number iterations brackets solve relative accuracy 10 gamma4 different mesh peclet ranges averaged flow angles cellcentered discretization stronger boundary conditions experiments similar theoretical results section 4 neumanndirichlet method 19 vertexcentered shows almost identical convergence rate neumannschwarz method low flow magnitudes shows slightly worse convergence behavior larger flow magnitudes 52 recirculating flow example investigate uniform flow problem domain decomposition general converges slower simple uniform flow problems problem defined k 2 x 2 sparse public domain direct solver available netlibornlgov peclet range ss ns rs nd table 4 average theoretical convergence rates corresponding number iterations brack ets solve relative accuracy 10 gamma4 different mesh peclet ranges averaged flow angles vertexcentered discretization x controls angle flow across interfaces two decompositions domain considered first two blocks vertical interface second 2 theta 2 blocks interfaces uniform grid onomega used combined cellcentered discretization table 5 lists results accelerated algorithm good convergence factors obtained algorithm quite insensitive direction flow interface type coupling condition robinschwarz method provides small improvement respect neumannschwarz difference small always show iteration count blocks blocks table 5 experimental convergence rate aem iteration counts brackets recirculation problem increasing obliqueness cellcentered discretization differences number iterations work small three coupling strate gies relative differences number iterations even smaller number subdomains increased 2 4 53 remarks robustness numerical experiments 7 shown gmres accelerated algorithm quite insensitive coupling strategy used experiments 7 also investigate influence convergence rate types external boundary conditions adding cross diffusion terms k 12 furthermore experiments investigate effect variations ordering blocks refinement within subdomains experiments show accelerated algorithm rather insensitive factors particular respect refinement promising applications complicated flow problems 6 conclusions investigated three domain decomposition methods namely schwarzschwarz neumann schwarz robinschwarz algorithms algorithms accelerated gmres krylov subspace method assuming accurate solution subdomain problems dimension vector length gmres reduced significantly introducing interface equations makes overhead krylov subspace acceleration negligible enables solution large complex cfd problems gmres krylov subspace acceleration procedure implemented easily top already implemented unaccelerated domain decomposition algorithm repeatedly calling subroutine performs single schwarz domain decomposition iteration given initial guess major importance implementation complex cfd codes theoretical experimental convergence rates agree reasonably well experiments show low flow magnitudes neumannschwarz methods provide reduction number iterations factor 2 large flow magnitudes differences methods less significant robinschwarz schwarzschwarz methods comparable convergence rates low high flow magnitudes neumanndirichlet method 19 convergence rate similar neumannschwarz method except large flow magnitudes requires iterations differences convergence rates found experimentally typically less predicted convergence rates effect even stronger nonuniform flow fields used recirculating flow problem robinschwarz rs method slightly better convergence rate neumannschwarz ns schwarzschwarz ss algorithms differences number iterations amount work ss ns rs methods small number iterations difference significant differences ss ns rs methods even less number subdomains increased 2 4 numerical experiments 7 show conclusions true larger number test problems method reasonably robust respect coupling conditions grid refinement velocity field external boundary conditions experiments show varying type interface conditions depending flow magnitude angle general gives moderate reduction iteration count experiments reduction factor 2 observed limited reduction factors general small effect total computing time especially complex cfd applications solving system equations may take small portion total computing time possibly detailed study interface conditions lead significant reductions iteration counts particular interesting limiting cases lowspeed stokes highspeed euler flows example 25 24 good convergence unaccelerated algorithm obtained problems optimizing interface conditions research necessary determine whether conclusion also holds accelerated algorithm disadvantage methods described 25 24 convergence seems depend sensitively coupling parameters another problem methods general difficult implement especially complex cfd codes besides one imagine complexity methods increases complexity cfd code instance extensions two three dimensions adding new models turbulence modeling property makes cfd software difficult maintain reasons omitted optimization interface conditions chosen start simple schwarzschwarz domain decomposition method incompressible navierstokes equations intend study parallel aspects present method generalize method full incompressible navierstokes equations general coordinates staggered grids see 6 5 acknowledgements authors would like thank p wesseling many valuable discussions work r domain decomposition algorithms schwarz type iterative methods solution elliptic problems regions partitioned substructures overlap overlap note domain decomposition method elliptic problems parallel domain decomposition algorithm incompressible navierstokes equations schwarz domain decomposition incompress sible navierstokes equations general coordinates domain decomposition method advectiondiffusion equation construction preconditioners elliptic problems substructuring comparison domain decomposition ilu preconditioned iterative methods nonsymmetric elliptic problems relationship overlapping nonoverlapping domain decomposition methods recent results schwarz type domain decomposition algorithms iterative procedure interface relaxation domain decomposition methods experiences domain decomposition three di mensions overlapping schwarz methods iterative solution large sparse systems equations multigrid composite meshes aerodynamics applications newtonkrylovschwarz solvers iterative solution elliptic equations refinement twolevel case relaxation procedure domain decomposition methods using finite elements benchmark solutions incompressible navierstokes equations general coordinates staggered grids gmres generalized minimal residual algorithm solving nonsymmetric linear systems domain decomposition method incompressible flow domain decomposition methods computational mechanics local coupling domain decomposition superlinear convergence behaviour gmres schwarz methods symmetric nonsymmetric elliptic problems schwarz schur note finitevolume domain decomposition advectiondiffusion pressurebased composite grid method navierstokes equations tr gmres generalized minimal residual algorithm solving nonsymmetric linear systems construction preconditioners elliptic problems substructuring iterative methods solution elliptic problems regions partitioned substructures multigrid composite meshes overlap overlap note domain decomposition method elliptic problems relaxation procedure domain decomposition methods using finite elements generalized schwarz splittings relationship overlapping nonoverlapping domain decomposition methods domain decomposition method incompressible viscous flow pressurebased composite grid method navierstokes equations superlinear convergence behaviour gmres