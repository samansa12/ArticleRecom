reduced systems threedimensional elliptic equations variable coefficients consider large sparse nonsymmetric linear systems arising finite difference discretization threedimensional 3d convectiondiffusion equations variable coefficients show performing one step cyclic reduction yields system equations well conditioned fast convergence obtained certain block ordering strategy applied analytical results concerning symmetrizability conditions bounds convergence rates given analysis accompanied numerical examples b introduction consider following threedimensional 3d convection diusion equation domain r 3 subject dirichlet neumann mixed boundary condi tions functions 11 trivariate p q r 0 several discretization schemes possible see morton 11 comprehensive survey numerical solution convectiondiusion problem work use sevenpoint discretization technique starting point extend analysis elman golub 4 done twodimensional 2d variable coecient case analysis greif varah 8 9 3d problem constant coecients 3d problem variable coecients let h denote width uniform mesh description follows use notation g ijk gih jh kh g trivariate function sevenpoint discretization done follows see eg 4 analogous 2d case first term 11 analogous discretization performed qu ru z z convective terms su x tu vu z use either upwind centered dierence schemes let f denote corresponding dierence operator scaled h 2 denote values associated computational molecule ijk b ijk c ijk ijk e ijk f ijk g ijk following manner j k gridpoint next boundary f received editors november 10 1997 accepted publication revised form z august 20 1998 published electronically august 3 1999 department computer science university british columbia vancouver bc v6t 1z4 canada greifcsubcca x z e f c sevenpoint operator b reduced operator fig 11 computational molecules unreduced reduced operators computational molecule graphically illustrated figure 11a figure subscripts dropped centered dierences used discretize convective terms values computational molecule given uses upwind schemes type scheme depends sign convective terms assuming v change sign domain positive one use backward scheme negative one use forward scheme discretizing using backward dierences yields forward dierences 14 needs modified obvious manner sparsity structure matrix representing system equations depends ordering unknowns common strategy redblack ordering depicted figure 12 gridpoints colored using two colors checkerboard fashion points correspond one colors say red numbered first case corresponding matrix written u r reduced systems 3d elliptic equations 31 x z 43 44 53 54 26 28 29 30fig 12 redblack ordering 3d grid b e diagonal 15 superscripts r b attached denote associated colors simple process block gaussian elimination leads smaller system black points called reduced system 2 since b diagonal matrix 16 sparse 3d case corresponding dierence operator computational molecule consists 19 points illustrated figure 11b solution black points computed solution red points corresponds solving diagonal system thus readily obtained moving system 15 system 16 amounts performing one step cyclic reduction 2 procedure repeated small system equations obtained solved directly overview idea cyclic reduction several references given 5 pp 177180 elimination half unknowns accompanied permutation matrix equivalently reordering unknowns permuted reduced system formed iterative method used find solution procedure performing one step cyclic reduction nonselfadjoint problem solving resulting system using iterative solver extensively investigated elman golub 2d problems 2 3 4 showed one step cyclic reduction leads systems valuable properties symmetrizability real diagonal nonsingular matrix large set underlying pde coecients eec tively used derive bounds convergence rates iterative solvers fast convergence 2 univariate case naturally transparent used illustrate advantages technique many highly eective techniques presented used elman golub generalized 3d case mentioned throughout paper outline rest paper follows section 2 introduce cyclically reduced operator section 3 discuss block orderings present family orderings reduced grid section 4 present symmetrization results section 5 use results section 4 derive bounds convergence rates block stationary methods section 6 present numerical examples include solving systems using krylov subspace solvers finally section 7 draw conclusions 2 reduced operator one step cyclic reduction 3d model problem constant coecients described 9 full details construction matrix given convergence analysis techniques solving resulting system equations using block stationary methods described 8 9 case constant coecients values computational molecule associated given gridpoint depend points coordinates opposed variable coecient case nevertheless sparsity structure reduced matrix identical cases explicit dierence equation associated reduced operator 3d variable coecient case found 7 used constructing reduced matrix alternative performing matrix products 16 might significantly costly especially 3d case particular programming environments vectorization crucial eg matlab consider following constant coecient model problem px z z 1 sx scaling ah 2 dierence equation form r u 2cf denote continuous operator corresponding model problem reduced operator derived directly discretization scheme original pde oh 2 correction terms case centered dierence discretization oh correction terms upwind discretization used done means analogous techniques used 2d case see elman golub 3 golub tuminaro 6 consider centered dierence discretization expanding 22 multivariate taylor expansion gridpoint ih jh kh yields scaling 2ah 2 r computation carried using maple v oh 2 terms contain among terms expression h 2 thought addition artificial viscosity original equation reduced righthand side equal w ijk oh 2 error gaussian elimination yields following righthand side reduced systems 3d elliptic equations 33 natural b redblack fig 31 two possible orderings block grid point grids corresponds onedimensional 1d block gridpoints underlying 3d grid whose taylor expansion gridpoint ih jh kh scaling 2ah 2 evaluated point ih jh kh another similarity 2d case 3 3 block ordering strategies reduced grid question ordering major importance good ordering strategy lead fast convergence excellent overview literature deals ordering strategies found recent report benzi szyld van duin 1 3d problems seems useful consider ordering blocks unknowns rather pointwise ordering strategy could particularly useful cyclically reduced problem reduced grid somewhat irregular instead ordering unknowns directly 3d reduced grid problem ordering divided two parts first define blocks gridpoints order tensorproduct 2d block grid ordering blocks determined task inner ordering blocks relatively simple define xoriented 1d block gridpoints referring set gridpoints whose collection xcoordinate values include possible values jh grid simple example single horizontal line gridpoints tensorproduct 3d grid similarly yoriented zoriented 1d blocks defined 1d blocks gridpoints defined block computational molecule defined follows definition 31 certain given 3d grid 1d block gridpoints associated block computational molecule defined computational molecule corresponding block grid components 1d blocks block grid contains least one gridpoint belongs point computational molecule associated 3d problem using easily define dierent families types orderings example certain ordering strategy natural block ordering strategy relative 1d blocks gridpoints blocks ordered block grid using natural lexicographic ordering similarly one define redblack block ordering strategy see figure 31 focus particular family orderings reduced grid call twoplane ordering ordering corresponds defining 1d blocks gridpoints collection 2n gridpoints two horizontal lines two adjacent planes n number gridpoints single line original 34 chen greif x 2pnxy b 2prbxy fig 32 two types twoplane ordering x fig 33 possible orientations 1d blocks gridpoints set natural twoplane orderings unreduced grid single member family introduced 9 figure 32 two members family depicted natural twoplane ordering redblack twoplane ordering notational convenience label 2pn 2prb respectively two additional letters added order distinguish dierent orientations 2nitem 1d blocks gridpoints let us illustrate specific case depicted figure 32a indices 18 916 1724 25 xoriented 1d block block grid size 22 components ordered natural lexicographic fashion sets indices 116 1732 forms xyoriented pair planes hence name 2pnxy figure 33 orientations blocks natural twoplane ordering depicted figures 34a b illustrate blocks associated single gridpoint figures x corresponds 1d block contains least one gridpoint point computational molecule associated selected gridpoint one center computational molecule evident reduced systems 3d elliptic equations 35 x x x x x x x x x x even h c computational molecule fig 34 block computational molecule associated twoplane ordering natural b redblack based 2d blocks fig 35 sparsity structures two matrices belong family twoplane orderings structure depends parity gridpoints index block computational molecule figure 34c obtained taking union 1d blocks associated gridpoints block thus identical computational molecule classical ninepoint operator allows one conclude eg reduced matrix block property 14 relative partitioning blocks hand applying 4color scheme blocks gridpoints eective parallelization ideas applied 2d blocks gridpoints block grid case univariate reduced matrix consistently ordered relative partitioning associated 2d blocks figure 35 sparsity structures matrices corresponding natural twoplane ordering redblack block ordering relative 2d blocks depicted order illustrate eectiveness twoplane ordering present figure 36 single 2d block natural twoplane matrix vs one corresponds point natural lexicographic ordering matrices figure associated 12 12 12 grid evident main diagonal block twoplane matrix dense compared natural lexicographic ordering significantly nonzero entries block diagonal submatrix whose bandwidth depend n result direct preconditioner solves ecient due less fillin stationary scheme block jacobi used 13 thm 315 guaranteed reduced matrix mmatrix convergence scheme associated twoplane matrix faster scheme 36 chen greif lexicographic b natural twoplane fig 36 zoom 2d blocks matrices corresponding two ordering strategies reduced grid lexicographic ordering circumstances reduced matrix mmatrix constant coecient case discussed 9 4 symmetrization reduced matrix order obtain bounds convergence rates block stationary methods consider following technique suggested used 2 3 4 also eectively applied 8 9 exists real diagonal matrix q splitting analogous splitting namely c bound spectral radius iteration matrix thus obtained evaluating expression righthand side 41 denote entries ij n 3 2 since sparse block structure small amount work needed order find qby requiring entries denote ji since matrices correspond dierent orderings merely symmetric permutations one another pick matrix corresponds specific ordering strategy work result obtaining general symmetrization conditions reduced matrices regardless ordering used thus pick specific ordering strategy 2pnxz let q denote th diagonal entry q symmetry conditions expressed j sucient look 2n 2n blocks start main diagonal blocks examine entries main block appear th row reduced systems 3d elliptic equations 37 matrix namely 4 3 4 4 mod 2n 5 equal 0 4 corresponds 2 j point thus follows i1jk c i1jk c ijk i2jk i1jk case values associated center computational molecule namely ijk canceled happens rows involve gridpoints applying procedure rest entries main diagonal block obtain following i1jk i1jk c ij1k e ijk ij1k i1jk b ij1k i1j1k ij1k i1jk i1jk ij1k i1jk e i1j1k i1jk ij1k i1jk ijk1 i1jk ijk1 ij1k ij1k ij1k ij1k evident 45411 overdetermine nonzero values matrix q indeed 49411 sucient determine diagonal entries except first entry 2n2n block stage arbitrarily chosen make sure therefore 4548 consistent three equations requirement imposes additional conditions constant coecient case unconditional consistency problematic nature variable coecient case demonstrated simply looking one consistency conditions consider gridpoint j whose associated index satisfies mod applying 49 1 means looking row corresponding gridpoint multiplying 49 applied 1 411 results equation q consistent 48 three additional consistency conditions main block eight additional conditions rest blocks reduced matrix consistency condition equate variables belong location computational molecule find sucient conditions abovementioned consistency conditions hold b similarly c consistency condition becomes i1 e j1 obviously satisfied actual meaning conditions continuous problem separable analysis odiagonal blocks identical following additional conditions obtained two equations determine rest entries matrix first entry symmetrizer determined arbitrarily last order symmetrizer real must require products sign said summarized following theorem demonstrates another point similarity 2d 4 3d problems variable coecients theorem 41 suppose operator 11 separable c i1 b j e j1 nonzero sign j k exists real nonsingular diagonal matrix q q 1 sq symmetric symmetrized computational molecule derived without actually performing similarity transformation example symmetrized value corresponding c ijk c i1jk i1jk i1jk symmetrization operation actually performed order solve linear system symmetrizing matrix entries unbounded h goes zero symmetrization done mere purpose convergence analysis 5 bounds convergence rates block stationary methods reduced matrix corresponds family natural twoplane orderings size n 3 2 n 3 2 thought block tridiagonal matrix relative ij block tridiagonal matrices respect 2n 2n blocks reduced systems 3d elliptic equations 39 8 two partitionings considered partitioning 1d blocks 2n 2n blocks partitioning 2d blocks size n 2 order find bound symmetrization possible strategy 4 applied theorem 51 refer ordering strategy 2pnxz since orderings symmetric permutations 2pnxz finding bounds ordering strategies discussed paper straightforward theorem 51 suppose continuous problem separable c i1 b j1 e j f k1 g k positive bounded x z respectively suppose also ijk j k denote spectral radii iteration matrices associated block jacobi scheme correspond 1d splitting 2d splitting bounded respectively defined follows 52a 52c proof proof follows using technique 4 pp 346347 conditions stated theorem guarantee matrix symmetrizable denote reduced matrix symmetrized matrix suppose obtained modifying following manner replace occurrence c x replace occurrence b j e j replace occurrence f k g k z replace occurrence ijk denote splitting analogous far sparsity structure concerned splitting 1d splitting matrix block diagonal semibandwidth 4 sparsity structure identical moreover componentwise smaller equal entries 9 lem 33 irreducible diagonally dominant mmatrix matrix c nonnegative satisfies c c thus perronfrobenius theorem 13 p 30 used obtain upper bound convergence rate splitting since matrix referred symmetrized version matrix associated constant coecient case bound convergence rate readily obtained 9 thm 315 2d splitting procedure completely analogous bound obtained 8 thm 36 remark estimates convergence rates block gaussseidel block sor schemes obtained using near property analysis presented 7 8 6 numerical experiments examples follow begin results validate convergence analysis section 5 stationary methods compare performance krylov subspace solvers reduced unreduced systems experiments performed sgi origin 2000 machine program written matlab 5 61 test problem 1 consider separable problem z table comparison computed spectral radii block jacobi iteration matrices bounds using centered dierences two splittings splitting 1d 2d z constructed solution ux notational convenience let 2 suppose h suciently small centered dierence discretization performed hence k bounds obtained identical manner center computational molecule 6 terms pde coecients condition means convergence analysis section 5 applicable pde coecients conditions hold matrix symmetrizable using notation previous sections let symmetrized matrix let modified version occurrence c i1 b j1 e j f k1 g k replaced upper bounds namely x z respectively since symmetrized version matrix corresponding constant coecient case 9 lem 33 diagonally dominant mmatrix using theorem 51 bounds convergence rate block jacobi method given table 61 evident bounds tight even small n noted however pde coecients grow larger bounds expected tight inequalities 64 become less eective next spectral radii block jacobi block gaussseidel iteration matrices approximation optimal sor parameter computed upwind scheme centered scheme relaxation parameter computed according formula 2 approximation optimal sor parameter since matrix close consistently ordered 8 experiments done 8 8 8 grid 512 gridpoints tables 62 63 superscripts c u stand centered upwind respectively r u stand reduced system unreduced system respectively subscripts j gs stand jacobi gaussseidel respectively present results reduced systems 3d elliptic equations 41 table spectral radius block jacobi block gaussseidel approximate optimal relaxation parameter reduced system using upwind centered dierences 1d splitting u r c table spectral radii block jacobi block gaussseidel optimal relaxation parameter unreduced system using upwind centered dierences 1d splitting two dierent cases one convection moderate size large convection upwind scheme eective centered scheme note unreduced system cases matrix satisfies conditions required youngs sor analysis 14 thus spectral radius gaussseidel matrix optimal relaxation parameter computed spectral radius block jacobi matrix comparing tables 62 63 evident stationary solvers reduced system converge faster unreduced system one case convergence reduced system divergence unreduced system moving consider krylov subspace solvers table 64 make comparison performance solvers two systems stopping criterion relative residual smaller 10 10 method used nonpreconditioned bicgstab table presents information complete process namely construction systems iterative solves increase iteration counts grid refined agrees theory least one assumes well conditioned mildly nonsymmetric system condition number magnitude oh 2 convergence rate similar conjugate gradient method symmetric positive definite systems one step cyclic reduction applied savings become dramatic systems grow larger explanation construction reduced system requires significantly floating point operations compared construction unreduced system becomes less significant factor overall computation grid becomes finer general since iterative solve costly component computation significant number iterations convergence unreduced solver larger factor approximately 2 compared reduced solver figure 61 illustrates saving convergence behavior problem table 65 provide numerical evidence suggests good performance reduced solvers due eective preconditioning original trix table estimates condition numbers upwind dierence discretization presented estimates obtained using matlabs command condest factor approximately 2 obtained several additional cases tested observations condition table comparison performance unreduced reduced solvers increasing mesh size using nonpreconditioned bicgstab iterations mflops time sec unreduced reduced unreduced reduced unreduced reduced iterations relative residual fig 61 relative residuals nonpreconditioned bicgstab applied linear systems arising discretization test problem grid residual associated reduced solver lower curve number reduced matrix found 7 62 test problem 2 consider nonseparable problem z z constructed solution 62 problem convergence analysis section 5 apply results given table 66 experiments done tensorproduct grid 13 824 gridpoints gmres5 12 used preconditioned ilu drop tolerance 10 3 stopping criterion r r 0 cases tested setting solving reduced system faster compared setting solving unreduced system noted cpu times aected long preconditioner setup time convection dominates centered scheme performs poorly general scheme suers numerical instability reynolds numbers large 10 additional numerical experiments indicate solvers property centered dierence discretization solver mildly nonsymmetric systems converges faster solver closetosymmetric system phenomenon proved analytically stationary methods constant coecient case 2 2d 9 3d reduced systems 3d elliptic equations 43 table comparison estimates condition numbers unreduced matrix denoted u vs reduced matrix r table comparison cpu times seconds setting solving unreduced system reduced system using ilugmres r u stand reduced unreduced respectively subscripts c u stand centered upwind respectively 50 912 435 487 327 100 1482 373 621 238 63 test problem 3 consider nonseparable problem neumann boundary conditions u conditions unit cube w constructed exact solution ux cosz compare performance krylov subspace solvers thus focus actual iterative solve time systems preconditioners set results table 67 20 20 20 grid ilu0 used preconditioner stopping criterion r r 0 cases reduced solver converges faster unreduced solver factor approximately 2 good indication gain performing one step cyclic reduction much finer grids bicgstab slightly faster cgs two schemes faster bicg dierences performance solvers qualitatively similar reduced unreduced systems table iteration counts solving times three krylov solvers method iterations time sec unreduced reduced unreduced reduced cgs 7 concluding remarks cyclically reduced operator 3d convection diusion equation variable coecients derived block orderings discussed solving techniques reduced system examined 44 chen greif numerical experiments illustrate fact reduced system easier solve unreduced system results presented work show one step cyclic reduction eectively used preconditioning technique solving convectiondiusion equation variable coecients questions parallelism applications topics investigation acknowledgments grateful jim varah carefully reading manuscript valuable advice would also like thank gene golub held helpful discussions pointed useful references many thanks two referees helpful comments suggestions r orderings incomplete factorization preconditioning nonsymmetric problems iterative methods cyclically reduced nonselfadjoint linear systems iterative methods cyclically reduced nonselfadjoint linear systems ii line iterative methods cyclically reduced discrete convectiondiusion problems matrix computations cyclic reductionmultigrid analysis cyclic reduction numerical solution threedimensional convectiondiusion equations block stationary methods nonsymmetric cyclically reduced systems arising threedimensional elliptic equations siam j iterative solution cyclically reduced systems arising discretization threedimensional convection diusion equation dont suppress wiggles numerical solution convectiondiusion problems iterative methods sparse linear systems matrix iterative analysis iterative solution large linear systems tr ctr cheung michael k ng blockcirculant preconditioners systems arising discretization threedimensional convectiondiffusion equation journal computational applied mathematics v140 n12 p143158 1 march 2002