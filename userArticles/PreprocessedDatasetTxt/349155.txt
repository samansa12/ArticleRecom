rapid evaluation nonreflecting boundary kernels timedomain wave propagation present systematic approach computation exact nonreflecting boundary conditions wave equation two three dimensions critical step analysis involves convolution inverse laplace transform logarithmic derivative hankel function main technical result paper logarithmic derivative hankel function hnu1z real order nu approximated upper half zplane relative error varepsilon rational function degree sim lognulogfrac1varepsilon log2 nu nu 1 log2frac1varepsilon nurightarrowinfty varepsilonrightarrow 0 slightly complicated bounds nu0 n number points used discretization cylindrical circular boundary two dimensions assuming varepsilon 1n log nlogfrac1varepsilon work required time step comparable work required fourier transform boundary three dimensions cost proportional n2 log2 n n2 log nlogfrac1varepsilon spherical boundary n2 points first term coming calculation spherical harmonic transform time step short nonreflecting boundary conditions imposed desired accuracy cost dominated interior grid work scales like n3 two dimensions n2 three dimensions b argument z satisfying imz 0 number poles bounded log log 1 log2 1 log2 1 similar representation derived valid imz 0 requiring log 1 log 1 log 1 log log 1 log 1 log log 1 poles section 2 introduce nonreflecting boundary kernels section 3 collect background material form convenient subsequent development section 4 contains analytical approximate treatment logarithmic derivative procedure computing representations presented section 5 results numerical computations contained section 6 present conclusions section 7 2 nonreflecting boundary kernels let us first consider wave equation twodimensional annular domain 0 1 general solution expressed kn modified bessel functions see example 17 section 96 coecients bn arbitrary functions analytic right halfplane l denotes laplace transform denotes inverse laplace transform ds likewise wave equation threedimensional domain r0 rr1 general solution expressed rsc rsc imagine used nonreflecting boundary assume sources exterior region coecients bnms zero let us denote un function satisfying un sans kn sc kn sc c knsc c knsc denotes laplace convolution convolution kernel 29 generalized function singular part easily removed however subtracting first two terms asymptotic expansion c knsc c 2 assumption un t0fort 0 standard properties laplace transform obtain boundary condition impose remark solution wave equation physical space recovered nonreflecting boundary un fourier transformation assuming n points used discretization analogous boundary condition three dimensions expressed terms functions unmr satisfying rsc algebraic manipulation assuming unmr t0fort 0 rscwhich impose note boundary conditions 212 216 exact nonlocal since rely fourier spherical harmonic transformation space history dependent form history simple however expressed separate mode terms convolution kernel inverse laplace transform function defined terms logarithmic derivative modified bessel function k z log kz dz kz remark three dimensions required logarithmic derivative kn 1 zisa ratio polynomials one recast boundary condition terms dierential operator order n resulting expression would equivalent derived sofronov 7 grote keller 8 remainder paper devoted approximation logarithmic derivatives 218 ratio polynomials degree olog convolution kernels n n expressed sum decaying exponentials representation allows recursive evaluation integral operators 212 216 using olog n work per time step see 18 note par sevals equality l2 error resulting convolution approximate kernel sharply bounded l error approximation kernels transform precisely approximating kernel bt kernel atwefind u b assume b u regular res 0 finite times may let positive real part therefore concentrate theoretical developments l approximations ease computation however compute rational representations least squares methods generally lead small relative errors maximum norm shown since hankel functions commonly used special function literature write logarithmic derivatives 1 i2 h1 zei2 log kz log h dz dz h1 zei2 interested approximating logarithmic derivative hankel function real axis 3 mathematical preliminaries section collect several wellknown facts concerning bessel equation logarithmic derivative hankel func tion pole expansions form useful subsequent analytical development 31 bessels equation bessels dierential equation dz2 z dz z2 1 2 r linearly independent solutions h h known hankels functions expressed formulae jz eijz jz eijz bessel function first kind defined z z24k expressions 32 replaced limiting values integer values 1 2 see example 17 section 91 general functions h h branch point customary place corresponding branch cut negative real axis impose restriction arg z shall find convenient however place branch cut negative imaginary axis restriction hankels functions especially simple asymptotic properties particular see example 19 section 741 z zk z zk 2z z z 42 1242 32 42 2k 12 branch square root determined finally note symmetry also make use modified bessel functions kz iz linearly independent solutions equation obtained 31 transformation z iz wronskian satisfies moreover positive r 20 asymptotic expansions kr ir r small large also known 17 sections 96 97 real r 0wehave r log 0 05772 euler constant finally note uniform expansions bessel functions given 17 hankel function derivative restrict z argz2 define 3 z ait denotes airy function 17 section 104 note large approximations modified bessel functions real arguments r given r 32 hankel function logarithmic derivative denote logarithmic 1 derivative h g 1 321 gz log h1z dz h1z following lemma states fundamental facts g use lemma 31 function gz r satisfies formulae z complex conjugate z asymptotic approximations g euler constant zk 2z z zk 1 fig 31 curve z defined 318 near scaled zeros h lie see lemma 32 1 branch cut h chosen 34 negative imaginary axis ak defined 37 defined 318 furthermore function u defined satisfies recurrence proof equations 322 323 asymptotic expansion 324 follow im 1 mediately definitions 32 34 j h asymptotic expansion 325 follows 35 36 326 consequence 316 317 recurrence 328 standard bessel recurrences 17 section 9127 1 zeros h z well characterized 17 20 lie lower half zplane near curve shown figure 31 obtained transformation 21 bessels equation terms asymptotic approximation 316 curve corresponds negative real arguments airy function 1 lemma 32 zeros h1h2 h z sector 2 arg z 0 given asymptotic expansion uniformly n n defined equation z obtained inverting 318 nth negative zero airy function ai zeros sector arg z 32 given h1 h2in particular 33 pole expansions set poles finite region defines function smooth away region smoothness increasing distance creases fact leads following approximation related fast multipole method 22 23 lemma 33 suppose q1qn complex numbers z1zn complex numbers zj1 j 1n function z zj approximated reza1 pole expansion z j root unity j defined error approximation bounded z zj proof use geometric series summation z v zk1 zm z v obtain zm z zj z j terms first summation vanish due combination 334 equality mk0 error term obtain z 12 1a2 12 z 1 zjz 12 z zj 12 moreover repeating computations 339 find 12 combination 338 341 triangle inequality gives 335 inequality 335 remains valid assume instead zjb rez abb arbitrary b r b0 fact leads next two results whose proofs mimic lemma 33 omitted lemma 34 suppose n p positive integers q1qn complex numbers z1zn complex numbers contained disks d1dp radii r1rp centered c1cp respectively function z zj approximated z satisfying rez ci ari ri 1pby mp pole expansion ri j ij defined ri jidj error approximation bounded 1a 12 1148 bradley alpert leslie greengard thomas hagstrom z zj lemma 35 suppose discrete poles lemma 34 replaced density q defined curve c c specifically c z finite z outside gm defined 343 ij defined ri bound 345 holds lemma 33 enables us approximate exponential convergence function defined sum poles fundamental assumption region interest separated pole locations notion separation eectively relaxed covering pole locations disks varying size adaptive manner lemmas 34 35 use approach derive principal analytical result 4 rational approximation logarithmic derivative hankel functions logarithmic derivative gz defined 321 approaches constant z regular finite z c except z 0 branch point 1 zeros h z simple therefore develop representation g analogous mittagleer theorem addition due branch cut negative imaginary axis convenient work uz defined 327 approximations introduced simple error bounds theorem 41 function uzzgz g defined r 321 branch cut defined 34 given formula z c 0h1h2hn negative imaginary axis 1 h1h2hn denote zeros h z number n proof case spherical hankel function simple consider first uz ratio polynomials iz real coecients clear observation u12ziz12 combination recurrence 328 hence z hn p polynomial n residue u hn zhn 1 cm 2 cm rez fig 41 integration contour cm inner circle radius 1m outer radius 1 lhopitals rule see 325 noting uiy r r combining 42 43 45 obtain 41 consider case z origin branch point 1 2 define cm simple closed curve shown figure 41 1 proceeds counterclockwise along circle cm radius centered origin arg z 2to32 vertical segment 2 circle cm radius 1m centered origin arg z 32to2 vertical segment z rei2 back first circle since none zeros 1 h lies imaginary axis cm encloses suciently large 1 z c inside cm h residue theorem gives 1 2 consider separate pieces contour cm circles cm cm use asymptotic expansion 44 infinity 324 origin obtain fig 42 plot urei2 containing zero crossing im urei2 exploiting symmetry ure3i2urei2 323 vertical segments obtain combined 46 yields 41 theorem primary aim paper reduce summation integral 41 similar summation involving dramatically fewer terms restrict z upper halfplane settle approximation representation 1 possible poles u zeros h lie entirely lower halfplane cluster near real axis first examine behavior u negative imaginary axis qualitative behavior u branch cut illustrated case shown figure 42 plot changes little changing except sign im uz sharpness extremum lemma 42 r z function urei2 infinitely dierentiable r 0 imaginary part satisfying following formulae cos r20 defined 320 1 proof infinite dierentiability uz follows observation h z negative imaginary axis derive 49 recall 311 obtain apply 310 remaining formulas follow asymptotic forms kr ir small large r uniform large expansions given 312 315 319 use symmetry u note 410 valid r0 approximation 412 nonuniform 2k 12 lemma 43 given 0 0 exist constants c0 c1 r z z satisfying imz 0 function satisfies bounds moreover exists 0 r 0 0 12 fz admits approximation gz sum 11 log1 log1 poles proof assume begin changing variables nonvanishing z asymptotic behavior w clear 415 holds 01 fixed 1 0 using 412 large bounded away 2k 12 integral k application watsons lemma 414 focuses unique positive zero wof defined 320 derivative function positive conclude cos function w 415 clearly holds however 2k 12 denominator righthand side 412 may nearly vanish w expansion loses uniformity setting cos cases see denominator minimum bounded o2 hence o1 neighborhood minimum includes wwehave change variables seen satisfy upper bound uniformly rest integral small upper bound holds move approximation positive integer positive number w0 define intervals f0f1 f2 defined formulae choose w0 f0 f2 ignored use lemma 35 approximate f1 using 410 412 taking w0 suciently small constant c2 independent 422 f0z w21dw w0 hence choice suces guarantee f0z fzin closed upper halfplane using 411 412 assuming su ciently large constant c3 independent 423 choosing appropriate m0 m1 independent leads fzfinally apply lemma 35 approximation f1 error involves function note using p poles j produce p mpole approximation gz error estimate imz 0 given by428 f1z gz f1z choice enforces combining 424 427 430 triangle inequality obtain 416 number poles satisfying stated bound case treatment first direct application preceding arguments leads significantly larger upper bound number poles second note relative error bounds near z 0 require vanishing absolute error finally lack regularity u0zatz 0 precludes uniform rational approximation discussed 10 therefore relax condition imz 0toimz 0 220 lead good approximate convolutions times 1 lemma 44 exists 0 0 12 0 12 function fzu0ziz 12 admits approximation gz sum log1 log log1 log1 poles proof note since u0z poles fz given 414 satisfies 415 define intervals f1 f2 defined formulae choose f2 ignored use lemma 35 approximate f1 using 411 assuming suciently large constant c hence choosing log log1 appropriate m0 independent leads finally apply lemma 35 approximation f1 using p poles j produce p mpole approximation gz error estimate imz given choice enforces 439 triangle inequality 431 achieved number poles satisfying stated bound consider contribution poles lemma 45 exist constants c0 c1 0 r 2 0 12 function z hn 1 h1hn roots h satisfies inequalities admits approximation gz sum log log1 poles proof curve c defined lemma 32 near h1hn lie contained disks separated real axis denote disk radius r centered c dr c disks example contain c1 1 331 root h1 closest real axis satisfies hence contained disk 443 n log2 243312a1123 roots contained olog disks applying lemma 34 obtain 442 h replaced obtain upper bound 441 h h note first trivial except z1 detailed analysis roots described lemma 32 shows hence z1 z hj lower bound 441 obvious except z1 however note since 326 415 righthand side dominated iz combination theorem 41 lemmas 43 45 suces prove principal analytical result theorem 46 given 0 0 exists 0 r 0 0 12 exists complex numbers 1d 1d depending function approximates uz bound provided imz 0 furthermore proof first note lower bound c 452 uz iz 12 0 function nonvanishing correct asymptotic behavior need consider case large result follows 326 proves 451 450 u replaced u iz 12 righthand side 326 final result follows scaling 13 number poles 448 required approximate uz tolerance depends asymptotic dependence proportional 1 log21 see numerical examples however term important small otherwise dominant term first asymptotic dependence log log1 generally 1 practice term log2 less importance similarly lemma 44 leads following theorem 0 theorem 47 exists 0 0 12 0 12 exists log1 log1 log log1 complex numbers 1d 1d depending function approximates u0z bound provided imz furthermore proof already 455 u0ziz 12 righthand side 324 find log1u0z theorem follows scaling log11 must take see number poles required may grow like log1 log log log log however mode twodimensionsal case short dependence insignificant practice 5 computation rational representations analytical error bound estimates developed previous sections based maximum norm errors 219 220 numerical computation often convenient however obtain least squares solutions method computing rational function u satisfies 450 enforce 451 alternative approach would use rational chebyshev approximation developed trefethen gutknecht 24 25 26 numerical computations work sumofpoles approximation uzuz iz 12 particular nonlinear least squares problem pq polynomials degp problem 52 nonlinear also poorly conditioned pq represented terms monomial coecients apply two tactics coping diculties linearization orthogonalization linearize problem starting good estimate q updating pq iteratively particular solve linear least squares problem integral replaced quadrature initial values p0 q0 obtained exploiting asymptotic expansion 325 recurrence 328 find two three iterations 53 generally suce quadrature 53 derived first changing variables 1m w1 wm denote appropriate quadrature nodes weights transformed integrand periodic interval 22 trapezoidal rule midpoint rule obvious candidate integrand infinitely continously dierentiable except regularity order 2for 8 say trapezoidal rule delivers least 16thorder convergence eective small however quadrature adjusts complicated singularity needed successively subdivide interval near singularity applying highorder quadratures subinterval see example 27 quadrature discretization 53 cannot solved least squares problem standard techniques due extremely poor conditioning avoid forming corresponding matrix rather solve least squares problem gramschmidt orthogonalization 2d orthogonalized real inner product refxgx obtain orthogonal functions uxn1 table number poles represent laplace transform nonreflecting boundary kernels n n various values 106 52 86 11 52 86 11 7291024 15 19 22 26 17 ndnd46 54 21 119 145 26 178 216 28 266 324 487 595 33 596 728 34 19 26 37 44 20 45 53 21 119 144 26 177 216 28 265 324 486 594 33 595 727 34 8911024 36 108 21 28 11 59 84 14 419 638 19 20 28 11 58 419 637 19 9721024 21 ndnd ndnd pi1 qi1 computed recurrence coecients cnj splitting even oddnumbered parts applications including nonreflecting boundary kernels convenient represent pq sum poles pz n qz z n compute 1d zeros q newton iteration zero suppression see table laplace transform cylinder kernel n defined 213 approximated sum poles n 14 106 nd pole coecient im pole location im 0426478e 02 example 28 formula 1n1 previously computed zeros q 1d computed formula pnqn derivative qz obtained dierentiating recurrence 57 6 numerical results implemented algorithm described section 5 compute representations n n laplace transforms recall cylinder kernels n sphere kernels n presents sizes representations 106 108 1015 451 cylinder kernels aected branch cut number poles small n higher sphere kernels dis crepancy however rapidly vanishes n increases asymptotic performance ensues log1 dependence number poles 108 also computed maximum norm relative errors appear 219 sampling fine mesh cylinder kernel n 0 expect o1 error small interval origin due 410 however errors less achieved 5 107 implies similar accuracy approximation convolution times order 106 cases maximum norm relative errors order finally table 2 presents poles coecients cylinder kernels 14 106 allow comparison reader interested repeating cal culations note pole locations written terms extensive tables made available web httpmathnistgovmcsdstabalpert remark approximate representation nonreflecting boundary kernel could used reduce cost method introduced grote keller 8 dierential operators degree n obtained derivation need replaced corresponding dierential operators degree log n specified accuracy interesting note twodimensional case approach 8 apply analysis described used derive integrodierential formulation spirit 7 summary paper introduced new representations logarithmic derivative hankel function real order scale size logarithm order algorithm compute representations presented numerical results demonstrate new representations modest size orders accuracies likely practical interest present motivation work numerical modeling nonreflect ing boundaries wave equation discussed briefly detail 18 maxwells equations also susceptible similar treatment outlined 29 new representations enable application exact nonreflecting boundary conditions global space time computationally eective 8 appendix stability exact approximate conditions ap pendix consider stability approach design nonreflecting boundary conditions given approximating exact conditions uniformly natural expect approximations possess similar stability characteristics indeed case oddly enough however exact boundary conditions satisfy uniform kreisslopatinski conditions necessary sucient strong wellposedness usual sense 30 may seem paradoxical since unbounded domain problem strongly wellposed diculty exact reduction unbounded domain problem bounded domain problem gives rise forcings inhomogeneous boundary terms live restricted subspace kreisslopatinski conditions hand require bounds arbitrary forcings setting best estimates result loss 13 derivative terms sobolev norms practice doubt fact significance certainly encountered stability problems long time numerical simulations fill details consider spherical domain radius one within homogeneous wave equation homogeneous initial data satisfied boundary unm skn r exact condition uniformly small use approx imations gnm spherical harmonic transform arbitrary forcing g following sakamoto seek estimate 0 denotes usual l2 norm boundary make use fractional sobolev norms easily defined terms spherical harmonic coecients strong wellposedness would follow showing gt20dtinstead show dt 13to prove let bounded solutions within sphere given precisely setting find 1 estimate norms solution first note products definition 1 1 n jzh z zjzh z uniformly bounded imz 0 see limits z 0 z therefore mentioned error term long small eect estimates derive simply ignore set n 1 concentrate boundary terms h straightforward compute ill behaved transform space throughout c denote positive constant independent variables first note singularities bessel functions occur zero infinity need consider limits z 0 z first two straightforward large use uniform asymptotic expansions bessel functions due olver yield z parsevals relation conclude gt13dt estimation spatial integrals involved r1 solution two transition zones z rz number cases consider however estimates follow along lines lead result interesting note lossofderivative phenomenon suppressed one looks error due approximation boundary condition case transform exact solution near boundary 1 hn rz 1 hn z error e satisfies problem gnm given 1 zhn z 1 hn z best estimate n takes form combination 86 would lead estimate 1norms error terms 43norms solution however using large asymptotics direct calculation shows thus n smaller maximum o13 transition region o13 hence find error words 1norms error controlled 1norms solution course ignored discretization error could conceivably cause diculties association lack strong wellposedness rule would require detailed analysis practice encountered diculties even long time simulations also note strong wellposedness could artificially recovered perturbing approximate conditions large n allowing high accuracy maintained smooth solutions finally note similar analysis carried two dimensions r accurate longtime solution wave equation exterior domains asymptotic expansions corrected boundary conditions highorder radiation boundary conditions artificial boundary conditions absolute transparency two threedimensional external timedependent scattering problems fast discrete polynomial transforms applications data analysis distance transitive graphs fast transform spherical harmonics modulus phase reduced logarithmic derivative hankel function handbook mathematical functions nonreflecting boundary conditions timedependent wave equation asymptotics special functions asymptotic expansion bessel functions large order asymptotic solution linear di thomas hagstrom fast algorithm particle simulations implemenation fast multipole method without multipoles rational chebyshev approximation unit disk real complex chebyshev approximation unit disk interval rational carath numerical solution onedimensional integral dierential equa tions introduction numerical analysis accurate boundary treatments maxwell hyperbolic boundary value problems tr ctr laurence halpern olivier lafitte dirichlet neumann map domains corners approximate boundary conditions journal computational applied mathematics v204 n2 p505514 july 2007 marcus j grote christoph kirsch nonreflecting boundary condition timedependent multiple scattering journal computational physics v221 n1 p4162 january 2007 andreas atle bjorn engquist surface radiation conditions highfrequency wave scattering journal computational applied mathematics v204 n2 p306316 july 2007 bjrn sjgreen n anders petersson perfectly matched layers maxwells equations second order formulation journal computational physics v209 n1 p1946 10 october 2005 john visher stephen wandzura amanda white stable highorder discretization evolution wave equation 1 journal computational physics v194 n2 p395408 march 2004 bradley alpert leslie greengard thomas hagstrom nonreflecting boundary conditions timedependent wave equation journal computational physics v180 n1 p270296 july 20 2002 isaas alonsomallo nuria reguera discrete absorbing boundary conditions schrdingertype equations practical implementation mathematics computation v73 n245 p127142 january 2004 jingrebecca li leslie greengard high order marching schemes wave equation complex geometry journal computational physics v198 n1 p295309 20 july 2004 v tsynkov artificial boundary conditions numerical simulation unsteady acoustic waves journal computational physics v189 august stephen r lau rapid evaluation radiation boundary kernels timedomain wave propagation blackholes theory numerical methods journal computational physics v199 n1 p376422 1 september 2004 hariharan scott sawyer dane quinn laplace transormpotentialtheoretic method acoustic propagation subsonic flows journal computational physics v185 n1 p252270 10 february dan givoli beny neta highorder nonreflecting boundary scheme timedependent waves journal computational physics v186 n1 p2446 20 march