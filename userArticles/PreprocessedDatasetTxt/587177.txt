largescale computation pseudospectra using arpack eigs arpack sc matlab counterpart tt eigs software packages calculate eigenvalues large nonsymmetric matrix arnoldi iteration implicit restarts show small additional cost diminishes relatively matrix dimension increases good estimates pseudospectra addition eigenvalues obtained byproduct thus largescale eigenvalue calculations feasible obtain routinely eigenvalue approximations also information whether eigenvalues likely physically significant examples presented matrices dimension 200000 b introduction matrices many eigenvalue problems large allow direct computation full spectra two iterative tools available computing part spectrum arpack 10 11 matlab counter part eigs 1 nonsymmetric matrices mathematical basis packages arnoldi iteration implicit restarting 11 23 works compressing matrix interesting hessenberg matrix one contains information eigenvalues eigenvectors interest general information largescale nonsymmetric matrix eigenvalue iterations see 2 21 29 31 matrices nonnormality nonorthogonality eigenvectors may physically important 30 extreme cases nonnormality combined practical limits machine precision lead diculties accurately finding eigenvalues perhaps common important situation nonnormality pronounced enough limit physical significance eigenvalues applications without rendering uncomputable applications users need know situation prevailing practice largescale eigenvalue calculations users get information kind familiar tool available learning cases nonnormality may important pseudospectra figure 1 shows pseudospectra grcar matrix dimension 400 6 exact spectrum converged eigenvalue estimates ritz values returned run arpack seeking eigenvalues largest modulus matrix original article 23 described algorithmic basis arpack sorensen presented similar plots diculties encountered grcar matrix extreme example nonnormality pronounced even convergence tolerance set lowest possible value machine epsilon eigenvalue estimates far true spectrum ritz values alone one might realize anything received editors june 6 2000 accepted publication revised form january 15 2001 published electronically july 10 2001 httpwwwsiamorgjournalssisc23237322html oxford university computing laboratory parks road oxford ox1 3qd uk tgwcomlab oxacuk lntcomlaboxacuk matlab version 5 eigs mfile adapted fortran arpack codes starting matlab version 6 eigs command calls fortran arpack routines g wright lloyd n trefethen fig 1 pseudospectra grcar matrix dimension 400 actual eigenvalues shown solid stars converged eigenvalue estimates eigenvalues largest modulus returned arpack shown open circles arpack estimates lie 10 16 10 17 pseudospectral contours amiss pseudospectra plotted obvious computing pseudospectra matrix dimension n traditionally expensive task requiring 3 singular value decomposition point grid reasonably fine mesh leads 3 algorithm constant order thousands recent developments algorithms computing pseudospectra improved constant 28 asymptotic complexity large sparse matrices 3 12 still fairly costly techniques paper show large matrices cheaply compute approximation pseudospectra region near interesting eigenvalues method uses upper hessenberg matrix constructed successive iterations implicitly restarted arnoldi al gorithm implemented arpack among things means performing eigenvalue computation arpack eigs user quickly obtain graphical check indicate whether ritz values returned likely physically meaningful vision every arpack eigs user ought plot pseudospectra estimates routinely eigenvalue computations cheap sanity check ideas related appeared earlier papers nachtigal reichel trefethen 17 ruhe 19 sorensen 23 toh 24 toh trefethen 25 example sorensen plotted level curves filter polynomials observed sometimes approximated pseudospectra ruhe showed pseudospectra could approximated rational krylov method new explicit development method approximating pseudospectra based arpack course one could also consider use dierent lowdimensional compressions matrix problem constructed jacobidavidson algorithm 22 preliminary experiments reported show kind jacobidavidson approximation pseudospectra also eective start giving overview pseudospectra calculations implicitly restarted arnoldi iteration followed practical details implementation along discussion problems deal give examples technique practice also mention matlab graphical user interface gui automates computation pseudospectra largescale computation pseudospectra 593 eigenvalues matrix computed eigs matlab computations presented paper performed using eigs matlab version 6 essentially arpack gui rather fortran arpack although initial experiments done fortran code 2 pseudospectra several equivalent ways defining pseudospectrum matrix two important see eg 27 perhaps e e e norms taken 2norm definitions equivalent min denotes minimum singular value provides basis many algorithms computing pseudospectra familiar technique use grid region complex plane interest calculate minimum singular value zi grid point z values passed contour plotter draw level curves rest paper consider 2norm norms discussed 8 28 reason cost computation pseudospectra clear amount work needed compute minimum singular value general matrix dimension n 3 see eg 5 however several techniques developed reduce cost 28 two important ones project matrix onto lower dimensional invariant subspace via eg partial schur factorization reddy schmid henningson 18 works well interesting portion complex plane excludes large fraction eigenvalues matrix case eect omitted eigenvalues interesting portion pseudospectra typically small especially undesired eigenvalues well conditioned projection significantly reduce size matrix whose pseudospectra need compute making singular value computation dramatically faster general additional cost projecting matrix much less cost repeatedly computing smallest singular value shifted original matrix perform single matrix reduction hessenberg triangular form singular value decompositions lui 12 allowing singular value calculations done using ecient algorithm one way combining ideas complete schur decomposition reorder diagonal entries triangular matrix leave wanted eigenvalues top reordered factorization truncated leaving required partial schur factorization find singular values matrices shifted grid point z using either original matrix triangular matrix allows us work solely triangular matrix 3 factorization completed minimum singular value zi determined 594 thomas g wright lloyd n trefethen 2 operations 2 using fact min zi calculated using either inverse iteration inverse lanczos iteration require solutions systems equations matrix zi solved two stages using triangular system solves combining techniques subtle refinements algorithm much ecient straightforward method suggested 28 speedup obtained typically factor n4 assuming cost schur decomposition negligible compared rest algorithm case fine grid relatively small matrix n order thousand less larger matrices schur decomposition relatively expensive destroys sparsity structure 3 arnoldi iteration arnoldi iteration matrix dimension n works projecting onto successive krylov subspaces k j dimension starting vector v 1 1 20 builds orthonormal basis krylov subspace arnoldi factorization upper hessenberg matrix dimension j columns v j form orthonormal basis krylov subspace f j orthogonal columns v j residual term f j e j incorporated first term v j h j augmenting matrix h j extra row zeros except last entry f j including next basis vector v matrix v j matrix h j rectangular size j matrix rectangular eigenvalues define pseudospectra terms singular values 23 definition occasionally used eigenvalue rectangular matrix rankdeficient rectangular matrix appropriate dimension 1 diagonal 0 elsewhere general rectangular matrix eigenvalues nonempty pseudospectra large enough shown 14 25 pseudospectra successive nested theorem 31 let n n matrix unitarily similar hessenberg matrix h let denote upper left j section particular could created using restarted arnoldi iteration 0 thus iteration progresses pseudospectra rectangular hessenberg matrices better approximate gives justification approximation unfortunately case rectangular matrices appear satisfactory theorems justify similar approximation square matrices h j course suciently small pseudospectra h j must disjoint since small sets surrounding eigenvalues h j general distinct case rectangular matrix points complex plane infinite resolvent norm unless ritz value exactly matches also used hessenberg matrices 12 advantage projection largescale computation pseudospectra 595 eigenvalue original matrix typically empty suciently small although property 32 encouraging theorems guaranteeing rapid convergence cases cannot expected quality approximate pseudospectra depends information krylov subspace turn depends starting vector v 1 guarantee rapid convergence could best probabilistic 31 implicitly restarted arnoldi basic form arnoldi process may require close n iterations subspace contains good information eigenvalues interest however information contained within hessenberg matrix dependent starting vector relatively small components eigenvectors corresponding eigenvalues quired convergence may quicker subspace size need grow large avoid size subspace growing large practical implementations arnoldi iteration restart subspace size j reaches certain threshold 20 new starting vector v 1 chosen smaller components directions eigenvectors corresponding unwanted eigenvalues process begun implicit restarting 11 23 based upon idea except subspace implicitly compressed single starting vector v 1 explicitly formed arnoldi factorization size k based new starting vector k number desired eigenvalues arnoldi factorization obtained carrying implicitly shifted steps qr algorithm shifts possibly corresponding unwanted eigenvalue estimates computation proceeds accordionlike manner expanding subspace maximum size p compressing smaller subspace 3 computationally ecient simple restarting subspace already size k iteration restarts addition process numerically stable due use orthogonal transformations performing restarting technique made arnoldi iteration competitive finding exterior eigenvalues wide range nonsymmetric matrices 32 arnoldi pseudospectra 1996 paper toh trefethen 25 demonstrated hessenberg matrix created arnoldi process sometimes provide good approximation pseudospectra original matrix provided results square matrix h j rectangular matrix choose build method around rectangular hessenberg matrices though makes pseudospectral computation harder worked square matrix advantage retain properties theorem 31 following particular every 0 approximate pseudospectrum generated arpack algorithm subset pseudospectrum original matrix completely dierent familiar situation ritz values points 0pseudospectrum square hessenberg matrix ritz values need contained true spectrum simply adding one row consider rectangular matrix obtained guaranteed inclusion every results presented toh trefethen focus trying approximate full pseudospectra matrix ie around entire spectrum use 3 use variable p follows eigs arpack sorensens original paper 23 would p 596 thomas g wright lloyd n trefethen kind restarting implementation arnoldi iteration useful theoretical idea think limited practical value computing highly accurate pseudospectra since good approximations often obtained generally large subspace dimensions work local want good approximation pseudospectra region around eigenvalues requested arpack eigs taking advantage arpacks implicit restarting keep size subspace hence reasonably small allowing us compute local approximations pseudospectra rapidly extending idea 25 fully practical technique restricted problem 4 implementation deciding use rectangular hessenberg matrix made postarpack phase algorithm dicult simple algorithm computing minimum singular value zi point approximately cost rectangular matrix square one speedup techniques described section 2 dicult translate rectangular case first idea projection lower dimensional invariant subspace make sense rectangular matrices thing invariant subspace second idea preliminary triangularization using schur decompo sition also extend rectangular matrices although possible triangularize rectangular matrix keeping singular values performing qr factorization example destroys vital property shiftinvariance see 24 however particular problem feature yet considered matrix hessenberg one way exploit property perform qr factorization matrix obtained shifting grid point upper triangular matrix r singular values shifted matrix also unchanged removing last row zeros makes matrix square use inverse lanczos iteration section 2 find smallest singular value qr factorization done 2 algorithm see eg 5 p 228 makes overall cost 2 unfortunately additional cost qr factorization stage makes algorithm slightly slower small matrices dimensions 50150 output arpack square matrices size appears price paid using matrices property 33 41 refinements cases found inverse iteration find minimum eigenvalue zi r zi r ecient inverse lanczos iteration used continuation lui 12 continuation works using vector corresponding smallest singular value previous grid point starting guess next grid point sounds like good idea two shifted matrices dier small shift singular values singular vectors similar works generally means single iteration needed satisfy convergence crite rion however lui indicates problem approach smallest second smallest singular values change places two values z iteration may converge second smallest singular value instead smallest since starting vector strong component direction corresponding singular vector leads convergence criterion satisfied wrong singular value even several iterations largescale computation pseudospectra 597 choose max subspace size plarger p better pseudospectra choose number eigenvalues klarger k better pseudospectra run arpacka p k obtain define grid region c enclosing converged ritz values grid point z perform reduced qr factorization shifted matrix z get max z lanczos iteration r r 1 random starting vector end start gui create contour plot min values allow adjustment parameters eg grid size contour levels gui fig 2 pseudocode algorithm course research found several test matrices suer problem including socalled tolosa matrix 4 accordingly desire create robust algorithm use inverse iteration theory also possible use continuation inverse lanczos iteration experiments indicate benefit small brings risk misconvergence algorithm main loop similar 28 summarized figure 2 5 practical examples one aim method approximate pseudospectra original matrix accurately perhaps important basic mission exhibiting degree nonnormality matrix arpack eigs user gets idea whether ritz values returned likely physically meaningful even cases approximations sets inaccurate great deal may still learned qualitative properties following examples arpack asked look eigenvalues largest real part except otherwise indicated however choice region complex plane focus unimportant results determined eigenvalues interest particular problem hand number requested eigenvalues k chosen rather arbitrarily large enough approximate pseudospectra clearly indicate true behavior region complex plane shown maximum subspace size p chosen ensure convergence arpack particular choice k experiments show computed pseudospectra sensitive choices k p provided large enough attempted optimize choices 51 two extremes first example figure 3 matrix market 15 shows case approximation extremely good matrix jacobi matrix dimension 800 reactiondiusion brusselator model chemical engineering 7 one seeks rightmost eigenvalues matrix highly non normal pseudospectra given approximation almost exactly match g wright lloyd n trefethen pseudospectra approximate pseudospectra fig 3 pseudospectra matrix rdb800l left computed using standard method pseudospectra upper hessenberg matrix dimension computed using arpack right 9 computer time fine grid used levels shown number matrixvector products needed arpack nv 1493 true pseudospectra around converged ritz values case pseudospectra computed running arpack indicate eigenvalues returned accurate physically meaningful investigation nec essary computation used maximum subspace dimension requested eigenvalues second case consider one matrix high degree non normalitythe grcar matrix seen figure 1 arpack converge ritz values eigenvalues perturbation order machine precision original matrix nonnormality particular matrix dimension 400 means ritz values found lie long way spectrum matrix figure 4 shows pseudospectra hessenberg matrix computed using asking eigenvalues largest modulus case good approximations pseudospectra original one typical highly nonnormal matricesthe hessenberg matrix cannot capture full extent nonnormality particularly p eigenvalues original matrix lie within region complex plane pseudospectra computed words approximation typically good areas away ritz values computed accurately approximates pseudospectra original matrix ritz values good approximations eigenvalues despite plot like figure 4 instantly indicate arpack user matrix hand strongly nonnormal needs investigation 52 moderately nonnormal example examples show two extreme cases many important applications middleoftherange largescale computation pseudospectra 599 pseudospectra arpack approximate pseudospectra fig 4 pseudospectra grcar matrix dimension 400 left computed using standard method pseudospectra upper hessenberg matrix dimension 50 computed using arpack right 8 computer time fine grid contours shown 04 03 02 04 03 02 010103pseudospectra approximate pseudospectra fig 5 pseudospectra linearized fluid flow circular pipe reynolds number 10000 streamwiseindependent disturbances azimuthal wave number machine precision sucient accurately converge eigenvalues pronounced nonnormality may nevertheless diminish physical significance good example case important matrix created linearization laminar solution navierstokes equations fluid flow infinite circular pipe 26 matrix obtained petrovgalerkin spectral discretization navierstokes problem due meseguer trefethen 16 axial azimuthal wave numbers 0 1 respectively matrix dimension 402 pseudospectra shown figure 5 although eigenvalues negative real part implying stability flow pseudospectra protrude far right halfplane implies pronounced transient growth perturbations velocity field pipe presence nonlinearities practice may lead transition turbulence 30 approximate pseudospectra also highlight g wright lloyd n trefethen 226 0505brusellator wave model crystal fig 6 left pseudospectra brusselator wave model nv 16906 right pseudospectral contours matrix dimension 10000 crystal set matrix market behavior parameters used 53 larger examples consider four larger examples first brusselator wave model matrix market confused first example models concentration waves reaction transport interaction chemical solutions tubular reactor 9 stable periodic solutions exist parameter rightmost eigenvalues jacobian purely imaginary matrix dimension 5000 using subspace dimension 100 asking arpack 20 eigenvalues obtained eigenvalue estimates approximate pseudospectra shown figure 6 left departure normality evidently mild conclusion computation ritz values returned arpack likely accurate corresponding eigenvalues physically meaningful figure 6 right shows approximate pseudospectra matrix dimension 10000 taken crystal set matrix market arises stability analysis crystal growth problem 32 eigenvalues interest ones largest real part fact see 10 13 pseudospectrum axis scale o1 indicates matrix significantly nonnormal although matrix large us able compute exact pseudospectra compar ison certainly case nonnormality could important making rightmost eigenvalues dubious physical significance application arpack parameters used case computation took one hour sun ultra 5 workstation although true pseudospectra case would expect rightmost portion fairly accurate good deal ritz data relatively little nonnormality expect leftmost portion less accurate eect remaining eigenvalues matrix unknown approximation begins become important third example figure 7 left shows airfoil matrix created performing transient stability analysis navierstokes solver 13 also matrix market case matrix appears fairly close normal picture gives every reason believe eigenvalues physical meaning using arpack took 9 hours converge eigenvalues able plot pseudospectra 3 minutes even fine grid used final example matrix bidiagonal plus random sparse entries largescale computation pseudospectra 601 04 airfoil random fig 7 left pseudospectra airfoil matrix matrix market dimension 23560 nv 72853 right random matrix nv 61347 elsewhere created matlab approximation pseudospectra matrix dimension 200000 shown figure 7 right conclude eigenvalue estimates returned probably accurate eigenvalues toward left plot would likely limited physical significance physical application one governed matrix used subspace size 50 requested 30 eigenvalues example whole computation took 26 hours 6 matlab gui created matlab gui automate process computing pseudospectra figure 8 shows snapshot run arpack initially pseudospectra computed coarse grid give fast indication nonnormality matrix gui allows control number grid points higher quality picture desired features include abilities change contour levels shown without recomputing underlying values select parts complex plane zoom greater detail gui also used graphical front end pseudospectra codes computing pseudospectra smaller general matrices codes available world wide web httpwebcomlaboxacukouclworknicktrefethen 7 discussion examples section 5 give indication sort pictures obtained technique matrices fairly close normal approximation typically close match exact pseudospectra highly nonnormal examples agreement close mainly due eect eigenvalues arnoldi iteration found eect pseudospectra typically pronounced nonnormal matrices point note use arnoldi iteration look ex g wright lloyd n trefethen fig 8 snapshot matlab gui computing pseudospectra matrix ample eigenvalues largest real part rightmost part approximate pseudospectra reasonably good approximation clearly seen figure 4 looking eigenvalues largest modulus top parts pseudospectra fairly good deteriorate lower eect unfound eigenvalues becomes important however mentioned introduction creating accurate approximations pseudospectra part motivation work equally important goal providing information help user arpack eigs decide whether computed eigenvalues physically meaningful purpose estimating degree nonnormality matrix important getting accurate plot exact pseudospectra one biggest advantages technique time spent computation grows dimension matrix increases time spent pseudospectra computation remains roughly constant pseudospectra computation based final hessenberg matrix dimension typically low hundreds figure 9 shows proportion time spent pseudospectra part computation examples presented timings based time compute initial output largescale computation pseudospectra 603 airfoil crystal grcar pipe flow rd brusselator random brusellator wave model dimension n pseudospectra time total time fig 9 proportion total computation time spent computing pseudospectra examples presented paper large n pseudospectra obtained little additional cost rd brusselator grcar fig 10 lowerquality plots pseudospectra produced gui default coarse plots take seconds matrices shown rdb800l figure grcar matrix figure 4 gui using coarse grid illustrated figure 10 standard resolution daytoday work publication quality pseudospectra resolution plots paper cost thirty times higher g wright lloyd n trefethen still much less cost arpack dimensions n thousands acknowledgments would like thank rich lehoucq advice beginning visit oxford octobernovember 1999 penny anderson mathworks inc help beta version new eigs command mark embree comments drafts paper r principle minimized iteration solution matrix eigenvalue problem vorst eds templates solution algebraic eigenvalue problems practical guide computing field values pseudospectra using lanczos method continuation stability analysis aeronautical industries matrix computations operator coe theory applications hopf bifurcation block algorithm matrix 1norm estimation waves distributed chemical systems experiments computations package httpwww computation pseudospectra continuation eigenvalue calculation procedure euler navierstokes solver applications flows airfoils hybrid iterative methods nonsymmetric systems linear equations matrix market spectral petrovgalerkin formulation pipe flow linear stability transient growth hybrid gmres algorithm nonsymmetric linear systems pseudospectra orrsommerfeld operator rational krylov algorithms nonsymmetric eigenvalue problems variations arnoldis method computing eigenelements large unsymmetric matrices numerical methods large eigenvalue problems jacobidavidson iteration method linear eigenvalue problems implicit application polynomial filters kstep arnoldi method matrix approximation problems nonsymmetric iterative methods calculation pseudospectra arnoldi iteration spectra pseudospectra pipe poiseuille flow pseudospectra matrices computation pseudospectra hydrodynamic stability without eigenvalues computational methods large eigenvalue problems numerical computation linear stability di tr ctr sh lui pseudospectral mapping theorem mathematics computation v72 n244 p18411854 october lorenzo valdettaro michel rieutord thierry braconnier valrie frayss convergence roundoff errors twodimensional eigenvalue problem using spectral methods arnoldichebyshev algorithm journal computational applied mathematics v205 n1 p382393 august 2007 kirk green thomas wagenknecht pseudospectra delay differential equations journal computational applied mathematics v196 n2 p567578 15 november 2006 c bekas e kokiopoulou e gallopoulos design distributed matlabbased environment computing pseudospectra future generation computer systems v21 n6 p930941 june 2005 computing smallest singular triplets implicitly restarted lanczos bidiagonalization applied numerical mathematics v49 n1 p3961 april 2004