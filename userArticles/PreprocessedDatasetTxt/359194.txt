dynamically relaxed block incomplete factorizations solving two threedimensional problems efficiently solve secondorder discrete elliptic pdes krylov subspacelike methods one needs use robust preconditioning techniques relaxed incomplete factorizations rilu powerful candidates unfortunately efficiency critically depends choice relaxation parameter omega whose optimal value hard estimate also strongly varies one problem another methods interpolate popular ilu modified variant milu concerning pointwise schemes new variant rilu dynamically computes variable omegaomegai introduced recently like ancestor rilu unlike standard methods robust respect existence performance top breaks problemdependence omegaopt block version dynamically relaxed method proposed compared classical pointwise blockwise methods well existing dynamic variants showing new blockwise preconditioning technique anisotropies handled effectively b introduction model problem take following selfadjoint second order elliptic pde inomega suitable boundary conditions whereomega denotes unit square 2d case cube 3d case coefficients p q r positive bounded nonnegative bounded differential operator discretized using fivepoint 2d case sevenpoint 3d case finite difference approximation point scheme box integration 30 41 mesh points ordered according lexicographic ordering one results large system linear equations form block tridiagonal pentadiagonal diagonally dominant stieltjes matrix b vector depends rhs f 11 boundary conditions u vector unknowns combined appropriate preconditioning matrix conjugate gradient method one widely used methods see eg 1 2 6 11 19 20 35 solving system 12 relaxed incomplete factorizations rilu powerful preconditioning techniques interpolate relaxation parameter popular incomplete lu factorization ilu modified variant milu preserves rowsums 4 13 opposed ilu milu two main advantages rilu following research supported commission european communities hcm contract erb chbgct930420 utrecht university mathematical institute netherlands current address de bruxelles service des milieux continus cp 1945 50 avenue fd roosevelt b1050 brussels belgium magoluulbacbe z universite libre de bruxelles service de metrologie nucleaire cp 165 50 av fd roosevelt b1050 brussels belgium ynotayulbacbe research supported fonds national de la recherche scientifique belgium mm magolu notay 1 suffer lot existence problem 13 17 18 2 robust respect discontinuities anisotropy 4 34 two major inconveniences optimal value relaxation parameter strongly varies problem another behavior could sensitive variations around observed opt 12 39 34 new variant rilu proposed relaxation parameter variable dynamically computed incomplete factorization phase like precursor rilu robust respect existence performance addition performance critically depends involved parameter intend propose block version dynamically relaxed method drbilu compare classical pointwise blockwise methods well existing dynamic variants stress even threedimensional problems consider linewise partitioning unknowns block corresponds set gridpoints along line parallel xaxis physical domain 28 study outlined follows needed general terminology notation gathered section 2 section 3 first review variants block incomplete factorizations subsection 31 32 next establish subsection 33 theoretical results motivate introduction dynamically relaxed block preconditioners comparative numerical experiments reported discussed section 4 2 general terminology notation 21 order relation order relation real matrices vectors usual componentwise order called nonnegative positive 0 22 stieltjes matrices real square matrix called stieltjes matrix equivalently symmetric mmatrix symmetric positive definite none offdiagonal entries positive 10 23 normalized point lufactorization given stieltjes matrix normalized point lu factorization understand factorization p pointwise diagonal l pointwise lower triangular diagl 24 miscellaneous symbols describe symbols used study denotes given square matrix order n transpose ith smallest eigenvalue smallest eigenvalue largest eigenvalue pointwise diagonal matrix whose diagonal entries coincide pointwise tridiagonal matrix whose main three diagonals coincide dynamically relaxed block preconditioners 3 diag block diagonal matrix whose block diagonal entries coincide offdiag e vector whose components equal 1 throughout work term block refer linewise partitioning mentioned introduction 3 blockwise incomplete factorizations simplicity throughout work consider blockwise incomplete factorizations fillin allowed outside main block diagonal part let n x n n z denote number unknowns respectively x zdirection order matrix according assumptions either block tridiagonal 2d case ie block pentadiagonal 3d case ie may split block diagonal part strictly block lower upper triangular part gammal gammal matrix p block diagonal matrix computed according algorithm 31 referred block incomplete lufactorization bilu 16 p stands normalized point lu factorization p ii choices g discussed 8 16 algorithms handle general matrices may found 8 25 given blocks iigamma1 iigamman diagonal p ii tridiagonal stieltjes matrix well known pointwise tridiagonal stieltjes may cheaply computed normalized point lu factorization follows fact gamma1 may rewritten lower part e may computed simple identification relevant entries identity performed algorithm 32 simplicity set improve performance algorithm 31 various variants proposed literature differ basic method way computing diagp ii modified satisfy rowsum relations andor keep control extreme eigenvalues preconditioned matrix b gamma1 4 21 22 26 reviewing existing block variants beyond scope study shall confine relaxed dynamically modified methods 4 mm magolu notay algorithm 31 bilu compute 3d ny igamman igamman igamman 2 lufactorization algorithm 32 e qnn normalized point lufactorization 31 relaxed block incomplete factorizations fillins neglected algorithm 31 accumulated added current main diagonal multiplication relaxation parameter 33 amounts impose following rowsum relation 22 stands pointwise diagonal matrix defined algorithm 33 words satisfies diag block 2d case 34 simplifies dynamically relaxed block preconditioners 5 algorithm 33 rbilu compute 3d ny igamman igamman igamman iigamman igamman igamman igamman igamman e 2 3d ii1 e i1 iiny e iny relaxed block incomplete lufactorization diagonal modification matrix well known multiplication p gamma1 p algorithm 33 implemented solution small linear system recovers bilu gets standard modified variant mbilu whose conditioning properties theoretically investigated ao 9 27 32 23 5 25 28 case consideration nonsingular irreducible stieltjes matrix algorithm 33 cannot breakdown gives rise nonsingular diagonally dominant stieltjes matrix later purposes note existence analysis discussed 26 32 covers incomplete factorization like pointwise counterparts standard methods suffer mainly robustness problems 17 22 25 26 34 40 optimal performances achieved 0 1 trouble opt strongly depends problem severe fact performances could highly sensitive variation around opt hard estimate 4 12 39 case 6 mm magolu notay uniform grid mesh size h directions advocated 4 use problems 4 case one see subsection 33 light theory extensively developed 9 22 23 28 32 34 one take ae n 2d case case order handle grid 39 suggested try 34 pointwise dynamic version rilu termed drilu improves performance stability respect parameter involved introduced discussing blockwise version drilu would like say words dynamically modified block methods 32 dynamically modified block incomplete factorizations standard modified method efficient nice situations eg case fixed mesh size dirichlet boundary conditions monotonous variation pde coefficients wellestablished performance strongly depends ordering strategy variations pde coefficients mesh size boundary conditions 25 28 dynamically modified methods goal general situations efficient even efficient classical modified method nice circumstances without changing numbering unknowns end small perturbations dynamically added diagonal entries p ii initially computed imposed constraints stand o1 positive parameter independent n x n n z one applies algorithm 34 following rowsum relation holds grid point j perturbation j defined algorithm 343 holds moreover one 22 26 22 26 2d case discussed proposed take extend 3d case agreement theoretical argument 9 22 23 28 32 analysis 2d case shows performances strongly depend variation opt 1 range pdes 22 26 algorithm 34 outperforms far basic block methods algorithm 33 long isotropy including strong discontinuities moderate anisotropy pde coefficients see 22 case strong anisotropy gives rise several degenerate say offlh 2 isolated smallest eigenvalues slows convergence pcg process 33 37 38 26 occurs eg case pdes involve isotropy strong anisotropy see eg 24 26 34 situation 2d case better use algorithm 35 dynamically relaxed block preconditioners 7 algorithm 34 dmbilu compute 3d ny igamman igamman igamman iigamman igamman igamman igamman igamman e e 3d e e dynamically modified block incomplete lufactorization diagonal modification matrix cancels perturbation j unsafe nodes 24 26 observe algorithm 35 reduces algorithm 34 absence strong anisotropy holds grid point j perturbation j equal j whenever j defined 0 otherwise 24 26 worth noting unsafe nodes nodes coefficients p q strongly anisotropic factor 10 algorithm 35 gives measure amount anisotropy beyond perturbations discarded 26 subsection 44 generalization algorithm 35 proposed far handle 3d problems trivial task one take account pde coefficient r contrary 2d case 24 26 easy 8 mm magolu notay establish many different possibilities respect anisotropy one drop perturbations without dramatically increasing largest eigenvalues preconditioned matrix alternative solution investigated next section main contribution work algorithm 35 dmbilu 2d case compute dmbilu endif dmbilu dynamically modified block incomplete lufactorization dropping test 33 dynamically relaxed block incomplete factorizations relaxed methods observed successfully handle strongly anisotropic problems whenever relaxation parameter properly chosen see eg section 4 unfortunately general theory provided date estimate opt pointwise variant standard rilu introduced 34 termed drilu dynamically computes variable relaxation parameters combines robustness respect variation pde coefficients optimized rilu relative insensitivity variation parameters involved dynamically perturbed methods blockwise version drilu going present section based generalization 34 theorem 51 motivated introduction drilu first give auxiliary result lemma 31 34 lemma 51 let f 0 pointwise strictly upper triangular matrix q 0 q 1 stand nonnegative pointwise diagonal matrices c matrix x positive vector c nonnegative definite dynamically relaxed block preconditioners 9 theorem 32 let stand diagonally dominant stieltjes matrix l strictly block lower triangular let p denote block diagonal diagonally dominant stieltjes matrix p normalized point lu factorization p assume diag block tridiag pointwise diagonal matrix f diag block e pointwise diagonal matrix w 1 proof first given check 312 313 imply diag block e offdiag block e diag block offtridiag next let pointwise diagonal matrix whose diagonal entries given one 0 theta gamma1 set diag block tridiag denotes pointwise diagonal matrix b 1 taking 312 account easy matter show offdiagb 1 hence follows stieltjes matrix therefore nonnegative definite 10 p stieltjes matrix p e 0 whence see 10 l gamma1 pointwise diagonal matrix defined ae one 316 xp2 denote pointwise diagonal matrices respectively application lemma 31 successively b 2 b 3 one easily shows matrices nonnegative definite hand since readily checks diag block offtridiag offdiag block delta 4 pointwise diagonal matrix whose explicit form matter 318 one diag block offtridiag e offdiag block definition see 317 one easily deduces 1 either implies gamma w 2theta therefore right hand side 319 nonnegative definite conclusion readily follows corollary 33 b corresponds relaxed block incomplete lu factorization proof apply theorem 32 defined eq 34 note since l gamma1 imply mbilu factorizations 3 dynamically relaxed block preconditioners 11 322 nothing upper bound basis dmbilu dmbilu elaborated imposing 22 24 26 alternative way achieve latter imposed upper bound consists computing p satisfy assumptions theorem 32 view 312 313 could achieved 1 computing entries p algorithm 31 block block 2 subtracting pointwise diagonal entries p quantity f defined 313 equality symbol defined 324 corresponding block preconditioner call dynamically relaxed block incomplete lufactorization drbilu described algorithm 36 note p pointwise tridiagonal stieltjes matrix therefore e may computed means algorithm 32 unlike rbilu relaxation parameter dynamically modulated function similar way perturbations added dmbilu leads us expect similar stability respect choice parameter block preconditioners discussed far parameters involved may chosen achieve upper bound say largest eigenvalues preconditioned matrix b gamma1 context pcg method convergence behavior also depends distribution smallest eigenvalues following estimate relates obtained successfully tested 7 26 31 x denotes pointwise diagonal matrix satisfies gamma1 ffl hi 1 depends weakly upon mesh size parameter h ffl rise general accurate estimates case n pointwise 7 31 blockwise preconditioners 26 one e order magnitude smallest eigenvalues mostly depends sum e x e perturbations far dmbilu dmbilu concerned one e x o1 22 26 whence follows smallest eigenvalues b gamma1 depend h ie o1 regards rbilu one 33 shows perturbations first block nodes ones oh smallest eigenvalues clearly oh therefore b gamma1 asymptotically oh gamma2 nevertheless properly chosen value rbilu performs well practice nice distribution interior eigenvalues 4 drbilu perturbations ie occur selected nodes according 324 moreover easy matter show target upper bound perturbations introduced drbilu larger ones added rbilu therefore basis 325 one may expect drbilu least robust rbilu worth noting rbilu drbilu algorithm 36 drbilu compute e 3d ny igamman igamman igamman e iigamman igamman igamman igamman igamman e igamman 2 e 3d e dynamically relaxed block incomplete lufactorization diagonal relaxation matrix perturbations direct proportion neglected fillins small occurs particular 2d problems strong anisotropy p q subsection 44 see also 328 comparison purposes let us mention far dmbilu concerned one 22 lemma 44 oh following sharp upper bound perturbations dynamically relaxed block preconditioners 13 bound could large case strong anisotropy instance 2d case p q 11 one could situation smallest degenerate eigenvalues gamma1 reproduced multiplicative constants b gamma1 see 325 number degenerate eigenvalues small ie n results slow convergence pcg process 33 case drbilu since 316 equivalent straightforward establish therefore 1jn diag block tridiag e whence follows perturbations involved drbilu never much larger ones involved dmbilu obvious considerations drbilu one tries combine advantages rbilu dmbilu observe finally case 2d problems even perturbations introduced drbilu small sum e x could larger corresponding sum dmbilu particular number j nodes perturbations dropped large enough instance order perform fair comparison give algorithm 37 version drbilu termed drbilu uses dropping test dmbilu 4 numerical experiments pcg method run zero vector starting approximate solution residual error reduction convergence criterion computations performed double precision fortran sun 514mp sparc workstation comparison purposes precondi tionings include 1 rbilu algorithm 33 four values parameter tested respectively unmodified unper turbed modified standard block methods defined eq 38 small moderate problem sizes includes 095 suggested 39 large problems includes 099 optimal observed nearest 001 minimizing number iterations 14 mm magolu notay algorithm 37 drbilu 2d case compute drbilu else endif drbilu dynamically relaxed block incomplete lufactorization dropping test 2 dmbilu dmbilu algorithms 34 35 used 1according recommendations made 26 3 drbilu drbilu algorithms 36 37 report results 4 anticipate near optimal dmbilu dmbilu 4 ilu milu popular pointwise unmodified modified incomplete lufactorizations see eg 6 5 drilu 34 pointwise dynamically relaxed incomplete lufactorization method recommended 34 parameter involved chosen target upper bound n 1 denotes space dimension first two problems dmbilu drbilu considered coincide respectively dmbilu drbilu problem 3 essentially stones problem 36 26 next three problems 3d extensions first three ones last example intended comparing behavior block pointwise methods case elongated grids non uniform mesh size arise 3d simulation problems dynamically relaxed block preconditioners 15 problem 1 2d ffl rhs linear system solve chosen function u 0 x generates solution grid problem 2 2d 40 ae 100 14 34 theta 14 34 elsewhere ae 100 14 34 theta 14 34 elsewhere problem 3 2d essentially 36 ffl coefficients p q specified fig 1 ffl rhs linear system solve chosen function u 0 x generates solution grid x region p q t0fig 1 problem 3 configuration specification pde coefficients stands positive parameter problem 4 3d omega mm magolu notay problem 5 3d ae 100 14 34 theta 14 34 theta 0 1 elsewhere ae 100 14 34 theta 14 34 theta 0 1 elsewhere problem 6 3d ffl coefficients p q r f depend xy specified fig 2 omega x region p q r1d fig 2 problem 6 configuration specification pde coefficients regions extend stands positive parameter problem 7 3d ae 1000 0 18 theta 0 18 theta 0 18 elsewhere ae 1 0 18 theta 0 18 theta 0 18 elsewhere problems last one used uniform mesh size h direction case problem 7 used non uniform rectangular grids obtained setting h ny h z 4h0 z nz function h 0 defined 025 025 05 dynamically relaxed block preconditioners 17 give tables 114 extremal eigenvalues andor spectral condition numbers well exponent assumed asymptotic relationship b gamma1 constant estimated largest two problems data say h gamma1 96 h gamma1 192 40 80 3d cases whenever min b gamma1 strongly isolated rest spectrum also include second smallest eigenvalue effective spectral condition number accounts superlinear convergence pcg method see eg 33 37 38 40 far pointwise preconditioners ilu milu drbilu concerned whose conditioning analysis investigated computed number iterations achieve prescribed accuracy order save space problems 3 6 large enough examples pde degenerate smallest eigenvalues report tables 5 11 case h case numerically computed smallest largest four eigenvalues associated block preconditioner involved pointwise jacobi diagonal preconditioner whose smallest eigenvalues connected preconditioners eq 325 also considered tables 6 13 14 number pcg iterations reach target accuracy collected problem h mesh sizes along three directions case problem 7 tables following observations made 1 expected rbilu smallest eigenvalues oh largest eigenvalues approximately oh gamma1 nevertheless oh gamma2 behavior b gamma1 compensated nice distribution interior eigenvalues 4 explains relative good performance preconditioner see tables 6 13 14 rbilu 2 dmbilu drbilu well versions smallest eigenvalues general o1 largest ones oh gamma1 effective spectral condition numbers oh gamma1 observe however case strong anisotropy problems 3 6 smallest eigenvalues associated drbilu oh whence follows effective spectral condition numbers oh gamma2 rbilu good behavior drbilu due nice distribution interior eigenvalues 3 case isotropic problems dmbilu drbilu give better results classical methods rbilu optimized rbilu winning methods perform quite similarly even strong jump pde coefficients problems 2 5 case small first eigenvalue one strongly isolated others 4 presence strong anisotropy problems 3 6 d10 3 rbilu essentially reproduce disastrous distribution smallest eigenvalues gamma1 slows convergence pcg process 33 noted rbilu eigenvalues clustered dmbilu one would expect comparing largest eigenvalues drbilu dmbilu drbilu successfully break dependence upon gamma1 reflects number pcg iterations predicted drbilu little bit efficient drbilu rbilu rate convergence mostly depends mm magolu notay distribution largest eigenvalues smallest ones known cluster around 1 5 accordance previous works 16 2d 3 28 3d blockwise linewise methods turn efficient pointwise counterparts case 2d problems reduction number iterations point methods block methods least 50 around 30 3d cases gain even spectacular case strongly anisotropic problems see table 6 problem 3b table 13 problem 6b regards computational complexity let us mention pcg iteration blockwise preconditioners needs two flops per point pointwise preconditioners rather small compared total number flops per pcg iteration 3 6 performances blockwise methods general particular dm bilu drbilu almost insensitive variation number gridpoints along xdirection say direction determines blocks see tables 12 14 quite agreement analysis performed 28 7 drbilu preconditioner always among best three ones whatever problem tested see tables 6 13 14 whenever drbilu absolutely winner far latter also observed variation parameter around 1 4 significant effect behavior preconditioners discussion together analysis made section 3 conclude promising method drbilu perfoms quite well wide range situations main merit contrary dmbilu dmbilu strongly depend dropping test set basis experiments performed fivediagonal 2d problems 24 26 dropping test involved yet extended 3d pdes performances drbilu quite satisfactory two threedimensional problems even though computations performed well structured grids natural blockwise partitionings available block methods investigated could applied finite element unstructured grids problem defining blocks irregular grids solved recently 14 15 combining techniques developed latter papers preconditoners discussed would result robust preconditioners tackle real life engineering problems awaits investigation dynamically relaxed block preconditioners 19 table problem 1 extremal eigenvalues min max andor spectral condition number b exponent corresponding estimated asymptotic relationship ch gamma c denoting constant rbilu 48 162 402 058 239 409 039 196 505 dmbilu drbilu 48 065 252 388 077 280 364 098 378 384 table problem 2 extremal eigenvalues min 2 max andor effective spectral condition number corresponding estimated asymptotic relationship denoting constant rbilu 48 2300 137 513 70e4 061 297 422 486 48 38e4 044 228 608 521 54e4 056 294 549 527 drbilu 48 76e4 066 329 435 498 20e3 085 542 271 639 mm magolu notay table problem 3 extremal eigenvalues min 2 max andor effective spectral condition number 2 b gamma1 exponent corresponding estimated asymptotic relationship ch gamma c denoting constant rbilu 48 7298 384 658 25e4 042 354 852 192 116422 614 309 57e5 011 685 640 48 13e4 024 276 115 50e5 013 322 248 drbilu 48 19e4 034 363 106 44e4 067 598 895 dynamically relaxed block preconditioners 21 table problem 3 extremal eigenvalues min 2 max andor effective spectral condition number 2 b gamma1 exponent corresponding estimated asymptotic relationship ch gamma c denoting constant rbilu 48 7302 362 750 26e4 043 314 722 48 14e4 028 245 888 11e6 37e4 384 1029 drbilu 48 19e4 034 420 124 43e4 064 649 102 22 mm magolu notay table problem 3 distribution extremal eigenvalues b gamma1 different preconditioners preconditioning smallest eigenvalues largest eigenvalues 1 1 1 1 159 204 248 368 point jacobi 3e9 59e8 17e7 46e7 2 2 2 2 table number pcg iterations achieve kr problem 1 problem 2 problem 3a problem 3b ilu dynamically relaxed block preconditioners 23 table problem 4 extremal eigenvalues min max andor spectral condition number b exponent corresponding estimated asymptotic relationship ch gamma c denoting constant rbilu dmbilu drbilu table problem 5 extremal eigenvalues min 2 max andor effective spectral condition number corresponding estimated asymptotic relationship denoting constant rbilu drbilu mm magolu notay table problem 6 extremal eigenvalues min 2 max andor effective spectral condition number 2 b gamma1 exponent corresponding estimated asymptotic relationship ch gamma c denoting constant rbilu drbilu table problem 6 extremal eigenvalues min 2 max andor effective spectral condition number 2 b gamma1 exponent corresponding estimated asymptotic relationship ch gamma c denoting constant rbilu drbilu table problem 6 distribution extremal eigenvalues b gamma1 different preconditioners preconditioning smallest eigenvalues largest eigenvalues 1 1 1 1 444 511 807 3129 point jacobi 17e9 39e7 57 e7 15e6 2 2 2 2 26 mm magolu notay table problem 7 extremal eigenvalues min max andor spectral condition number b gamma1 rbilu grid min max min max 160 theta 80 theta 40 374 302 012 106 917 62e3 75 121 dmbilu drbilu grid min max min max min max 160 theta 80 theta 40 029 106 367 033 110 324 063 153 241 table number pcg iterations achieve kr problems 4 5 6 6a problem 4 problem 5 problem 6a problem 6b ilu drilu table number pcg iterations achieve kr k2 kr 0 k2 10 gamma7 problem 7 grids a40 theta 40 theta g160 theta 80 theta 40 h80 theta 160 theta 40 grid b c e f g h 43 43 61 28 42 28 28 28 ilu 76 158 114 128 175 138 205 205 acknowledgments part work done first author holding postdoctoral position mathematical institute utrecht university thanks henk van der vorst warm hospitality suggesting include threedimensional case study thanks also due referees constructive comments r cambridge university press finite element solution boundary value problems vectorizable preconditioners elliptic difference equations three space dimensions eigenvalue distribution class preconditioning methods eigenvalue estimates block incomplete factorization methods templates solution linear systems modified incomplete factorization strategies sparse block factorization iterative methods existence conditioning properties sparse approximate block factorizations nonnegative matrices mathematical sciences survey preconditioned iterative methods fourier analysis relaxed incomplete factorization preconditioners approximate incomplete factorizations objectoriented framework block preconditioning bpkit block preconditioning tool kit block preconditioning conjugate gradient method beware unperturbed modified incomplete factorizations relaxed stabilized incomplete factorizations nonselfadjoint linear sys tems matrix computations closer solution iterative linear solvers compensative block incomplete factorizations modified blockapproximate factorization strategies analytical bounds block approximate factorization methods empirically modified block incomplete factorizations ordering strategies modified block incomplete factorizations taking advantage potentialities dynamically modified block incomplete factorizations conditioning analysis block approximate factorization methods theoretical comparison pointwise efficient planewise like preconditioners cope 3d prob lems computational methods engineering science conditioning analysis modified block incomplete factorizations convergence rate conjugate gradients presence rounding errors iterative methods sparse linear systems iterative solution implicit approximation multidimensional partial differential equations convergence behaviour conjugate gradients ritz values various circumstances rate convergence conjugate gradients iccg related methods 3d problems vector computers convergence behaviour preconditioned cg cgs iterative solution elliptic systems application neutron diffusion equations reactor physics tr