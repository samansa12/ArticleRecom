schur complement systems mixedhybrid finite element approximation potential fluid flow problem mixedhybrid finite element discretization darcys law continuity equation describing potential fluid flow problem porous media leads symmetric indefinite linear system pressure velocity vector components method solution reduction three schur complement systems based successive block elimination considered first second schur complement matrices formed eliminating velocity pressure variables respectively third schur complement matrix obtained elimination part lagrange multipliers come hybridization mixed method structural properties consecutive schur complement matrices terms discretization parameters studied detail based results computational complexity direct solution method estimated compared computational cost iterative conjugate gradient method applied schur complement systems shown due special block structure spectral properties successive schur complement matrices deteriorate approach based block elimination subsequent iterative solution well justified theoretical results illustrated numerical experiments b introduction let bounded domain r 3 lipschitz continuous boundary potential uid ow saturated porous media described velocity u using darcys law continuity equation incompressible ow p piezometric potential uid pressure symmetric uniformly positive denite second rank tensor hydraulic resistance medium represents density potential sources medium boundary conditions given n outward normal vector dened almost everywhere boundary assume domain polyhedron divided collection subdomains every subdomain trilateral prism vertical faces general nonparallel bases see eg 11 14 15 denote discretization domain e h assume uniform regular mesh discretization parameter h denote also collection faces elements adjacent work supported grant agency czech republic grant 20198p108 grant cr a2030706 revised version october 1999 seminar applied mathematics swiss federal institute technology eth zurich eth zentrum ch8092 zurich switzerland mirosammathethzch z institute computer science academy sciences czech republic pod vodarenskou vez 2 182 07 prague 8 czech republic maryskauivtcascz mirouivtcascz tumauivtcascz boundary introduce set interior faces consider following low order nite element approximation let space spanned linearly independent basis functions v e dened element e 2 e h form orthonormal respect set functionals z 5 f e k denotes kth face element e k3 outward normal vector respect face f e k velocity function u approximated vector functions linear every element e 2 e h raviart thomas space denotes restriction function v h onto element e 2 e h denote space constant functions element e 2 e h 0 e denote space constant functions face f 2 h 0 f piezometric potential p approximated space consists elementwise constant functions h j e restriction function h onto element e lagrange multipliers coming hybridization method approximated space functions constant every face h h j f denotes restriction function h onto face f 2 h analogously introduce spaces 0 n spaces functions constant every face e2e h e h respectively detailed description spaces use found 14 see also 11 15 raviartthomas approximation mixedhybrid formulation problem 11 12 reads follows see 4 find e 1 e p dh unh approximations functions p un spaces function q approximated details refer 14 11 denote number elements number interior interelement faces number faces prescribed neumann boundary conditions discretization j j let e numbered ordering set prismatic elements f k nnc ordering set nondirichlet faces h every element denote nif e number interior interelement faces nnc e number faces neumann boundary conditions imposed element e let nitedimensional space rt 0 spanned linearly independent basis functions v na denition 16 let space 0 spanned ne linearly independent basis functions nally space 0 spanned nif linearly independent basis functions k nnc raviartthomas approximation obtain system linear algebraic equations formb c b unknowns symmetric positive denite matrix block 2 r nana given terms av outdiagonal block b 2 r nane r block c 2 r nanifnnc n k outward normal vector respect face see 11 14 let us denote system matrix 112 symmetric matrix indenite due zero diagonal block dimension nnc structure nonzero elements matrix small model problem seen figure 1 partition submatrix c c 1 corresponds interior interelement faces discretized domain c 2 2 r nannc face condition incidence matrix corresponding element faces neumann boundary conditions note every column c 1 contains two nonzero entries equal 1 singular values c 1 equal 2 matrix block c 2 orthogonal columns moreover whole matrix block c also singular values equal 2 1 matrix b special structure nonzero elements correspond face element incidence matrix values equal 1 thus singular values matrix equal 5 matrix b normalization coecients orthogonal easy see denition approximation spaces see 14 15 symmetric positive denite block 5 5 block diagonal shown 15 fig 1 structural pattern matrix obtained mixed hybrid nite element approximation model problem discussed section 5 spectrum matrix block satises positive constants independent discretization parameters dependent domain tensor also easy see system matrix 112 nonsingular block b c full column rank clearly condition holds boundary conditions neumann conditions matrix block b c singular due fact sums row elements zero words function p unique constant function case assuming follows analysis presented 15 exist positive constants c 3 c 4 singular values matrix block b c moreover eigenvalues whole symmetric indenite matrix follows asymptotically positive constants independent system parameters paper solving symmetric indenite systems 112 successive reduction schur complement systems proposed consider three successive schur complement systems arising block elimination unknowns correspond matrix blocks b c 2 respectively words correspond elimination velocity variables u pressure variables p part lagrange multipliers concept reduction rst second schur complement systems well known static condensation described eg 4 section v 11 proposed reduction third schur complement system seems new main contribution paper consists detailed investigation structure nonzero entries spectral properties schur complement trices enables thorough complexity analysis direct iterative solution corresponding schur complement systems brief analysis structure rst schur complement matrix found 4 well straightforward observation principal leading block diagonal extend analysis discuss mutual relation number nonzero entries rst schur complement matrix number nonzeros system matrix 112 show llin occurs process reduction second third schur complement system moreover prove number nonzeros two schur complements always less number nonzeros 112 shown also spectral properties matrices schur complement systems deteriorate successive elimination thus approach based block reduction subsequent iterative solution well justied outline paper follows section 2 examine structural pattern resulting schur complement matrices give estimates number nonzero elements terms discretization parameters listed section 3 devoted solution whole indenite system 112 via three schur complement reductions subsequent direct solution using graph theoretical results give asymptotic bound computational complexity cholesky decomposition method applied third schur complement system section 4 concentrate spectral properties schur complement system matrices theoretical convergence rate iterative conjugate gradienttype method terms discretization parameters estimated asymptotic bounds computational work iterative solution given section 5 contains numerical experiments illustrating previously developed theoretical results finally give concluding remarks mention open questions future work 2 structural properties schur complement matrices section take closer look discretized indenite system corresponding schur complements extend brief analysis 4 several possibilities choice block ordering consecutive elimination shall concentrate block ordering seems natural ecient point view solving nal schur complement system direct solver conjugate gradienttype method ordering elimination rst two blocks used also 4 p 178181 11 note static condensation way form successive schur complements eg 17 case raviart thomas discretization closely related nodal methods studied reduction dierent second schur complement system discussed following simple result gives number nonzero elements triangular part matrix triangular part matrix mean upper lower strict triangle diagonal deal structural nonzero elements take account accidental cancellations possible initial zero values fig 2 structural pattern schur complement matrix aa figure 1 tensor hydraulic permeability structure matrix mean 0g lemma 21 number nonzeros triangular part given proof triangular part 15ne nonzeros block b contributes 5ne nonzeros c 1 2nif nonzeros c 2 contains nnc nonzeros symmetric positive denite matrix block 112 blockdiagonal 5 5 block corresponds certain element discretization domain therefore straightforward eliminate velocity variables u obtain rst schur complement system matrix aa b 11 12 13 structure matrix aa example problem shown figure 2 details also refer 4 p 180181 11 number nonzeros matrix aa show following result lemma 22 number nonzeros triangular part schur complement matrix aa equal proof clearly note llin 1 c 1 considerably higher equal 10nif ja 13 number nonzeros 23 equal finally note observe directed graph matrix b c 1 set arcs interior face ig undirected graph c adjacency relation based connectivity interior faces inside domain follows ef ef two elements e h considering relation nif putting partial sums together get desired result consider second schur complement matrix 22 23 structure aaa 11 example matrix shown figure 3 matrix block 11 rst schur complement matrix aa diagonal 4 11 following result shows worth form schur complement matrix aaa 11 matrix aa since llin appears elimination block 11 corresponding pressure variables p reduce dimension system theorem 21 22 23 proof following structural equivalences fig 3 structural pattern schur complement matrix aaa11 figure 1 previous theorem also easy see right lower block b 22 blockdiagonal blocks varying size depending number faces neumann conditions element corresponding certain element discretization following consider third schur complement matrix induced block b 22 matrix aaa 11 prove similar result one given theorem 21 therefore schur complement system matrix aaa 11 reduced schur complement matrix aaa 11 b 22 dimension equal nif without inducing additional llin moreover done using incomplete factorization procedures theorem 22 proof using theorem 21 get trivial singular case je h get desired result structb 11 following simple corollary gives number nonzero elements second third schur complement matrices aaa 11 aaa 11 b 22 shall use results later corollary 21 number nonzeros triangular part aaa 11 given number nonzeros triangular part aaa 11 b 22 given apart explicit assembly schur complement matrices using implicitly another possibility may considered keeping schur complements factorized form consider following decomposition contrast previous case local numbering faces corresponding individual elements play role case theorem 23 assume elements within diagonal blocks matrix nonzero llin faces dirichlet boundary conditions numbered rst local ordering nite element proof block structure consider individual nite elements independently minimum value nonzero count subsequent rows correspond nite element 1p easily checked minimal case therefore assume within element rst numbered faces corresponding dirichlet boundary conditions interior interelement faces nally faces neumann boundary conditions matrix 219 written form clear advantageous keep blocks 220 explicit form multiplying factors directly typical example block b diagonal matrix main question whether reduce system previous case time keep matrix blocks factorized form unfortunately one basic obstacle whereas able embed structure structure 22 cannot general express factorized form factor easily computed considered partially factorized structure 220 since important computational point view using structural prediction based factors exactly way obtain sparsity structure explicit schur complement matrices 22 ecient way implementations used procedure similar one 16 get structures 3 direct solution schur complement systems following discuss direct solution schur complement systems namely concentrate system matrix aaa 11 b 22 2 r nifnif following theorem gives bound asymptotic work necessary solve linear system 112 dominated decomposition matrix aaa 11 b 22 theorem 31 number arithmetic operations solve symmetric inde nite system 112 directly via three consecutive block eliminations using cholesky decomposition onif 2 proof give sketch proof work dominated decomposition b 12 nonzero structure 22 uniform regular nite element mesh wellshaped mesh suitable sense see 19 proof lemma 22 statements theorem 21 22 imply graph g aaa 11 b 22 also graph wellshaped mesh namely boundeddegree subgraph overlap graph see 18 19 shown 25 upper bound secondsmallest eigenvalue laplacian matrix g fiedler value order o1nif 23 using techniques 25 obtain exists onif 23 size bisector g therefore g satises socalled nif 23 separator theorem exist constants vertices g partitioned sets ga gb vertex separator gc jga j jgb j nif jgc j nif 23 moreover subgraph g satises nif 23 separator theorem technique recursive partitioning g called generalized nested dissection used reorder considered schur complement matrix provides elimination ordering onif 2 bound arithmetic work cholesky decomposition see theorem 6 12 note explicit computation matrix aaa 11 b 22 necessary framework direct methods theorem 31 provides theoretical result based spectral partitioning methods reordering algorithms based separators obtained spectral partitioning techniques applied recursively within nested dissection need necessarily best practical approach get reasonable matrix reordering nevertheless experimental results various partitioning schemes show high quality reorderings eciently computed way see 7 also reorderings combine global procedures partitioning large meshes local algorithms like mmd provide reasonable strategies nd llin minimizing permutation 4 conjugate gradient method applied schur complement sys tems section concentrate iterative solution schur complement systems discussed section 3 consider conjugate gradient method applied symmetric positive denite systems matrices aa aaa 11 22 well known convergence rate conjugate gradient method bounded terms condition number corresponding schur complement matrix 9 6 26 show condition number matrix aa asymptotically conditioning negative part spectrum whole indenite matrix moreover prove condition numbers matrices grow like 1h 2 respect discretization parameter h deteriorate successive eliminations based results estimate number iteration steps necessary achieve prescribed tolerance error norm reduction show number iteration steps necessary reduce error norm factor grows asymptotically like 1h three schur complement systems therefore total number ops iterative algorithm signicantly reduced due decrease matrix order elimination first consider following theorem theorem 41 let 1 eigenvalues positive denite block 2 r nana 1 singular values matrix block b c 2 r nanbc eigenvalues schur complement moreover eigenvalues positive denite matrix blocks 22 23 22 23 condition number schur complement system matrix aa bounded expression 4 proof positive denite matrix 1 spectrum 0 1 1 1 1na rst inclusion theorem follows following two inequalities 1 na b cx b cx similarly inequalities 1 obtain second inclusion third part proof completely analogous second part corollary 41 exist positive constants c 9 c 10 spectrum schur complement matrix aa condition number matrix aa bounded schur complement system positive denite matrix aa solved iteratively conjugate gradient method 9 conjugate residual method 6 well known conjugate gradient method generates approximate solutions minimize energy norm error iteration step 26 6 closely related conjugate residual method dier denition innerproduct hand generates approximate solutions minimize residual norm every iteration 6 also well known fact exists socalled peakplateau connection methods 5 showing signicant dierence convergence rate methods measured residual norm approximate solution paper use conjugate gradient method together minimal residual smoothing procedure applied top get monotonic residual norms 28 applying technique allows better monitoring convergence residual norm mathematically equivalent residual minimizing conjugate residual method 6 computational cost technique minimal costs two inner products one vector update per iteration framework iterative methods number operations matrixvector products usually important products performed repeatedly iteration loop contribute substantial way nal eciency iterative solver solving system schur complement matrix aa number ops per iteration unpreconditioned method dominated matrix vector multiplication matrix aa number nonzeros given lemma 22 moreover using estimates 113 114 condition number schur complement matrix aa bounded term 3 consequently number ops conjugate gradients necessary achieve reduction order assuming overestimates obtain asymptotic estimate order one 3 previous considerations take account schur complement systems matrices aaa 11 aaa 11 b 22 convergence rate iterative conjugate gradient method applied second third schur complement systems depend analogously condition number schur complement matrices 9 6 26 analysis spectrum matrix aaa 11 given following theorem theorem 42 let 1 eigenvalues positive denite block 2 r nana 1 singular values matrix block b c 2 r nanbc spectrum schur complement matrix aaa 11 consequently condition number matrix aaa 11 bounded follows proof denition schur complement matrix aaa 11 statement theorem 41 22 23 bound minimal eigenvalue obtained considering following result see 20 p201 11 12 13 interlacing property eigenvalue set symmetric matrix aa see eg 8 follows considering previous inequalities get lower bound minimal eigenvalue matrix aaa 11 completes proof shown condition number schur complement system matrix aaa 11 bounded multiple condition number matrix aa therefore number iteration steps conjugate gradient method necessary reduce error normor smoothing residual norm factor asymptotically complexity matrixvector multiplication lower according corollary 21 order assuming overestimates nif obtain asymptotic estimate one total number ops conjugate gradients conjugate residual method necessary achieve reduction factor order one 3 ne statements theorem 41 theorem 42 clear reduction schur complement systems aect asymptotic conditioning positive denite matrices aa aaa 11 true spectral properties third schur complement system matrix aaa 11 b 22 since proof completely analogous proof theorem 42 shall present following statement cf 10 p 256 theorem 43 condition number aaa 11 b 22 bounded condition number matrix aaa 11 following present two additional results concerning matrixvector multiplications schur complement matrices theorem 44 compares number nonzeros schur complement matrices aaa 11 aaa 11 b 22 number nonzeros original matrix theorem 44 number nonzero entries matrix aaa 11 matrix aaa 11 b 22 smaller number nonzeros matrix proof using fact follows lemma 21 theorem 21 clearly number nonzeros matrix aaa 11 b 22 even smaller note number nonzeros original matrix smaller larger corresponding number nonzeros matrix aa consider factorized schur complement form 220 shown also clear winner number oatingpoint operations multiply dense vector number operations get product matrix aaa 11 b 22 dense vector appropriate dimension respectively result depends shape domain boundary conditions never theless following theorem 45 shows form schur complement explicitly worth use factorized form 219 reordering schur complement theorem 23 instead implicit form theorem 45 let v dense vector number oatingpoint operations compute smaller number oatingpoint operations computeb proof taking account local ordering theorem 23 dierence two quantities bounded 2nif nnc 0 5 numerical experiments following present numerical experiments illustrate results developed theoretical part paper two model potential ow problems 11 12 rectangular domain neumann conditions prescribed bottom top domain considered dirichlet conditions preserve nonsingularity whole system matrix imposed rest boundary choice boundary conditions examples motivated application comes modelling conned aquifer see 3 two impermeable layers order verify theoretical results derived previous sections restrict attention rst simplest geometrical shape cubic domain report results obtained uniformly regular mesh renement practical situations however relatively thin aquifers possible cracks rock frequently modelled number neumann conditions may represent big portion whole boundary second model example consider rectangular domain discretized 6 layers model potential uid ow problem cubic domain discretization parameters matrix dimensions h ne nif nnc aa aaa 11 aaa 11 b 22 15 250 525 100 2125 875 625 525 110 2000 4600 400 17000 7000 5000 4600 115 6750 15975 900 57375 23625 16875 15975 120 16000 38400 1600 136000 56000 40000 38400 130 54000 131400 3600 459000 189000 135000 131400 135 87750 209475 4900 728875 300125 214375 209475 140 128000 313600 6400 1088000 448000 320000 313600 table model potential uid ow problem realistic domain discretization parameter matrix dimension 95x95x6 251560 36100 937460 395960 287660 251560 elements mesh see later reduction third schur complement proposed paper become even signicant cubic domain prismatic discretizations domains ne elements used 14 11 cubic domain discretization parameters h ne nif nnc dimension n resulting indenite system matrix dimensions corresponding schur complement matrices aa aaa 11 aaa 11 b 22 given table 1 cubic domain table 2 realistic domain note dierence dimensions second third schur complement matrix signicantly larger case modelling thin layers arise regularly application example cubic domain spectral properties matrix blocks b c well whole symmetric indenite matrix investigated extremal positive negative eigenvalues matrix extremal singular values block b c squared roots extremal eigenvalues matrix approximated reduction symmetric tridiagonal form matrix using 1500 steps symmetric lanczos algorithm 8 subsequent spectral properties system matrix blocks problem cubic domain matrix blocks spectral properties eigenvalues matrix ne spectrum sing values bjc negative part positive part 2000 033e2 02e1 0927e1 264 264 0898e1 0335e2 264 16000 066e2 04e1 0467e1 264 264 0413e1 0679e2 265 54000 099e2 06e1 0312e1 265 264 0241e1 0104e1 265 128000 013e1 08e1 0234e1 265 264 0152e1 0136e1 265 eigenvalue computation resulting tridiagonal matrix using lapack double precision subroutine dsyev 1 extremal eigenvalues diagonal matrix block computed directly lapack eigenvalue solver element element seen computed extremal eigenvalues block perfect agreement theory see table 3 similarly observe approximately linear decrease computed minimal singular value matrix block b c respect mesh discretization parameter h computed extremal eigenvalues whole indenite system conclude even mesh size parameters h rather small give rise large system dimensions see table 1 outside asymptotic inclusion set 115 indeed example mesh size interval c 1 h c 4 c 2 h c 4 exception using lemma 21 22 pp 34 see also 15 obtain inclusion set form good agreement results table 3 using technique approximated extremal eigenvalues schur complement matrices aa aaa 11 aaa 11 b 22 coming problem cubic domain table 4 seen inclusion set extremal eigenvalues rst schur complement matrix aa coincides bounds given theorem 41 see extremal eigenvalues second schur complement matrix aaa 11 bounded extremal eigenvalues matrix aa similarly extremal eigenvalues third schur complement matrix bounded extremal eigenvalues matrix aaa 11 behaviour accordance asymptotic bounds given theorem 42 theorem 43 smoothed conjugate gradient method applied resulting three schur complement systems see also discussion previous section unpreconditioned also preconditioned versions ic0 preconditioner 23 24 solution symmetric positive denite systems used solution spectral properties schur complement matrices problem cubic domain spectral properties schur complement matrices 2000 0182e1 0173e4 0251e1 0596e3 0272e1 0596e3 54000 0693e1 0579e3 0966e1 0199e3 0992e1 0199e3 128000 0293e1 0434e3 0409e1 0149e3 0417e1 0149e3 whole indenite system minimal residual method used preconditioned version positive denite blockdiagonal preconditioning ilut020 decomposition block corresponding constraints see eg 22 21 used choice ilut020 motivated eort obtain rather precise factorization restricted memory requirements close full decomposition block b c b c preconditioner found generally better denite blockdiagonal preconditioning ilut020 decomposition indenite preconditioner discussed 13 21 initial approximation x 0 set zero relative residual norm krnk used stopping criterion implementation details iterative solvers refer 6 experiments performed sgi origin 200 processor r10000 table 5 table 6 consider iteration counts cpu times minimal residual method unprecondi tionedpreconditioned applied whole system 112 conjugate gradient method unpreconditionedpreconditioned applied schur complement systems matrices aa aaa 11 aaa 11 b 22 model problem cubic realistic domain respectively dependence iteration counts presented columns table 5 corresponds surprisingly well theoretical order 3 ne convergence behaviour smoothed conjugate gradient method applied third schur complement system matrix aaa 11 b 22 case presented figure 4 results table 5 table 6 follows gain solution third schur complement system rather moderate case cubic domain case realistic domain becomes signicant 6 conclusions successive block schur complement reduction solution symmetric indenite systems considered paper shown due particular structure matrices arise mixedhybrid nite element discretization potential uid ow problem resulting schur complement matrices remain sparse moreover spectral properties deteriorate iterative conjugate gradient method successfully applied theoretical bounds number iterations conjugate gradient method problem cubic domain unpreconditionedpreconditioned cg applied matrix ne aa aaa 11 aaa 11 b 22 2000 60876 15435 8732 8032 643156 076025 030016 025014 48171191 386150 151092 130101 16000 1031138 28867 16463 15563 54000 1358188 41895 23493 22893 9269821878 104763692 39882404 37942313 128000 1637229 546122 303122 298122 table number iterations conjugate gradient method realistic model example unpreconditionedpreconditioned cg applied matrix ne aa aaa 11 aaa 11 b 22 50700 2053336 810172 448166 421166 86700 2959403 1042222 578214 543214 132300 3420447 1272271 706262 663262 iteration number relative residual norms unpreconditioned smoothed conjugate gradient method applied aaa 11 b 22 fig 4 convergence smoothed conjugate gradient method applied third schur complement system convergence rate method terms discretization parameters developed tested model problem example numerical experiments indicate given theoretical bounds eigenvalue set realistic system matrix blocks also schur complement matrices iteration counts conjugate gradient method also good agreement theoretical predictions direct solution third schur complement system also possible al ternative nevertheless comparison iterative solvers outside scope paper case structured grids geometric multigrid solver andor preconditioner solving nal schur complement system used namely stencil rst schur complement expresses elementelement connectivity domain see proof lemma 22 remains unchanged subsequent two reduction appropriate method could based another approach solution symmetric indenite systems seems promising pointed 2 classical nullspace algorithm imple mented qr factorization odiagonal block b c considered solution indenite system transformed solution block lower triangular sys tem subproblem corresponding diagonal block solved using factorization iterative conjugate gradienttype algorithm approach advantage performing matrixvector multiplication q factor using elementary householder transformations although q factor may structurally full elementary householder vectors may quite sparse moreover roundo error analysis algorithm carried 7 acknowledgment authors would like thank michele benzi careful reading manuscript anonymous referees many useful comments significantly improved presentation paper indebted jir muzak department mathematical modelling diamo se straz pod ralskem providing us model numerical example experimental part paper jorg liesen giving us reference 20 work supported grant agency czech republic grant 20198p108 grant cr a2030706 r lapack users guide siam use qr factorization sparse quadratic programming dynamics fluids porous media mixed hybrid finite element methods relations galerkin normminimizing iterative methods solving linear systems iterative methods large geometric mesh partitioning implementation exper iments matrix computations method conjugate gradients solving linear systems accuracy stability numerical algorithms generalized nested dissection sparse qr factorization applications linear least squares problems approximate schur complement preconditioning lowestorder nodal discretizations automatic mesh partitioning geometric separators schur complement statistics preconditioned iterative method saddle point problems iterative methods sparse linear systems ilut dual threshold incomplete ilu factorization spectral partitioning works planar graphs parallel iterative solution methods linear systems arising discretized pdes tr