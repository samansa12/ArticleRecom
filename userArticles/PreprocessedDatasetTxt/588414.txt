best circulant preconditioners hermitian toeplitz systems paper propose new family circulant preconditioners illconditioned hermitian toeplitz systems x b preconditioners constructed convolving generating function f generalized jackson kernels nbyn toeplitz matrix construction preconditioners requires entries require explicit knowledge f f nonnegative continuous function zero order 2p condition number known grow on2p show however preconditioner positive definite spectrum preconditioned matrix uniformly bounded except 2p1 outliers moreover smallest eigenvalue uniformly bounded away zero hence conjugate gradient method applied solving preconditioned system converges linearly total complexity solving system therefore log n operations case f positive show convergence superlinear numerical results included illustrate effectiveness new circulant preconditioners b introduction nbyn matrix n entries ij said toeplitz igammaj toeplitz systems form n occur variety applications mathematics engineering email rchanmathcuhkeduhk department mathematics chinese university hong kong shatin hong kong research supported part hong kong research grants council grant cuhk 420797p cuhk dag grant 2060143 email mhyipahkusuahkuhk department mathematics university hong kong pokfu lam road hong kong z email mngmathshkuhk department mathematics university hong kong pokfulam road hong kong research supported part hku crcg grant 10201939 7 paper consider solution hermitian positive definite toeplitz systems number specialized fast direct methods solving systems 2 operations see instance 22 faster methods requiring log 2 n operations also developed see 1 strang 21 proposed using preconditioned conjugate gradient method circulant matrices preconditioners solving toeplitz systems number operations per iteration order log n circulant systems solved efficiently fast fourier transforms several successful circulant preconditioners introduced analyzed see instance 11 5 papers given toeplitz matrix n assumed generated generating function f ie diagonals j n given fourier coefficients f shown f positive function wiener class ie fourier coefficients f absolutely summable circulant preconditioned systems converge superlinearly 5 however f zeros corresponding toeplitz systems illconditioned fact toeplitz matrices generated function zero order 2p condition numbers grow like 2p see 19 hence number iterations required convergence increase like p see 2 p24 tyrtyshnikov 23 proved strang 21 chan 11 preconditioners fail case tackle problem noncirculant type preconditioners proposed see 6 4 18 16 basic idea behind preconditioners find function g matches zeros f preconditioners constructed based function g approaches work generating function f given explicitly ie fourier coefficients f available however given finite nbyn toeplitz system ie fa j g jjjn given underlying f unknown preconditioners cannot constructed contrast wellknown circulant preconditioners strang chan preconditioners defined using entries given toeplitz matrix di benedetto 3 proved condition numbers preconditioned matrices sine transform preconditioners uniformly bounded however preconditioners may singular indefinite general aim paper develop family positive definite circulant preconditioners work illconditioned toeplitz systems require explicit knowledge f ie require fa j g jjjn nbyn toeplitz system idea based unified approach proposed chan yeung 9 showed circulant preconditioners derived general convolving generating function f kernels instance convolving f dirichlet kernel bn2c gives strang preconditioner proved positive 2 periodic continuous function f c n kernel convolution product c n f tends f uniformly gamma corresponding circulant preconditioned matrix n n clustered spectrum particular conjugate gradient method converge superlinearly solving preconditioned system result turns problem finding good preconditioner problem approximating f c n f notice bn2c f partial sum f depends solely first bn2c fourier coefficients fa j g jjjbn2c f thus strang preconditioner similarly circulant preconditioners constructed kernels require explicitly knowledge f paper construct preconditioners approximating f convolution product k m2r f matches zeros f depends fa j g jjjn k m2r chosen generalized jackson kernels see 15 since k m2r positive kernels preconditioners positive definite n comparison dirichlet kernel n positive hence strang preconditioner indefinite general prove f zero order 2p k m2r f matches zero f r p using result show spectra circulant preconditioned matrices uniformly bounded except 2p outliers smallest eigenvalues bounded uniformly away zero follows conjugate gradient method applied solving circulant preconditioned systems converge linearly since cost per iteration log n operations see 7 total complexity solving illconditioned toeplitz systems log n operations case f positive show spectra preconditioned matrices clustered around 1 thus method converges superlinearly case f multiple zeros involved considered future paper paper expanded version proceedings paper 10 preliminary results reported recently potts steidl 17 proposed skew circulant preconditioners illconditioned toeplitz systems idea also use convolution products match zeros f construct preconditioners par ticular used generalized jackson kernels bspline kernels proposed 8 construction however order guarantee preconditioners positive definite position zeros f required general may readily available contrast circulant preconditioners constructed without explicit knowledge zeros f outline paper follows x2 give efficient method computing eigenvalues preconditioners x3 show k m2r f matches zeros f analyze spectrum preconditioned matrices x4 numerical results given x5 illustrate effectiveness preconditioners solving illconditioned toeplitz systems concluding remarks given x6 2 construction circulant preconditioners let c 2 space 2periodic continuous realvalued functions fourier coefficients function f c 2 given gamma fe gammaik gammak k let n f nbyn hermitian toeplitz matrix jth entry given igammaj use c 2 denote space nonnegative functions c 2 identically zero remark toeplitz matrices n f generated f positive definite n see 6 lemma 1 conversely f 2 c 2 takes positive negative values n f non definite paper consider f positive definite hermitian toeplitz matrices say 0 zero f order p f 0 smallest positive integer f p 0 6 0 f p1 continuous neighborhood 0 taylors theorem p neighborhood since f nonnegative c 0 p must even remark condition number n f generated f grows like p see 19 paper consider f single zero general case f multiple zeros complicated considered future paper systems n f solved preconditioned conjugate gradient method circulant preconditioners well known nbyn circulant matrices diagonalized nbyn fourier matrix f n see 7 therefore circulant matrix uniquely determined set eigenvalues given function f define circulant preconditioner c n f nbyn circulant matrix jth eigenvalue given note c n f hence matrixvector multiplication f v required iteration preconditioned conjugate gradient method done log n operations fast fourier transforms clearly f positive function c n f positive definite following use generalized jackson kernel functions sin construct circulant preconditioners k m2r normalization constant gamma k m2r 1 known k m2r bounded constants independent see 15 p57 11 note k m2 fejer kernel k m4 jackson kernel 15 p57 fejer kernel k m2 expressed see instance 9 note gamma k m2 1 2 see k m2r rth power k m2 scaling hence coefficients b m2r k obtained convolving vector b m2 times done fast fourier transforms see 20 pp294296 thus cost computing coefficients fb m2r k g jkj order orm log operations order guarantee gamma k m2r normalize b m2r 0 12 dividing coefficients b m2r k 2b m2r convolution product two arbitrary functions defined g h j gamma given nbyn toeplitz matrix n f proposed circulant preconditioner 3 4 since k e ik convolution product k m2r f given k m2r k b m2r 0 otherwise clearly k m2r f depends k jkj n ie entries given nbyn toeplitz matrix n f notice 1 construct preconditioner need values k m2r f 2jn n 6 values obtained taking one fast fourier transform length n thus cost constructing c n k m2r f log n operations remark strang 21 chan circulant preconditioners 11 equal c n bn2c f c n k n2 f respectively bn2c dirichlet kernel k n2 fejer kernel see 9 3 properties kernel k m2r section study properties k m2r order see good approximation f k m2r f properties useful analysis circulant preconditioners x4 first claim preconditioners positive definite lemma 31 2 preconditioner c n k m2r f positive definite positive integers n r proof 2 k m2r positive except 2 nonnegative identically zero function k m2r f j gamma clearly positive 2 gamma hence 1 preconditioners c n k m2r f positive definite following use denote function defined whole real line r clarity use 2 denote periodic extension gamma ie 2 1 clear 2 2 c 2 first show k m2r 2p 2 matches order zero 2p 2 lemma 32 let p r positive integers r p gamma proof first two equalities 7 trivial definition 2 last equality since sin2 2 0 2 gamma z sin 2r z 0sin 2r u aez 1sin 2r u z 1sin 2r u oe aez 1u 2p du z 11 oe hand also gamma z sin 2r z 1sin 2r u setting gamma putting 11 back 9 10 8 remark using arguments 10 show ie chan preconditioner match order zeros 2p p 1 see x5 chan preconditioner work toeplitz matrices generated functions zeros order greater equal 2 next estimate k m2r 2p 2 oe oe 6 0 order first replace function 2p 2 convolution product 2p defined r lemma 33 let p positive integer theta proof prove 13 first claim definition 2 see figure 1 gamma2 gamma2 thus 16 16 see gamma gamma theta k m2r 2p similarly also 5 thus 13 prove 14 note 15 lemmas 32 33 show k m2r 2p 2 2p essentially away zero 2p 2 figure 1 functions theorem 34 let p r positive integers r p dnre exist positive numbers ff fi independent n sufficiently large n proof see lemma 33 different values oe k m2r 2p 2 oe replaced different functions hence proceed proof different ranges values oe first consider oe 2 n 2 binomial expansion gamma gamma odd k gamma k m2r tt k oe gamma2k gamma k m2r tt 2k dt 7 gamma k m2r 2p 8 c k2r bounded positive constants independent 5 r mn oem thus 18 hence 14 17 follows oe 2 n 2 case oe 2 gamma2 gamman similar case oe 2 n 2 next consider case oe 2 2 note theta k m2r 2p gamma gamma dt degree 4p polynomial without constant term 7 gamma c 2j2r thus theta c 2j2r 2 oe 2 2 theta clearly bounded independent n lower bound use fact 2 oe 2 2 19 theta k m2r 2p c 2j2r c 2j2r sufficiently large n hence large last expression bounded uniformly say 2p 2 combining 20 21 15 see 17 holds oe 2 2 n sufficiently large case oe 2 gamma gamma2 proved similar way using fact gamma obtain following corollary deals functions zero fl 6 0 corollary 35 let fl 2 gamma p r positive integers r p exist positive numbers ff fi independent n sufficiently large n extend results theorem 34 functions c 2 single zero order 2p theorem 36 let f 2 c 2 zero order 2p fl 2 gamma let r p integer dnre exist positive numbers ff fi independent n sufficiently large n proof definition zeros see x2 2 g positive continuous function g gamma write k m2r f oe deltagoe clearly last factor uniformly bounded positive constants corollary 35 holds second factor n first factor mean value theorem integrals exists 2 gamma hence g min g max minimum maximum g respectively thus theorem follows far considered interval n show convolution product k m2r f matches order zero f zero f theorem 37 let f 2 c 2 zero order 2p fl 2 gamma let r p integer dnre joe gamma flj n k m2r f proof first prove theorem function binomial theorem gamma gamma since gamma k m2r tt j joej n gamma gamma 7 8 5 hence 14 hand 22 8 5 k m2r 2p oe gamma hence 14 thus theorem holds 2 general case 2 g positive function g 2 c 2 mean value theorem integrals exists 2 gamma k m2r hence min delta k m2r 2p oe 2 gamma g min g max minimum maximum g respectively first part proof already see k m2r 2p 1n 2p joe gamma flj n hence theorem follows 4 spectral properties preconditioned matrices 41 functions zero subsection analyze spectra preconditioned matrices generating function zero need following lemma lemma 41 4 16 let f 2 c 2 n f positive definite n moreover 2 0 ff fg fi constants ff fi n x n gx next first main theorem states spectra preconditioned matrices essentially bounded theorem 42 let f 2 c 2 zero order 2p fl let r p exist positive numbers ff fi independent n sufficiently large n 2p outside interval ff fi proof function g 2 c 2 let g nbyn circulant matrix jth eigenvalue given one j j2jn gamma flj n 1 matrix rank 1 assumption positive function g c 2 use following decomposition rayleigh quotient prove theorem x n f x x n sin 2p x x n sin 2p x x sin 2p x x sin 2p x x x x x remark lemma 41 definitions 1 23 matrices factors right hand side 24 positive definite g positive function c 2 lemma 41 first factor right hand side 24 uniformly bounded similarly 23 third factor also uniformly bounded eigenvalues two circulant matrices fourth factor differ j2jn gamma flj n theorem 36 ratios eigenvalues uniformly bounded n large eigenvalues two circulant matrices last factor differ j2jn n theorem 37 ratios also uniformly bounded remains handle second factor define 2p j sin 2p gammafl ie 2p pth degree trigonometric polynomial recall function convolution product dirichlet kernel n h equal nth partial sum h ie n jgamman b j e ij hence n 2p bn2c 2p since c n bn2c 2p strang preconditioner n 2p see 9 c n 2p strang preconditioner n 2p n 2p 2p pth degree trigonometric polynomial n 2p band toeplitz matrix half bandwidth p 1 therefore n 2p definition strang preconditioner r r p pbyp matrix see 21 thus n 2p nbyn matrix r n rank 2p 1 putting back numerator second factor 24 x n f x x x x x x x n f x x r n x notice sufficiently large n except last factor factors uniformly bounded positive constants thus x n f x n large hence large n x r n q positive eigenvalues weyls theorem 13 p184 q eigenvalues c n k m2r f larger ff max using similar argument prove 2p less ff min hence theorem follows finally prove eigenvalues preconditioned matrices bounded constant independent n hence computational cost solving class nbyn toeplitz systems log n operations theorem 43 let f 2 c 2 zero order 2p fl let r p exists constant c independent n n sufficiently large eigenvalues preconditioned matrix c larger c proof view proof theorem 42 suffices get lower bound second rayleigh quotient right hand side 24 equivalently get upper bound aea gamma1 denotes spectral radius note definition 23 zero matrix given f diag j j2jn gamma flj n thus lemma 41 gamma1 positive definite thus matrix similar symmetric matrix gamma12 hence ae gamma12 gamma12 gamma12 6 theorem 1 hence last term 26 o1 remains estimate first term 26 according 25 partition gamma1 pbyp matrices 25 ae last equality follows 3by3 block matrix equation vanishing central column blocks 3 theorem 43 shown r p b 11 b 13 bounded 1 norms 1 norms hence using fact aedelta k see 27 bounded theorem follows combining theorems 42 43 number preconditioned conjugate gradient iterations required convergence o1 see 3 since pcg iteration requires log n operations see 7 construction preconditioner see x2 total complexity pcg method solving toeplitz systems generated 2 log n operations 42 positive functions subsection consider case generating function strictly positive note spectrum n f contained f min minimum maximum values f see 6 lemma 1 since f min 0 n f wellconditioned 9 shown f spectrum c f n f clustered around 1 pcg method converges superlinearly recall chan circulant preconditioner following generalize result generalized jackson kernels first easy show k m2r f oe f max thus whole spectrum c contained f min f ie preconditioned system also wellconditioned show spectrum clustered around 1 theorem 44 let f 2 c 2 positive spectrum c clustered around 1 sufficiently large n proof first prove k m2r f converges f uniformly gamma 0 modulus continuity f property see 15 p43 uniform continuity f 0 exists ffi 0 f ffi gamma gamma gamma gamma gamma bounded constant independent n cf proof lemma 32 therefore k m2r f converges uniformly f 9 theorem 1 spectrum c clustered around 1 sufficiently large n immediate consequence conclude f positive c n k m2r lambdaf used preconditioner pcg method converges superlinearly see instance 5 5 numerical experiments section illustrate numerical examples effectiveness preconditioner solving toeplitz systems comparisons also test strang 21 chan 11 circulant preconditioners following set dnre example 1 first set examples mildly illconditioned toeplitz systems condition numbers systems grow like 0 correspond toeplitz matrices generated functions zeros order see 19 illconditioning conjugate gradient method converge slowly number iterations required convergence grows like 2 2 p24 however see using preconditioner c n k m2r f 2r preconditioned system converge linearly ie number iterations required convergence independent n solve toeplitz systems n f preconditioned conjugate gradient method twelve nonnegative test functions since functions nonnegative generated positive definite remark f takes negative values n f nondefinite large n mentioned x2 construction preconditioners nbyn toeplitz matrix requires n diagonal entries fa j g jjjn given toeplitz matrix knowledge f required tests righthand side vectors b formed multiplying random vectors n f initial guess zero vector stopping criteria jjr q jj 2 jjr 0 jj residual vector q iterations tables 14 show numbers iterations required convergence different choices preconditioners table denotes preconditioner strang preconditioner 21 k m2r preconditioners generalized jackson kernel k m2r defined 2 chan preconditioner 11 iteration numbers 3000 denoted note general positive definite dirichlet kernel n positive see 9 eigenvalues negative denote iteration number pcg method apply nondefinite systems solution thus obtained may inaccurate first two test functions table 1 positive functions therefore correspond wellconditioned systems notice iteration number nonpreconditioned systems tends constant n large indicating convergence linear case see preconditioners work well convergence fast see theorem 44 9 table 1 numbers iterations wellconditioned systems four test functions table 2 nonnegative functions single multiple zeros order 2 gamma thus condition numbers toeplitz matrices growing like 2 hence numbers iterations required convergence without using preconditioners increasing like see functions chan preconditioner work expected fact order match 2 see 12 however see k m4 k m6 k m8 work well predicted convergence analysis x4 order zero 4 like two test functions table 3 condition number toeplitz matrices increase like 4 matrices illconditioned even moderate n see table strang chan preconditioners fail chan preconditioner failure also expected fact order k m2 4 match 4 12 predicted theory k m6 k m8 still work well numbers iterations required convergence roughly constant independent n table 4 test functions theory cover first two functions differentiable zeros last two functions functions slowly decaying fourier coefficients found numerically minimum values 36 79 170 362 753 1544 53 141 293 547 1113 2213 table 2 numbers iterations functions order 2 zeros 26 42 71 161 167 247 24 35 58 106 144 196 kn4 15 17 20 24 26 26 15 kn8 table 3 numbers iterations functions order 4 zeros table 4 numbers iterations functions jkj1024jkj 05 1 e ik approximately equal 03862 04325 respectively hence last two test functions approximately zero points gamma table 4 shows k m2r preconditioners still perform better strang chan preconditioners illustrate theorems 42 43 give figures 2 3 spectra preconditioned matrices five preconditioners see spectra preconditioned matrices k m6 k m8 small interval around 1 except one two large outliers eigenvalues well separated away 0 note strang preconditioned matrices cases negative eigenvalues depicted figures example 2 image restoration blurring averaging processing resulting matrix usually strongly illconditioned sense condition number grows exponentially respect size n contrast condition numbers mildly illconditioned matrices considered example 1 increasing like polynomials n regularization techniques used time mathematics engineering treat strongly illconditioned systems idea restrict solution smooth function spaces 14 approach adopted circulant preconditioned conjugate gradient method successful applied groundbased astronomy 7 illustrate idea use prototype image restoration problem given 12 strang preconditioner negative eigenvalues chan preconditioner k m4 jackson preconditioner k m6 jackson preconditioner k m8 jackson preconditioner figure 2 spectra preconditioned matrices strang preconditioner negative eigenvalues chan preconditioner k m4 jackson preconditioner k m6 jackson preconditioner k m8 jackson preconditioner figure 3 spectra preconditioned matrices consider 100by100 toeplitz matrix entries given ae 0 oe blurring matrices form called truncated gaussian blur occur many image restoration contexts used model certain degradations recorded image condition number approximately 23theta10 6 thus regularization used result obtained inaccurate experiment solve regularized least squares problem min x suggested 12 problem equivalent normal equations ffi solve preconditioned conjugate gradient method choose solution vector x entries given see 12 compute noise vector added b component noise vector taken normal distribution mean zero standard deviation stopping criteria jjr q jj 2 jjr 0 jj residual vector q iterations choose optimal regularization parameter ff minimizes relative error computed solution xff normal equations original solution x given 28 ie ff minimizes trial error found gamma6 one digit accuracy preconditioner used normal equations form ff chosen k m4 k m6 k m8 corresponding numbers iterations required convergence equal 21 33 22 22 23 respectively number iterations without preconditioning 171 relative error regularized solution 31 theta 10 gamma1 contrast 69 theta 10 2 regularization used thus see preconditioners also work strongly illconditioned systems regularized 6 concluding remarks remark even mildly illconditioned matrices condition number order matrix n illconditioned already moderate regularization also needed case system regularized preconditioner c n k m8 f work even p 6 cf example 2 x5 instance hence general circulant preconditioner c n k m8 f able handle cases whether matrix n wellconditioned mildly illconditioned illconditioned regularized r superfast solution real positive definite toeplitz systems finite element solution boundary value problems analysis preconditioning techniques illconditioned toeplitz matrices circulant preconditioners hermitian toeplitz systems toeplitz preconditioners toeplitz systems nonnegative generating functions conjugate gradient methods toeplitz systems circulant preconditioners bsplines circulant preconditioners constructed kernels circulant preconditioners illconditioned hermitian toeplitz matrices optimal circulant preconditioner toeplitz systems algorithm regularization illconditioned matrix analysis theory tikhonov regularization fredholm equations first kind approximation functions preconditioners illconditioned toeplitz matrices preconditioners illconditioned toeplitz systems constructed positive kernels preconditioning strategies hermitian toeplitz systems nondefinite generating functions extreme eigenvalues hermitian block toeplitz matrices introduction applied mathematics proposal toeplitz matrix calculations algorithm inversion finite toeplitz matrices circulant preconditioners unbounded inverses tr ctr weiming cao ronald haynes manfred r trummer preconditioning class spectral differentiation matrices journal scientific computing v24 n3 p343371 september 2005