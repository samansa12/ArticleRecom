firstorder system leastsquares helmholtz equation paper develops multilevel leastsquares approach numerical solution complex scalar exterior helmholtz equation secondorder equation first recast equivalent firstorder system introducing several field variables combination scaled l2 h1 norms applied residual system create leastsquares functional shown appropriate hilbert space homogeneous part functional equivalent squared graph norm product norm space individual variables equivalence norm decouples variables means standard finite element discretization techniques standard multigrid solvers applied obtain optimal performance however equivalence uniform wavenumber k signal degrading performance numerical solution process k increases counter difficulty obtain result characterizes error components causing performance degradation defining finitedimensional subspace components whose orthogonal complement kuniform equivalence proved functional analogous functional based l2 norms subspace equivalence motivates nonstandard multigrid method attempts achieve optimal convergence uniformly k report numerical experiments empirically confirm kuniform optimal performance multigrid solver also report tests error discretization seem confirm optimal accuracy free socalled pollution effect b introduction scalar helmholtz equation exterior radiation boundary conditions describes variety wave propagation phenomena one phenomenon electromagnetic scattering timeharmonic waves since advent stealth technology helped propel interest ecient numerical solution techniques however boundary value problems challenging indefinite nonselfadjoint hence standard numerical procedures solving generally suer poor discretization accuracy slow convergence algebraic solver accuracy improved taking meshes refined enough given wavenumber refinements impractical many problems also convergence iterative solver improved preconditioning algebraic system finding appropriate preconditioner problematic general robust iterative solvers indefinite nonselfadjoint problems dicult design received editors may 29 1998 accepted publication revised form february 16 1999 published electronically april 28 2000 work sponsored national science foundation grant dms9706866 department energy grant defg0393er25165 httpwwwsiamorgjournalssisc21533977html center applied scientific computing lawrence livermore national laboratory po box 808 l661 livermore ca 94551 lee123llnlgov applied math department campus box 526 university colorado boulder boulder co 803090526 tmanteufbouldercoloradoedu stevembouldercoloradoedu jrugeboulder coloradoedu 1928 lee manteuffel mccormick ruge standard multigrid methods exception helmholtz problems tax multigrid methods admitting certain highly oscillatory error components yield relatively small residuals components oscillatory standard coarse grids cannot represent well coarsening cannot eliminate eectively yield small residuals standard relaxation methods cannot eectively reduce compounding diculties property dimension subspace troublesome components increases increasing wavenumber k one approach ameliorate diculties cf 9 10 21 23 introduce raylike basis functions coarser grids via exponential interpolation weighting use multiple coarsening several coarse grids used given discretization level resolve error components introduction ray basis functions allows oscillatory error components represented coarser grids successive coarsening increasing controlled number grids allows full range components resolved coarser levels since magnitude wavenumber k dictates oscillatory nature error components judicious introduction exponential interpolation weighting new coarse grid problems function k leads multigrid schemes whose convergence kuniform direct application multigrid algorithm scalar helmholtz equation would generally achieve optimal discretization accuracy uniform k kuniform optimality discretization multigrid solver central aim paper multigrid algorithm applied instead carefully designed firstorder system leastsquares fosls cf 11 12 21 22 formulation helmholtz problem fosls methodology involves recasting scalar equation firstorder system introducing field variables deriving boundary conditions new variables applying leastsquares approach resulting firstorder system boundary value problem important consideration numerical solution helmholtz problems socalled pollution eect results 3 5 19 show large wavenumber k even kh 1 dispersive nature galerkin finite element discretization introduces large phase lead error term fact sharp h 1 error estimate contaminated pollution term unless k 2 h 1 stabilized galerkin leastsquares finite element method developed 3 5 19 reduce pollution eect hence ameliorate eects restrictive condition work presented fosls methodology leads minimization principle rayleighritz principle applied thus standard bases used achieve okh discretization error bounds leastsquares norm norm determined functional fosls formulation numerical results suggest pollutionfree performance achieved fosls formulationnot leastsquares norm scaled h 1 norm well thus aim paper twofold kuniform multigrid convergence factors pollutionfree discretization accuracy since fast kuniformly convergent solver dicult obtain historically primary focus work however also show final numerical experiment fosls discretization appears pollution free substantial literature available computational electromagnetics algorithms apply timedependent maxwell equations divcurl systems general include described 13 20 24 26 27 fosls helmholtz 1929 studies based firstorder system formulations helmholtz equation include 16 18 21 23 approach described 16 include curl term functional discretizations somewhat restrictive standard multigrid methods could perform well large wavenumbers expected functional 18 incorporates curl expression way achieves uniformity discretization multigrid solver analyzed fact except 21 23 basis work presented present paper none methods cited shown achieve optimal discretization accuracy multigrid convergence general literature fosls see 8 11 12 21 22 treat leastsquares functionals based l 2 l 2 combination l 2 products leastsquares functionals described next section also based norms fact analytical techniques used papers also used derive theoretical results presented techniques enable establishment several uniform norm equivalence results would possible way restrictive agmondouglisnirenberg theory cf 2 paper organized follows section 2 introduces functional setting firstorder system l 2 l 2 leastsquares formulations section 3 coercivity result l 2 defined appropriate hilbert space established using compactness argument unfortunately coercivity estimate hold uniformly respect wavenumber section 4 introduce appropriate subspace prove kuniform coercivity estimates provide intuitive basis nonstandard multigrid method developed section 5 final section report numerical tests demonstrate kuniform pollutionfree optimality discretization technique multigrid solver 2 fosls formulation let 2 bounded domain technical reasons eg scaled h 1 equivalence l 2 fosls functional cf theorems 32 42 assumed c 11 convex polygonal boundary positive measure consider exterior helmholtz boundary value problem k wavenumber f l 2 loc r denotes derivative radial direction used asymptotic sommerfeld radiation condition cf 14 solve 21 numerically unbounded domain truncated sommerfeld radiation condition approximated thus let b ball containing b c 11 boundary e region bounded e annuluslike assuming f l 2 consider reduced boundary value problem firstorder approximation sommerfeld radiation condition used assume henceforth 22 unique solution h introducing field variable k p 22 recast firstorder system l firstorder operator corresponding 23 note 23 essentially scaled form maxwells equations reduced assuming transverse magnetic wave solution variable p gives electric field variable u gives magnetic field analyze 23 corresponding leastsquares formulations several functional spaces required nonnegative integer let h denote usual sobolev space order norm denote usual sobolev trace space norm cf 1 let denote l 2 inner product following spaces scaled h 1 norm needed 0d boundary condition imposed definition w taken trace sense finally let h 0d denote completion l 2 respective inverse norms w w 1k fosls helmholtz 1931 0d w w 1k well known cf 17 hdiv h 1 hilbert space norm thus also hilbert space norm using continuity trace operators h 2 hdiv easy see w also hilbert space k norm cf 22 define l 2 l 2 leastsquares functionals f f 1d respectively functionals incorporate curl terms essentially increase complexity f moderate increase g allow simplified finite element discretization multigrid solution processes brevity equivalence results next two sections focus g state prove analogous h 1k equivalence results f cf 21 detailed proofs similar results 3 nonuniform coercivity w3 compactness argument cf 7 8 used establish equivalence homogeneous part l 2 leastsquares functional gu p 0 square product norm 2 1k follows c denotes generic constant may change meaning occurrence independent k notation c k used section dependence k may occur theorem 31 exist constants c c k u p w 1932 lee manteuffel mccormick ruge proof let u p w prove upper bound note triangle inequality yields 1d integration parts triangle cauchyschwarz inequalities trace theorem inequality give 0d w 1k 0d u w 1 w 1k 0d w 1k 0d w 1k 0d also integration parts boundary condition h 1 give w 1k w 1k w 1k u finally p 1d p p 1k upper bound follows 3134 prove lower bound let w completion w u norm prove first fosls helmholtz 1933 w5 note triangle inequality used twice 34 yield hence 35 would follow could shown end note integration parts producesk 2 p moreover since 1 real righthand side 38 must real together triangle inequality complex modulus arithmetic cauchyschwarz inequalities yieldsk 2 p bound 35 holds w1 prove 1934 lee manteuffel mccormick ruge w contradiction suppose 39 hold exists sequence w rellich selection theorem cf 7 implies p j p p l 23 35 310 shows cauchy sequence 1k limit u p also consider scaled helmholtz equation corresponding bilinear form 0d integration parts gives convergence p j p 1k norm cauchyschwarz inequalities 310 imply lim fosls helmholtz 1935 equivalently solution uniqueness 311 finally 35 follows contradiction thus 39 must hold theorem follows restricting bound subspace analogous result f essentially obtained using helmholtz decomposition u proof similar proofs thorems 35 45 21 thus included theorem 32 exist constants c c k u p w theorems show homogeneous parts functionals f g bounded constant c coercive constant 1 ck w unfortunately coercivity constant depends wavenumber k means standard numerical solution processes degrade performance k increases next section subspace w introduced prove coercivity constant independent k 4 uniform coercivity z 2 fundamental problem helmholtz equation approximate fourier components wavenumbers near k produce relatively small residuals oscillatory components near nullspace 21 degradation usual sense ellipticity also present system 23 means homogeneous parts respective functionals g f equivalent square product norms 2 1k 1k uniformly k however see troublesome functions treated specially multigrid coarsening finite element approximation processes guide design processes section establish equivalence results subspace w excludes nearnullspace components end note 1936 lee manteuffel mccormick ruge dense subspace h 1 0d see 6 corresponds range inverse laplace operator n07 operator 41 selfadjoint exists l lim j isolate nearnullspace components h 1 0d2 let 0 1 given define spaces k 2 z use span mean finite linear combinations overbar denote closure h 1k norm subspace z w0 closed k norm avoids oscillatory nearnullspace error components system 23 yield small residuals hence subspace uniform equivalence statements made leastsquares norms corresponding g f square roots homogeneous parts respective product norms 2 theorem 41 let 0 1 given exists constant c independent k u p z proof upper bound follows theorem 31 fact z w proof lower bound rests observation z contained closure z 0 product norm 2 1k proof analogous upper bound theorem 31 shows gu p 0 continuous z norm therefore sucient establish lower bound u p z 03 end consider helmholtz decomposition cf 12 fosls helmholtz 1937 2 divergencefree n e substituting decomposition gu p 0 using l orthogonality property decomposition divergencefree property also integration parts cauchyschwarz inequality give 0d w 1k 0d w 1k triangle inequality 44 yield gives positivedefinite selfadjoint p easy verify bound 1k hence 43 45 46 imply u p z 01 finally combining 47 triangle inequality restriction 1 obtain 4 1938 lee manteuffel mccormick ruge lower bound follows 47 48 state analogous result f without proof theorem 42 let 0 1 given k 1 exists constant c independent k u p z remark 41 coercivity constant theorem 42 uniform k dimension z grows k fixed however troublesome components still specially treated multigrid coarsening process without increasing order complexity show next section 5 nonstandard multigrid basic concepts section taken inspired work achi brandt cf 9 brandt livshitz 10 l 2 functional f applies usually practical l 2 functional g involves somewhat cumbersome negative norms rea son remaining two sections focus minimizing f u p f rayleighritz finite element method used discretization process let h triangulation domain finite elements maximal length let w 1 finitedimensional subspace w approximation property v q h w discrete fine grid minimization problem following find equivalently defining bilinear form u p v q w discrete fine grid variational problem following find f v 1 standard multilevel scheme solving either discrete problems fairly straightforward let conforming sequence coarsenings triangulation h fosls helmholtz 1939 set nested coarse grid subspaces w 1 finest subspace suitable generally local basis w j referred level j given initial approximation level j level j relaxation sweep consists following cycle chosen minimize b c meant f quadratic function local minimization procedure simple inexpensive see 23 25 fact minimization process block gaussseidel iteration blocks determined choice b recalling l firstorder operator corresponding 23 block system expressed given fine grid approximation level 1 level 2 coarse grid problem find correction obtained fine grid approximation corrected according applying process recursively yields multilevel scheme usual way unfortunately coarser level basis functions chosen natural way coarse grid correction process may eective fosls formulation helmholtz equation diculties arise error components elements z specifically trouble arises error components approximate form sin e kx cos sin 0 2 main problem grid type highly oscillatory hence poorly approximated standard 1940 lee manteuffel mccormick ruge coarse grids yet produce small residuals therefore poorly reduced relaxation compounding problem principle infinitely many components since virtually angle 0 2 precisely k increases dimension z consists elements approximately form 56 fortunately problems circumvented introducing exponential interpolation multiple coarsening multilevel scheme 10 23 exponential interpolation exponential interpolation used approximate troublesome oscillatory error components approximate form 56 ray e kx cos sin problematic factor form useful characterization error components given sx ye kx cos sin sx smooth function satisfying appropriate boundary conditions j components product space w j assumed concreteness consist continuous piecewise bilinear functions spaces generally dier boundary also let level j correspond grid fine enough relative k components 57 adequately approximated bilinear functions although marginally sense approximation begins deteriorate level j 1 exact coarse level correction level j assumed eective eliminating smooth components left relaxation level j 1 level however ability bilinear functions approximate components 57 deteriorates enough contaminate twolevel performance levels j heuristics show occurs 2 approximate exponential components levels j basis functions simply rescaled ray elements sin specific fix 0 2 l denote entry number element number standard basis b l level l define level j ray element l l element w agrees e kx cos sin level j node values e level j nodal interpolant e kx cos sin eect altering usual bilinear interpolation formula relates coarse fine node values rays better approximated fact ensures level j interpolant given ray range interpolation coarser levels determined corresponding figure 51 sketches real part onedimensional level 3 basis function 3 typical ray basis element e determined oscillatory level 1 ray assuming simplicity note exponential interpolation much costly bilinear inter polation given function level l j bilinearly interpolated level j simply rescaled e kx cos sin level j nodes multiple coarsening consider case level j approximation components 57 begins deteriorate may enough introduce one ray eg sense exact correction level might adequately correct smooth level j error however perhaps eective introduce coarse grids one say four rays eg fosls helmholtz 1941 ray h fig 51 onedimensional real parts typical standard 3 basis function e basis element critically level coarsened scale k2 j1 h doubles essentially twice many rays become oscillatory specific suppose angles corresponding two neighboring level j rays sense two rays used coarsen level perhaps others none needed angles 1 2 level one ray coarsening ray angle 1 2will poorly reduced relaxation poorly approximated level j grids means twice many rays must somehow used coarsening level turn require ray doubling level accomplished eectively introducing two separate ray coarsenings level may come ray coarsening suppose level created level j ray angle task coarsen level using rays angles one way accomplish introduce level ray j2 oscillates level j scale applying operator function generally require level j evaluations alternatively ray coarsenings eciently introduced using intermediate level suppose level j rays j1 already introduced level j 1 since e kx cosy letting e j denote level j interpolant ray perturbation e kxcoscos ysinsin means perturbed rays computed directly level appealing level j particular since level j2 constructed exponentially interpolating level figure 52 sketch 1942 lee manteuffel mccormick ruge process creating level 3 ray basis function levels 1 2 hence given operator assuming constructed ray basis level j 1 j2 constructed exponentially weighting c c weighting elements 59 exponential weights c recursively applying exponential weighting process analogous coarser level calculations computed without appealing level j solved coarse grid problem solution exponentially interpolated level j using angle perturbations recursive way example j2 solution level problem corresponding perturbation j2 interpolated level j first exponentially interpolating level exponentially interpolating result level j using since exponential interpolation consists standard bilinear interpolation exponential scaling successive interpolation process easy implement moreover since exponential interpolation operator adjoint exponential weighting operator exponential weighting also easy implement angles angles cannot arbitrary must chosen optimal number exponential components adequately approximated perturbed ray elements describe selection procedure assume rays first introduced level j 1 obtain adequate approximation simple tedious analysis 21 shows perturbation angle must chosen following approximation within level j discretization error j2 example 2 level 3 angle perturbations must depicted figure 54 angle perturbations simply halved successively finer level nonstandard multigrid scheme computational cost exponential terpolationweighting multiple coarsening essentially required fosls helmholtz 1943 ray 2h perturbed ray hfig 52 level 3 ray element determined perturbation corresponding angle level 2 ray element level j1 level j level j1 level j2 fig 53 multiple coarsening develop eective nonstandard multigrid scheme helmholtz equation components ray basis elements naturally introduced nonstandard multigrid scheme form standard multigrid scheme defined 52 55 see assume rays first introduced level perturbation angles determined multigrid cycling begins choose j largest integer satisfying since guarantees essentially 8 grid points per wavelength piecewise bilinear approximation level j levels l j nested spaces still consist products piecewise bilinear functions levels l must introduce product ray element spaces l span r 1944 lee manteuffel mccormick ruge level 3 angles level 2 angles fig 54 angle choices uniformly distributed level 2 level 3 rays l total number rays introduced level l r angle rth ray r corresponding perturbed vector ray basis introduced level l first introduce four rays level double number successively coarser level note l perturbation angle r levels l j relaxation defined 52 b l c l standard basis w l levels l j level l problem find u l1 p l1 w l1 v l1 q l1 w l1 l level l approximation however ray levels l j relaxation defined 52 b l c l product ray basis element r l levels l j two level l problems corresponding r find u l1 v l1 q l1 w l approximation level l angle r note level l angle r corrected two level l actually four gives structure multigrid process scheduling determines various levels visited best described studying schematic figure 55 continue refer process v cycle although looks dierent standard vcycle level j nonstandard multigrid scheme interpreted multilevel multiplicative schwarz method cf 28 level j coarse grid problem involves subspace corrections standard finite element space w j ray subspaces l l j also relaxation ray spaces simply block gaussseidel iteration fosls helmholtz 1945 level j1 level level j1 level j2 fig 55 vcycle nonstandard multigrid scheme 53 b l c l r l since lr l computed eciently using exponential weighting elemental block matrices stencils l lr l fact stencils computed stored prior multigrid cycling relaxation routine used levels angles assuming stencils computed stored multigrid cycling occurs computational cost multiple coarsening algorithm generally excessive fact one multilevel vcycle requires several fine grid work units cost fine grid relaxation example consider worst case four rays introduced level 2 need rays would signal level h coarse relative k discretization accuracy would almost meaningless fact need four rays level 2 already sign level 1 accuracy quite poor level j 2 would total 2 j level j problems also j assumed stepsize doubled coarsening number fine grid work units required relaxation 2 2j2 omitting cost ray interpolation substantial proportional number points minor operations total number fine level work units nonstandard v 1 0cycle double cost standard v 1 0cycle 6 numerical examples simplicity facilitate comparisons examples treated unit square lack dirichlet boundary fact severe test methodology sense results include multigrid performance standard nonstandard schemes described 1946 lee manteuffel mccormick ruge table standard coarsening v 1 0cycles table standard coarsening twolevel cycles previous section also assess accuracy discretization based raytype elements facilitate assessment iterative solver first restrict homogeneous boundary value problem 22 exact solution course useful measuring asymptotic algebraic convergence factors stationary linear iterative methods multigrid methods since avoids limiting stagnation caused machine representation unit square partitioned rectangles functional f minimized space piecewise continuous bilinear functions possibly involving rays satisfy boundary condition cases finest grid chosen satisfy 8 rays first introduced level 8 typically relaxation scheme nodal gaussseidel relaxation block gaussseidel block consists unknowns u h node assess worstcase convergence factors twenty multigrid v10cycles one relaxation none coarsening performed starting random initial guess convergence measure defined superscript parentheses denotes iteration number tables 61 62 respectively summarize results twenty v 1 0 twolevel cycles standard bilinear elements table 61 confirms convergence degrades function k due troublesome oscillatory error components present coarser levels table 62 shows poissonlike obtained kh large comparing table 61 indicates rays introduced soon kh 1 tables 63 64 show multigrid convergence factors improve substantially introducing ray functions exact rays intro fosls helmholtz 1947 table exact ray 0cycles table exact ray cycles 3 table approximate ray 0cycles table approximate ray delayed kh 1 0cycles duced kh 1using algorithm described previous section factors fairly uniform k compare favorably twolevel factors standard coarsening moreover degrade slightly exact rays approximated using recursive scheme described previous section see table 65 test eect introducing rays late multigrid solver reran examples delayed use rays kh 1 expected rates degrade noticeably tables 66 67 show measure discretization accuracy ran tests see fosls scheme pollution eects specified exact solution 5 sin solves 22 except boundary condition inhomogeneous 5 sin 5 sin 1948 lee manteuffel mccormick ruge table approximate ray delayed kh 1 0cycles table discretization error leastsquares functional norm table relative discretization error scaled h 1k norm khh 11111 used fosls scheme approximate p scaled gradient u k p isolate possible pollution chose various h varied k kh constant 164 errors measured comparing discrete approximation obtained applying several multigrid cycles exact solution relative sense leastsquares product h 1k norms tables 68 69 essentially show constant discretization errors constant kh factor 2 decrease kh halved consistent assertion approach pollutionfree okh respectively r new york estimates near boundary solutions elliptic partial di generalized finite element method solving helmholtz equation two dimensions minimal pollution partition unity method pollution e expansions eigenfunctions selfadjoint operators finite elements theory leastsquares approach based discrete minus one inner product first order systems stages developing multigrid solutions finite element method solution maxwells equations multiple media inverse acoustic electromagnetic scattering theory partial di numerical methods acoustic problems finite element methods navierstokes equations finite element solution helmholtz equation high wave number multilevel firstorder system leastsquares fosls helmholtz equations multilevel projection methods partial di mixed method approximating maxwells equations electric magnetic problems vector fields anisotropic nonhomogeneous media iterative methods space decomposition subspace correction tr ctr jan mandel mirela popa iterative solvers coupled fluidsolid scattering applied numerical mathematics v54 n2 p194207 july 2005 jan mandel iterative substructuring method coupled fluidsolid acoustic problems journal computational physics v177 n1 p95116 march 20 2002