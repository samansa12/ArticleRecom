multigrid method enhanced krylov subspace iteration discrete helmholtz equations standard multigrid algorithms proven ineffective solution discretizations helmholtz equations work modify standard algorithm adding gmres iterations coarse levels outer iteration demonstrate algorithms effectiveness theoretical analysis model problem experimental results particular show combined use gmres smoother outer iteration produces algorithm whose performance depends relatively mildly wave number robust normalized wave numbers large 200 fixed wave numbers displays gridindependent convergence rates costs proportional number unknowns b introduction multigrid algorithms effective numerical solution many partial differential equations providing solution time proportional number unknowns important classes problems however standard multigrid algorithms useful paper focus developing effective multigrid algorithms one class discrete helmholtz equation main interest lies solving exterior boundary value problems form onomega ae r 11 omega 12 arise modeling timeharmonic acoustic planepolarized electromagnetic scattering obstacle boundary gamma represents scattering obstacle boundary operator b chosen dirichlet neumann robin boundary condition imposed original unbounded domain truncated finite domainomega introducing artificial boundary gamma 1 radiation boundary condition 13 approximates outgoing sommerfeld radiation condition depending type radiation condition chosen either local differential operator global integral operator coupling points gamma 1 see 14 data problem given right hand side f boundary data g common case f j 0 gammag boundary data incident plane wave critical parameter wave number k positive case unattenuated wave propagation due radiation boundary condition solution 1113 complexvalued function u discretization 1113 finite differences finite elements leads linear system equations coefficient matrix complexsymmetric ie hermitian moreover large values wave number k becomes highly indefinite indefiniteness recently prevented multigrid methods applied solution discrete equations success methods enjoyed symmetric positive definite problems illustrated section 2 difficulties standard multigrid methods applied helmholtz problems concern main multigrid components smoothing coarse grid correction particular standard smoothers jacobi gauseidel relaxation become unstable indefinite problems since always error components usually smooth oneswhich amplified smoothers difficulties coarse grid correction usually attributed poor approximation helmholtz operator coarse meshes since meshes cannot adequately resolve waves wavelength solution primarily consists show however although coarse grid correction inaccurate coarsegrid eigenvalues agree well finegrid counterparts coarse meshes still yield useful information multigrid cycle paper analyze test techniques designed address difficulties smoothing coarse grid correction helmholtz equation smoothing approach use standard damped jacobi relaxation works reasonably well fine enough grids replace krylov subspace iteration fails smoother earlier work bank 2 brandt taasan 11 employed relaxation normal equations context krylov subspace smoothing principally using conjugate gradient method considered variety authors 3 7 8 27 29 coarse grid correction identify type number eigenvalues handled poorly correction remedy difficulty introducing outer acceleration multigrid use multigrid preconditioner outer krylov subspace iteration approach used many authors eg 28 31 problems coarse grid restricted fairly fine also used settings 20 23 krylov subspace method option smoother outer iteration use gmres 25 contrast many multilevel strategies 2 6 9 31 resulting algorithm requirements coarse grid sufficiently fine approaches based preconditioning indefinite problems preconditioners leading term see 4 5 15 32 recent work brandt livshits 10 developed effective multigrid approach helmholtz equation based representing oscillatory error components coarse grids product oscillatory fourier mode smooth amplitudeor rayfunction standard vcycle augmented socalled ray cy cles oscillatory error components eliminated approximating associated ray functions multigrid fashion waveray methodology also combined lee et al 21 firstorder system leastsquares formulation helmholtz equation approaches require construction bookkeeping extra grids associated ray functions outline paper follows section 2 perform model problem analysis using onedimensional problem identify difficulties encountered smoothers coarse grid correction supplementing observations analysis dimensionality problem affects computations section 3 present refined multigrid algorithms test performance set twodimensional benchmark problems square domain particular demonstrate effectiveness automated stopping criterion use gmres smoothing show combined use gmres smoother outer iteration produces algorithm whose performance depends relatively mildly wave number robust wave numbers large two hundred section 4 show performance multigrid solver exterior scattering problem finally section 5 draw conclusions 2 model problem analysis deficiencies standard multigrid methods solving helmholtz problems seen onedimensional model problem therefore consider helmholtz equation unit interval 0 1 homogeneous dirichlet boundary conditions problem guaranteed nonsingular k 2 eigenvalue negative laplacian assume requirement holds problem indefinite smallest eigenvalue negative laplacian finite difference discretization 21 uniform grid containing n interior points leads linear system equations 14 n theta n coefficient matrix denotes mesh width denotes identity matrix assumptions k wellknown see 26 sufficiently fine discretizations discrete problems also nonsingular also assume coarse grid problems nonsingular eigenvalues eigenvectors 2h sin ijh n choice dirichlet boundary conditions 21 allows us perform fourier analysis using analytic expressions eigenvalues eigenvectors experiments described section 3 examine observations coincide performance problems radiation conditions nonsingular k 18 aspects algorithm depend dimensionality problem considered end section 21 smoothing smoothing operator consider damped jacobi laxation defined stationary iteration em um denote residual error vectors step respectively denotes matrix consisting diagonal damping parameter associated error propagation matrix eigenstructure matrix governs behavior error em since multiple identity matrix polynomial hence shares system orthonormal eigenvectors 23 eigenvalues thus eigenvalue j damping factor error component corresponding eigenvalue j consider effects damped jacobi smoothing three levels grids fine coarse intermediate 211 fine grids fine grid mesh size determined accuracy requirements discretization allows us make certain assumptions size h versus k fine grid recall wavelength associated timeharmonic wave wave number k 0 given 2k quantity number mesh points per wavelength measures approximability solution given mesh commonly employed engineering rule thumb 17 states secondorder finite difference linear finite element discretization equivalently kh 5 25 required enforce 25 experiments also note reasons stability bound quantity h 2 k 3 also required 18 high wave numbers bound restrictive bound kh consequence 25 quantity multiplying smoothing parameter 24 vary gamma14 94 smoothing results slight amplification oscillatory modes well smoothest modes one adjust oscillatory mode damped case long effective smoother usually chosen maximize damping oscillatory half spectrum leads choice equal familiar optimal value 23 laplacian 22 p 11 smoothest mode amplified positive choice discrete problem indefinite case discrete helmholtz operator seen 24 smoothmode eigenvalues become larger one magnitude h increased thus making damped jacobias well standard smoothersincreasingly unstable mesh coarsened figure 21 shows damping factors j eigenvalues j wave number grid 31 maximal amplification occurs smoothest mode corresponding leftmost eigenvalue amplification factor approximately equal figure 22 shows ae varies kh limiting largest amplification factor say ae 11 would lead mesh size restriction kh 052 somewhat stronger 25 one also observes kh 6 mode damped summary situation finest grids similar positive definite case except small number amplified smooth modes whose number amplification factors increase mesh coarsened l fig 21 damping factors damped jacobi relaxation plotted eigenvalues kh fig 22 variation dampingamplification factor smoothest mode function kh 212 coarse grids mesh coarsened eigenvalues correspond larger eigenvalues underlying differential operator disappear discrete problem small onesthose smooth eigenfunctions remain means fixed k large enough differential problem indefinite coarsening level eigenvalues negative model problem 21 occurs kh 2 cosh2 fixed k negative definite case damped jacobi iteration convergent spectral radius minimized would permit use undamped jacobi smoother coarse grids shall make use 213 intermediate grids remains difficult case values kh problem yet negative definite large number smooth modes amplified damped jacobi relaxation jacobi smoothing standard smoothers therefore longer suited becomes necessary use different smoothing procedure 11 16 proposed replace classical smoothers kaczmarz iteration gauseidel relaxation applied symmetric positivedefinite system aa auxiliary variable v defined method advantage amplifying modes suffers drawback damping oscillatory modes weak following section propose using krylov subspace methods gmres smoothing methods possess advantage reducing error components sides imaginary axis without resorting normal equations 22 coarse grid correction rationale behind coarsegrid correction smooth error components well represented coarser grids hence sufficiently good approximation error obtained approximating fine grid residual equation using analogous system coarser mesh assumes error consists mainly smooth modes solution coarse grid residual equation close counterpart fine grid section present analysis goes wrong helmholtz problem 221 amplification certain modes assume number interior grid points fine grid odd consider next coarser mesh interior points identify r n r n respectively spaces grid functions two meshes vanish endpoints indicate mesh vectors associated using superscripts h h let e fine grid error let r denote residual let denote coarse mesh size let coarsetofine transformation given interpolation operator h theta h following indication go wrong exact coarse grid correction given 11 consider finegrid error e consisting smoothest eigenvector v h h associated eigenvalue h finegrid residual thus given r since assuming v h smooth restriction r h h h coarse grid close eigenvector coarsegrid operator h respect slightly different eigenvalue h coarse grid version correction h hence error fine grid correction assumed smooth mode v h invariant restriction followed interpolation tells us assumption restrictions smooth eigenvectors eigenvectors h quality correction depends ratio h h two equal correction perfect relative error large correction arbitrarily bad occurs whenever one h h close origin moreover h h opposite signs correction wrong direction go beyond existing analysis examine eigenvalues problematic sense finite differences similar analysis also performed linear finite elements consider coarsegrid eigenfunctions v h understand effects interpolation grid functions fine grid must examine first n finegrid eigenfunctions fv h complementary modes fv h related theta v h theta v h easily verified holds 12 h c j cos jh2 j sin jh2 full weighting used restriction operator h componentwise theta h theta theta relation h following mapping properties easily established h c j j defined h denotes coarsegrid discretization matrix corrected iterate possesses error propagation operator c gamma h h h denoting eigenvalues h h f h respectively may summarize action c eigenvectors using 29 follows theorem 21 image finegrid eigenfunctions fv h error propagation operator c exact coarse grid correction given consequence twodimensional spaces spanned smooth mode complementary mode invariant following result shows dependence matrices c j theorem 22 using notation defined holds moreover lim proof 213 214 simple consequences 212 representation 22 eigenvalues h application error propagation operator smooth mode v h entries first column c j small mode damped coarse grid correction however 1 1entry large mode amplified 2 1entry large somewhat less likely smooth mode corrupted complementary mode seen 213 difficulties occur whenever h small magnitude limits 214 evident problems arise symmetric positivedefinite case fact wellknown also occur kh large ie coarse grid helmholtz operator negative definite observations extended returning 28 using 22 wherein holds coarsegrid correction strongly damps smooth error modes either small large values kh may fail intermediate range associated smooth mode also note limit eigenvalues c j 0 1 c j projection case projection orthogonal respect inner product induced symmetric positive definite operator h projection property lost k 0 since coarse grid operator defined fails satisfy galerkin condition h h h h galerkin condition however satisfied eg finite element discretizations interpolation inclusion moreover regardless type discretization term h orthogonality ceases makes sense k sufficiently large h indefinite 222 number sign changes section discuss number eigenvalues undergo sign change coarsening process thereby inhibit effectiveness coarse grid correction aspect algorithm significantly depends dimensionality problem thus considering helmholtz equation 11 ddimensional unit cube 0 1 homogeneous dirichlet boundary conditions consider standard finite differences second order threepoint fivepoint sevenpoint discretization laplacian one two three dimensions respectively well class low order finite elements consisting linear bilinear trilinear elements first state issue precisely using finite differences dimensions eigenvalues discrete operator grid mesh size h n grid points direction sin fixed multiindex eigenvalue welldefined function h converges corresponding eigenvalue differential operator h 0 concern indices function changes sign troublesome eigenvalues treated correctly coarse grid correction mesh coarsened oscillatory modes j n2 represented next coarser mesh smoothmode eigenvalues f h g slightly shifted left respect finegrid counterparts f h g eigenvalues change sign point coarsening process following theorem gives bound function k maximal number eigenvalue sign changes occurring grids theorem 23 finite difference discretization helmholtz equation dirichlet boundary conditions unit cube dimensions 3 number eigenvalues undergo change sign multigrid coarsening process bounded 3 finite element discretizations number sign changes bounded pj 3 proof finite differences let fine denote number negative eigenvalues given fine grid let lim denote number negative eigenvalues continuous helmholtz operator eigenvalues 216 index shift right left grid coarsening follows equality fine enough grids discrete eigenvalues tend continuous ones identify lim consider continuous eigenvalues convenient view indices eigenvalues lying positive orthant ddimensional coordinate system negative eigenvalues contained intersection orthant ddimensional sphere radius k centered origin let n denote intersection let n denote ddimensional cube enclosing n number indices n bkc number n aebkc ratio volume n n follows 3 consider eigenvalues discrete problems since sign changes occur right left coarsening mesh size yields maximum number negative eigenvalues smallest value h discrete operator negative semidefinite n mesh points coordinate direction equivalent sin 2 nh 3 thus dk 3 combining 219 fact fine fine latter difference shown 217 bound number sign changes finite elements concerned eigenvalues coefficient matrix h also convenient consider associated operator h defined finite element space v h eigenvalues h generalized matrix eigenvalue problem h u h mass matrix eigenvalues tend continuous operator moreover since v h subspace v h courantfischer minmax theorem implies eigenvalues oe h oe h common index shift right coarsening left refinement addition since h symmetric positivedefinite sylvesters inertia theorem implies number negative eigenvalues h 221 follows observations sign changes sign changes fig 23 indices eigenvalues undergoing sign change coarsening n theta n finite element grid coarsening next coarser n theta n grid maximal number negative eigenvalues h bounded fine grid limit lim also bound number sign changes improved examining eigenvalues h closely using tensor product form operators express eigenvalues 1 indices run 1 n consider requirement h h negative semidefinite equivalent since expression j j monotonically increasing j largest eigenvalue dimensions equals zero n 12dk value h 12d negative eigen values coarser meshes problem remains negative definite consequently none quantities undergo sign change giving bound j gamma 218 figure 23 gives idea sign changes distributed bilinear elements two dimensions levels changes take place indices eigenvalues lie curved strip twodimensional plane indices typically one level majority sign changes occur k increased h decreased correspondingly via 25 shape strips remains fixed number indices contained grows like oh gammad however 25 needed analysis behavior finite differences similar remedy suggested 11 difficulties consists maintaining approximation eigenspace v h troublesome eigenvalues projection scheme used orthogonalize coarse grid correction v h coefficients solution problematic space obtained separately since involves explicit separate treatment problematic modes approach restricted cases small number 3 incorporation krylov subspace methods view observations smoothing section 21 coarse grid correction section 22 modify standard multigrid method following way treat helmholtz problems ffl obtain smoothers stable still provide strong reduction oscillatory components use krylov subspace iteration gmres smoothers intermediate grids ffl handle modes eigenvalues either close origin gridsand hence belong modes sufficiently damped gridor cross imaginary axis thus treated incorrectly coarse grid corrections add outer iteration use multigrid preconditioner gmres iteration 14 demonstrate effectiveness approach series numerical experiments tests outer iteration run stopping criterion satisfied aum residual mth gmres iterate norm vector euclidean norm multigrid algorithm vcycle cases smoothing schedules specified 31 gmres accelerated multigrid begin experiment onedimensional helmholtz equation unit interval forcing term inhomogeneous dirichlet boundary condition left sommerfeld condition right discretize using linear finite elements uniform grid discrete right hand side f determined boundary conditions apply vcycle multigrid algorithm gmres iteration preconditioned vcycle multigrid method smoother tests one step damped jacobi iteration presmoothing postsmoothing using 26 initial guess vector normally distributed entries mean zero variance one generated matlab function randn table 31 shows iteration counts increasing numbers levels beginning fine grids containing elements wave numbers correspond two four wavelengths unit inter val respectively observe first methods display typical hgammaindependent multigrid behavior mesh size coarsest grid reaches kh 2 256 elements occurs coarsest mesh 18 coarsest 116 point methods require noticeably iterations increase much pronounced standalone multigrid case yet coarser levels added multigrid diverges whereas levels mg gmres mg gmres mg gmres mg gmres table iteration counts multigrid vcycle standalone iteration preconditioner gmres applied onedimensional model helmholtz problem damped jacobi smoothing dash denotes divergence iteration 128 theta 128 elements 256 theta 256 elements levels mg gmres mg gmres mg gmres mg gmres table iteration counts twodimensional problem fine grids 128 theta 128 256 theta 256 meshes dash denotes divergence iteration multigrid preconditioned gmres method settles hindependent iteration count however increase k table 32 shows iteration counts twodimensional helmholtz problem unit square second order absorbing boundary condition see 1 13 imposed four sides discretized using bilinear quadrilateral finite elements uniform mesh since problem cannot forced radiation condition entire boundary remaining examples section 3 inhomogeneity imposed choosing discrete right hand side consisting random vector mean zero variance one generated randn initial guess identically zero trends problems smooth right hand sides addition twodimensional problems use two jacobi pre postsmoothing steps whenever jacobi smoothing used damping parameter chosen maximize damping oscillatory modes grids use damped jacobi smoothing optimum value determined 89 results show qualitative behavior onedimensional problem standalone multigrid begins diverge coarse levels added gmres accelerated iteration converges hindependent number iterations growing elements coarsest grid 512 256 128 64 gmres iterations 152 78 42 25 table coarse grid information used number iterations decreases onedimensional problem fine grid containing k although larger number iterations onedimensional case natural question whether corrections computed coarse grids particular associated mesh widths larger 110 times wavelength contribution towards reducing error investigate repeating gmres accelerated multigrid calculations onedimensional problem omitting calculationsbe smoothing direct solveson increasing number coarse levels results shown table 33 leftmost entry table shows iteration counts coarse grid information used ie gmres preconditioning two steps iteration reading left right subsequent entries show counts smoothings succession coarser grids included computations done grid levels coarsest grid rightmost entry direct solve done coarsest mesh full vcycle computation results indicate computations grids level 2 eight elements two points per wavelength still accelerate convergence outer iteration results show although multigrid may diverge nevertheless powerful enough preconditioner gmres converge hindependent number steps two additional questions whether replacing unstable jacobi smoother krylov subspace iteration leads convergent standalone multigrid method sensitive convergence behavior function wave number k address former following section 32 gmres smoother section replace unstable jacobi smoother gmres smoothing use gmres levels j kh j 12 continue using damped jacobi relaxation kh choice motivated discussion end section 211 ensures largest amplification factor jacobi smoother become large results section 212 show could switch back jacobi smoothing coarse meshes explored option 321 nonconstant preconditioners introduces slight complication regard outer gmres iteration multigrid used preconditioner inner gmres smoothing steps linear iterations therefore different preconditioner applied every step outer iteration variant gmres able accommodate changing preconditioner known flexible gmres due saad 24 requires following minor modification standard right preconditioned gmres algorithm orthonormal basis m1st krylov space km1 case constant preconditioner denoted arnoldi relation hm holds upper hessenberg matrix hm preconditioning matrix multiplication step z performed changing preconditioner results modified arnoldi relation residual vector minimized space need longer krylov space requires storing vectors fz j g addition orthonormal vectors fv j g form basis 322 handtuned smoothing schedules numerical experiments fixed number gmres smoothing steps every level result good perfor mance get idea appropriate smoothing schedule proceed follows given k calculate number max fgmres iterations needed j level multigrid preconditioning use jacobi smoothing grids direct solve next coarser grid making j grids replace direct solve coarsest grid jlevel scheme gmres smoothing grid coupled direct solve next coarser grid determine smallest number j gmres smoothing steps required outer iteration converge omax steps example first line table 34 6 outer fgmres steps needed 5level scheme smoothing steps needed outer iteration new 6level preconditioner converge 6 steps number j determined could fix number gmres smoothing steps j grid add one coarser level determine optimal number gmres smoothing steps coarser grid continue fashion maximal number levels reached approach modified slightly whenever possible trying reduce number smoothings finer levels coarser levels added often possible since replacing exact solve coarsest grid several gmres smoothing steps often regularizing effect avoiding damage possibly done exact coarse grid correction modes whose eigenvalues well represented coarse grid handtuning procedure gives insight best possible behavior algorithm contrast classical linear smoothers whose damping properties different modes fixed damping properties gmres depend initial residual particular since gmres constructed minimize residual damp modes lead largest residual norm reduction reason favor postsmoothing presmoothing prevent unnecessary damping smoother modes handled coarsegrid correction include two gmres presmoothing steps avoid overly large oscillatory components residual prior restricting next lower level could otherwise lead spurious oscillatory error components introduced coarse grid correction results shown table 34 entry denotes direct solve corresponding level j indicates damped jacobi smoothing used level looking smoothing schedules observe hump number gmres smoothing steps first two levels gmres smoothing used number decreases often zero coarsest levels however 256 theta 256 levels smoothing schedule mg fgmres 9 j j j j 13 128 theta 128 levels smoothing schedule mg fgmres 256 theta 256 levels smoothing schedule mg fgmres 256 theta 256 levels smoothing schedule mg fgmres 6 j j 9 j j 256 theta 256 levels smoothing schedule mg fgmres 9 j table manually optimized gmres smoothing schedule twodimensional model helmholtz prob lem j denotes jacobi smoothing denotes direct solve fgmres algorithm uses multigrid vcycle preconditioner gmres smoothing still helps levels extremely coarse regard resolution waves case performing three gmres smoothing steps level 4 corresponds 12 point per wavelength still improves convergence remark number outer iterations tests preconditioned fgmres standalone mg corresponding twogrid versions methods cannot expect faster convergence respect wave number k also note number iterations standalone multigrid close fgmres multigrid preconditioning believe relatively large number gmres smoothing steps intermediate levels eliminates lower frequency errors mitigates effects axis crossings return point section 34 33 stopping criterion based l 2 sections hand tuning previous section clearly suitable practical algorithm section develop heuristic finite element discretizations automatically determines stopping criterion gmres smoother technique based idea introduced 29 briefly introduce standard terminology multilevel methods applied second order elliptic boundary value problems bounded domainomega ae r 2 see 30 assume nested hierarchy finite element spaces largest space v j corresponds grid solution sought require l 2 orthogonal projections defined delta delta denotes l 2 inner product omegagamma let phi denote basis finite element space v dimension n used defining stiffness mass matrices nestedness property v ae v 1 exists n 1 theta n matrix 1 whose columns contain coefficients basis phi terms basis phi 1 writing bases row vectors stopping criterion shall use gmres smoothing iterations based representation residual r approximate solution u level equation sum differences l 2 projections refer residual sections following result coercive problems proven 29 shows error u u small appropriately weighted residual section small theorem 31 assume underlying elliptic boundary value problem h 1 elliptic h 1ff regular ff 0 exists constant c independent level h norm error level bounded boundary value problem 1113 consideration h 1 elliptic therefore satisfy assumptions theorem found however bound 31 suggests useful stopping criterion terminate gmres smoothing iteration level soon residual section q become sufficiently small obtain formula computation sections assume residual r represented coefficient vector r terms dual basis phi representation q respect dual basis phi gamma1 given coefficient vector returning representation respect basis phi gamma1 requires multiplication obtain sequence triangulations underlying finite element spaces v quasi uniform mass matrix level uniformly equivalent identity scaled h denotes dimension domain case consideration means euclidean inner product coordinate space denoted delta delta e scaled h 2 uniformly equivalent respect mesh size l 2 inner product v therefore associated norms satisfy ch 2 v coordinate vector v respect phi using norm equivalence easily shown constants c c uniformly levels result residual sections may computed sufficiently accurately without need inverting mass matrices 29 suggested gmres smoothing iteration full multigrid cycle terminated soon residual section given level order discretization error level problem consideration shall use relative reduction l 2 sections stopping criterion roughly equal error reduction modes achieved one vcycle first level gmres smoothing used additional difficulty many eigenvalues may badly approximated nextcoarser level reason better also smooth oscillatory modes belonging next lower level base stopping criterion residual section use safer choice levels numerical experiments optimal smoothing schedules shown relative reduction residual section scale like kh arrive stopping criterion complete description multigrid vcycle algorithm starting finest level follows algorithm 31 vcycle gmres smoothing coarse levels else steps damped jacobi smoothing obtain u 1 else perform 2 steps gmres smoothing obtain u 1 endif steps damped jacobi smoothing obtain else perform gmres smoothing stopping criterion 32 satisfied obtain endif endif standalone multigrid vcycle algorithm 31 used recursively beginning finest level iterated desired reduction relative residual achieved finest level fgmres variant algorithm 31 represents action inverse preconditioning operator applied vector f 34 experiments automated stopping criterion show multigrid solver preconditioner perform automated stopping criterion gmres smoothing method applied twodimensional helmholtz problem unit square secondorder absorbing boundary condition random right hand side data tests used 32 also imposed upper bound mmax number gmres smoothing steps terminating smoothing stopping criterion satisfied mmax steps tested two values levels damped jacobi smoothing used number presmoothings postsmoothings 2 standalone mg mgpreconditioned fgmres nnk 2 4 8 16 32 64 2 4 8 16 32 64 table iteration counts standalone multigrid multigridpreconditioned fgmres various fine grid sizes wave numbers cases gmres smoothing performed levels kh 12 smoothing terminated l 2 section stopping criterion mmax smoothing steps reached count extrapolated maximum 47 steps memory constraints permitted present three sets results table 35 shows iteration counts variety wave numbers mesh sizes table 36 examines performance detail showing automatically generated smoothing schedules two wave numbers finally give idea efficiency table 37 shows estimate operation counts required problems treated table 36 grid levels smoothing schedule iterations 128 theta 128 7 j j 128 theta 128 7 j j 17 17 11 2 13 grid levels smoothing schedule iterations 128 theta 128 7 j j 19 17 11 2 9 128 theta 128 7 j j 17 17 11 2 13 grid levels smoothing schedule iterations 512 theta 512 9 j j 33 37 512 theta 512 9 j j 31 37 grid levels smoothing schedule iterations 512 theta 512 9 j j 20 20 512 theta 512 9 j j 20 20 table smoothing schedules automated stopping criterion selected parameters make following observations results ffl low wave numbers number iterations standalone multigrid close fgmres difference increases wave number creases especially case 20 large enough k multigrid fails converge whereas mgpreconditioned fgmres robust behavior explained results section 222 large wave numbers increased number amplified modes eventually causes standalone multigrid fail larger number smoothing steps mitigates difficulty presumably eliminating smooth errors outer fgmres iteration handles situation robust manner ffl automated stopping criterion leads smoothing schedules close obtained hand tuning see table 34 correspondingly similar outer iteration counts ffl operation counts shown table 37 suggest mgpreconditioned fgmres efficient standalone multigrid even latter grid mg fgmres mg fgmres 64 theta 64 132 133 128 theta 128 240 221 256 theta 256 612 432 10912 9711 512 theta 512 1966 1481 14181 13778 table operation counts millions selected parameters method effective ffl fixed wave number outer iteration counts mesh independent standard multigridlike behavior observed moreover jacobi smoothing less expensive gmres smoothing initial stages mesh refinement costs per unknown increasing less linear rate ffl growth outer iteration counts increasing wave number slower linear k operation counts increase rapidly however increased number smoothing steps required larger wave numbers 4 application exterior problem final example apply algorithm exterior scattering problem helmholtz equation given 1113 domainomega consists exterior ellipse bounded externally circular artificial boundary gamma 1 impose exact nonlocal dirichletto neumann dtn boundary condition see 19 source function forcing due boundary condition boundary gamma scatterer given data gx representing plane wave incident angle ff positive xaxis solution u represents scattered field associated obstacle incident field g resulting total field ug satisfies homogeneous dirichlet neumann boundary condition gamma respectively angle incidence chosen avoid symmetric solution problems discretized using linear finite elements beginning coarse mesh successively refined uniformly obtain hierarchy nested finite element spaces finest mesh obtained five refinement steps contains 32768 degrees freedom several combinations k h tested case kh 05 finest mesh figure 41 shows contour plot solution u dirichlet problem 8 computations make use pde toolbox matlab 53 computing environment problems solved using standalone fgmresaccelerated versions multigrid gmres smoothing using residual section stopping criterion stopping criterion requiring residual reduction gamma6 section 3 zero initial guess examples used maximal number levels exception dirichlet problem also varied number levels six two results shown table 41 table gives wave number k length ellipse 2k third column gives maximum value kh dirichlet problem 28 4 100 26 neumann problem 28 table iteration counts exterior scattering problem dirichlet neumann plane wave data boundary ellipse various wave numbers grid sizes numbers levels finest mesh fourth column indicates number levels used computation last two columns list iteration counts observe preconditioned iteration performs well cases growth number iterations slower linear k standalone multigrid variant performs less well comparison requiring 100 steps converge several cases even diverging one case particularly case neumann problem superiority preconditioned variant even pronounced neumann problems also notice slight growth iteration counts fixed k decreasing h 5 conclusions results paper show addition krylov subspace iteration multigrid smoother outer accelerating procedure enables construction robust multigrid algorithm helmholtz equation gmres effective smoother grids intermediate coarseness appears amplify error modes addition tends regularizing effect contribution coarse grid correction coming smoothing given level combination multigrid algorithm preconditioner fgmres effective handling deficiencies standard multigrid methods helmholtz equation outer fgmres acceleration necessary particularly high wave numbers addition results paper indicate grids coarse result meaningful discretization helmholtz equation may still provide useful information coarsegrid corrections using automated stopping criterion based l 2 sections residual leads smoothing cycles close handtuned optimal smoothing schedules important aspect algorithm consists familiar building blocks thus easily implemented large wave numbers discretiza fig 41 contour plot solution dirichlet problem wave number tion must keep kh also k 3 h 2 small grid hierarchy contain grids fine enough use jacobi smoothing thus making algorithm efficient result multigrid method appears converge rate independent mesh size h moderate dependence wave number k finally numerical results show able effectively solve helmholtz problems wave numbers practical relevance r comparison two multilevel iterative methods nonsymmetric indefinite elliptic finite element equations sharp estimates multigrid rates convergence general smoothing acceleration iterative method helmholtz equation cascadic multigrid method elliptic problems combination multigrid method conjugate gradients analysis multigrid algorithms nonsymmetric indefinite elliptic problems multigrid methods nearly singular slightly indefinite absorbing boundary conditions numerical simulation waves multigrid preconditioners applied iterative solution singularly perturbed elliptic boundary value problems scattering problems finite element method helmholtz equation exterior domain exact nonreflecting boundary conditions analysis comparison relaxation schemes robust multigrid conjugate gradient methods multigrid preconditioner stabilised discretisations advectiondiffusion problems iterative methods sparse linear systems gmres generalized minimal residual algorithm solving nonsymmetric linear systems observation concerning ritzgalerkin methods indefinite bilinear forms estimates rate convergence cascadic conjugategradient method multigrid techniques highly indefinite equations performance krylov subspace iterations smoothers multigrid meth ods new class iterative methods nonselfadjoint indefinite problems multilevel spltting finite element spaces indefinite elliptic boundary value problems tr ctr jan mandel mirela popa iterative solvers coupled fluidsolid scattering applied numerical mathematics v54 n2 p194207 july 2005 peng li l pileggi efficient harmonic balance simulation using multilevel frequency decomposition proceedings 2004 ieeeacm international conference computeraided design p677682 november 0711 2004