performance greedy ordering heuristics sparse cholesky factorization greedy algorithms ordering sparse matrices cholesky factorization based different metrics minimum degree popular effective greedy ordering scheme minimizes number nonzero entries rank1 update degree step factorization alternatively minimum deficiency minimizes number nonzero entries introduced deficiency step factorization paper develop two new heuristics modified minimum deficiency mmdf modified multiple minimum degree mmmd former uses metric similar deficiency latter uses degreelike metric experiments reveal average mmdf orderings result 21 fewer operations factor minimum degree mmmd orderings result 15 fewer operations factor minimum degree mmmd requires average 713 time minimum degree mmdf requires average 3334 time minimum degree b introduction well known ordering rows columns matrix crucial step solution sparse linear systems using gaussian elimination ordering drastically affect amount fill introduced factorization hence cost computing factorization 7 13 matrix symmetric positive definite ordering step independent numerical values performed prior numerical factorization ideal choice ordering introduces least fill problem computing ordering npcomplete 22 consequently almost ordering algorithms heuristic nature examples include reverse cuthillmckee 5 6 8 automatic nested dissection 9 minimum degree 18 greedy ordering heuristic numbers columns successively selecting step column optimal value metric minimum degree algorithm tinney walker 21 metric number nonzero entries hence operations update associated column rightlooking sparse cholesky factorization algorithm stated terms vertex eliminations graph representing matrix 18 metric translates degree vertex efficient implementations minimum degree due george liu 11 12 minimum degree algorithm multiple eliminations mmd due liu 16 become method choice last decade multiple independent vertices eliminated single step mmd reduce ordering time recently amestoy davis duff 1 developed approximate minimum degree algorithm amd uses approximation degree reduce ordering time berman schnitger 4 analytically shown minimum degree algorithm rare cases produce poor ordering however experience shown minimum degree algorithm variants work supported part defense advanced research projects agency contracts daal0391c0047 erd9501310 xeroxmp002315 applied mathematical sciences research program office energy research us department energy contract deac0596or22464 lockheed martin energy research corp national science foundation grants nsf asc9411394 nsfcda9529459 computer science mathematics division oak ridge national laboratory p box 2008 oak ridge tn 378316367 ngegornlgov z 107 ayres hall department computer science university tennessee knoxville tn 37996 1301 padmacsutkedu effective heuristics generating fillreducing orderings fact recent separatorbased schemes 3 14 15 outperformed mmd certain classes sparse matrices new schemes hybrids use minimum degree algorithm order columns greedy ordering heuristic also proposed tinney walker 21 largely ignored minimum deficiency minimum fill algorithm minimum deficiency algorithm minimizes number fill entries introduced step sparse cholesky factorization deficiency graph terminology although metrics look similar minimum deficiency minimum degree algorithms different example deficiency could well zero even degree two reasons minimum deficiency algorithm become popular minimum degree algorithm 7 first minimum deficiency algorithm typically much expensive minimum degree algorithm second believed quality minimum deficiency orderings much better minimum degree orderings 7 results rothberg 19 also us 17 demonstrate minimum deficiency leads significantly better orderings minimum degree however current implementations minimum deficiency algorithm require substantially time mmd paper develop two greedy heuristics less expensive compute minimum deficiency compute better orderings minimum degree average heuristics variants minimum deficiency minimum degree section 2 provide background material introduce special notation help describe heuristics section 3 develop modified minimum deficiencymmdf modified multiple minimum degree mmmd heuristics also show two heuristics implemented using update mechanism approximate degree scheme amestoy davis duff 1 section 4 provide empirical results performance mmdf mmmd section 5 contains concluding remarks remaining part section describes recent related work related work rothberg investigated metrics greedy ordering schemes based approximations deficiency 19 work work 17 done independently 1 rothberg 19 ffl shows minimum deficiency algorithm significantly superior mmd terms number operations required compute cholesky factor ffl develops three approximate minimum fill amf heuristics based approximations deficiency ffl concludes heuristic amf1 best among three average amf1 orderings require 14 fewer operations factor mmd orderings earlier report 17 ffl establish many techniques used efficient implementations minimum degree algorithm namely indistinguishable vertices mass elimination outmatching also apply minimum deficiency algorithm ffl corroborate rothbergs empirical results establishing superior performance minimum deficiency metric ffl develop modified minimum deficiency mmdf modified multiple minimum degree mmmd heuristics ffl show mmdf mmmd orderings require 17 15 fewer operations factor mmd average difficult compare results 17 19 directly test suites used 1 raghavan rothberg presented results independently second siam conference sparse matrices 1996 two papers substantially different aggregate measures reported two papers also different moreover based performance data obtained different sets initial numberings recently revision 19 rothberg eisenstat developed two new metrics greedy ordering schemes 20 rothberg eisenstat 20 ffl develop two heuristics approximate minimum mean fill ammf average minimum increase neighbor degree amind ffl show ammf orderings require 22 median 25 geometric mean fewer operations factor mmd orderings amind orderings require 20 median 21 geometric mean fewer operations factor mmd orderings paper shorter version 17 test suite paper substantially different original paper attempt compare performance heuristics amf1 called amf 20 ammf amind heuristics 19 20 use nearly test suite two papers four matrices 19 20 proprietary therefore available us report performance relative mmd earlier used median ratios 7 initial orderings 6 random orderings ordering matrix given us paper use ratio medians 11 random initial orderings 19 20 see later paper mmdf mmmd heuristics produce better orderings mmd mmdf mmmd orderings competitive produced amf1 ammf amind see interesting development five different metrics produce orderings significantly better produced mmd commented earlier report 17 could well relatively inexpensive greedy strategies outperform ones known time performance newer schemes ammf amind 20 supports prediction ammf seems slightly better mmdf discuss section 5 still believe may well greedy metrics perform better five developed far 2 implementing greedy ordering heuristics efficient implementation greedy ordering schemes based compact realization graphmodel cholesky factorization 18 section provide brief description elimination graphs quotient graphs introduce example together notation used describe greedy heuristics also describe minimum degree minimum deficiency schemes using quotient graphs throughout use terminology common sparse matrix factorization reader referred book george liu 13 details elimination graphs quotient graphs sparse cholesky factorization modeled using elimination graphs 18 let g denote elimination graph beginning g initialized g 0 graph sparse symmetric positive definite matrix 13 step vertex incident edges removed g x vertex removed edges added g neighbors x become clique thus cliques formed elimination proceeds quotient graph 10 13 compact representation elimination graph requires space g 0 13 unlike elimination graph vertices explicitly removed neither cliques formed explicitly instead vertices grouped supervertices marked eliminated uneliminated let g denote current elimination graph let set vertices eliminated consider subgraph induced g 0 subgraph contain one connected components also called domains quotient graph vertices connected component coalesced eliminated supervertex note cliques created elimination process g easy identify quotient graph clique contains uneliminated neighbors eliminated supervertex well known elimination proceeds uneliminated vertices become indistinguishable share essentially adjacency structure current elimination graph g set indistinguishable vertices coalesced uneliminated supervertex quotient graph observe vertices uneliminated supervertex degree deficiency hence masseliminated degree deficiency becomes minimum 13 17 furthermore vertices uneliminated supervertex form clique z z 6 fig 1 example quotient graph x recently eliminated supervertex supervertices enclosed curve form clique partial cliques used mmdf shown using dotted curves thus quotient graph viewed graph containing two kinds supervertices uneliminated supervertices eliminated supervertices uneliminated supervertex clique indistinguishable vertices corresponding elimination graph g eliminated supervertex subset vertices eliminated original graph g 0 vertices set uneliminated supervertices adjacent eliminated supervertex quotient graph form clique elimination graph simplicity say uneliminated supervertices form clique quotient graph two uneliminated supervertices said neighbors quotient graph edge adjacent eliminated supervertex quotient graph thus vertices belonging one uneliminated supervertex adjacent supervertex corresponding elimination graph example notation figure 1 contains example quotient graph eliminated supervertices represented rectangles uneliminated supervertices represented circles assume uneliminated supervertex selected according greedy criterion quotient graph transformed gives new eliminated supervertex quotient graph denote new eliminated supervertex x remaining part paper x referred recently eliminated supervertex using convention z 1 z 2 neighbors 1 note uneliminated supervertices enclosed curve adjacent eliminated su pervertex x form clique two cliques fy 1 g observe three cliques disjoint uneliminated supervertices enclosed dotted curve z 2 z 3 z 4 z 5 form call partial clique partial cliques used describe heuristics next section v supervertex either uneliminated eliminated quotient graph define set uneliminated supervertices neighbors v use n 2 v denote set uneliminated supervertices neighbors n 1 v use degv denote degree uneliminated supervertex total number vertices supervertices n 1 v minimum degree deficiency schemes recall greedy heuristic needs metric dv selecting next supervertex eliminate examples degree minimum degree deficiency minimum deficiency terms elimination graphs greedy heuristic following structure select vertex minimizes eliminate current elimination graph form next elimination graph update value metric vertex affected elimination greedy scheme also described terms quotient graphs select uneliminated supervertex minimizes create new quotient graph update value metric uneliminated supervertex affected elimination minimum deficiency heuristic updating deficiency one step elimination may significantly time consuming updating degree minimum degree algorithm consider example figure 1 x recently eliminated supervertex minimum degree mmd amd uneliminated supervertices n 1 x need degree update however minimum deficiency need update deficiency supervertices n 1 x also supervertices belonging n 2 x supervertex n 2 x neighbor two supervertices would need deficiency update respect figure 1 would update deficiency z 1 since neighbor 1 ym similarly would update deficiency z 5 z 6 delta delta delta z k supervertex neighbor 1 rothberg showed true minimum deficiency algorithm true local fill 19 produces significantly better orderings mmd obtained similar results 17 however implementation minimum deficiency algorithm average slower mmd two orders magnitude 17 let x recently eliminated supervertex using deficiency metric restricting updates uneliminated supervertices v 1 x mmd leads orderings inferior true minimum deficiency still significantly better mmd observed rothberg 19 later corroborated ng raghavan 17 however even restricted scheme 40 times slower mmd 17 next section describe two relatively inexpensive effective heuristics based modifications deficiency degree 3 modified minimum deficiency minimum degree heuristics describe two heuristics based approximations deficiency degree metrics implemented using either update mechanism mmd faster scheme amd first heuristic modified minimum deficiency mmdf based deficiencylike metric consider example figure 1 assume x recently eliminated supervertex update values metric uneliminated vertices n mmd consider updating dy 1 figure 1 upper bound ffi deficiency 1 obtained terms degree 1 true deficiency 1 obtained subtracting upper bound number edges present 1 eliminated identifying edges requires examining uneliminated supervertices n 1 1 n 2 1 however edges identified easily quotient graph representation uneliminated supervertices connected common eliminated supervertex form clique using notation introduced earlier n 1 1 set uneliminated neighbors 1 elements grouped set disjoint partial cliques k obvious member k consisting uneliminated neighbors eliminated supervertex x partial cliques depend order neighbors 1 examined without loss generality assume fz 1 g forms second clique likewise let fz next partial clique examine finally fz fourth disjoint partial clique metric dy 1 defined upper bound deficiency c sum contributions partial cliques ct correction term initialization set upper bound ffi define ct upper bound ffi based external degree 16 upper bound favors larger supervertices two supervertices degree larger supervertex smaller upper bound deficiency since external degree smaller k set disjoint partial cliques described define partial clique k size v total number vertices uneliminated supervertices constitute v ct correction term ct takes account contributions missed 1 partial cliques k forced disjoint 2 cliques fz 1 ym g detected examine n 2 1 heuristic value ct j rationale choice ct follows assume supervertex n 1 1 connected one supervertex associated contribution missed assume size 1 representative sizes supervertices n 1 1 contributions missed equal simplifies ct would like emphasize mmdf heuristic see correction term approximation edges missed restrict attention partial cliques disjoint experiments found small multiples correction term behaved well better second heuristic modified multiple minimum degree mmmd attempts use metric bounded small multiple degree indicated name close variant minimum degree algorithm multiple eliminations consider figure 1 assume x recently eliminated supervertex uses metric dy 1 u size largest partial clique set k described precisely initialization simply use 2 edegy 1 note mmmd differs mmd definition metric metric mmmd tries take account contributions largest clique contains 1 disjoint partial cliques set k 1 exactly used implicitly lius mmd code compute edegy 1 hence update cost mmdf mmmd similar lius mmd approximate mmdf mmmd briefly outline approximate versions two schemes implemented using faster update mechanism amd scheme amestoy davis duff 1 consider approximate mmdf consider figure 1 metric 1 uneliminated supervertex adjacent x recently eliminated supervertex upper bound calculated using approximate external degree amd correction term also easily calculated terms approximate external degree size supervertex 1 main difference k constructed hence term c set k corresponds cliques used amd compute approximation degree amd uses sizes certain cliques supervertices set g respect example figure 1 cliques used amd fy g first clique one formed elimination x remaining cliques overlap clique however remaining cliques may supervertices common mmdf based mmd forces partial cliques disjoint hand approximatemmdf relaxes restriction ie uses cliques amd cliques may common une liminated supervertices approximation c contribution deficiency partial cliques computed using clique sizes used amd approximation degree approximatemmmd similar also uses cliques amd relation deficiencylike schemes would like note mmdf similar amf3 proposed rothberg 19 differs mainly way partial cliques constructed well definition correction term amf approximate minimum fill ammf approximate mean minimum fill amind approximate mean increase neighbor degree three heuristics developed rothberg eisenstat 19 20 deficiencylike metrics amf ammf amind use edges recently formed clique metric mmdf takes account edges many cliques easily identify amind also uses term similar correction term mmdf mmmd similar amf uses size single clique differs sense uses degreelike metric 4 performance mmdf mmmd report performance mmdf mmmd use set 36 test matrices empirical study test suite subset one used rothberg eisenstat 19 20 test suite contains four matrices proprietary hence available us mmd code lius fortran implementation converted c mmdf mmmd heuristics built using mmd code mmdf differs mmd metric update well use heaps store retrieve metric furthermore unlike mmd mmdf allow multiple eliminations mmmd nearly identical mmd differs metric update portion experiments performed sun ultra sparc2 workstation quality greedy orderings vary depending initial numbering test matrix use 11 different random initial numberings mmd mmdf mmmd consider two quantities quality ordering number nonzeros cholesky factor number floatingpoint operations required compute also report actual execution times mmd mmdf mmmd characteristics test matrices quality mmd orderings reported table 1 report mean median values 11 initial random numberings mmd table 1 table 2 shows performance mmdf mmmd relative mmd relative measure computed ratio medians 11 initial random numberings also present geometric mean median test matrices last two lines table execution time mmmd matches mmd mmdf performance mmd jlj operations mean median values 11 initial orderings problem rank jaj mean median time jlj operations time jlj operations bcsstk36 23052 11662 156 2760 609 156 2761 609 crystk01 4875 3207 046 1082 337 046 1083 338 crystk03 24696 17758 392 13943 13050 392 13944 13051 gearbox 153746 92341 4052 52972 57327 4052 52973 57328 msc10848 10848 12406 107 2028 576 107 2028 576 pwt 36519 3261 251 1768 224 251 1768 225 struct2 73752 36709 774 9810 3817 774 9810 3817 struct3 53570 12273 636 5309 1215 636 5309 1216 struct4 4350 2421 207 2248 1756 207 2248 1756 troll 213453 11985 4237 61171 153228 4237 61171 153228 performance mmdf mmmd relative mmd problem report ratio median values 11 initial random orderings problem ordering time jlj operations mmdf mmmd mmdf mmmd mmdf mmmd bcsstk36 168 147 101 100 098 096 crystk01 133 122 091 089 080 077 crystk02 123 104 086 083 072 068 crystk03 125 104 089 080 079 064 flap 150 106 093 091 081 078 gearbox 158 113 091 100 077 117 pwt 148 103 094 097 085 092 struct1 172 108 095 096 085 090 struct2 180 106 097 098 094 093 struct3 128 105 095 096 087 090 troll 113 104 080 085 065 073 gmean 133 113 091 092 080 084 median 134 107 092 095 080 086 requires average overhead 34 mmd experiments indicate avoiding use heaps mmdf suggested referee reduce third overhead results variants mmdf mmmd summarized table 3 approximate versions mmdf mmmd based implementation amd include features aggressive absorption approximate version mmdfmmmd performs equally well geometric mean median mmdfmmmd mmdf mmmd approximate versions adding ashcrafts initial compression step 2 improved performance slightly 1 average table summary performance mmdf mmmd variants relative mmd geometricmean median problems test suite based ratio median values 11 initial random orderings problem method jlj operations gmean median gmean median initial compression initial compression 5 conclusions developed two new greedy heuristics modified minimum deficiency mmdf modified multiple minimumdegree mmmd schemes produce orderings better mmd orderings first scheme mmdf produces orderings require approximately 21 fewer floatingpoint operations factorization mmd second scheme mmmd generates orderings incurs 15 fewer operations factorization mmd mmdf uses deficiencylike metric ie metric whose value quadratic function degree execution time mmdf approximately 13 times mmd hand mmmd uses degreelike metric bounded twice value degree mmmd mmd difference choice metric consequently ordering time mmmd similar mmd furthermore change quality orderings mmdf mmmd implemented using approximate degree 1 framework completeness table 4 summarizes performance schemes well 20 appears performance mmmd approximate minimum fill amf1 19 amf 20 similar likewise mmdf approximate mean increase neighbor degree amind 20 produce orderings similar quality approxi mate mean minimum fill ammf 20 appears slightly better mmdf relative mmd ammf orderings require 25 geometric mean 22 median fewer operations factorization mmdf compression orderings require 21 geometric mean median fewer operations factorization table summary operation counts factor mmdf mmmd amf ammf amind relative mmd initial compression measure ngraghavan rothbergeisenstat mmdf mmmd amf1 ammf amind gmean 79 84 85 75 79 median 79 85 85 78 80 work attempt understand factors affecting performance greedy ordering heuristics tried several metrics close mmdf mmmd many average operation counts factorization similar reported mmdf mmmd others varied substantially also experimented variant mmdf update metric neighbors neighbors true minimum deficiency surprisingly operation counts average higher 34 variant performance true minimum deficiency shows deficiency better metric degree however surmise improved performance heuristics complicated interplay metric greedy process necessarily accurately modeling true deficiency conjecture could well relatively inexpensive greedy strategies significantly outperform ones known far r approximate minimum degree ordering algorithm compressed graphs minimum degree algorithm robust orderings sparse matrices using multisection performance minimum degree ordering gaussian elimination several strategies reducing bandwidth matrices reducing bandwidth sparse symmetric matrices direct methods sparse matrices computer implementation finite element method automatic nested dissection algorithm irregular finite element problems fast effective algorithms graph partitioning sparse matrix dering improving runtime quality nested dissection ordering modification minimum degree algorithm multiple elimination performance greedy ordering heuristics sparse cholesky fac torization graphtheoretic study numerical solution sparse positive definite systems linear equations ordering sparse matrices using approximate minimum local fill node selection strategies bottomup sparse matrix ordering direct solution sparse network equations optimally ordered triangular factorization computing minimum fillin npcomplete tr ctr abdou guermouche jeanyves lexcellent gil utard impact reordering memory multifrontal solver parallel computing v29 n9 p11911218 september patrick r amestoy iain duff stphane pralet christof vmel adapting parallel sparse direct solver architectures clusters smps parallel computing v29 n1112 p16451668 novemberdecember timothy davis john r gilbert stefan larimore esmond g ng column approximate minimum degree ordering algorithm acm transactions mathematical software toms v30 n3 p353376 september 2004 timothy davis column preordering strategy unsymmetricpattern multifrontal method acm transactions mathematical software toms v30 n2 p165195 june 2004