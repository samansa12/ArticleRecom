scenario reduction algorithms stochastic programming consider convex stochastic programs approximate initial probability distribution p finite support supp p ie finitely many scenarios behaviour stochastic programs stable respect perturbations p measured terms fortetmourier probability metric problem optimal scenario reduction consists determining probability measure supported subset supp p prescribed cardinality closest p terms probability metric two new versions forward backward type algorithms presented computing optimally reduced probability measures approximately compared earlier versions computational performance accuracy running time new algorithms improved considerably numerical experience reported different instances scenario trees computable optimal lower bounds test examples also include ternary scenario tree representing weekly electrical load process power management model b introduction many stochastic decision problems may formulated convex stochastic programs form minf z x r given nonempty closed convex set closed subset r function f 0 r r continuous respect convex respect x p xed borel probability measure p instance formulation covers convex two multistage stochastic programs recourse typical integrands f 0 x x 2 x convex stochastic programming problems nondierentiable locally lipschitz continuous fol lowing assume exist continuous nondecreasing function nondecreasing function xed element heitsch romisch x 2 x function c r given c means function hk 0 describes growth local lipschitz constants f 0 x balls around 0 respect norm k r important particular case function h grows poly nomially ie 1 instance shown 11 choice appropriate twostage models stochasticity entering prices righthand sides shown 411 model 1 behaves stable respect small perturbations terms probability metric c p q sup z z f c class continuous functions dened probability measures p q set p z see also earlier work 13 distance c probability metric structure also called fortetmourier type metric generality introduced 14 studied 1012 particular metric c dual representations terms kantorovichrubinstein functional cf section 53 10 12 important instance initial probability measure p discrete nitely many atoms scenarios good discrete approximation p available support may large reasons computational complexity time limitation probability measure approximated probability measure q carried much smaller subset scenarios case distance c p q represents optimal value nitedimensional linear program precisely 4 obtain c j p denotes dirac measure placing unit mass particular metric c used evaluate distances specic probability measures obtained scenarioreduction process various reduction rules appear literature context recent largescale reallife applications refer corresponding discussion 4 scenario reduction algorithms stochastic programming 3 recent work 3 scenario generation reduction paper 9 approach scenario generation based fortetmourier distances given present paper follow approach reducing scenarios given discrete probability measure developed 4 consists determining index set j given cardinality j probability measure q problem 7 may reformulated mixedinteger program section 2 derive bounds 7 develop two new algorithms fast forward selection simultaneous backward reduction constitute heuristics solving 7 study complexity relations algorithms 4 indeed fast forward selection algorithm turns ecient implementation forward selection procedure 4 producing reduced probability measures order compare performance algorithms provide section 3 explicit formulas minimal distances 7 case p regular binary ternary scenario tree ie tree specic structure q reduced tree xed cardinality n section 4 report numerical experience reduction regular binary ternary scenario trees test trees also include ternary scenario tree representing weekly electrical load process power management model considered 4 turns new implementation fast forward selection algorithm 10100 times faster earlier version furthermore fast forward selection best algorithm comparing accuracy results simultaneous backward reduction algorithm accurate backward reduction variant 4 cases expense higher running times comparing running times fast forward selection simultaneous backward reduction preferable case n n reduction consider stochastic program 1 select function c form 3 lipschitz condition 2 satised let initial probability distribution p discrete carried nitely many scenarios iwith weights consider probability measure 4 heitsch romisch ie compared p measure reduced deleting assigning new probabilistic weights q j scenario optimal reduction concept described recommends consider probability distance depending index set j q optimal reduction concept 7 says index set j optimal weight q selected dj q jg first recall following bounds min q dj index set j xed 4 theorem 31 theorem 21 redistribution index set j c max furthermore equality 9 hence optimality q h 1 convenience reader proof theorem 21 displayed appendix interpretation formula 10 new probability preserved scenario equal sum former probability probabilities deleted scenarios closest respect c h 1 call 10 optimal redistribution rule next discuss optimal choice index set j scenario reduction xed cardinality j theorem 21 motivates consider following formulation optimal reduction problem given n 2 n n minfd j ng 11 problem 11 means set covered two sets j xed cardinality n n cover minimal cost j thus 11 represents setcovering problem may formulated 01 integer program cf 7 nphard since ecient solution algorithms hardly available general looking scenario reduction algorithms stochastic programming 5 fast heuristic algorithms exploiting structure costs j specic cases solving 11 becomes quite easy case j 1 problem 11 takes form min l2f1ng l min minimum attained l ie scenario l deleted redistribution rule 10 yields probability distribution reduced measure q j 2 arg min j 6l c l holds q q g course optimal deletion single scenario may repeated recursively prescribed number n n scenarios deleted strategy recommends conceptual algorithm called backward reduction case j n 1 problem 11 form min u2f1ng minimum attained u scenario u kept redistribution rule 10 provides strategy provides basic concept second conceptual algorithm called forward selection first take closer look backward reduction strategy backward type algorithm already suggested 46 determines reduced scenario set reducing n n scenarios original set scenarios follows let indices l selected l min shown lower bound optimal value 11 furthermore holds index set solution 11 n set nonempty 46 property motivates following algorithm rst step index n 1 determined using formula 14 j solution 11 next redistribution rule theorem 21 used leads reduced probability measure p 1 containing scenarios indexed reduced deleting scenarios belonging index set j 2 j n obtained way using formula 14 procedure continued step r n 6 heitsch romisch finally redistribution rule 10 used index set j algorithm called backward reduction scenario sets still many degrees freedom choose next scenario step often exist several candidates deletion section 4 use one particular implementation backward reduction scenario sets another particular variant consists case j variant without nal redistribution already announced 25 however numerical tests shown backward reduction scenario sets provides slightly accurate results compared backward reduction single scenarios next going present new modication backward reduction principle major dierence include deleted scenarios backward step simultaneously namely next index l determined solution optimization problem detailed description whole algorithm called simultaneous backward reduction given algorithm 22 simultaneous backward reduction sorting fc c 1 min z 1 l p l c 1 l2f1ng z 1 step c kl min z l z step nn1 redistribution 10 algorithm 22 allows following interpretation rst step corresponds optimal deletion one scenario 1 l chosen j 1 flg dened 11 hence index l dened recursively index set optimal subject constraint scenario reduction algorithms stochastic programming 7 previous indices xed since running times important characteristics scenario reduction al gorithms study computational complexity ie number elementary arithmetic operations algorithm 22 shown 6 proper implementation without sorting backward reduction scenario sets requires complexity 2 operations holds uniformly respect n comparing formulas 14 16 one notices increase complexity cost structure 16 determining l precisely step requires computation n sums consisting summands n i1 comparisons summand represents product two numbers one factors requires 2 operations determining minimum sorting process step 1 requires 2 log n operations 1 chapter 1 excluding complexity evaluating function c redistribution rule altogether obtain n 3on 2 log n operations selecting subset n scenarios hence proposition 23 computational complexity reducing set n 2 n scenarios subset containing n 2 consists b n n see 18 operations using simultaneous backward reduction hence complexity simultaneous backward reduction increasing decreasing n course minimal result corresponds running time observations numerical tests reported section 4 next describe strategy opposite backward reduction conceptual idea based formula 13 consists recursive selection scenarios deleted basic concept algorithm given 4 called forward selection forward selection determines index set fu un g g rst step procedure coincides solving problem 13 last step optimal redistribution rule used determine reduced probability measure formula 19 allows interpretation case simultaneous backward reduction closely related structure j 11 let us consider following algorithm easy implement called fast forward selection 8 heitsch romisch algorithm 24 fast forward selection z 1 u2f1ng z 1 step c z z step n1 redistribution 10 theorem 25 index set fu un g determined algorithm 24 solution forward selection principle ie u satises condition 19 holds j dened 11 proof result immediate holds z hence index u satises condition 19 holds z conditions 17 20 show algorithms based basic idea selecting next scenario index dierence scenario reduction algorithms stochastic programming 9 consists use backward forward strategies respectively ie determining sets deleted remaining scenarios respectively case backward reduction computational complexity algorithm 24 interest step requires operations computing c operations z operations determining u altogether obtain operations selecting subset n scenarios hence proposition 26 computational complexity fast forward selection reducing set n 2 n scenarios subset containing n 2 scenarios consists fn n see 21 operations hence complexity fast forward selection increasing increasing n maximal thus use fast forward selection recommendable number n remaining scenarios satises condition n number n fn n zero polynomial degree 3 depends nonlinearly n turns n nfor large n 3 minimal distances scenario trees algorithms discussed previous section provide approximate solutions 11 general since error estimates algorithms available need test examples discrete original reduced measures dierent scale known optimal c distances practical importance consider probability measures scenarios exhibiting tree structure particular derive optimal distances certain regularly structured original scenario trees reduced trees containing different numbers scenarios consider scenario tree represents discrete parameter stochastic process parameter set f0 scenarios paths branching parameter k 2 f0 branching degree ie node tree successors case tree called binary ternary respectively hence tree consists n k scenarios k root node furthermore let scenarios equal probabilities scenario tree called regular k 2 exist symmetric sets v k f k g r heitsch romisch k 1tuple indices corresponds index say case means sets v k form v respectively clearly holds 0 trees figure 1 c c c c c c c c c c c figure 1 binary scenario tree shows example regular binary scenario tree scenarios specify function c 3 setting h 1 choosing maximum norm k k1 r k1 ie c rst result provides explicit formula minimal distance regular binary tree reduced subtrees least proposition 31 34solution let regular binary scenario tree holds n 2 n n proof use representation 22 scenario let corresponding k 1tuples indices let l 2 kg l 1 obtain r jr j l r scenario reduction algorithms stochastic programming 11 hence holds j remains show exists index set j j lower bound attained ie end consider index set fi let r denote tree consisting figure 2 illustrates detail r starting node r r r r r r figure 2 detail subtree r level k 0 1 ending level k 2 hence cardinality j obtain 4 j want show j 2 j exists index 2 related scenario let us consider behaviour j branching levels k 2 distinguish three cases k0 case case case 3 k01 consider following k k 62 fk 12 heitsch romisch denote corresponding index clearly 2 consequently holds distance j r jr j r jr j case 1 case 2 maxfj2 k0 j j2 k0 2 k01 jg case 3 latter equation holds due assumption k0 maxf 2 k0 hence considering subsets j cardinality 1 3 result follows general case 2 second result provides similar formula minimal distance regular ternary tree reduced subtrees containing n 2 9 n scenarios proposition 32 79solution let regular ternary scenario tree holds n 2 n 2 proof similarly proposition 31 obtain subset j show exists index set j j lower bound n n attained j consider index set fi k0 denote tree consisting figure 3 illustrates detail r starting scenario reduction algorithms stochastic programming 13 r r r r r r figure 3 detail subtree r node level k 0 1 ending level k 2 obtain cardinality j 9 3 9 n j similarly proposition 31 shown j 2 j exists index 2 holds k 9 k0 considering subsets j cardinality 9 n result follows general case 2 similar results available additional assumptions case euclidean norm instead maximum norm see also 6 aim section report numerical experience testing comparing algorithms described section 2 namely backward reduction scenario sets simultaneous backward reduction fast forward selection algorithms implemented c test runs performed hp 9000 780j280 computeserver 180 mhz frequency 768 mbyte main memory hpux 1020 ie conguration numerical tests 4 consider situation function c dened c original discrete probability measure p given scenario tree form precisely use test battery three binary ternary scenario trees respectively test trees regular thus results section 3 apply provide minimal distances p reduced measures supported n scenarios n small example 41 binary scenario tree 05 06 07 09 11 13 16 19 23 27 figure 4 illustrates original scenario tree proposition 31 applies k n holds n 256 n n example 42 ternary scenario tree 07 09 12 15 26 33 tree shown figure 5 proposition 32 applies n holds 2n 14 heitsch romisch example 43 ternary load scenario tree consider scenario tree construction section 4 4 weekly electrical load process german power utility see also 58 description stochastic power management model solution lagrangian relaxation original construction based hourly discretization weekly time horizon branching points piecewise linear interpolation k corresponding mean shifted tree illustrated figure 6 moment disregard nonbranching points time discretization consider corresponding mean shifted tree latter tree regular ternary scenario tree denotes standard deviation stochastic load process time since case increases increasing proposition 32 applies k holds min n finally remains remark due piecewise linear structure scenarios choice maximum norm dening c minimal distance min n change including nonbranching points original scenario trees examples 4143 reduced trees containing n scenarios using 3 reduction algorithms corresponding tables contain relative accuracy running time algorithm needed produce reduced tree n scenarios addition tables provide relative lower bound 15 relative minimal distance n percent available relative always means corresponding quantity divided minimal c distance p one scenarios endowed unit mass particular relative accuracy dened quotient c distance original measure p reduced measure qn n scenarios c distance p rel c denotes set scenarios p dened c c numerical experience shows algorithms work reasonably well algorithms reduce 50 scenarios p optimal way ex pected simultaneous backward reduction fast forward selection produce accurate trees backward reduction scenario sets expense higher running times results also indicate fast forward selection slightly accurate simultaneous backward reduction although backward reduction variants sometimes competitive fast forward selection works much faster implementation forward selection scenario reduction algorithms stochastic programming 15 figure 4 original binary scenario tree number backward simultaneous fast lower minimal n scenario sets backward forward bound distance scenarios rel c time rel c time rel c time table 1 results binary scenario tree reduction heitsch romisch figure 5 original ternary scenario tree number backward simultaneous fast lower minimal n scenario sets backward forward bound distance scenarios rel c time rel c time rel c time table 2 results ternary scenario tree reduction scenario reduction algorithms stochastic programming 17 50050024 48 72 96 120 144 168 figure original load scenario tree number backward simultaneous fast lower minimal n scenario sets backward forward bound distance scenarios rel c time rel c time rel c time table 3 results load scenario tree reduction heitsch romisch 4 instance fast forward selection required 35 seconds determine load scenario subtree example 43 containing 600 scenarios instead 8149 seconds reported 4 especially case deeply reduced trees fast forward selection works fast accurately furthermore turned lower bound good even optimal large n extremely pessimistic small n another observation reduction half scenarios implies loss 10 relative accuracy instance case example 42 possible determine subtree containing 6 originally 729 scenarios still carries 50 relative accuracy finally take closer look numerical results load scenario tree reduction particular compare running times simultaneous backward reduction fast forward selection case figure 7 displays10300 100 200 300 400 500 600 time seconds number scenarios fast forward simultaneous backward figure 7 running time reducing load scenario tree running times algorithms shows clearly opposite algorithmic strategies ects corresponding theoretical complexity results propositions 23 26 shows running time fast forward selection smaller n napproximately conrms forward selection concept favourable n small figures 8 9 10 show reduced load trees 15 scenarios obtained algorithms gures display scenarios line width proportional scenario probabilities scenario reduction algorithms stochastic programming 19 50050024 48 72 96 120 144 168 figure 8 backward reduction load tree 50050024 48 72 96 120 144 168 figure 9 simultaneous backward reduction load tree 50050024 48 72 96 120 144 168 figure 10 fast forward selection load tree heitsch romisch acknowledgement research partially supported bmbf project 03rom5b3 appendix proof theorem 21 let j arbitrary index set set c ij c programming duality implies feasible q particular consider holds ki hence obtain next set u min 2 noting u hence obtain feasible q proof complete 2 r introduction algorithms reduktion von szenariob handbooks operations research management science probability metrics stability stochastic models theory probability applications 28 tr introduction algorithms integer programming quantitative stability stochastic programming