completion energies scale abstractthe detection smooth curves images completion gaps two important problems perceptual grouping study examine notion completion energy curve elements showing exploiting intrinsic dependence length width scales introduce fast method computing likely completion two elements developing novel analytic approximations fast numerical procedure computing curve least energy use newly developed energies find likely completions images generalized summation induction fields done multiscale procedures ie separate processing different scales interscale interactions procedures allow summation induction fields done total log n operations n number pixels image important procedures yield realistic dependence induction field length width scales field long element different sum fields composing short segments b introduction smooth completion fragmented curve segments skill human visual system demonstrated many compelling examples due skill people often able perceive boundaries objects even lack sufficient contrast presence oc clusions number computational studies addressed problem curve completion attempt provide computational theory problem part process extracting smooth curves images studies commonly obtain two edge elements also referred edgels find either likely completions connect elements smoothest curves trav research supported part israel ministry science grant 4135 193 gauss minerva center scientific computation research supported part unites statesisrael binational science foundation grant 9400100 eling methods proposed problem generally require massive computations results strongly depend energy function used evaluate curves image therefore important develop methods simplify computation involved methods providing results competitive existing approaches present method directly relates number recent studies completion curve salience 9 18 5 19 12 7 see also 2 6 8 14 15 along simplifying computations proposed studies method also takes account size edge elements allowing proper computation completion saliency different scales number studies addressed problem determining smoothest completion pairs edge elements studies seek define functional given two edge elements defined location orientation image selects smoothest curve connects two minimizing curve common functional based notion elas tica minimizing total squared curvature curve 9 scale invariant variations functional introduced 18 5 definition scaleinvariant elastica intuitive exists simple analytic expression calculate shape energy existing numerical computations ordersofmagnitude expensive shown first part paper revisit problem determining smoothest completion pairs edges introduce two new analytic approximations curve least energy first approximation obtained assuming deviation two input edgels straight line connecting relatively small assumption valid examples used demonstrate perceptual completions humans monkeys 10 11 show simplifying assumption hermite spline see eg 13 provides good approximation curve least energy good approximation least energy develop second expression directly involves angles formed edgels straight line connecting second expression shown give extremely accurate approximations curve least energy even input edgels deviate significantly line connecting introduce new fast numerical method compute curve least energy show analytic approximations obtained early stages numerical computation several recent studies view problems curve completion salience follows given edge elements space curves connecting pairs elements examined attempt determine completions likely using smoothness length considerations purpose 7 19 define affinity measure two edge elements grows likelihood elements connected curve fixing one elements allowing element vary entire image induction field representing affinity values induced fixed element rest image obtained system finds likely completions elements applying process includes summation induction fields elements second part paper use newly developed completion energies define affinity measure encourages smoothness penalizes gap length use induction fields defined affinity measure solve problem finding likely completions elements since practice edge elements never dimensionless usually obtained applying filters certain width length image adjust affinity measure take parameters ac count relating scale filters range curvatures detected orientational resolution needed finally show affinity measure asymptotically smooth implemented using multigrid methods run efficiently time complexity onm n number pixels number discrete orientations every pixel paper divided follows section 2 review notion elastica scale invariant variation section 3 introduce two analytic approximations curve least energy section 4 develop fast numerical method compute curve least energy compare analytic approximations finally section 5 construct affinity measure taking account length width edge filters applied image discuss multiscale multigrid method fast summation induction fields 2 elastica consider two edge elements positioned r 2 directed orientations 1 2 respectively measured righthand side line passing shall confine case may conveniently assume illustrated fig 1a let c 12 denote set curves e 1 e 2 denote curve orientation representation ys 0 l arclength along curve r r also denote curvature curve dysds r f f f 1 r b figure 1 planar relation two edge ele ments relation governed measured line b general relation f common functional used determine smoothest curve traveling p 1 p 2 respective orientations 1 2 elastica functional namely smoothest curve e 1 e 2 curve ys minimizes functional g el def r l elastica already introduced euler first applied completion ullman 17 properties investigated horn 9 one problems classical elastica model changes behavior uniform scaling image fact according model increase r distance two input elements energy curve connecting proportionately decreases easily seen rescaling cf 1 somewhat counterintuitive since psychophysical neurobiological evidence suggests affinity pair straight elements drops rapidly distance 11 also classical elastica yield circular arcs complete cocircular elements solve problems weiss 18 5 proposed modify elastica model make scale invariant functional defined g inv r l believe proper adjustment completion energy scale must take account length curve equivalently distance input elements also dimensions input edge elements elastica functional scale invariant version assume input elements dimensions practice however edge elements frequently obtained convolving image filters specified width length proper adjustment completion energy result scaling distance elements also consider whether corresponding scaling width length elements taken place first develop useful approximations scale invariant functional approximations also readily used slight modifications classical elastica measure later section 5 develop affinity measure elements also takes account distance elements dimensions 3 analytic simplification g inv although definition classical scale invariant elastica functionals fairly intuitive simple closedform expression specifies energy curve shape obtained functionals section introduce two simple closedform approximations functionals first approximation valid sum angles jf relatively small assumption represents intuition psychophysical demonstrations gap completion perceived orientations curve portions completed nearly collinear assumption may also restrict range applicable orientations second approximation assume jf small ie curve portions completed nearly cocircular since curve least energy supposed smooth reasonable assume within chosen range smoothest curve wind much consequently described function fig 1a expressing curvature terms x obtain g inv r l get l r variation unimportant comparison g inv different curves 2 c 12 g inv r r r hence g inv r min minimizing curve appropriate cubic hermite spline see 1 r evidently simple approximation e inv scale independent leads us define scaleinvariant spline completion energy e spln although spline energy provides good approximation scale invariant elastica measure small values jf measure diverges large values alternative approximation e inv constructed noticing small values tan f 1 f 1 tan f 2 f 2 thus may define refer functional scaleinvariant angular completion energy measure diverge large values jf fact f section 4 show angular energy obtained early stage numeric computation e inv provides extremely accurate approximations scale invariant least energy functional even relatively large values jf 1 jjf 2 j especially small jf range nearly cocircular elements using numeric computation also derive smoothest curve according angular completion energy generalized follows eq 4 identical eq 6 2 angular completion energy made equal sum two penalties one squared difference f 1 f 2 growth suggests possible generalization e ang weights 0 b 0 one also think using energies e circ elaborate study types energies properties presented 1 finally note new approximations small angles also used approximate classical elastica energy since el g el 1 4 computation e inv use scaleinvariance property g inv order reformulate minimization problem minimizing c 12 curves length applying eulerlagrange equations see eg 13 get necessary condition extremal curve satisfy st 8 considering nature original minimization problem also repeatedly differentiating sides ode equation shown solution must smooth hence well approximate solution polynomial form n small comparison discretization problem presented 5 far less efficient since exploit infinite smoothness solution full interval 01 result accuracy 5 second order 1order ie error decreases exponentially number discrete variables eq 8 fixing n well two integers n p build following system n2 equations n2 unknowns collocating ode n weights porder numerical integration generally increase n gradually increase n p functions n way discretization error governed discretization error integration nonlinear system equations solved newton iterations also called newtonraphson see eg 13 start newton iterations solution previously obtained system lower n actually one newton iteration needed value n n incremented fast way convergence extremely fast step several dozen computer operations error solving differential equation squared fact due smoothness solution ode already simple 2system simpson integration rule good approximation accurate solution also e inv obtained seen 1 good approximations obtained already small values n n suggest e inv well approximated simple analytic expressions indeed show 1 comparingbetween several simple approximations e inv fig 2 illustrates completions obtained using inv two analytic approximations e ang e spln seen differences three curves barely noticeable except large angles e spln diverges notice especially close agreement curve obtained angular energy eq 5 obtained scaleinvariant elastica measure even large angles angles deviate significantly cocircularity note although spline curve approximate scale invariant elastica curve large angles jf 1 j jf 2 j still produces reasonable completion elements fact two elements deviate co circularity elastica accumulates high curvature one ends whereas spline curve continues roughly follow tangent two elements ends see eg fig 2b behavior desirable especially elements segments see section 52 5 completion field summation considered problem finding smoothest completion pairs edge elements natural generalization problem given image edge elements extracted find likely completions connecting pairs elements image rank according likelihoods problem recently investigated 7 19 studies affinity measures relating pairs elements defined measures encourage proximity smoothness com pletion using affinity measures affinities induced element elements image referred induction field element derived likelihoods possible completions computed simultaneously process includes summation induction fields elements important issue overlooked previous ap proaches however issue size edge elements studies curve completion assume edge elements dimensionless practice however edge elements usually obtained convolving image filters certain width length proper handling scale must take parameters account thus example one may expect scaling distance two elements would result change affinity two elements elements scaled proportion first present general type nonscaled induction underlying previous works modify induction properly account width length edge elements finally process summing induction fields may computationally intensive nevertheless third part section show summation kernel obtained method smooth thus summation induction fields speeded considerably using multigrid algorithm result also applies summation kernels 19 16 7 efficient implementation methods obtained similar multigrid algorithm 51 nonscaled induction 12 19 model computing likelihoods curve completions referred stochastic completion fields figure 2 completion curves elastica solid line eq 5 dotted line cubic hermite spline eq 2 dashed line proposed according model edge elements image emit particles follow trajectories brownian motion shown likely path particle may take source element sink element curve least energy according elastica energy function 1 compute stochastic completion fields process summing affinity measures representing source sink fields used 1 show analyzing results 16 affinity measure used induction 19 16 general type ae 1 fig 1b r 0 oe 0 strictly positive apriori set parameters parameters need adjusted properly according scale involved see sec 52 note small values jf 1 jjf 2 el hence el oe 0 another method uses summation induction fields compute salience curves presented 7 method affinity two edge elements cocircular form e gammafl r e gammaffi fl ffi strictly positive constants curvature circle connecting e 1 e 2 r distance e 1 e 2 reasonable straightforward definition spirit serves approximation according eq 3 fig 3 shows example computing stochastic completion field suggested williams jacobs 19 replacing affinity measure simple expression verified comparing fields obtained affinity measure fields presented 19 results similar although much simpler affinity measure employed 52 induction scale given image edge element producedby selecting filter certain length l width w eg rectangular filters convolving filter image certain position orientation result convolution scalar value referred response filter edge filter may example measure contrast along primary axis case response represents edgeness level likelihood relevant subarea image contain edge l w scale similarly 1 actually path minimizes energy functional r l predetermined constant b figure 3 stochastic completion fields 128 theta 128 pixels 36 orientations induction e gamma2r e gamma20e spln f results closely resemble obtained 19 filter may indicate existence fiberlike shapes image case response represents fiberness level relevant subarea image use term straight responses refer responses obtained convolving image edge fiber filter consider edge elements obtained convolving image filter fixed length l width w every edge element positioned certain pixel p oriented two opposite directed orientations number edge elements required faithfully represent image scale depends l thus long thin elements require finer resolution orientation square elements fact orientational resolution required sample significantly different orientations increases linearly lw see 4 similarly elements larger size require less spatial resolution elements smaller size brandt dym 4 use observations order introduce efficient computation log n n number pixels image significantly different edge elements given particular scale determined length l width w edge elements would like compute completion field scale note curves within relevant range curvature radii arouse significant responses l theta w elements denote smallest curvature radius arouse still significant response curvature radii arouse significant responses also larger lw scales implying fartherreaching orientationspecific continua tion fig 4a see consequently l2ae 2 implying ae l 2 8w next consider pair straight responses assuming elements roughly cocircular using relations defined fig 4b differential relation 0 1aes approximated w rae hence completion particular scale l w reasonable define every pair points p 1 p 2 scale turning angle w given rael w scale lw define completion energy pair straight responses depend scaled turning angle waer since straightforward show 05w reasonable definition scaled angular energy therefore monotonically decreasing function aer rcosa r f 1y f r b r figure 4 relation lw curvature radius ae b turn w moving particle takes way two straight responses characterized planar location orientation obviously given scale straight responsesl w every f 1 f 2 induction p 1 upon p 2 decrease increase rae hence define field induced element e 1 length l width w location directed orientation 1 similar element e 2 u 1 denotes strength response e 1 appropriate function response ae r f f distance turning attenuation functions smoothly decreasing dimensionless functions determined considerations experience thus summation kernel product orientational spatial components involved completing curve e 1 e 2 shall see definition many computational advantages let fu g denote set straight responses given scale l w u associated two directed edges total field induced element e expressed theta total field induced given g lw theta theta since general responses obtained convolving image edge filters bidirectional may want combine two fields one done various ways simplest way take sum fv completion field another possibility spirit 19 take product fv j completion field note field long straight response different fartherreaching orientation specific sum fields shorter elements composing strongly depend width see fig 5 suggests comprehensive completion process one must practice multiscale process performing separate completion within scale scaled induction field 1011 avoids fundamental difficulty nonscaled fields like 7 19 16 latter exhibit weak completion far elements would completely masked local noise foreign local features103050a103050b figure 5 induction fields 200 theta 200 pixels different scales using f induction field one long directed orientations b sum induction fields three shorter elements composing long element consist directed orientations 53 fast multigrid summation inductionfields number sites p number orientations site required order describe l theta w straight responses significantly different shown see 4 l w measured pixel units npixel picture total number l theta w elements onw hence geometric sequence scales eg l124 w139 total number straight elements log n shown 4 responses elements calculated log n operations using multiscale algorithm constructs longerelement responses shorter ones given scale l theta w seems summations eqs 12 13 summing value would require total operations even though performed parallel 20 however using smoothness properties particular kernel 11 summation reorganized multiscale algorithm totals onm operations number unparallelizable steps grows logarithmically nm indeed functions 11 would usually take typical form f choices functions practically reasonable choice kernel property asymptotic smoothness mean q order derivative g respect six arguments decays fast r theta higher q faster decay also fixed r ij even smallest ie r ol g smooth function j due asymptotic smoothness total contribution v j elements far p j smooth function need computed separately j interpolated qorder interpolation small error desired using sufficiently high q values representative points similar reasons multiscale algorithms split summations various scales farness see details 3 perform summations merely onm operations 6 conclusion important problems perceptual grouping detection smooth curves images completion gaps paper simplified computation involved process completion exploiting smoothness solution problem defined affinity measures completion take proper account scale edge elements particular introduced new closedform approximations elas tica energy functional presented fast numeric method compute curve least energy method error decreases exponentially number discrete elements used approximations define affinity measure takes account width length edge elements considering range curvatures detected corresponding filters scale finally shown solutions problem finding likely completions image implemented using multigrid algorithm time linear number discrete edge elements image last observation applies also recent methods completion salience 7 19 future intend use multigrid algorithm simultaneously detect completions different scales order combine completions single saliency map r completion energies scale shape encoding subjective contours multilevel computations integral transforms particle interactions oscillatory kernels fast computation multiple line integrals minimal energy trajec tories role illusory contours visual segmentation inferring global perceptual contours local features computational model neural contour processing figureground segregation illusory contours curve least energy organization vision improve ment visual sensitivity changes local context parallel studies human observers v1 alert monkeys elastica computer vision handbook applied mathematics second edition shape completion structural saliency detection globally salient structures using locally connected network analytic solution stochastic completion fields fillingin gaps shape subjective contours model generation 3d shape representation contours stochastic completion fields neural model illusory contour shape salience local parallel computation stochastic completion fields tr ctr washington mio anuj srivastava xiuwen liu contour inferences image understanding international journal computer vision v69 n1 p137144 august 2006 sylvain fischer pierre bayerl heiko neumann rafael redondo gabriel cristbal iterated tensor voting curvature improvement signal processing v87 n11 p25032515 november 2007 marie rochery ian h jermyn josiane zerubia higherorder active contour energies gap closure journal mathematical imaging vision v29 n1 p120 september 2007 dan kushnir meirav galun achi brandt fast multiscale clustering manifold identification pattern recognition v39 n10 p18761891 october 2006 fragmentbased image completion acm transactions graphics tog v22 n3 july benjamin b kimia ilana frankel anamaria popescu euler spiral shape completion international journal computer vision v54 n13 p157180 augustseptember song wang joachim stahl adam bailey michael dropps global detection salient convex boundaries international journal computer vision v71 n3 p337359 march 2007 jonas august steven w zucker sketches curvature curve indicator random field markov processes ieee transactions pattern analysis machine intelligence v25 n4 p387400 april xiaofeng ren charless c fowlkes jitendra malik learning probabilistic models contour completion natural images international journal computer vision v77 n13 p4763 may 2008 song wang toshiro kubota jeffrey mark siskind jun wang salient closed boundary extraction ratio contour ieee transactions pattern analysis machine intelligence v27 n4 p546561 april 2005