waveletbased numerical homogenization numerical homogenization procedure elliptic differential equations presented based wavelet decompositions discrete operators fine coarse scale components followed elimination fine scale contributions operator divergence form preserved homogenization procedure periodic problems results similar classical effective coefficient theory proved procedure applied problems cellperiodic b introduction many applications problem solution exhibit number different scales certain cases interested finding correct coarsescale features solution without resolving finer scales finescale features may lesser importance may prohibitively expensive compute however fine scales cannot completely ignored contribute coarse scale solution high frequencies solution may combine high frequencies research supported office naval research grants n0001492j1890 p00003 n00014 95i0272 numerical analysis computing science royal institute technology stockholm mihainadakthse z department mathematics university california los angeles california 90024 engquistmathuclaedu numerical analysis computing science royal institute technology stockholm differential operator yield low frequency components homogenization problem stated various formulations classical formulation see eg bensoussan et al 1 following consider family operators indexed small parameter given f let u solve problem assume homogenization problem find operator l f example consider following operator oscillating coefficients dx dx ax positive 1periodic function bounded away zero easy show limit u satisfies constant coefficients equation coefficient average ax period rather harmonical average also called effective coefficient homogenized operator since f practice often need solve equation 1 small fixed since close u may solve homogenized equation 2 instead original equation homogenized equation usually much simpler solve case effective coefficients solution homogenized equation contains high frequency components thus approximation coarse scale behavior interesting paper e brewster g beylkin 3 describe homogenization procedure based multiresolution analysis mra decomposition consider integral equations may arise eg method lines discretization pde homogenize timevariable mra concept different scales contained nested spaces v j homogenization reduced projecting solution original equation fine resolution space v n onto coarse resolution space v 0 homogenized operator exists operates space v 0 general projection original operator onto coarse space many classical homogenization techniques based essential assumption coefficients periodic fine scale however hold many applications analytic expansions methods require priori known number scales may serious restriction see eg l durlofsky 7 twodimensional elliptic operators cellperiodic coefficients homogenized operator effective coefficients ij found computing z solution cellproblem ik waveletbased homogenization deal nonperiodic coefficients fine scale use scales involved finescale space v j coarsescale space v 0 following construction 6 using haar system build homogenized operator l j discrete operator 1 gridsize forward backward undivided difference operators show homogenized operator natural structure form 1 h well approximated band diagonal matrix cases prove h equals effective coefficients predicted classical homogenization ory modulo small errorterm twodimensions show technique preserves divergence form operators concerned model fine coarseresolution spaces framework multiresolution analysis wavelet formalism framework concepts fine coarse scales together locality properties needed analyzing operators variable coefficients precise definitions mra defer reader books daubechies 4 meyer 9 consider ladder spaces v j ae v j1 spanned dilates integer translates one shapefunction functions jk form l 2 orthonormal basis orthogonal complement v j v j1 denoted w j generated another orthonormal basis called mother wavelet transformation mapping basis f j1k g f jk jk g orthogonal operator denote inverse w product w j called wavelet transform optimally implemented called fast wavelet transform denote p j q j l 2 projections onto operator l j1 acting space v j1 decomposed four operators l acting subspaces w j v j shorthand notation simply note evaluated basis operator notation becomes legitimate block matrix construction identification function f 2 v j sequence c coefficients basis jk isometry unless otherwise specified jjjj notation refers corresponding 2norm con tinuous discrete holds innerproduct notation results proven simplest multiresolution analysis haar system shape function indicator function interval 0 1 mother wavelet haar system provides orthonormal basis l 2 r l 2 0 1 space v j consists piecewise constant functions grid stepsize identified l 2 r 2 j finite case haar transform v j1 w j phi v j simply 3 homogenization haar basis discretize equation dx dx uniform grid using finite volumes let diaga diagonal matrix containing values ax gridpoints operator v j1 diaga represents multiplication gridfunction discrete equation split natural decomposition v u l f l indices h l denote w j v j components equation 3 discretization continuous equation axu 0 coarse scale solution discrete equation 3 projection u onto v j ie u l eliminating u h yields equation u l homogenized operator schur complement let us make preliminary remarks ffl homogenization procedure fact block gaussian elimination idea new found eg oddeven reduction techniques real gain homogenized operator l j well approximated sparse matrix compression properties wavelets maintain homogenization procedure efficient similar case calderonzygmund operators seen 2 5 ffl experience nonstandard form representation elliptic operators indicate j strong diagonal dominance thus inversion difficult inverting operator l j1 see 6 ffl expect homogenized operator l j similar structure operator l j fact see l j1 divergence form h strongly diagonal dominant matrix call h homogenized coefficient matrix ffl homogenization procedure applied recursively equation produces solution scale homogenize operator l j1 means produce operator l j righthand side f j solution homogenized equation ffl homogenized operator rapid decay away diagonal well approximated banddiagonal operator applies matrix h structure homogenized operator given decomposition discrete operators delta diaga 31 multiplication operator first examine multiplicationbyfunctions operator diaga following lemma obvious lemma 1 haar systems shape function mother wavelet use notation w j fi v denote componentwise multiplication vectors following pointwise multiplication rule e e fi e proof set p j1k j1k using lemma 1 kl j1k v j1l j1k j1l j1k v j1k thus pointwise multiplication functions equivalent componentwise multiplication coefficients e k jk e proves statement2 high frequency components v interact contribute low frequency part product av modeled haar basis correcting product fi v coarse scale coefficients fine scale contribution e fi e v structure pointwise multiplication operator given following statement proposition 1 w j diaga diage diage diaga7 5 matrix diaga pointwise multiplication operator following amusing result proposition diaga multiplicationbyfunction operator coarsegrid projection p j j1 p j multiplication arithmetical averages 2k 2k1 2 homogenized operator j multiplication har monical averages ff proof coarse grid projection diaga 1 2 diaga component arithmetical average 2k 2k1 2 corresponding finegrid values homogenized operator ispi componentwise k 2a 2k 2k1 harmonical cellaverage corresponding finegrid values 2 32 decomposition delta start computing decomposition w j delta w basis functions w j phi similar computations yield let n shift matrix n defined n projection shift operator following proposition proposition 3 decomposition 1 haar system obviously structure repeated level j since dropping diag notation proposition 1 p j 33 boundary conditions notations discrete difference operators corresponding matrices describe periodic neumann dirichlet boundary conditions also operate infinite matrices infinite sequences arising discretizing problems whole real axis derivation decompositions l j1 homogenized coefficient matrix h formally however periodic case operator l j1 singular trivial j invertible periodic case matrices delta circulant property preserved transform w j define shift matrices sigma1 circulant matrices also circulant thus matrices corresponding level j property infinite case trivially circulant periodic boundary conditions easy show l j1 1dimensional nullspace spanned constant gridfunctions since vanishes con stants ellipticity condition 0 implies nonconstant zeroeigenfunction must satisfy constant follows v monotone contradicts periodicity nullspace l j1 transformed w j onedimensional space n spanned 0 constant gridfunction quadratic form j x positive whenever x 62 n particular putting 6 0 proves j positive definite therefore invertible thus homogenized operator l j welldefined even periodic boundary conditions equations l j1 u need extra conditions decide eg fix boundary value eliminate row systems elimination done homogenized operator produced thus need track effect boundary condition homogenization process type conditions dirichlet boundary conditions nonperiodic case integral conditions handled similar fashion 34 homogenized coefficient matrix let us consider discretization whole real axis ie case matrices infinite coarsescale projection l j1 l j wrong operator obvious reason average coefficient obtained using even components finescale coefficient l j insensitive variations oddcomponents original problem even finescale present ax ie e 0 l j still wrong coefficient build homogenized operator schur complement l proposition 4 operator l j natural structure 1 7 definition 1 call h homogenized coefficient matrix operator natural question ask connection homogenized coefficient matrix h classical homogenized equations proposition 2 gives schur complement diagonal matrix diagonal matrix ff containing harmonical averages neighboring values would agree exactly classical homogenization theory schur complement delta could expressed terms schur complement middle factor unfortunately case use form given 7 look extreme case sum constant highest frequency represented grid ie axm e represented constant vectors bases v j w j fact ax 0 implies je aj since e constant vectors simple computations yield homogenized coefficient matrix defined 7 classical homogenization theory yields effective equation ff 2 effective coefficient given harmonical average z 2haxdx 0 rest section looking coarse grid function space j simplicity let denote gridsize v j following theorem shows numerically homogenized operator 1 equals discrete form ff 1 classically homogenized equation apart secondorder term h theorem 1 let j1 2 v 0 constant oscillatory part e 2 w j constant amplitude satisfies condition j e aj let l ff harmonical average 9 exists constant c independent gridsize h v discretization function vx continuous bounded fourth derivative proof let us show first highfrequency operator j invertible showing diagonal dominant tridiagonal structure j clearly seen ellipticity l j1 implies diagonal entries j larger 4a sum offdiagonal terms smaller amount diagonal dominance j gives rapid decay entries gamma1 j away diagonal indeed e gamma 12 neumann expansion gamma1 j convergent 10 reveals size offdiagonal entries next compute rowsum h note first since j circulant corresponding eigenvalue 8a gamma1 j shares eigenvector c shows rowsums 18a note c also eigenvector corresponding eigenvalue 2 thus p2a finally estimate l j v note since assuming v discrete smooth function taylor expansion around v let us estimate j component hv applying h first term 12 produces ffv j due symmetry gamman applying h oddorder terms 12 shifts j component quantities opposite signs adds evenorder terms contribute show later coefficients fl n exponential decay thus convergent k applying 1 comparing turn gives desired estimate remains shown constant c independent gridsize h expansion 11 shows gamma1 j generated infinite long stencil exponential decay rate 1 build h gamma1 j first apply 1 gamma1 effect adding together neighboring diagonals indeed gamma1 p n n elements product bounded 4k ae n h found multiplication 2 addition diagonal term decay away diagonal terms fl n exponential decay fl n dominates growth n 2 thus find constant c ae log ae 2 cremark fact hv ffv smooth functions v also seen fourier analysis h discrete fourier transform h obtain diagonal matrix diagg diagonal g given symbol h note g fourier transform row h therefore surprise turns dg approximation error indeed quadratic since fourier coefficients v decay sufficiently fast gv ffv inverse transform hv ffv note figure 1 g moderate growth even large figure 1 fourier components h ffi dashed line g behaves like multiplication boundary conditions assumed practice want approximate homogenized operator l j sparse approximation due diagonal decay approximate l j band diagonal matrix l j bandwidth let us consider operator band defined ae fact two obvious strategies available producing l j set directly use homogenized coefficient form build produce small perturbations l j however important properties divergence form lost first approach numerical experiments show needs rather large compensate second approach produces l j divergence form moreover approximation error estimated following result theorem 2 conditions theorem 1 valid v discretization smooth function vx proof exponential decay diagonal h given 13 yields v smooth function using commutation property h bandh point r therefore taking supremum maximum j yields desired estimate 2 remark estimates hold also dirichlet boundary conditions case periodic boundary conditions meaning away diagonal different wraparound effect diagonal band width defined 2ji gamma jj mod size matrix 35 numerical experiments test homogenization procedures examples ffl periodic coefficients wavelet classical homogenization produce discrete solution nonperiodic variations coefficients effective equations cannot extract local features solution due localization wavelet basis elements local features preserved wavelet homogenization ffl solution several different scales test problem ax x 1 project solution spaces resolve either scales finest scale 1 ffl comparison solutions homogenized forms using two truncation strategies bandl j 1 different values see truncation homogenized coefficient matrix h performs much better 351 nonperiodic variable coefficients first compare exact classicalhomogenized wavelethomogenized solutions periodic problem consider twopoint boundary problem exact solution solves discrete equation take ax alternating values 1 100 fixed grid classical wavelet homogenized solutions pictured figure 2 exact solution wavelet homog classical homog solution wavelet homog classical homog figure 2 exact classical homogenization haar basis homogenization solutions periodic case gridpoints plot right detail left image wavelet solution computed using 3 levels ie coarse scale contains eight times fewer gridpoints effective coefficient 200101 19802 thus classical homogenization yields approximation x note detail figure 2 wavelet based solution u essentially shift u eff ie u contains high frequencies take ax uniformly distributed interval 1 100 plotted figure 3 left classical homogenized coefficient effective coefficient computed dx solution wavelet homog classical homog figure 3 coefficients ax left comparison exact solution u effective equations solution u eff haar basis homogenization solutions u gridpoints plots figure 3 right compares exact solution u wavelet homogenized u result classic homogenization u eff effective coefficient 188404 fine grid 256 points u eff u represented coarse grid using 32 points however wavelet homogenized solution u captures much coarsescale detail classic solution u eff 352 homogenization multiple scales test problem contains three different scales let coefficient three scales solution equationh 2 contains three scales h resolves finest scale ax put resolve scales problem project exact solution onto v 6 exact sol v9 projection v3 projection v6 006 002exact sol v9 projection v3 projection v6 006 figure 4 homogenization several scales coefficient plot u 9 u 6 left details plots right shows u 6 averages finest scale resolves coarser scales u 3 resolves coarsest scale figure 4 shows finest scale contribution averaged coarser scales resolved projection onto v 3 averages finer scales solution characteristics constantcoefficients problem 353 banding strategies test accuracy approximating homogenized operator banded matrices using two strategies described section 34 coefficients ax chosen random uniformly distributed interval 01 2 boundary conditions exact homog diagonals diagonals diagonals 04 03 02 01exact homog 3 diagonals 5 diagonals 7 diagonals 04 03 02 figure 5 homogenized operator approximated banded matrices banding exact homogenized operator l j left needs much larger bandwidth compared banding homogenized coefficient matrix h right 512 gridpoints fine grid 64 gridpoints coarse grid figure 5 left plot solutions bandl j u obtain even better accuracy using approximation homogenized coefficient considerably fewer diagonals needed figure 5 right plots solutions 1 diagonals 4 2d problems numerical homogenization multidimensional problems great interest since analytic methods handle periodic microstructures see eg bensoussan et al 1 aim section show 2d finescale operator discrete divergence form homogenized operator l j acting coarser space form saw onedimensional case property important efficient truncation strategies 2 operator l j1 called discrete elliptic 1 l j1 symmetric ie 2 spectrum l j1 lies f0g ffi 1 ffi 0 0 cannot multiple eigenvalue 41 2d tensor product wavelet spaces let us make notations precise consider tensor product space v generated canonical basis coarse space v jomega v j generated jkomega jl orthogonal complement v j v j1 wavelet space wavelet transform maps standard basis v j1 union standard bases v j three components w j l j1 matrix linear operator v j1 orthogonal basis transformation w j yields operators j b j c j l j operate subspaces elimination homogenized operator note finite case dimw j continue decomposition v obtain manner multiresolution analysis product space product orthogonal transformations orthogonal wavelet transform maps v j1 phi 0jj w j 42 invariance divergence form operator acts v j1 defined delta x fomega g 1d forward difference operator delta defined similar manner regard operators ij multiplication discrete functions ij x ie ij l general ij operator v j1 l j1 may longer discretization differential operator let us formulate result theorem 3 let l j1 discrete elliptic operator divergence form 14 assume periodic boundary conditions x directions let l j homogenized operator using haar transform l j also divergence form proof begin observing orthogonal transform w v j written w corresponding 1d transform xdirection w defined analogously remark also w x w w w x next observe delta x omega delta gives delta x delta next step compute decomposition delta x w using standard innerproduct tensorproduct spaces apply delta x basis function test another basis function jk jk note second innerproduct 0 g 1 6 g 2 first innerproduct gives 1d decomposition delta proposition 3 using notations proposition 3 synthesis decomposition following table w theta w w theta v v theta w v theta v w theta w momega gammadelta omega momega gammadelta omega v theta w delta delta omega delta omega similar fashion obtain decomposition delta iomega iomega iomega gammam delta gammaomega gammam delta gammaomega gammaomega delta gammaomega gammaomega delta essential point last blockrow decomposition delta x delta contains delta omega entries delta x delta analogous holds last blockcolumn noting delta coarse space v j decomposition product 1 gamma form4h 26 6 6 4 arbitrary operators adding contributions terms form 14 l j1 yields4h 26 6 6 4 discrete divergence form since l j1 elliptic periodic boundary conditions imply onedimensional nullspace spanned constant functions nullspace mapped transform w j v j since operator l j1 nonnegative eigenvalues operates complement v j follows v av 0 v 6 0 therefore invertible build homogenized operator block gauss elimination yields delta 1 stands delta x l j divergence form coarse space v j 2 remark conservation divergence form l j1 2d haar transformation important consequences multidimensional case known problem r admits homogenized equation apart cellperiodic problem general algorithm deriving homogenized operator l fact nature l known numerical homogenization therefore used practical tool also find information structure homogenized operator l 43 numerical example chose ax 1 classical homogenized equation harmonical average cell length period 2 arithmetical average cell homogenized equation constant coefficients strongly anisotropic figure 6 displays exact wavelet homogenized solutions domain unit square dirichlet boundary conditions coordinate axes neumann conditions two sides 5 5 figure fine scale left homogenized solution right note homogenized solution captures effect coarsescale strong anisotropy averaging finescale variations extensions homogenization procedure carried coarser coarser levels produce sequence homogenized equations solve coarse scale problem exactly block backsubstitution produce exact solution truncations used building homogenized operators l j strategy describes exact direct solver compares reduction techniques computational linear algebra see 8 truncations used direct solver contains approximation error homogenization procedure applied recursively number lev els provided initial operator discrete divergence form elliptic two properties sufficient existence schur complement inherited homogenized operator necessary l j1 approximates differential operator long elliptic divergence form coarser scales homogenized operator resembles inverse differential operator expected dense use wavelets high number vanishing moments known compress well calderonzygmund operators could better compression effects haar system spirit ideas presented beylkin coifman rokhlins work 2 applications want use homogenized coefficient matrices would invert j rather lufactorize prescribed bandwidth r asymptotic analysis periodic structures fast wavelet transform numerical algorithms multiresolution strategy numerical homoge nization ten lectures wavelets wavelets singular integrals curves surfaces numerical calculation equivalent grid block permeability tensors heterogenuous porous media matrix computations ondelettes et operateurs tr ctr shafigh mehraeen jiunshyan chen waveletbased multiscale projection method homogenization heterogeneous media finite elements analysis design v40 n12 p16651679 july 2004 giovanni samaey ioannis g kevrekidis dirk roose patch dynamics buffers homogenization problems journal computational physics v213 n1 p264287 20 march 2006 assyr abdulle e weinan finite difference heterogeneous multiscale method homogenization problems journal computational physics v191 n1 p1839 10 october pingbing ming xingye yue numerical methods multiscale elliptic problems journal computational physics v214 n1 p421445 1 may 2006 jiunshyan chen hailong teng aiichiro nakano waveletbased multiscale coarse graining approach dna molecules finite elements analysis design v43 n5 p346360 march 2007