numerical approximation maximal solutions class degenerate hamiltonjacobi equations paper study approximation scheme class hamiltonjacobi problems uniqueness viscosity solution hold class includes eikonal equation arising shapefromshading problem show appropriate stability condition satisfied scheme converges maximal viscosity solution problem furthermore give estimate discretization error b introduction given hamiltonjacobi equation general result due barlessouganidis 3 says reasonable approximation scheme based fe finite differences finite elements finite volumes discretization characteristics etc converges viscosity solution equation besides simple properties approximation scheme satisfy requested equation satisfies comparison theorem discontinuous solutions particular implies uniqueness viscosity solution result covers wide class first second order hamiltonjacobi equations yet interesting examples equations coming applications uniqueness viscosity solution hold significant example given eikonal equation open bounded domainomega ae r n coupled example dirichlet boundary condition equation arises shapefromshading problem image analysis large literature devoted study see 4 description problem paper written second author visiting dipartimento di matematica universita di roma la sapienza supported dfggrant gr156921 research partially supported tmr network viscosity solutions applications 16 viscosity solution approach well known f vanishes points infinite many viscosity solutions 11 see 15 nevertheless among solutions general one relevant solution example physical point view control theoretic one etc 6 see also 14 requiring stronger condition supersolution standard viscosity solution comparison principle characterizes maximal viscosity solution problem obtained following class hamiltonjacobi problems hereomega bounded domain r n h f nonnegative continuous functions f general zero set eikonal equation 11 fits class equation worth noting maximal solution value function control problem associated suitable way 1213 general two approaches discretization problem 1213 first possibility discretize problem 1213 directly imposing additional condition among infinite many solutions singles one want approx imate example 17 assumed solution known zero set f part boundary domain problem discretized second possible approach see 4 5 references therein discretize regularized version problem 1213 obtained cutting f positive level note f 0 problem 1213 unique viscosity solution prove convergence scheme ffl discretization step h send 0 since limit problem unique viscosity solution possible apply barlessouganidis theorem knowledge convergence theorem class schemes least general zero set f furthermore ffl h related condition approximation scheme shows numerical instability really known solution approximated see 12 numerical tests sense aim paper describe approximation scheme possible prove convergence maximal solution problem 1213 without requiring additional assumptions scheme based two step discretization control problem associated regularized problem first time variable discretization step h space variable discretization step k see 2 13 related ideas first part sections 3 4 study approximation scheme obtained discretization time show ffl h related appropriate way scheme converges maximal solution 1213 ffl h going zero result spirit 3 sense based stability properties maximal viscosity solution characterization given comparison theorem 6 therefore proof convergence theorem easily modified manage boundary conditions instead 13 also different approximation schemes necessarely based control theoretic interpretation problem approximation degenerate hamiltonjacobi equations 3 second part section 5 study discretization error fully discrete scheme show zero set f wild possible estimate terms ffl discretization steps l 1 distance approximate solution maximal solution continuous problem part deeply employs control theoretic interpretation discrete problem continuous one continuous problem assumptions results section briefly recall characterization maximal solution problem obtained 6 remainder paper sub supersolutions mean crandalllions viscosity sub supersolutions see 1 general treatment first set assumptions data problem hamiltonian h omega theta r n assumed continuous variables verify lim uniformly x strictly increasing 2 0 1 x p 2omega theta r n convex x note hypothesis 22 replaces stronger one convexity h p function f r nonnegative continuous inomega moreover defined k fx 2 assumed finally assume g r n r continuous bounded function introduce gauge function ae support function ffi convex set zx namely x p 2omega theta r n functions convex homogeneous variable p lsc respectively continuous inomega note x 2 k aex related following equality example 21 let continuous function strictly increasing consider equation case define nonsymmetric semidistance onomega thetaomega r x 2omega r 0 open sets fy shown family bl x r induces topology l omegagamma k consists isolated points topology equivalent euclidean topology problem studied framework viscosity solution theory see 14 general l weaker euclidean topology x 2 k set points zero ldistance x subset k obtain characterization maximal solution definition viscosity solution adapted topology l definition 22 given lsc function v continuous function oe called lsubtangent v x 0 2omega ffl 0 lsubtangent called strict oex vx outside bl 0g remark convexity assumption 22 allows us use lipschitz continuous test functions instead c 1 test functions standard definition viscosity solution lipschitz continuous function oe denote oex generalized gradient oe oe differentiable x n g definition 23 lsc function v said singular supersolution 12 x 0 2omega oe lsubtangent v x 0 exists sequence x n 2omega n k sequence p n 2 oex n lim lim approximation degenerate hamiltonjacobi equations 5 worth noting definition singular supersolution reduces standard definition viscosity supersolution x 0 fact case since topology l euclidean topology equivalent neighborhood x 0 lsubtangents x 0 coincide standard subtangents moreover aex p 1 hx p fx resp hx p fx following theorem compare viscosity subsolutions singular supersolutions equation 12 theorem 24 let u 2 uscomega lscomega viscosity subsolution singular supersolution equation 12 respectively u v hypothesis 22 allows us give control theoretic interpretation problem 1213 let u value function control problem dynamics x 2omega q bounded measurable function 0 1 r n cost functional z dynamic programming equation associated control problem 210211 sup equation turns equivalent equation 12 sense viscosity sub supersolution equation 212 also viscosity sub supersolution equation 12 vice versa following assume boundary datum g verifies compatibility condition standard show hypothesis 213 u viscosity solution 12 satisfies boundary condition 13 furthermore proposition 25 value function u singular supersolution equation 12 omegagamma theorem 24 proposition 25 allow us characterize maximal solution denote set functions v 2 uscomega viscosity subsolutions 12 satisfy v g omegagamma theorem 24 proposition 25 follows value function u control problem 210211 maximal element ie maximal subsolution problem 1213 moreover u singular supersolution 12 satisfying hence maximal solution 6 fabio camilli lars gr remark 26 h convex p u coincides value function control problem dynamics 210 cost functional h x delta denotes legendre transform hx delta cp 15 note however ffix q fx h x q general coincide pointwise conclude section stating particular case general stability theorem proved 6 needed construction approximation scheme proposition 27 set f ffl sequence viscosity solutions lim ffl0 uniformly omegagamma u maximal solutions 1213 note ffl 0 fixed since f ffl 0 omegagamma problem 214 admits unique viscosity solution moreover solution given value function control problem dynamics 210 cost functional omega ffi ffl x q defined ffix q f ffl instead f introduce notations use following define moreover ffl 0 set note ffl 0 r bounded rg 3 semidiscrete scheme let us introduce semidiscrete approximation scheme obtained discretizing time exit time control problem 210215 fixed ffl 0 choose step time define discrete dynamics recursive sequence approximation degenerate hamiltonjacobi equations 7 cost given assume convention 0 value function control problem n 1g standard application discrete dynamic programming principle function u hffl solution problem following result holds true proposition 31 constant c independent h ffl moreover u hffl unique bounded solution 31 proof first observe always possible assume adding constant 0 follows u hffl 0 moreover 216 two bounded solution 31 set w 2 2omega follows r n n omegagamma conclude ffl 0 h 0 exists one bounded solution 33 therefore problem 31 solution given u hffl remark 32 discretized control problem 210211 directly corresponds setting previous approximation scheme resulting approximating equation unique bounded solution similarly happens problem 1213 causes drawback algorithm designed solve approximating equation could converge maximal viscosity solution case displays high numerical instability see 12 4 convergence semidiscrete scheme section prove convergence approximation scheme introduced previous section maximal solution 1213 given locally uniformly bounded sequence functions v ffl lim inf ffl0 ffl0 lim sup ffl0 ffl0 x 2 omegagamma functions lim inf ffl0 ffl0 respectively lsc usc inomega lemma 41 let u hffl sequence solutions 31 assume ffl0 2omega singular supersolution 12 proof 32 function u well defined omegagamma let oe r lsubtangent u x 0 2 omegagamma possible assume without loss generality see 6 proposition 51 oe strict lsubtangent u x 0 employing standard argument viscosity solution theory find sequence x ffl minimum points u tends 0 ae oe ae oe q ffl jq ffl mean value theorem lipschitz continuous functions see clarke 7 exist substituting 43 42 get observe x ffl 62 k otherwise since k approximation degenerate hamiltonjacobi equations 9 impossible since ffi ffl strictly positive omegagamma let homogeneity ffi ffl x q respect q q ffl 2 fq 2 1g dividing 44 recalling 26 get since sequence x ffl belongs hypothesis 41 u singular supersolution 12 theorem 42 assume either omega convex 46 u hffl sequence solutions problem 31 satisfies assumption 41 lim ffl0 uniformly inomega 47 u maximal solution problem 1213 proof set ffl0 ffl0 function well defined 32 proposition 41 follows u singular supersolution equation 12 moreover standard show u subsolution 212 therefore 12 inomega see fe 1 2 show u u omegagamma theorem 24 proposition 25 imply inomega therefore 47 show show ux gx omegagamma need estimate behavior u hffl neighborhood sufficiently small jg x omega dx discrete control problem denoted x n corresponding discrete trajectory let 62omega g observing nh jy gamma xj get 216 g modulus continuity g x omega x ffl 2omega sequence converging x 0 either u hffl omega dx ffl converges x 0 get ux 0 get inequality 48 g j 0 u inomega therefore u 0 46 holds adding constant always assume g 0 x 2omega let q n joptimal control u hffl x x n corresponding discrete trajectory n exit time c 32 let qt control law continuous problem obtained setting respectively trajectory time corresponding qt r estimate jt holds convexity omegagamma since u ffl x 2 omega assumption 41 satisfied 49 easily get inequality 48 remark 43 eikonal equation 11 condition 41 reduces f modulus continuity function f omegagamma 5 discretization error fully discrete scheme section discuss fully discrete scheme derived semidiscrete one developed previous sections order simplify calculations assume approximation degenerate hamiltonjacobi equations 11 function g defining boundary condition uniformly lipschitz constant l g domainomega convex introduce space discretization transforms 31 finite dimensional problem purpose choose grid gamma coveringomega consisting simplices j nodes x look solution 31 space const j g piecewise linear functions gamma parameter k denote maximal diameter simplices j simplicity assume boundary gridded domain coincides boundary omegagamma general case always achieve error scaling linearly distance two boundaries due fact g lipschitz thus end fully discrete scheme fflh fflh nodes x 2omega boundary condition u k fflh nodes x 62omega linear interpolation nodes note exists unique bounded solution 51 boundedness solution 51 follows fact fflh fflh holds q 2 r n 1 thus always choose q u k fflh depends nodes closer boundary omega x h weight strictly less one since value boundary nodes bounded obtain boundedness node induction due boundedness existence unique solution u fflh easily proved applying kruzkov transformation fflh proof proposition 31 note function ffi ffl appearing scheme defined implicitely via h f ffl order solve scheme assume compute function analytically eg example 21 case convex hamiltonian one may alternatively use numerical approximation integrand remark 26 via legendre transform given eg 10 note however procedure yields different cost function following analysis start estimating discretization error ju ffl fflh allow nonconstant boundary conditions introduce following auxiliary functions useful estimation error definition 51 point x 2omega define delta optimal path initial value x node x grid pick control q minimizing 51 let w 2 2 w unique solution boundary condition w 2 interpolation nodes finally define remark 52 existence optimal paths follows continuous dependence functional jx q control function q using weak metric defined control functions eg 9 using gronwall lemma 8 proof lemma 34ii structure ffi ffl note apriori boundedness length approximately optimal trajectories following positivity ffi ffl crucial continuous dependence thus general existence optimal trajectories hold nonregularized problem since sequence approximately optimal trajectories length trajectories may grow unbounded restrict note require uniqueness optimal paths definition 51 case unique optimal path may use one minimizes w 1 definition 51 defines functions 0 omega away omega essentially grow like fflh respectively precisely fflh fflh delta q used definition note particular gx j c constant obtain using w give following estimate discretization error proposition 53 let u k fflh 2 w unique solution 51 estimate fifflh holds x 2omega sufficiently small k 0 h 0 ff defined 216218 constant c independent ffl h k approximation degenerate hamiltonjacobi equations 13 proof found appendix remark 54 note estimate 53 stronger usual l1 estimate since essentially error scales function wx 0 omegagamma reason behaviour origins fact error estimated along optimal trajectories whose length depends optimal value ii constant ffffl essentially depends growth h jpj eg example 21 ffl constant fiffl determined difference hx p hx q particular hx p 2 c 1 jpj fiffl c 1 c 2 independently ffl finally ffi gives bound combines continuity properties h f ie example 21 ffi iii note requirement h ensuring convergence fully discrete scheme thus consistent condition 41 convergence semidiscrete scheme iv appearance value ffffl denominator 53 due fact implicitely included worst case ie length optimal trajectories may grow like 1ffffl ffffl 0 since necessarily case many practical examples one expect better convergence behaviour ffffl 0 v particular nice formulation estimate 53 obtained consider eikonal equation 11 implying assume f uniformly impose homogeneous boundary condition ie implying l 0 case estimate becomes constant c 0 independent ffl h k particular implies convergence scheme turn discussion error obtained equation 12 replaced equation 214 ie error introduced regularization problem proposition 27 already implies u converges u u maximal subsolution 12 unfortunately general convergence arbitrary slow optimal control interpretation due fact length approximately optimal trajectories may grow unbounded approximation gets better better since long pieces trajectories appear regions f sufficiently small otherwise cost would large contradicting approximate optimality derive estimate regularization error defining criterion sets f small turn gives bound length approximately optimal trajectories following definition main tool purpose definition 55 let b ae r compact set connected component b b define inner diameter db 14 fabio camilli lars gr b define inner diameter sum taken connected components b using definition state following estimate regularization error proposition 56 let u maximal subsolution 12 let u ffl unique viscosity solution 214 estimate holds k ffl fx proof found appendix constant cffl depends sets z ffl xg ie ffl hamiltonian h fact easy calculation shows thus eg estimate cffl c ffl fl constants c fl 0 ffl 0 sufficiently small holds hx p jpjc 1fl x 2 k ffl ffl 0 sufficently small p 2 r n jpj sufficiently small particular eikonal equation 11 implies observe f piecewise polynomial bounded ffl 0 hence convergence order cffl follows ffl 0 piecewise polynomial maps particular interesting since include case f obtained experimental data polynomial interpolation eg using piecewise linear interpolations multidimensional splines following theorem gives full apriori estimates approximation error whole numerical approximation theorem 57 let u maximal subsolution 12 let u k fflh unique solution numerical scheme 51 estimate fifflh holds x 2omega constants propositions 53 56 approximation degenerate hamiltonjacobi equations 15 proof follows immediately propositions 53 56 remark 58 possible modification scheme made allow smaller time steps boundary ie x 2omega x 62omega use restricted time step 2omega g although slightly difficult implement modification usually gives better numerical results proof proposition 53 also applies modified scheme ii due structural similarity scheme described section scheme considered 13 adaptive grid scheme developed also applied similar convergence results 13 obtained scheme using technique proof proposition 53 6 appendix proof propositions 53 56 order prove proposition 53 first state useful estimate local error along functional lemma 61 measurable qdelta almost 2 0 h path delta 2omega 2 0 h exists p 2 r n z conversely p 2 r n x 2omega x 2omega exists measurable function qdelta z 2omega 2 0 h proof convexity ffi ffl second argument implies z hence defining z hqtdt first assertion immediately follows continuity ffi ffl measured second assertion follows directly continuity ffi ffl setting qt j p using convexity ofomega proof proposition 53 start giving preliminary estimates first note error boundary estimated simply follows lipschitz property g furthermore easy see element j grid estimate two points show estimate 53 estimating seperately quantities u k fflh x first consider u observe fl 0 exists j 0 easily follows fact w 1 0 u k fflh bounded fix arbitrary fl 0 choose j 0 minimal 63 assertion immediately follows otherwise continuity functions compactness ofomega conclude exists x 2omega fflh consider element j containing x write x x nodes j nonnegative coefficients using estimate 62 obtain fflh i2i fflh nodes distinguish three cases 61 implies fflh 2omega optimal path delta definition 51 exists approximation degenerate hamiltonjacobi equations 17 omega case convexity ofomega conclude exists p 2 r n 62omega jx obtain fflh 2omega optimal path delta 51 equality z holds omega case lemma 61 definition u k fflh imply fflh 68 estimate definition 51 thus also taking account coefficients 65 sum 1 derive i2i fflh combining 63 64 65 610 611 obtain w 1 conclude estimating note j ffffl becomes h specify assumption h k 0 sufficiently small choosing h constant c 0 thus fih h j implies desired estimate w values resulting inequality independent fl 0 also implies estimate inequality u ffl fflh x follows technique obvious modifications using note convexity ofomega also needed lemma 61 used case iii proceeding way end analogous estimate 612 leads desired result without using assumptions k h proof proposition 56 measurable bounded q x 2omega denote solution 210 arbitrary pick x 2 omegagamma optimal control representation u 210211 exists solution omega divide connected components k k ffl two classes defining 1 continuity h exists constant flffl 2 furthermore uniform continuity f every set k volume bounded uniform constant depending ffl 2 hence finitely many sets may number define k hit trajectory ffl 1 times g omit sets k holds gives us finite number r pairwise disjoint intervals assume numbered according order ie trajectory piece ffl 1 613 fact outside k ffl functions ffi ffi ffl coincide estimate approximation degenerate hamiltonjacobi equations 19 points ffl 1 yielding ffl 2 0 ffl possible definition ddelta structure dynamics 210 define sequence times measurable function qdelta construction yields thus particular follows r x obtain dt dt letting first ffl obtain assertion since u ffl u obvious r optimal control viscosity solutions hamiltonjacobibellman equations approximation scheme minimum time function convergence approximation scheme fully nonlinear second order equations mit press global la sapienza optimization nonsmooth analysis infinite fime optimal control periodicity aspects control systems dynamical systems fast legendrefenchel transform applications hamiltonjacobi equations conservation laws numerical approach infinite horizon problem deterministic control theory image analysis processing adaptive grid scheme discrete hamiltonjacobibellman equation uniqueness results class hamiltonjacobi equations singular coefficients generalized solutions hamiltonjacobi equations viscosity solution approach shape shading tr