bounds error estimates radiosity present method determining posteriori bounds estimates local total errors radiosity solutions ability obtain bounds estimates total error crucial fro reliably judging acceptability solution realistic estimates local error improve efficiency adaptive radiosity algorithms hierarchical radiosity indicating adaptive refinement necessaryfirst describe hierarchical radiosity algorithm computes conservative lower upper bounds exact radiosity function well approximate solution bounds account propagation errors due interreflections provide conservative upper bound error also describe nonconservative version algorithm capable computing tighter bounds realistic error estimates obtained finally derive expression effect particular interaction total error yields new errordriven refinement strategy hierarchical radiosity shown superior brightnessweighted refinement b introduction past decade radiosity become method choice simulating global illumination environments consisting entirely lambertian ideal diffuse reflectors emitters global illumination environments governed fredholm integral equation second kind z kx yby dy 1 email danix bes dpggraphicscornelledu bx total radiosity point x ex emission aex reflectivity 1 kernel integral operator xy describes pointtopoint transfer x x angles surface normals line connecting x r xy distance two points vx 1 visible x 0 otherwise radiosity algorithms compute approximate solution b bx equation 1 projecting continuous integral equation finite dimensional function space radiosity algorithms use spaces piecewise constant functions although recently several investigators described radiosity algorithms use higher order basis functions 12 21 22 projection continuous equation results discrete system n linear equations n dimension finite dimensional space since radiosity algorithms produce approximate results reliable error bounds realistic error estimates crucial assessing acceptability particular solution well automatic adaptive refinement theory integral equations 1 10 provides priori error analysis computational methods fredholm equations second kind general framework valuable analyzing convergencerates 10 boundingvarious components error terms corresponding operator norms 3 however priori error bounds typically pessimistic often difficult evaluate requiring information operators exact solution may available paper discuss posteriori methods bound combined effect various error sources particular instance problem analysis takes place computation solution methods provide tighter bounds easily 1980s issues posteriori error estimation automatic adaptive refinement received considerable attention finite elements literature 4 19 work related partial differential equations recently results become available also boundary integral equations andboundaryelement methods 5 essentially similar radiosity methods radiosity literature however little written regarding posteriori error analysis particular current radiosity algorithms provide user neither guaranteed bounds total error function norm k delta k reliable 1 quantities depend wavelength simplicity restrict discussion single wavelength throughout paper estimates total error goal paper address deficiencies begin brief account past attempts estimate error radiosity approximations section 3 describe algorithm computes two piecewise constant functions guaranteed bound exact solution bx done simultaneously computation approximate solution b bx bounds pertain bx b bx used compute conservative upper bound error algorithm resembles general bracketing technique suggested brown 6 utilize special properties equation 1 produce tighter bounds many instancesa conservative error bound requiredor pessimistic good error estimate preferable section 4 describe nonconservative bounding algorithm computes tighter bounds longer guaranteed contain exact solution bx everywhere nonconservative bounds much cheaper compute result realistic error estimates ie estimates closer actual errors final contribution derivation expression describes effect particular interaction total error bound expression uses boundson importance radiosity computed using algorithms gives rise new errordriven refinement strategy hierarchical radiosity shown superior brightnessweighted refinement cohens adaptive subdivision algorithm 8 viewed first attempt posteriori error estimation algorithm elements subdivided radiosity differs neighbors certain threshold thus difference radiosities adjacent elements treated indicator local error note heuristic may fail identify elements subdivided conservative approach described campbell 7 uses numerical optimization find minimum maximum radiosity element difference extrema used criterion adaptive subdivision among various radiosity methodshierarchical radiosity hr comes closest bounding errors solution bound computed error interaction link patches hanrahan et al 13 compute approximate upper bound formfactor corresponding link use obtain approximate upper bound transferred energy smits et al 17 obtain estimate error interaction point sampling kernel function areas two interacting patches difference maximum minimum values thus obtained taken error form factor error estimate less conservative hanrahans generally accurate given error estimates links environment one approximate total error patch summing errors associated links however take account propagation errors parallels propagation light several error estimation techniques surveyed cohen wallace 9 techniques canbe classified two groups comparing approximation higher order approximation ii computing residual z dy computationally expensive provide foolproof subdivision criteria 3 radiositybounding algorithm simplicity start radiositybounding algorithm full matrix radiosity later section extend algorithm work within efficient radiosity algorithm namely hierarchical radiosity goal bounding algorithm compute two piecewise constant functions bx bx bound exact radiosity bx respectively words given discretization environment set n elements roughly achieved replacing coefficients discrete linear system 2 infima supremabounding corresponding continuous functions areas elements 31 computing lower bounds infima reflectivity emis sion respectively also let f ij denote infimum pointtoarea formfactor point z let k lower bounds vector obtained solving linear system n equations using standard method jacobi gaussseidel iteration proof easy see matrix gamma k strictly diagonally dominant follows 11 spectral radius k strictly less 1 thus inverse matrix expressed neumann series solution vector b written alternatively b expressed limit series vectors b k defined recurrence relation note corresponds jacobi iteration matrix nota tion easy see induction b k lower bound radiosity k light bounces therefore limit b lower bound total radiosity function bx 2 32 computing upper bounds unfortunately cannot use straightforward approach computing upper bounds let k defined way k except suprema taken instead infima matrix gamma k necessarily diagonally dominant entries k upper bounds formfactors thus sum absolute values entries row gamma k exceed 1 case iterative solution methods jacobi gaussseidel could diverge furthermore possible gamma k singular describe iterative algorithm transforms k strictly diagonally dominant matrix k solution linear system equations vector upper bounds solution b computed simultaneously transformation k k algorithm starts forming matrix k perform jacobi iterations using modified matrix sum formfactors given element cannot exceed 1 zero elements row k formfactors corresponding remaining nonzero entries sum 1 ensure modified matrix still yields upper bound current light bouncewe zero entries correspondingto dimmest elements since brightness ordering elements may change one iteration another different entries matrix may zeroed iteration however iterates converge solution b order elements becomes fixed point obtain k precisely iteration sort current solution vector order decreasing brightness permute columns matrix accordingly entry solution vector updated l l largest index row shown induction iterates sorted described upper bound radiosity k inter reflections thus iterates converge converge total upper bound radiosity function bx proof prove convergence must examine behavior entry solution vector algorithm progresses entries matrix k nonnegative b 0 set e entry solution vector increases iteration ie b k allow formfactors row exceed 1 entry b k bounded emax maximum emission ae max maximum reflectivity environment elementary analysis know monotonically increasing series bounded must converge since vectors b k finite dimension follows vector sequence converges 2 gatherlowerboundsnode lower foreach link 2 nodelinks lower noderho linkfmin linksourcelower end isleafnode else foreach child 2 nodechildren gatherlowerboundschild lower end gatherupperboundsnode contriblist foreach link 2 nodelinks add pair linkfmax linksourceupper contriblist end isleafnode foreach pair ff upper 2 contriblist ffsum ff nodeupper noderho ff upper else break end else foreach child 2 nodechildren gatherupperboundschild contriblist end figure 1 pseudocode gathering lower upper bounds 33 radiositybounding algorithm hr algorithms sections 31 32 presented context full matrix radiosity algorithm involve compute bounds formfactors therefore practical however modified work efficiently within hr framework requires changes standard hr algorithm need compute store upper lower bounds fmin fmax formfactor associated link gather push pull radiosity bounds way similar patch radiosities see figure 1 note gathering pushing pulling performed single sweep hierarchy thus bounds updated place makes gaussseidel iteration iteration converges faster jacobi iteration used previous hr algorithms speedup applies computation bounds computation radiosities well gathering upper bounds bit involved gathering lower bounds seen pseudocode figure 1 gatherupperbounds essentially pushes links leaves sorted according brightnesses corresponding source nodes upper bound leaf node updated using equation 3 one undesirable feature algorithm sorting links implies ok log work must done update upper bound leaf node k number contributing links however complete sorting avoided cases sorting necessary sum contributing formfactors exceeds 1 even dimmest sources must removed list done efficiently using heap data structure deletemin operation tarjan 20 provides detailed description data structures 34 bounding formfactors thus far assumed bounds f ij f ij available us obtain know analytical way computing bounds thus must resort numerical optimization find minimum maximum values pointtopolygon formfactor points j numerical methods discussed detail campbell 7 methods generally require computation formfactor gradients presence occluders done either using finite differences analytically described arvo 2 current implementation estimate formfactor bounds evaluating analytical pointtopolygon formfactor 18 center vertices receiving patch partially occluded case analytical formula applied visible parts source 16 upper lower bounds formfactor set maximum minimum values bounds conservative elements decrease size pointtoarea formfactor function becomesmonotonic elements heuristic yields accurate bounds particularly sowhena discontinuitydriven subdivision strategy 15 employed plots figures 2 3 4 show piecewiseconstant bounding functions computed hierarchical bounding algorithm three simple environments shown figure 5 exact radiosity function also plotted three cases functions plotted along dotted lines across floor environment bounds figure 2 found single iteration since interreflections environment errors propagate bounds tight fact tighter piecewise constant bounds possible elements used figures 3 4 show two cases interreflections results looser bounds due error propagation illustrated figures boundscomputedby algorithm become tighter accuracy solution increases note radiosity function bounds symmetric corresponding environments reflectivity left wall higher right wall obtained bounds radiosity element obtain upper bound local error assuming the050607radiosity bounds exact figure 2 upper lower bounds configuration shown figure 5a smooth curve middle exact radiosity coarse fine exact figure 3 nested lower upper bounds corresponding two hr solutions configuration figure 5b one solution coarse fine smooth curve middle exact radiosity function0206114 radiosity coarse fine exact figure 4 nested lower upper bounds corresponding two hr solutions configuration figure 5c one solution coarse fine smooth curve middle exact radiosity function b c figure 5 three simple test cases direct illumination b interreflections without occlusion c interreflections occlusion surfaces grey reflectivities 03 07 approximate radiosity b lies halfway b b errors l1 l 1 l 2 norms r r however error bounds represent worst case scenario give accurate error estimate even bounds radiosity tight figure 2 realistic estimates obtained assume values bx uniformly distributed b b assumption l 1 l 2 norm errors estimated compute local error estimates leaves hierarchy estimates pulled roots hierarchies combined obtain estimate total error error parent node sum childrens errors l 1 norm maximum childrens errors l1 norm norm squares childrens errors summed square root sum taken 41 obtaining tighter nonconservative bounds conservative algorithm produces bounds quite loose even simple environments resulting pessimistic error esti mates practical purposes good nonconservative error estimates could prove useful conservative error bounds quote delves mohamed 10 given two error estimates equal realism equal cost given one also bound would clearly prefer bound practice bounds usually prove expensive pes simistic users usually prefer cheaper realistic error estimate recognizing accepting estimates sometimes err side optimism present way computing tighter although conser vative bounds radiosity error estimates computed radiosity bounds guaranteed error bounds much closer true errors compute tighter bounds approximate equivalent first setting b b b b performing single gathering iteration environment using gatherlowerbounds gatherupperbounds routines one iteration performed error propagation longer accounted computation significantly simpli fied conservative estimates obtained using two iterations yielding tradeoff speed conservativity two additional changes algorithm used produce even tighter bounds first instead bounding formfactor separately summing bounds directly bound radiosity contributed node links contribution evaluated center vertices patch extrema values used bounds second set nodelower nodeupper areaweighted averages children bounds rather minimum maximum respectively 42 results test quality error estimates computed extremely fine radiosity solution three environmentsin figure 5 floor polygon eachenvironmentwassampledon 400 400 grid serve reference computed series radiosity solutions various degrees accuracy environment floor polygon sampled difference solution reference solution computed difference referred measured error solution two error estimates computed one conservative bounds tighter nonconservative bounds cases equations 4 7 8 used estimate errors figure 6 shows plots error estimates together measured error three test cases left column corresponds l1 norm right column l 1 norm error plots l 2 norm given since look almost exactly l 1 plots test cases top pair plots corresponding figure 5a conservative nonconservative bounding algorithms yield bounds therefore corresponding error estimates always l1 norm estimates follow tightly measured error l 1 norm give realistic upper bounds remaining two cases significant difference two types error estimates l1 norm nonconservative estimate always yield bound error see lower left plot l 1 norm estimates bound measured error conservative error estimates much pessimistic nonconservative counterparts h element size conservative nonconservative h element size conservative nonconservative h element size conservative nonconservative h element size conservative nonconservative h element size conservative nonconservative h element size conservative nonconservative measured figure estimated measured errors function element size three environments shown figure 5 top row corresponds figure 5a middle row 5b bottom row 5c l1 errors shown left l 1 errors right types estimates become closer measured error accuracy solutions increases estimated measured errors vary linearly element size h expected piecewiseconstant approximations original hierarchical radiosity algorithm 13 adaptively improves accuracy solution estimating error associated link links error estimate exceeds given threshold ffl refined solution recomputed specifically hanrahan et al suggest refine links estimated upper bound transferred energy exceeds ffl link refined subdividing node greater formfactor seen center node strategy referred brightnessweighted refinement gives priority links transferring energy bright sources make two observations respect brightnessweighted refinement links carrying largest amount energy necessarily ones greatest errors transferred energy ii due propagation errors refining link nodes j reduces error patch may also reduce errors patches receiving light thus make benefit link refinement priority given links greatest effect total solution error first observation suggests using estimate link formfactor error rather using upper bound formfactor error transferred energy given address second observation derive expression relates dk ij overall value upper bound overall error l 1 norm done using concept importance 51 importance linear functionals recall importance shall denote z solution adjoint transport equation 14 17 adjoint real matrix context radiosity receiver vector dual emission vector e linear functional f b radiosities expressed inner product r b r gives contribution b value f b shown 17 thus ith element importance vector gives contribution made unit emission patch value r b note entries vector non negative value l 1 norm given linear functional vector patch areas derive main result section expression relates link errors dk errors emission term z dkb sum links values summed link formfactor error dk ij weighted lower bound importance receiver z upper bound radiosity source b j intuitively upper bound incorrect radiosity patch receives patch j z gives contribution incorrect radiosity total error bound z e term gives effect nonconstant emission total error bound proof let k system lower boundson radiosities adjoint equation written upper bounds system written noting follows terms dk follows relative brightnessweighted errordriven figure 7 relative l 1 error function number links brightnessweighted vs errordriven refinement substituting equation 10 expression eequation 9 exact expression relating errors transferred energy value linear functional r particular expression applies viewdependent functionals used smits et al 17 thus expression smits et al used assess viewdependent error viewed approximation conservative bound 52 new refinement strategy equation suggests new errordriven refinement strategy hr strategy refine links z since links greatest effect total error bound order evaluate expression link routine gatherlowerbounds must modified solve lower bounds importance addition lower bounds radiosity changes straightforward significantly increase amount work done routine refine link receiver node source node j need decide node subdivide obtain greatest reduction error use following heuristic node subdivided node j subdivided otherwise intuitively means subdivide receiver error due nonconstant formfactor greater error due nonconstant radiosity source 53 results implemented brightnessweighted errordriven refinement strategies tested simple environment shown figure 5c plot figure 7 shows measured relative error floor decreasesas function number links plot demonstrates clearly errordriven refinement much efficient capable achieving much smaller errors using fraction links required brightnessweighted refinement similar results observed several test cases 6 conclusions described hierarchical radiosity algorithm computes conservative bounds exact radiosity function simultaneously computation approximate solution contrast previous attempts estimate errors radiosity algorithm properly accounts propagation errors due interreflec tions provides conservative upper boundson error also presented nonconservative version algorithm provides tighter bounds realistic error estimates finally derived new errordriven adaptive refinement strategy hierarchical radiosity significantly outperforms brightness weighted refinement hope results described paper prove useful reliable image synthesis also fields similar integral equations arise examples include radiative heat transfer illumination engineering remote sensing fields numerical accuracy results even crucial image synthesis much work needed posteriori error analysis radiosity instance need techniques efficiently computing reliable tight bounds formfactors perhaps using tools irradiance jacobians 2 also would like extend techniques described paper higher order basis functions able bound exact radiosity function bounds necessarily apply higher order approximations may exhibit oscillations 22 even approximation contained within bounds equations 7 8 probably produce pessimistic error estimates since assume approximation piecewiseconstant prior rendering image radiosity solution usually projected onto new set basis functions typically piecewiselinear piecewisequadratic 15 need analyze effect projections error order extend error estimates solutions images finally would like emphasizethe need development perceptual error metrics image synthesis fast convergencein quantitative error metric l 1 norm necessarily imply fast convergence resulting images perceived human observer thus expect perceptual errordriven refinement strategy would appropriate image synthesis acknowledgements special thanks go jim arvo without encouragement advice paper would written would also like thank richard lobb charlie van loan helpful discussions reviewing manuscript comments provided anonymous reviewers helped greatly improve paper work supported nsf grant interactive computer graphics input display techniques ccr8617880 nsfdarpa science technology center computer graphics scientific visualization asc8920219 generous donations equipment hewlettpackard r convergence error bounds approximate solutions integral operator equations irradiance jacobian partially occluded polyhedral sources framework analysis error global illumination algorithms adaptive finite boundary element methods upper lower bounds solutions integral equations brock efficient radiosity approach computational methods integral equations loan matrix computa tions rapid hierarchical radiosity algorithm adjoint function physical basis variational perturbation theory transport diffusion problems greenberg combining hierarchical radiosity discontinuity meshing salesin importancedriven radiosity algorithm new simpler formulation radiative angle factors max radiosity algorithms using higher order finite elements tr data structures network algorithms computational methods integral equations rapid hierarchical radiosity algorithm importancedriven radiosity algorithm modeling global diffuse illumination image synthesis radiosity realistic image synthesis combining hierarchical radiosity discontinuity meshing radiosity algorithms using higher order finite element methods galerkin radiosity wavelet radiosity framework analysis error global illumination algorithms irradiance jacobian partially occluded polyhedral sources ctr robert garmann heinrich mller computational complexity hierarchical radiosity computer science perspective springerverlag new york inc new york ny fraois sillion george drettakis featurebased control visibility error multiresolution clustering algorithm global illumination proceedings 22nd annual conference computer graphics interactive techniques p145152 september 1995 pellegrini monte carlo approximation form factors error bounded priori proceedings eleventh annual symposium computational geometry p287296 june 0507 1995 vancouver british columbia canada james arvo irradiance jacobian partially occluded polyhedral sources proceedings 21st annual conference computer graphics interactive techniques p343350 july 1994 hualin zhou min chen mike f webster comparative evaluation visualization experimental results using image comparison metrics proceedings conference visualization 02 october 27november 01 2002 boston massachusetts wu enhua wang wenping interleaving radiosity journal computer science technology v17 n1 p18 january 2002 wolfgang heidrich philipp slusallek hanspeter seidel sampling procedural shaders using affine arithmetic acm transactions graphics tog v17 n3 p158176 july 1998 frdo durand george drettakis claude puech visibility skeleton powerful efficient multipurpose global visibility tool proceedings 24th annual conference computer graphics interactive techniques p89100 august 1997 franois x sillion unified hierarchical algorithm global illumination scattering volumes object clusters ieee transactions visualization computer graphics v1 n3 p240254 september 1995 volevich karol myszkowski andrei khodulev edward kopylov using visual differences predictor improve performance progressive global illumination computation acm transactions graphics tog v19 n2 p122161 april 2000 cyril soler f x sillion texturebased visibility efficient lighting simulation acm transactions graphics tog v19 n4 p302342 oct 2000 doug l james dinesh k pai artdefo accurate real time deformable objects proceedings 26th annual conference computer graphics interactive techniques p6572 july 1999 george drettakis eugene l fiume structured penumbral irradiance computation ieee transactions visualization computer graphics v2 n4 p299312 december 1996 frdo durand george drettakis claude puech fast accurate hierarchical radiosity using global visibility acm transactions graphics tog v18 n2 p128170 april 1999 kavita bala julie dorsey seth teller radiance interpolants accelerated boundederror ray tracing acm transactions graphics tog v18 n3 p213256 july 1999