multivariate locally adaptive density estimation multivariate versions variable bandwidth kernel density estimators lead improvement kernel density estimators using global bandwidth choices estimators flexible better able model complex multimodal densities work two variable bandwidth estimators discussed balloon estimator varies smoothing matrix estimation point sample point estimator uses different smoothing matrix data point binned version sample point estimator developed various situations low moderate dimensions exhibits less error mise fixed bandwidth estimator balloon estimator practical implementation sample point estimator shown simulation example better job reconstructing features underlying density fixed bandwidth estimators computational details including parameterization smoothing matrix discussed throughout b introduction kernel density estimator become staple data analysis tool box largely flexibility generality method much research done theoretical properties kernel estimator superiority naive estimators histograms wellestablished crossvalidation rudemo 1982 bowman 1984 plugin sheather jones 1991 rules choosing smoothing parameters data driven automatic bandwidth selection achieved certain level maturity rules choosing bandwidths generally based relatively simple important idea balancing bias variance globally idea works well regular densities ie densities unimodal extremely skewed consider multivariate kernel density estimator given n dvariate random sample density f kernel k taken dvariate density function contours kernel restricted spherically symmetric smoothing parameter h controls size kernels straightforward asymptotic approximations yield integrated squared bias isb integrated variance iv equal nh z r k 2 wdw tr indicates trace matrix 5 2 fx hessian matrix second partial derivatives f combining terms yields estimate mean integrated squared error dx optimal bandwidth easily derived equal oe 4 choice h yields univariate standard normal distribution globally optimal smoothing parameter sample size 0421 value reflects best tradeoff variance bias density sample size interestingly optimal smoothing parameter region near mode gamma1 1 slightly smaller global bandwidth either tails 11 11 optimal bandwidth larger reflecting sparseness data attempt control higher variability tails ultimately global bandwidth closer bandwidth optimal mode largest contribution error comes area near mode effect tails substantial enough greatly influence global bandwidth dimensionality increases however socalled curse dimensionality becomes influential effect multivariate density estimates well noted friedman stue zle 1981 scott wand 1991 due sparseness data higher dimensions multivariate neighborhoods generally empty particularly tails density exercise 41 wand jones 1995 furthermore less probability mass near mode effect slowing convergence rate mise dimensionality increases relative contributions variance bias change univariate setting ratio bias variance 41 general dimensions ratio 4d hence dimension increases larger larger bandwidths necessary control increased variability particularly contributions tails however also adverse effect averaging away features near modes sain scott 1996 give another example tradeoff variance bias fails consider bimodal normal mixture form 14oe 13 normal density mean variance oe 2 mixture characteristic density difficult kernel estimator modes equal height differing scales globally optimal smoothing parameter sample size 0248 considering sample sizes associated mode optimal smoothing parameters global value reflects attempt find sort middle ground optimal mode however value h undersmooth oversmooth depending mode analyst faced difficult decision choosing features real noise graphical ideas proposed minnotte scott 1993 chaudhuri marron 1997 proven effective aids exploring structure univariate multimodal densities approaches use family kernel estimates bandwidth allowed range small large methods attractive allow user change resolution focusing large bandwidths gain insight general structure smaller bandwidths finer detail however serve emphasize lesson single smoothing parameter ineffective complex densities proposals vary amount smoothing fashion intuitively task seems straightforward smoothing necessary data scarce ie tails valleys less smoothing necessary near modes however easy model bandwidth function level underlying density alone attempt account curvature must made well sain scott 1996 actually proven difficult gain understanding exactly vary bandwidth apply understanding varying bandwidth practice particularly multivariate case paper variable bandwidth estimators studied multivariate setting building work terrell scott 1992 sain scott 1996 following brief introduction issues involved general fixed bandwidth multivariate kernel estimator section 2 comparison two common approaches variable bandwidth estimators presented sections 3 4 finally brief discussion issues problems variable bandwidth estimation practice presented section 5 fixed bandwidth estimators general multivariate kernel density estimator given kh gamma12 unlike 1 smoothing parameter h actually symmetric positive definite matrix analogous covariance matrix k hence kh straightforward asymptotic analysis involving multivariate taylors series expansions yield estimate mise following scott 1992 wand jones 1995 asymptotic approximation mise given z indicates determinant matrix choosing form h depends complexity underlying density number parameters must estimated wand jones 1993 give excellent discussion issues bivariate case three primary classes parameterizing smoothing matrix assuming k multivariate normal kernel ie x2 first class introduced 1 kernel contours restricted spherically symmetric one independent smoothing parameter keeping notation wand jones 1993 class denoted h 1 h second class h 2 allows kernels ellipsoidal however axes restricted parallel coordinate axis independent smoothing parameters allowed diag indicates diagonal matrix class commonly referred product kernel estimator allows different amounts smoothing dimension optimal bandwidths h still proportional n gamma1d4 amise order h 1 however gain obtained using different smoothing parameters dimension especially scales variables differ final class full smoothing matrix employed involves dd independent smoothing parameters denoted h 3 class allows ellipsoidal kernels arbitrary orientation given unfortunately closed form expression optimal smoothing matrix case numerical methods required find h candidate density particular sample size underlying density spherically symmetric contours standard mal optimal smoothing matrix class ie proportional identity matrix however interesting exercise compare smoothing parameterizations cases order evaluate gain terms amise well developing understanding smoothing matrix adapts shape density class consider case bivariate normal density centered origin oe 06 sample size case optimal bandwidth matrices class given 10 00 00 10 05 00 00 20 0625 075 075 25 smoothing matrices h 1 h 2 h 3 respectively standard normal kernel note smoothing matrices written form h controls size kernel controls orientation see scott 1992 restrictive case single smoothing parameter yields smaller kernel tries adjust structure density eg different scales correlation h 2 h 3 correctly adjust scale squared smoothing parameters four times larger second dimension unrestricted kernel h 3 largest area suggesting tradeoff flexibility model orientation scale density size kernel unrestricted product kernel estimators yield amise values 30 16 smaller using one smoothing parameter practice common approach scale data sample variances dimension sphere data linear transformation applied yields identity sample covariance matrix approaches essentially dimension reduction ideas allow use single smoothing parameter transformed data however wand jones 1993 urge caution using approaches guaranteed give correct transformation rotation achieve gains possible using full smoothing matrix many authors noted densities particular unimodal ones allowing different amounts smoothing dimension product kernel estimator adequate complex densities especially multimodal ones situation less clear although rotations help structure distribution aligned coordinate axis wand jones 1993 3 locally adaptive density estimation conceivable consider bandwidth function adapts point estimation also observed data points shape underlying density matter practice however two simplified versions studied first varies bandwidth estimation point referred balloon estimator second varies bandwidth data point referred samplepoint estimator see jones 1990 detailed comparison two estimators univariate case 31 balloon estimators general form balloon estimator given hx smoothing matrix estimation point x considered pointwise construction estimator fixed bandwidth estimator given 2 point density estimated kernels size orientation centered data point density estimate computed taking average heights kernels estimation point type estimator introduced loftsgaarden quesenberry 1965 kth nearest neighbor estimator generally considered kernel estimator directly written 4 taking k uniform density unit sphere restricting smoothing matrix h 1 thus bandwidth function written measures distance x kth nearest data point much written kth nearest neighbor estimator seems clear effective density estimator univariate case bandwidth function discontinuous discontinuities manifest directly density estimate silverman 1986 furthermore estimator suffers severe bias problems particularly tails mack rosenblatt 1979 hall 1983 terrell scott 1992 however terrell scott 1992 show kth nearest neighbor estimator improves dimensionality increases perform well dimensions greater 4 terrell scott 1992 also study error properties general balloon estimator found remarkable results applied pointwise balloon estimator behaves like fixed bandwidth estimator authors show choosing orientation smoothing matrix appropriately bias dramatically reduced fact bias higherorder following important result terrell scott 1992 outlined extensions shown paper allow comparison sample point estimator consider using 4 pointwise 1 notational conve nience argument h dropped following h controls size kernel orientation asymptotic approximation bias written x matrix second partial derivatives underlying density terrell scott 1992 look three cases based form x demonstrate consider f bivariate standard normal density k bivariate standard normal kernel first x assumed positive negative definite choice make asymptotic bias equal zero best possible asymptotic mean square error gamma4d4 order fixed bandwidth estimator example case corresponds points inside unit ball chosen minimize bias solution aa x given form h computing minimizing resulting pointwise amse resulting second case corresponds density saddle shaped eigenvalues x positive negative case shown properly choosing leading bias made zero example corresponds points outside unit ball jjxjj 1 choose form absolute value eigenvalues x matrix eigenvectors x chosen finding fashion h chosen minimize amse determine amse resulting value h fourth order terms taylors series expansion expectation bias must considered expectation given kh z z z ijth element f represents ith partial derivative f respect x assumptions kernel proper choice expectation reduces f ijkl z z yielding bias oh 4 writing bias cf k constant dependent mixed fourthorder partial derivatives f evaluated x mixed fourthorder moments k combining bias asymptotic expression variance pointwise mse points outside unit ball given taking partial derivative respect h setting zero solving h gives third case corresponds x positive negative semidefinite eigenvalues equal zero hence hessian lower rank bias higher order proper choice corresponds points example unit circle unfortunately closed form expression mise computed expressions optimal pointwise smoothing matrices however terrell scott 1992 point asymptotic mse numerically integrated study behavior balloon estimator 32 samplepoint estimators multivariate samplepoint estimator given hx smoothing matrix associate x samplepoint estimator still places kernel data point kernels size orientation regardless density estimated type estimator introduced breiman meisel purcell 1977 suggested using hx distance x kth nearest data point asymptotically equivalent choosing hx dimension data abramson 1982ab suggested squareroot law ie setting practice using pilot estimate density calibrate bandwidth function formulation bandwidth function popular small part due early results show bias associated squareroot law higher order silverman 1986 hall marron 1988 jones 1990 however recent work shown early result may always hold due bias contributions tails hall 1992 mckay 1993 terrell scott 1992 hall hu marron 1994 sain scott 1996 squareroot law suffers bias properties diminish gains varying bandwidth asymptotically also suffers certain inflexibility restricting bandwidth function function height density sain scott introduce binned version samplepoint estimator uses piecewise constant bandwidth function attempt provide general study properties estimator work authors showed estimator exhibit higherorder mise lead substantial improvement fixed bandwidth estimator univariate case multivariate version binned samplepoint estimator given number data points jth bin j center jth bin smoothing matrix associated jth bin general equally spaced mesh points laid support density define bins although binning rules linear binning defined hall wand 1996 could considered binning used density estimation variety reasons hall 1982 studied rounded truncated data silverman 1982 hardle scott 1992 wand 1994 hall wand 1996 use binning device radically reduce computing time scott sheather 1985 build result hall 1982 show binning results inflated bias mise insensitive reasonable amounts binning adaptive estimation binning becomes much computational tool computing bias adaptive estimator difficult impossible without specifying form bandwidth function done square root law binning expectation estimator 6 easy compute noting random quantities n counts thought realization multinomial distribution parameters r denotes jth bin assuming k multivariate normal kernel following sain scott 1996 mise multivariate binnedsample point estimator given z z z gamman z z note normal integrals follow directly formulae presented appendices wand jones 1995 specifying f usually sort normal mixture probabilities computed mise function optimized collection smoothing matrices h 4 comparison variable bandwidth methods comparing optimal bandwidth functions balloon samplepoint estimator difficult task especially multivariate setting however developing understanding optimal smoothing parameters behave yield insight particularly designing practical algorithms would seem reasonable sort fundamental relationship two methods least asymptotically sain scott 1996 noticed similarities samplepoint estimator socalled zerobias bandwidths discussed hazelton 1996 sain scott 1997 devroye 1998 however finite multivariate samples differences appear illustrate let f bivariate standard normal let k also standard normal figure 1 display optimal kernels fixed bandwidth estimator balloon estimator binned samplepoint estimator using equally spaced mesh 9 bins per dimension two versions samplepoint estimator considered one restricts contours kernels circular h 1 second allows unrestricted size orientation h 3 optimal kernels computed using formulae techniques discussed previous sections four cases considered corresponding bins centered origin along xaxis 09 18 27 correspond mesh samplepoint estimator laid square defined gamma3 3 since contours density radially symmetric follows contours optimal kernels centered different bins distance origin behave similarly figure 1 optimal kernels fixed bandwidth estimator solid line balloon estimator dotted lines samplepoint estimator smoothing matrix restricted h 1 short dashed lines samplepoint estimator unrestricted smoothing matrix long dashed lines ellipses 95 contours kernels optimal kernel fixed bandwidth estimator contours circular regardless density estimated data point parameterization smoothing matrix used 95 contour kernel plotted figure 1 solid line centered origin reference indication scale variable bandwidth kernels examining optimal kernels balloon estimator samplepoint estimator important keep mind construction estimator balloon estimators plotted kernels centered estimation point density constructed centering kernels data point binnedsample point estimator density estimated placing weighted kernel center bin bin different size orientation practice kernels assumed data point bin first consider kernels origin jjxjj 00 figure 1 kernels circular surprise considering structure density origin however variable bandwidth kernels smaller fixed bandwidth kernel next plot 09 center bin still within unit circle fixed bandwidth kernel still much larger samplepoint kernels still roughly circular balloon estimator kernel already adjusting local curvature major axis ellipse parallel line origin center bin third plot shows kernels bin outside unit circle variable bandwidth kernels much larger fixed bandwidth kernel however distinct change orientation noted balloon kernel unrestricted samplepoint kernel recall balloon kernel higherorder bias region based fourthorder derivatives density hence orientation changes major axis ellipse perpendicular line origin center bin major axis unrestricted kernel retains lowerorder bias behavior major axis kernel parallel origin moving even tails density 27 variable bandwidth kernels dwarf fixed bandwidth kernel restricted samplepoint kernel exceptionally large phenomenon explained samplepoint estimator restricted kernels attempt minimize variability tails trading much larger size correct orientation note kernel samplepoint estimator much larger balloon estimator kernel binned samplepoint estimator allows headtohead comparisons general samplepoint estimator fixed bandwidth estimator balloon estimator actuality binned samplepoint estimator entirely general smoothing matrix assumed constant data points particular bin however optimization smoothing matrices allowed adapt level curvature something squareroot law cannot accomplish estimator bins per dimension fixed table 1 mise values fixed samplepoint adaptive methods using normal kernel h 1 n0 density sample size scott sheather 1985 hall wand 1996 showed binning inflate bias sain scott 1996 showed binned samplepoint estimator needed enough bins counteract bias give sufficient flexibility improve fixed bandwidth estimator true multivariate case fact table 1 shows bins per dimension may needed achieve gain table 1 based multivariate standard normal density 100 fixed bandwidth method mise computed using expressions derived worton 1989 marron wand 1992 kernels binned samplepoint estimator restricted spherically simplicity equally spaced mesh laid approximate support density assumed 33 dimension consistency clear table 1 considerable gain terms mise achieved relatively small number bins per dimension restricting shape kernels using 5 bins actually worse fixed bandwidth estimator however using 5 bins per dimension 125 total bins able achieve gain fixed bandwidth estimator using bins achieved 44 gain mise suggests may necessary use bins per dimension use general smoothing matrices bin table 2 mise values also computed bivariate standard normal however samplepoint estimator included allows unrestricted smoothing matrices considerable gain terms mise realized restriction kernels removed restricted kernel samplepoint estimator bins leads 29 improvement mise unrestricted smoothing matrices leads 51 reduction mise fixed balloon table 2 mise values fixed samplepoint balloon estimators using normal kernel n0 2 samplepoint estimator binned samplepoint estimator also allows direct comparison balloon estimator case unrestricted samplepoint estimator actually gives slight improvement balloon estimator implies samplepoint estimator better job even near mode place estimators actually compete balloon estimator higher order tails results also suggest small sample curiosity improvement also achieved moderate sample size n 1000 however larger results likely change impact tails balloon estimator higher order becomes pronounced varying bandwidth aid combating curse dimensionality real power samplepoint estimator may lie ability model complex multimodal distributions consider normal mixture density labeled k wand jones 1993 bivariate trimodal density comprised three normal components parameters p3 p3 contours mixture shown left frame figure 2 density poses problems fixed bandwidth kernel even unrestricted orientation covariance structure entire density far identity modes however varying heights different covariance structures table 3 shows comparison mise fixed kernel estimator smoothing estimator mise fixed table 3 mise values fixed samplepoint estimators using normal kernel trimodal normal mixture sample size matrix h 1 unrestrictive smoothing matrix h 3 sample point estimator bins per dimension also considered two smoothing matrix struc tures results two parameterizations fixed bandwidth estimator terribly different slight improvement going unrestricted smoothing matrix however allowing kernels vary lead significant reduction mise even allowing size kernels vary give significant gains restricted samplepoint estimator giving 35 reduction mise contours optimal bandwidth function shown right frame figure 2 roughness contours due interpolating piecewise constant bandwidth function however clear contours size kernels mirror shape density difficult discern plot however kernels adapting simply based heights alone curvature also taken account kernels near left mode first component mixture much smaller near top right mode second component mixture despite similar heights modes finally unrestricted samplepoint estimator yields even promising results mise 62 smaller unrestricted fixed estimator 5 practical algorithms previous section shows varying bandwidth fashion lead substantial theoretical gains designing practical databased algorithm realize gains practice difficult task many things consider univariate case least estimating bandwidth function parameterization figure 2 contours normal mixture distribution left frame contours optimal bandwidth function right frame binned samplepoint estimator kernels example balloon estimator attractive variety reasons tremendous potential good pointwise estimates density tails required ever orientation balloon kernel leading higherorder bias requires knowledge fourth order derivatives pilot estimate could used calibrate kernels suggested terrell scott 1992 estimating fourthorder derivatives generally perceived harder estimating density gains adaptivity would overwhelmed error estimating derivatives samplepoint estimator currently asymptotic approximations mise would allow plugin style bandwidth selector due part traditional asymptotic approximations inability model behavior optimal bandwidth function sain scott 1996 however leastsquares crossvalidation offers method unbiased estimate mise rely asymptotic approximation also shown sain scott 1996 perform well univariate setting estimating optimal bandwidth function hence used test case illustrate difficulties may encountered leastsquares crossvalidation also referred unbiased crossvalidation ucv introduced rudemo 1982 bowman 1984 approximation integrated squared error average criterion equal mise hence term unbiased crossvalidation setting ucv function given note fully binned version ucv actual data used estimation crossproduct expression mise bin counts computed criterion minimized space smoothing matrices illustration consider lipid data scott et al 1978 data consist measurements cholesterol triglycerides 320 men diagnosed coronary artery disease original paper showed data bimodal indicating increased risk heart disease associated increased cholesterol level study data reveals potential third mode figure 3 shows scatterplot data mesh used bin data sample point estimator shown dotted lines 11theta11 mesh used bins data indicated plot note data scaled zero mean unit variance dimension figure 4 shows perspective contour plots fixed bandwidth estimator using smoothing matrix h 1 smoothing parameter selected crossvalidation estimate shows evidence two distinct modes third mode marginal also considerable amount noise exhibited spurious modes tails figure 3 scatterplot cholesterol triglyceride levels males heart disease grid indicates mesh used samplepoint estimator data scaled zero mean unit variance dimension 22 22 figure 4 perspective contour plots fixed bandwidth h 1 estimate lipid data bandwidths samplepoint estimate smoothing matrices restricted shown figure 5 observed pattern consistent intuition larger bandwidths tails smaller near modes estimate shown figure 6 initially appears oversmoothed however modes actually pronounced higher three clear modes adaptive estimate also little evidence spurious modes tails distribution resulting estimator achieves goals adaptive procedure namely correctly emphasize features heights positions modes minimizing noise spurious modes figure 7 shows samplepoint estimate using unrestricted kernels h 3 chosen ucv unfortunately estimate reflect promise mise results previous section estimate quite rough many spurious modes determine cause consider examination estimated kernels kernels near modes shown figure 8 source difficulties found many appear close degenerate seem wildly varying orientations may artifact wellestablished aggressive behavior crossvalidation yield highly variable bandwidths often much smaller optimal unfortunately many parameters estimate case 48theta3144 moderate sample size clearly attempting estimate fully parameterized smoothing matrices require much data stable procedure one way reduce dimensionality problem based notion fixed bandwidth procedure adequate unimodal distributions hence pilot estimate could used calibrate bandwidth function using bandwidth data point near sample mode example shown figure 9 fixed bandwidth estimate figure 4 used partition data 16 sample modes estimate data point assigned nearest mode mode assigned separate smoothing parameter effect defining piecewise constant bandwidth function mesh equally spaced figure 9 shows estimated bandwidths using restricted smoothing matrices h 1 behavior expected smaller bandwidths near dominant modes larger bandwidths tails estimate using bandwidths plotted figure 259 186 218 173 07 08 155 209 209 202 figure 5 estimated bandwidths restricted samplepoint estimate 22 figure perspective contour plots samplepoint estimate h 1 lipid data figure 7 perspective contour plots estimated density using fully parameterized bandwidth matrix h 3 22 figure 8 estimated kernels fully parameterized bandwidth matrix 1378 222103480433295623431901 figure 9 left plot modes partitions calibrating smoothing matrix right plot estimated bandwidths based partitions 22 figure 10 perspective contour plots estimated density using bandwidth function calibrated pilot estimate shows two modes clearly third mode apparent variability tails also diminished good samplepoint estimate shown figure 6 estimate still improvement fixed bandwidth estimate particularly tails number spurious modes reduced one interpretation result improvement gained using restrictive bandwidth function puts adaptivity may needed tails 6 conclusions two primary points made work first locally adaptive density estimation allows smoothing vary fashion lead substantial gains fixed bandwidth density estimation extent combat curse dimensionality results even promising underlying density complex exhibiting multiple modes differences scale orientation second possible achieve gains practice necessarily easy overparameterizing smoothing matrices concern work certainly required understanding complex theory behind locally adaptive methods connections mixture models work certainly required building practical algorithms leastsquares crossvalidation holds lot promise certainly problems well research blurring lines parametric nonparametric density es timation proposed certainly inspired kernel estimators motivated desire learn variable bandwidth kernel estimators applications higher dimensions kernel estimators already possess great flexibility locally adaptive kernel estimators add significantly already rich class concern kernels necessarily local however additional assumptions underlying density proposed also flavor mixture models inspired desire parametrically model data appears generated several subpopula tions mixture models surprising ability model distributions whose components necessarily parametric family components mixture see sain et al 1998 example practice among others work also exploring connection kernels mixtures example priebe 1994 marchette et al 1996 finally much work done required sort numerical optimization optimization done splus using function nlminb statistical sciences 1995 based subroutines port mathematical subroutine library att bell laboratories 1984 cases gradient also computed used optimization expected optimizing criteria time cpu intensive point making procedures unattractive cases realtime estimation r bandwidth variation kernel estimates square root law arbitrariness pilot estimator adaptive kernel methods alternative method crossvalidation smoothing density estimates variable kernel estimates multivariate densities sizer exploration structures curves variable kernel estimates impossibility tuning parameters projection pursuit regression influence rounding errors nonparametric estimators density derivatives near neighbor estimates multivariate density global properties variable bandwidth density estimators accuracy binned kernel density estimators improved variable window kernel estimates probability densities smoothing weighted averaging rounded points bandwidth selection local density estimation variable kernel density estimates variable kernel density estimates nonparametric estimate multivariate density function note bias reduction variable kernel density estimates multivariate knearest neighbor density esti mates filtered kernel density estimation exact mean integrated squared mode tree tool visualization nonparametric density features adaptive mixtures empirical choice histogram kernel density estimators outlier detection mixture distribution training data unlabeled locally adaptive density estimation zerobias locally adaptive density estimators multivariate density estimation theory plasma lipids collateral risk factors coronary heart disease study 371 males chest pain feasibility multivariate density estimates reliable databased bandwidth selection method kernel density estimation kernel density estimation using fast fourier transform density estimation statistics data analysis splus guide statistics mathematical analysis variable kernel density estimation fast computation multivariate kernel estimators comparison smoothing parameterizations bivariate kernel density estimation kernel smoothing optimal smoothing parameters multivariate fixed adaptive kernel methods tr accuracy binned kernel density estimators ctr anders adamson marc alexa anisotropic point set surfaces proceedings 4th international conference computer graphics virtual reality visualisation interaction africa january 2527 2006 cape town south africa yaser sheikh mubarak shah bayesian modeling dynamic scenes object detection ieee transactions pattern analysis machine intelligence v27 n11 p17781792 november 2005