polynomial time algorithm shaped partition problems consider class shaped partition problems partitioning n given vectors ddimensional criteria space p parts maximize arbitrary objective function convex sum vectors part subject arbitrary constraints number elements part class broad expressive power captures nphard problems even either p fixed contrast show p fixed problem solved strongly polynomial time solution method relies studying corresponding class shaped partition polytopes polytopes may exponentially many vertices facets even one p fixed however show p fixed number vertices shaped partition polytope ondpchoose 2 vertices produced strongly polynomial time b introduction partition problem concerns partitioning vectors dspace p parts maximize objective function convex sum vectors part see 3 vector represents numerical attributes associated ith element set ng partitioned ordered partition associated theta p matrix whose jth column represents total attribute vector jth part problem find admissible partition maximizes objective function f given real convex functional ir dthetap particular interest shaped partition problem department applied mathematics chiaotung university hsinchu 30045 taiwan email address fhwangmathnctuedutw william davidson faculty industrial engineering management technionisrael institute technology 32000 haifa israel email address onnietechnionacil research supported part mathematical sciences research institute berkeley california nsf grant dms9022140 n haar r zinn research fund technion fund promotion research technion z william davidson faculty industrial engineering management technionisrael institute technology 32000 haifa israel email address rothblumietechnionacil research supported part e j bishop research fund technion onr grant n0001492j1142 shaped partition problems admissible partitions whose shape j 1 lies prescribed set admissible shapes article concentrate later situation shaped partition problem applications diverse fields include circuit layout clustering inventory splitting ranking scheduling reliability see 5 9 14 15 references therein demonstrate later problem expressive power captures nphard problems maxcut problem traveling salesman problem even number p parts attribute dimension fixed first goal article demonstrate constructively polynomial time algorithm shaped partition problem exist p fixed result valid set admissible shapes function c presented oracles first result formally stated proved section 4 ffl theorem 42 shaped partition problem solvable polynomial oracle time using dp 2 operations queries solution method based observation since c convex shaped partition problem embedded problem maximizing c shaped partition defined convex hull matrices corresponding partitions admissible shapes class shaped partition polytopes broad generalizes unifies classical permutation polytopes birkhoffs polytope permuto hedron see eg 8 19 21 subclass bounded shaped partition polytopes lower upper bounds shapes previously studied 3 assumption vectors distinct therein polynomial procedure testing whether given vertex p obtained procedure simplified extended 11 related different generalization classical permutation polytopes arising algebraic representationtheoretical constraints rather shape constraints imposed permutations involved studied 19 references therein since shaped partition polytope defined convex hull implicitly presented set whose size typically exponential input size even p fixed efficient representation convex hull vertices intersection halfspaces readily expected second objective prove nevertheless fixed p number vertices shaped partition polytopes polynomially bounded n possible explicitly enumerate vertices polynomial time second result formally stated proved section 4 ffl theorem 43 shaped partition polytope p vertices produced polynomial oracle time using 2 p 3 operations queries immediate corollary theorem 43 fixed p number facets p polynomially bounded well facets produced polynomial oracle time corollary 44 theorem 43 shows particular possible compute number vertices efficiently might extendible situation variable counting vertices generally hard task cf 16 counting partitions various prescribed properties see 4 10 vertex counting problem variable p addressed elsewhere frank k hwang shmuel onn uriel g rothblum 3 special role development played separable partitions defined partitions vectors distinct sets weakly separable hyperplanes special case partitions studied quite extensively see eg 2 5 7 17 case also considered quite recently 6 study partitions p well class generic partitions provide upper bound number algorithm producing recent related work 1 precise extremal asymptotical behavior partitions determined embedding partition problem problem maximizing convex function c partition polytope useful due optimality vertices latter problem consists single shape optimality vertices holds general class asymmetric schur convex function introduced 13 see 8 results apply c asymmetric schur convex function consisting single shape article organized follows next section formally define shaped partition problem shaped partition polytope demonstrate expressive power problem giving four examples first two examples parameters p typically small fixed theorem 42 provides polynomial time solution last two examples show maxcut problem traveling salesman problem modeled shaped partition problems fixed respectively corresponding polytopes exponentially many vertices section 3 study separability properties vertices shaped partition polytopes discuss separable generic partitions final section 4 use preparatory results section 3 establish theorems 42 43 corollary 44 shaped partition problems polytopes ppartition n ng ordered collection sets possibly empty whose union n pshape n tuple nonnegative integers n shape ppartition pshape n given jj j 1 j set pshapes n partition partition whose shape jj member let real theta n matrix denote ith column ppartition n define amatrix theta p matrix consider following algorithmic problem shaped partition problem given positive integers set pshapes n objective function partitions given c convex ir dthetap find partition maximizes f namely satisfies 4 shaped partition problems course complexity problem depends presentation c construct algorithms work strongly polynomial time cope minimal information c specifically assume set admissible ppartitions represented membership oracle query answers whether 2 convex functional c ir dthetap presented evaluation oracle query partition returns since c convex shaped partition problem embedded problem maximizing c convex hull amatrices feasible partitions defined follows shaped partition polytope matrix 2 ir dthetan nonempty set pshapes n define shaped partition polytope p convex hull amatrices partitions conv point polytope p image shaped partition polytope n theta n identity projection x 7 ax 12 exploited situation function c linear set bounded shapes solve corresponding shaped partition problem n p polynomial time linear programming p demonstrate expressive power shaped partition problem par ticular show even one p fixed shaped partition problem may nphard number vertices shaped partition polytope may exponen tial therefore polynomial time algorithms optimization vertex enumeration expected show exist p fixed start two examples natural p small fixed example 21 splitting n assets company split among p owners follows jth owner prescribes nonnegative vector entries represent relative values various assets owner partition splits assets among owners maximizes l q norm q total value vector whose jth entry ji total relative value assets allocated jth owner alternative interpretation splitting problem concerns division estate consisting n assets among p inheritors equal rights es tate 2 model captures problem divorcing couple dividing joint frank k hwang shmuel onn uriel g rothblum 5 fixed p theorem 42 asserts find optimal partition polynomial time number p n partitions exponential note convex functions c used within framework particular c linear ir pthetap results 12 apply ield polynomial time solution even p variable example 22 balanced clustering given objects represented attribute vectors objects grouped p clusters containing points minimize sum cluster variance partition given jj delta jj denotes l 2 norm j barycenter ith cluster use fact fixed p theorem 42 find optimal balanced clustering polynomial time dp 2 number partitions next two examples show unless p fixed shaped partition problem may nphard idea simple formulation every partition gives distinct vertex shaped partition polytope p function f partitions factors f convex c p say one given following examples membership oracle evaluation oracle f restricted amatrices easily polynomial time realizable natural data problem example 23 maxcut problem unit cube find cut maximum number crossing edges given graph e amatrices partitions precisely 0 1valued n theta 2 matrices row sum equals 1 particular matrix determined first column follows shaped partition polytope p 2 n vertices stand bijection partitions affinely equivalent ndimensional unit cube projection matrices onto first column distinct vertex p convex c ir dtheta2 6 shaped partition problems example 24 travelling salesman problem permutohedron find shortest hamiltonian path n sites given symmetric nonnegative matrix ij represents distance sites j regard partition simply corresponding permutation matrices case simply permutations shaped partition polytope p n vertices stand bijection partitions socalled permutohedron since distinct vertex p convex c ir n 3 vertices generic partitions section show every vertex shaped partition polytope p equals amatrix ageneric partition notion introduce develop convex hull subset u ir denoted convu two finite sets u v points ir separable vector h 2 ir h u 6 v case refer h separating vector u v proof following characterization separability standard left reader implies particular u v separable lemma 31 let u v finite sets ir u v separable convex hulls either disjoint intersect single point common vertex let given theta n matrix subset n let set columns indexed multiple copies columns identified p partition aseparable sets r separable pair vector h rs 2 ir rs j following lemma generalizes result 3 matrices zero columns repeated columns lemma 32 let matrix ir dthetan let nonempty set pshapes n let partition vertex p aseparable partition proof claim obvious suppose p 2 let vertex matrix c 2 ir dthetap linear functional ir dthetap given inner product hc uniquely maximized p pick pair 1 suppose 6 j otherwise r trivially separable let 0 partition obtained switching j ie taking 0 frank k hwang shmuel onn uriel g rothblum 7 choice c hc 0 rs proves r separable pair 1 r p hence aseparable need terminology let 2 ir dthetan ppartition n adisjoint disjoint pair 1 r p convex hulls finite sets disjoint sets strictly separated hyperplane adisjoint exists vector h rs 2 ir h rs course adisjointness implies aseparability two properties coincide columns distinct vector obtained appending first coordinate 1 v matrix 2 ir dthetan indices 1 sign matrix generic columns affine general position set 1 vectors less among f ng linearly independent particular case signs sign nonzero also columns generic matrix distinct next provide representation set adisjoint 2partitions generic matrices case n simple lemma 33 let 2 ir dthetan generic p 2 n every ppartition n adisjoint proof suffices consider case 2 standard result linear algebra shows n linearly independent range 2partition n vector 2 ir d1 0 obtained truncating first coordinate 1 proving adisjoint let 2 ir dthetan generic n dsubset n course fi gamma g 2partition n n let n dset 2partition 2partitions n associated defined either two 2partitions lemma 34 let 2 ir dthetan generic n set adisjoint 2partitions set 2partitions associated dsets n 2partitions 8 shaped partition problems proof show dset n 2partition two 2partitions associated adisjoint adisjoint 2partition generated way first let n delements say h hyperplane contains columns indexed hyperplane written fx 2 thus h next observe assures 2partition bdisjoint thus exists vector 2 ir j sufficiently small positive c proving adisjoint follows immediately proving two 2partitions n associated 2partition adisjoint next assume adisjoint 2partition exists hyperplane strictly separating 1 2 hyperplane perturbed hyperplane spanned columns weakly separates 1 2 details constructing perturbation left reader particular span hyperplane former case latter case 2 list 2partitions n associate ptuple subsets n follows ptuple associated given list pairwise disjoint p holds well ppartition called partition associated given list lemma 35 2 ir dthetan p 2 set adisjoint ppartitions equals set ppartitions associated lists adisjoint 2partitions proof first consider ppartition associated list adisjoint conversely let adisjoint ppartition consider pair 1 disjoint hyperplane h rs contains column defines two corresponding half spaces rs h rs satisfy r ae h gamma rs ae h rs let rs rs 2 adisjoint 2partition defined rs rs g rs rs g let 0 frank k hwang shmuel onn uriel g rothblum 9 ptuple associated constructed rs sets 0 pairwise disjoint ppartition associated constructed list adisjoint 2partitions ffl 0 define fflperturbation affl 2 ir dthetan follows let ith column affl affl image moment curve ir consider 1 n determinant polynomial degree ffl van der monde determinant known nonzero sufficiently small ffl 0 sign affl sign first nonzero coefficient among either gamma1 1 independent ffl define generic sign common value sign affl sufficiently small positive ffl lemma 36 let 2 ir dthetan p 1 sufficiently small ffl 0 affl generic set affldisjoint ppartitions every dset 2 n sets gamma affl independent ffl proof lemma 35 set affldisjoint ppartitions entirely determined set affldisjoint 2partitions thus suffices consider 2 first assume n case augment vectors obtain matrix 0 2 ir dthetad1 arguments show sufficiently small positive ffl det 0 ffl nonzero implying affl n linearly independent lemma 33 follows ffl set affldisjoint 2partitions n set 2partitions n next assume n explained sufficiently small ffl 0 sign affl nonzero generic sign follows sufficiently small ffl matrix affl generic every dset sets gamma affl independent ffl lemma 34 set affldisjoint 2partitions set pairs 2partitions n associated dsets n 2partitions pair depends gamma hence sufficiently small ffl 0 let 2 ir dthetan ppartition n ageneric affldisjoint sufficiently set ageneric ppartitions lemma 36 shows sufficiently small ffl 0 set affldisjoint partitions equals pi p final lemma section links vertices shaped partition polytopes generic partitions shaped partition problems lemma 37 let 2 ir dthetan let nonempty set pshapes n every vertex polytope p representation amatrix ageneric partition proof let dthetap vertex p let c 2 ir dthetap matrix hc deltai uniquely maximized p b let pi lambdag set partitions let pi f bg sufficiently small ffl 0 addition guaranteed lemma 36 affl generic set affldisjoint ppartitions equals pi p ffl hc deltai maximized perturbed polytope p affl vertex form affl 2 pi lemma 32 afflseparable since affl generic distinct columns therefore also affldisjoint conclude ageneric proving contains generic partition 4 optimization vertex enumeration use facts established previous section prove main results computational complexity terminology fairly standard cf 20 algorithms positive integer n input unary representation whereas numerical data matrix input binary representation algorithm strongly polynomial time uses number arithmetic operations polynomially bounded n runs time polynomially bounded n plus bit size numerical input lemma 41 let p fixed 2 ir dthetan set pi p ageneric ppartitions algorithm given n 2 2 l produces strongly polynomial time using dp 2 proof n set ageneric ppartitions set partitions p n p henceforth assume n fng consists single ppartition n suppose p 2 choice 1 compute generic sign evaluate polynomial evaluation involves computation determinant matrix order d1 done say gaussian elimination using od 3 arithmetic operations rational strongly polynomial time solve following linear system equations obtain indeterminates done inverting nonsingular van der monde matrix coefficients system gaussian elimination generic frank k hwang shmuel onn uriel g rothblum 11 sign sign first nonzero fixed number operations needed compute signs lemma 36 sufficiently small positive ffl dset n gamma affl independent ffl dset n ffl gamma affl available signs determine det permutation puts right location may applied lemma 36 34 pi 2 equals common set affldisjoint partitions sufficiently small positive ffl set set partitions n form dsubset n 2partition dset n common 2partitions sufficiently small positive ffl determined hence list 2partitions pi 2 available construction may contain duplicates dsubsets 2 2partitions jpi 2 partitions pi 2 obtained generic signs using d1 operations sufficiently small positive ffl pi p common set affldisjoint ppartitions common set affldisjoint 2partitions follows lemma 35 pi p set ppartitions associated lists 2partitions pi 2 shows construct pi p produce lists 2partitions pi 2 list form associated ptuple test partition ie p n lists work easily done using dp 2 operations subsumes work computing generic signs constructing pi 2 claimed bound provide solution shaped partition problem set admissible ppartitions represented membership oracle query answers whether 2 convex functional c ir dthetap presented evaluation oracle query partition returns oracle c called mguaranteed guaranteed rational number whose absolute value larger partition algorithm strongly polynomial oracle time uses number arithmetic operations oracle queries polynomially bounded n runs time polynomially bounded n plus bit size theorem 42 every fixed p algorithm given n 2 2 l oracle presented nonempty set pshapes n mguaranteed oracle presented convex functional c l solves shaped partition problem strongly polynomial oracle time using dp 2 operations oracle queries proof use algorithm lemma 41 construct set pi p ageneric ppartitions strongly polynomial time using dp 2 test shapes partitions list obtain subset pi f 2 pi p lambdag ageneric partitions querying oracle jpi p partitions pi p since c convex maximized shaped partition polytope p vertex p shaped partition problems lemma 37 vertex equals amatrix partition pi therefore 2 pi achieving optimal solution shaped partition problem find compute 2 pi matrix query coracle value pick best number operations involved queries coracle dp 2 bit size numbers manipulated throughout process polynomially bounded bit size hence algorithm strongly polynomial oracle time recall shaped partition polytope defined p lambdag number matrices set fa lambdag typically exponential n even fixed p therefore although dimension p bounded dp polytope potentially exponentially many vertices facets well lemmas 37 41 yield following theorem shows fact shaped partition polytopes exceptionally well behaved theorem 43 let p fixed 2 ir dthetan nonempty set pshapes n number vertices shaped partition polytope p p algorithm given n 2 2 l presented produces vertices strongly polynomial oracle time using 2 p 3 operations queries proof lemma 37 vertex p equals amatrix partition therefore number vertices p bounded jpi p j hence lemma 41 construct set vertices given rational matrix proceed fol lows use algorithm lemma 41 construct set pi p ageneric ppartitions strongly polynomial time using dp 2 operations test shapes partitions list obtain subset pi f 2 pi p lambdag ageneric partitions querying oracle jpi p partitions pi p construct set matrices u fa 2 pi g multiple copies identified set u contained lemma 37 contains set vertices p u 2 u vertex precisely convex combination elements u could tested using linear programming algorithm obtain strongly polynomial time procedure proceed follows caratheodorys theorem u vertex convex hull affine basis u n fug test u 2 u vertex p compute affine dimension u n fug u n fug test affine basis u n fug compute unique p p convex hull fu vertex p affine basis get computing affine dimension testing a1subset u nfug affine basis computing done gaussian elimination strongly polynomial time since perform entire procedure ju j jpi elements u number affine bases u nfug number arithmetic operations involved oju j absorbs work constructing pi obeys claimed bound frank k hwang shmuel onn uriel g rothblum 13 immediate corollary theorem 43 get following polynomial bound number facets shaped partition polytope strongly polynomial oracle time procedure producing facets mean finding facet f supporting p f corollary 44 let p fixed 2 ir dthetan nonempty set pshapes n number facets shaped partition polytope p 2 p 3 algorithm given n 2 2 l presented produces facets p strongly polynomial oracle time using 2 p 3 operations queries proof well known upper bound theorem 18 number facets kdimensional polytope vertices om k applying p k dp get bound number facets p construct facets construct first set v vertices using algorithm theorem 43 compute dimension affp possibly empty set dp gamma points together v affinely span ir dthetap affinely independent asubset v compute hyperplane fx 2 spanned hyperplane supports facet p points v lie one closed halfspaces clearly facets p obtained way strongly polynomial time number arithmetic operations oracle queries bounded claimed acknowledgment shmuel onn thanks mathematical sciences research institute berkeley support part research done r discrete applied mathematics simple online randomized incremental algorithm computing higher order voronoi diagrams optimal partitions disjoint convex conic hulls mathematics operations research consecutive optimizers partitioning problem applications optimal inventory groupings joint replenish ment cutting dense point sets half art counting edited joel spencer partition polytopes 1 dimensional points pareto set partition bargaining game journal combinatorial theory ser representations characterizations vertices boundedshape partition polytopes linear programming partitions partitions clustering optimality siam journal algebraic discrete mathematics discrete computational geometry number halving lines maximum numbers faces convex polytope theory linear integer programming lectures polytopes tr ctr uli wagner number corner cuts advances applied mathematics v29 n2 p152161 august 2002 sharon aviran nissan levtov shmuel onn uriel g rothblum vertex characterization partition polytopes bipartitions planar point sets discrete applied mathematics v124 n13 p115 15 december 2002 babson shmuel onn rekha thomas hilbert zonotope polynomial time algorithm universal grbner bases advances applied mathematics v30 n3 p529544 april f k hwang j lee c liu u g rothblum sortability vector partitions discrete mathematics v263 n13 p129142 28 february