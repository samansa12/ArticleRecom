generalized polar decompositions approximation matrix exponential paper describe use theory generalized polar decompositions h munthekaas g r w quispel zanna found comput math 1 2001 pp 297324 approximate matrix exponential algorithms presented property z frakg lie algebra matrices approximation expz resides g matrix lie group frakg property relevant solving liegroup odes usually fulfilled standard approximations matrix exponential propose algorithms based splitting z matrices simple structure usually one row one column rows columns whose exponential computed cheaply machine accuracy proposed methods complexity cal okappa n3 constant kappa small depending order lie algebra frakg algorithms recommended cases fundamental importance approximation exponential resides g order approximation needed high present detail algorithms fourth order b introduction recent developements theory liegroup integration schemes ordinary differential equations iserles munthekaas nrsett zanna 2000 problem approximating matrix exponential lately received renewed attention liegroup methods require number computation matrix exponentials lie algebra g r nthetan lie group g gln r usually constitutes bottleneck numerical implementation schemes celledoni iserles nrsett orel 1999 matrix exponentials need approximated order underlying ode method hence exact computation issue however fundamental importance approximations resides g generality property fullfilled many standard approximations exponential function moler van loan 1978 unless exponential evaluated exactly cases usually small dimension exponential matrix evaluated exactly happens instance three three skewsymmetric matrices whose exponential institutt informatikk university bergen hyteknologisenteret thormhlensgate 55 n5020 bergen norway email antoiiuibno hansiiuibno calculated exactly means well known eulerrodriguez formula sin ff ff marsden ratiu 1994 exact formulas skewsymmetric matrices matrices sop q derived dimension eight making use cayleyhamilton theorem horn johnson 1985 significant savings respect approximation techniques barut zeni laufer 1994 leite crouch 1999 however algorithms practical larger dimensions several reasons first require high powers matrix question matrixmatrix multiplication amounts secondly well known direct use characteristic polynomial large scale matrices may lead computational instabilities problem approximating exponential matrix lie algebra corresponding lie group recently considered celledoni iserles 2000 celledoni iserles 1999 first paper authors construct approximation first splitting matrix x 2 g sum bordered matrices strangtype splittings order two considered one could apply yoshida technique yoshida 1990 based symmetric composition basic scheme whose error locally expands odd powers time increase order second paper authors consider techniques based canonical coordinates second kind ccsk varadarajan 1984 follow approach necessary choose basis lie algebra g choice basis plays significant role computational complexity algorithms owren marthinsen 1999 choosing chevalley bases carter segal macdonald 1995 entail large number zero structure constants possible reduce significantly cost methods delta paper consider problem approximating given order accuracy f z exptz 2 g z 2 f z 2 g g glr n g glrn techniques introduce consist liealgebra splitting matrix z means iterated generalized polar decomposition induced appropriate involutive automorphism oe g discussed munthekaas et al 2000b introduce general technique approximations arbitrary high order discuss practical algorithms order two three four large n algorithms competitive standard approximations exponential function example diagonal pade approximants paper organized follows section 2 discuss background theory polar decomposition lie groups symmetric version polar decomposition used induce splitting lie algebra g long splitting practical compute together exponential splitted part leads splitting methods approximation exponential practical interest section 3 use theory developed x2 derive approximations exponential function relevant matrix lie groups sorn slr n methods order two three four discussed greater detail together computational complexity methods based splittings bordered matrices whose exact exponentials easy compute section 4 devoted numerical experiments illustrate results derived paper finally section 5 devoted concluding remarks background theory usual differential geometry denote liegroup elements lower case letters lie algebra elements uppercase letters whether represent matrices vectors scalars hel gason 1978 adopt convention throughout section let g lie group lie algebra g restrict attention matrix groups ie case g glrn known provided g involutive automorphism g every element z 2 g sufficiently close identity decomposed product wg subgroup elements g fixed oe subset antifixed points oe lawson 1994 munthekaas et al 2000b set g oe structure symmetric space helgason 1978 closed product easily verified application oe righthandside relation decomposition 21 called polar decomposition z analogy case real matrices choice automorphism g automorphism oe induces involutive automorphims doe g natural manner dt defines splitting algebra g sum two linear spaces zg subalgebra g gammaz g structure lietriple system set closed double commutator keep presentation relevant argument matter paper refer reader munthekaas et al 2000b munthekaas quispel zanna 2000a references therein extensive treatement decompositions however fundamental importance note sets k p possess following properties denote pi canonical projection onto subspace p pi k k projection onto k assume x 21 form expanded series x explicitely calculated means following recurrence relations c 2 k1 k 2k0 k1deltadeltadeltak 2k 2q 2m ad 2m z zanna 2000 note expands odd powers first terms expansions xt also consider symmetrictype generalized polar decomposition xt 2 p 2 k compute xt apply oe sides 27 obtain isolating term 28 27 equating result obtain leads differential equation x similar one obeyed 25 zanna 2000 using recursions zanna 2000 obtain recursions xt first terms given xt expand odd powers generalized polar decomposition symmetric version approximation exponential assume wish approximate exptz z 2 g oe 1 involutive automorphism exponential terms well analytic functions adp easy compute approximate x 1 1 obey order conditions 2426 suitable order alternatively approximate x 1 1 obey order conditions 210211 given accuracy mechanism applied split k 1 p 2 phi k 2 means suitable automorphism oe 2 procedure iterated provided exponential k easy compute algorithm approximate exptz given order accuracy circumstance 31 read analogue 32 corresponding algebra splitting 31 choice automorphisms oe follows consider automorphisms oe form g 36 idempotent matrix ie munthekaas zanna 2000 clearly simplicity abuse notation writing oez place doez given computations take place space matrices eigenvalues either 1 gamma1 thus powers matrices well powers adp easy evaluate means 1 gamma1eigenspace munthekaas zanna 2000 32 automorphisms lead banded matrices splittings let z 2 gln r n theta n matrix consider automorphism idempotent matrix 0 easy verify z 2 z z pi k1 z general assume jth step space consists matrices form w obvious choice 0 j gamma1 denotes j gamma 1 theta j gamma 1 identity matrix subspace p j consists matrices form exponentials matrices form 311 easy compute effect exp exp exp computed exactly either formula analogous eulerrodriguez formula 11 denote exp gammaa note another alternative exact exponential one proposed celledoni iserles exp j e 1 vector 1 finally 1z latter formula 313 shall see sequel leads significant savings computation assembly exponentials moreover given w jj next z 2 g obtain approximation exponential g automorphisms shall require oe defined matrices map g g clearly case ffl son r since oe z map son son given orthogonal matrix ffl sln r since oe leaves diagonal elements z hence trace unchanged ffl quadratic lie algebras commute instance case j diagonal hence formulas valid symplectic algebra spn r latter situation consider different choices automorphisms oe discussed greater length munthekaas zanna 2000 33 splittings order two four implementation complexity section describe details algorithms implementation complexity splittings induced automorphisms described cases polartype repre sentation xy symmetric polartype representation z xyx discussed separately algorithm 1 polartype splitting order two based iterated generalized polar decomposition 33 note pi p j pi k j projections need stored separate matrices stored places rows columns matrix z truncate expansions 26 order two hence step p j part needs correction taking mind 33 matrices x j low rank matrices nonzero entries jth row column row stored place corresponding z entries matrix ngamma1 diagonal stored diagonal entries z purpose 2nd order approximation splitting 33 overwritten nonzero elements x computation splitting requires step two matrixvector multiplications amounting floating point operations count multiplications ad ditions well two vector updates operations hence large n cost computing splitting order ffl 2n 3 son taking account b note sop q son matrix ngamma1 zero matrix algorithm 2 symmetric polartype splitting order two based iterated generalized polar decomposition 34 truncate expansions 210211 order two storing entries purpose 2nd order approximation splitting 34 overwritten nonzero elements x computation splitting splitting costs ffl nngamma1for son skewsymmetry algorithm 3 polartype splitting order three truncate 2627 include terms note term k p k form 315 need include also term form p p k observe purpose 3rd order approximation splitting 33 overwritten nonzero elements x computation splitting analyzing computations involved costly part constituted matrixvector products computations c products update zj j computation c amounting 8n 3 whole process update zj need compute two vectorvector products operations uptdate elements matrix thus whole cost updating matrix zj n 5n 3 update z jj requires operations per step give 2n 3 contribution total cost splitting summary total cost splitting ffl 5n 3 sop q sln ffl son note j need calculated well z similarly take account b half elements zj need updated total amounts 2 1 easy modify splitting obtain order four note requires computation scalar b costing 23n 3 operations whole pro cess however powers ad computation next computed two one extra matrixvector computations sln resp son contribute 4n 3 resp 2n 3 cost splitting splitting order four costs total 7n 3 operations sln resp 4n 3 son algorithm 4 symmetric polartype splitting order four truncate 210211 include terms also case term k p k form 315 term p p k computed according 316 purpose 4th order approximation splitting 34 overwritten nonzero elements x need compute total four matrixvector products yielding 8 operations update block zj costs 5n 3 operations update zj costs 2n 3 operations total ffl 5n 3 operations sln sop operations son 34 higher order splittings costs implementing splittings following 33 34 depend type commutation involved commutators form p k p contribute delta term total complexity splitting however commutators form k easily contribute delta total complexity splittings special structure terms involved taken consideration carefully implemented also terms computed matrixvector vectorvector products contributing delta operations total cost splitting example let us consider term appears contribution expansion part polartype symmetric polartype splitting one denotes matrix z jj gamma parenthesis indicate correct order operations executed obtain right complexity per iteration hence total delta splitting many terms already computed lower order conditions yet complexity arises significantly therefore recommend splitting type techniques moderate order approximation required construct higher order approximations splitting techniques one could use symmetric polartype splittings together yoshidatype symmetric combination 35 assembly approximation f z exponential algorithm computes approximation exponential distinguish two cases approximation applied vector v instead matrix exponential expz required since matrices x j never constructed explicitely stored vectors computations exponentials expx j also never performed explicitely implemented case householder reflections golub van loan 1989 applied vector first let us return 313 easy verify denote ff exact form 2 theta 2 identity matrix similar remarks hold matrix gamma1 thus computation done flops contribute total cost algorithm next v k assembly exp according computed 6j operations let j vary 1 n total cost multiplications hence 3n 2 precisely complexity assembly exponential polartype splittings form 33 algorithm 5 polartype approximation purpose computing approximant 33 applied vector v containing nonzero elements x old new new case output needs applied n theta n matrix b apply algorithm column b total 3n 3 operations complexity reduced 2n 3 taking account vector calculated depending splitting matrix z manner columns b also computed stored latter use algorithm 6 symmetric polartype approximation approximation exponential carried manner similar described algorithm 5 except 34 based strangtype splitting assembly also performed reverse order purpose computing approximant 34 applied vector v containing nonzero elements x old old new new old table 1 complexity polartype ordertwo approximant algorithm sln sop q son 15 vector matrix vector matrix splitting 1 1n 3 1 1n 3 2n 3 2n 3 assembly exp 3n 2 2n 3 3n 2 2n 3 new new vectors ff fi fl need calculated stored latter use reverseorder multiplication cost assembly roughly twice cost assembly algorithm 1 hence amounts 5n 2 operations save n 2 operations omitting computation ff result applied matrix b apply algorithm column b yields n 3 operations also case vector ff depend b computed reducing cost 4n 3 operations remark holds vectors fi fl important mention matrix might singular close singular example j b j close orthogonal hence computation exp according 313 may lead instabilities case recommended use 312 instead 313 latter choice twice expensive 5n 2 polartype assemblies 9n 2 symmetric assemblies f z applied vector deals better case nearly singular 4 numerical experiments 41 nonsymmetric polartype approximations exponential commence comparing polartype order2 splitting algorithm 1 combined assembly exponential algorithm 5 1 1pade approximant matrices sln son corresponding groups sln son choose diagonal pade approximants benchmarck easy implement rational approximant highest order approximation origin well known map quadratic lie algebras quadratic lie groups necessarily lie algebras corresponding lie groups table 1 reports complexity method 15 1 1pade approximant costs floating point operations applied vector essentially cost lufactorising linear system operations applied n theta n matrices 2n 3 operations come construction righthandside 2 3 lu factorization 2n 3 n forward backward solution triangular systems figure 41 compare number floating point operations scaled n 3 matrices z size 500 obtained matlab polartype ordertwo algorithm method 15 applied matrix consider cases z sln son costs computing approximations clearly converges theroretical estimates plot represented solid lines given table 1 large n flopsnmethod 15 sln method 15 son figure 1 floating point operations scaled n 3 versus size approximation exponential matrix sln son applied matrix order2 polartype algorithm method 15 1 1pade approximant table 2 complexity polartype orderthree approximant numbers parenthesis correspond coefficients orderfour approximation algorithm sln sop q son 35 vector matrix vector matrix splitting 57n 3 57n 3 2 14n 3 2 14n 3 assembly exp 3n 2 2n 3 3n 2 2n 3 total 57n 3 79n 3 2 14n 3 4 16n 3 figure 2 compare accuracy two approximations left plot exponential normalized kzk methods show local truncation error revealing order approximation exact exponential two right plot shows error determinant function pade approximant error behaves like h 3 method preserves determinant equal one machine accuracy table 2 report complexity method 35 yields approximation exponential order three numbers parenthesis refer cost algorithm order four corrections 42 symmetric polartype approximations exponential commence comparing method 26 yielding approximation order two 1 1 pade approximant table 3 reports complexity method 26 clearly matrixvector case methods one order magnitude cheaper pade approximant definitively preferred see figure 3 matrices sln furthermore exact exponential method 15 sln det 1 method 15 sln figure 2 error approximation left determinant right versus h approximation exponential traceless matrix unit norm order2 polartype algorithm method 15 1 1pade approximant table 3 complexity symmetric polartype ordertwo approximant algorithm sln sop q son 26 vector matrix vector matrix splitting assembly exp 5n 2 4n 3 5n 2 4n 3 total method maps approximation sln pade approximant comparing approximations matrix exponential applied vector must consider krylov subspace methods saad 1992 compare method 26 krylov subspace method z matrix sln normalized kzk vector unit norm krylov subspaces obtained arnoldi iterations whose computational cost amounts circa 2mn 2 counting multiplications additions dimension subspace km j spanfv vg obtain total cost krylov method add computations arising evaluation exponential hessenberg matrix obtained arnoldi iteration plus 2nm operations arising multiplication latter orthogonal basis however n large n costs subsumed arnoldi iteration leading factor 2mn 2 error computed floating point operations approximations given table 4 krylov method converges fast three cases eightnine iterations sufficient obtain almost machine accuracy two iterations yield error order method 26 two thirds 064 068 069 respectively cost hand krylov methods produce sln approximation exponential unless computation performed machine accuracy particular example 330 284 285 circa three times costly 26 algorithm son case concerned noted z 2 son approximation w expzv produced krylov method feature kwk independently number iterations case hessenberg matrix produced arnoldi iterations tridiagonal skewsymmetric hence exponential orthogonal thus krylov methods method choice actions son r n munthekaas zanna 1997 one might extrapolate floating point operations method 26 sln figure 3 floating point operations versus size approximation exponential matrix sln applied vector order2 symmetric polartype algorithm method 26 table 4 krylov subspace approximations versus method 26 approximation expzv krylov 26 size n error flops error flops074 1 21041 7 table 5 complexity symmetric polartype orderfour approximant algorithm sln sop q son 46 vector matrix vector matrix splitting 5n 3 5n 3 2 1n 3 2 1n 3 assembly exp 5n 2 4n 3 5n 2 4n 3 total 5n 3 9n 3 2 1 wish compute exponential expzq q 2 son one could perform iterations krylov method compute w columns q unfortunately approximation w ceases orthogonal although vectors w cease linearly independent final approximation son similar analysis yields stiefel manifolds unless krylov methods implemented approximate exponential machine accuracy passing recall methods based symmetric polartype decomposition time symmetric hence possible compose basic scheme symmetric manner following technique introduced yoshida yoshida 1990 obtain higher order approximations two orders accuracy obtained three times cost basic method instance use method 26 basic algorithm obtain approximation order four thus approximation order four applied vector obtained 17n 2 operations sln two splittings three assemblies compared operations required method 46 conclude gallery compare method 46 orderfour scheme whose complexity described table 5 2 2pade approximant requires 2 2 floating point operations applied vectors 2n 3 assembly 2 lu factorization 6 2 matrices since resolve multiple righthand sides figures obtained numerical simulations matrices sln son clearly agree theoretical asymptotic values plotted solid lines shown figure 4 cost methods similar error exact exponential although sln case 46 scheme preserves determinat machine accuracy pade scheme see figure 5 conclusions paper introduced numerical algorithms approximating matrix exponential methods discussed possess feature z 2 g output g lie group g property fundamental integration odes means liegroup methods proposed methods complexity denotes size matrix whose exponential wish approximate typically moderate order order four constant less 10 whereas exact computation matrix exponential matlab employes scaling squaring pade approximant generally costs 20n 3 30n 3 comparing methods order accuracy applied vector v 2 r n matrix g ffl case f zv exptzv v vector symmetric polartype methods slightly cheaper nonsymmetric variant son case complexity symmetric methods comparable diagonal pade approximants flopsnmethod 46 sln method 46 son figure 4 floating point operations scaled n 3 versus size approximation exponential matrix sln applied n theta n matrix order4 symmetric polartype algorithm method 46 2 2pade approximant exact exponential methods 46 sln det 1 methods 46 sln figure 5 error approximationleft determinant right versus h approximation exponential traceless matrix unit norm order4 symmetric polartype algorithm method 46 2 2pade approximant order complexity method 26 rest methods krylov subspace methods however complexity number iterations independent n thus important stay group recommend krylov methods iteration machine accuracy kind problems convergence krylov methods slow methods might good alternatives see hochbruck lubich 1997 accurate bounds number iterations krylov methods ffl case f zb exptzb b n theta n matrix nonsymmetric polartype methods marginally cheaper symmetric counterpart however latter preferred underlying ode scheme timesymmetric proposed methods complexity comparable diagonal pade approximants order require slightly less operations son case addition map sln sln property shared pade approximants problems proposed methods seem best choice also noted significant advantages arise z banded matrix instance cost method 26 scales onr f z applied vector applied matrix z bandwidth 2r 1 savings less striking higher order methods since commutation usually causes fillin splitting schemes implementation cost smaller proposed celledoni iserles 1999 also produce output g z 2 g son case celledoni et al propose orderfour scheme whose complexity 11 1 orderfour schemes method 35 orderfour corrections method 46 costs 6n 3 6 1 operations comparable diagonal pade approximant order furthermore implementation schemes celledoni et al requires precise choice basis g hence knowledge structure constants algebra approach instead based inclusion relations 23 easily expressed familiar linear algebra formalism r lectures lie groups lie algebras methods approximation matrix exponential liealgebraic setting complexity theory liegroup solvers matrix computations differential geometry matrix analysis polar olshanskii decompositions closed forms exponential mapping matrix lie groups based putzers method introduction mechanics symmetry numerical integration differential equations homogeneous manifolds integration methods based canonical coordinates second kind lie groups recurrence relation factors polar decomposition lie groups tr ctr kenichi kawanishi counting process class markovian arrival processes application queueing system queueing systems theory applications v49 n2 p93122 february 2005 jeanpierre dedieu dmitry nowicki symplectic methods approximation exponential map newton iteration riemannian submanifolds journal complexity v21 n4 p487501 august 2005