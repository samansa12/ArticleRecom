active probing using packet quartets significant proportion link bandwidth measurement methods based ips ability control number hops packet traverse along route via timetolive ttl field ip header new delay variation based path model introduced used analyse fundamental networking effects underlying methods insight model allows new link estimation methods derived analysed new method family based packet quartets combination two packet pairs comprising probe following pacesetter packet ttl pacesetter limited endtoend delay variation probes measured introduced methods provide pathcharlike rate estimates multiple links without relying delivery icmp messages reduced invasiveness advantages methods demonstrated using simulations measurements two different network routes used illustration comparison available tools pathchar clink comprehensive analysis practical issues affecting accuracy methods link layer headers provided particular attention paid consequences invisible hops nodes ttl decreased b introduction recent papers lai baker 1 dovrolis 2 identify two primary network effects foundation existing probing techniques onepacket methods based assumption transmission delay linear packet size idea first introduced v jacobson pathchar tool estimate link bandwidths round trip delays different sized packets successive routers along path 3 1 packet pair family based spacing effect bottleneck link 4 fact minimum interdeparture time consecutive packets link attained backtoback effect utilised estimate bottleneck bandwidth smallest link rate 5 6 7 8 1 2 methods estimating available bandwidth also based observation interdeparture time consecutive probe packets taking consideration cases cross traffic packets inserted possibility discussed 6 7 9 1 2 10 recent paper 11 enhanced packetpair family thoroughly investigating dependence probe size effects link layer headers paper contribute development hybrid methods exploiting research center ultra broadband information networks dept electrical electronic engineering university melbourne hungary rd fapasztor dveitchgeemuozau authors gratefully acknowledge support ericsson effects make extensive use ip header timetolive ttl field means accessing different hops along path pathchar first link bandwidth estimation method published based idea used ttl field induce reverse path icmp messages allowing roundtrip delay measurements figure 1 downey suggested number improvements filtering method used implemented clink tool 3 forward path backward path icmp returned udp sent receiver fw hop 3 fw hop 2 fw hop 1 fw hop 4 expired fig 1 ip time live ttl expiration explained ttl udp packet set 2 real networks backward route different ttl paper expand generalise ideas several ways first describe advantages moving approach based measuring delays minimum filter ing one based delay variation peak detection tograms give thorough description nature noise encountered probes traverse route introduce new methods exploiting characteristics noise details see 12 also point crucial importance onepacket methods probes remaining different busy periods hop distinction central performance probing methods clearly appreciated see however 11 12 condition satisfied noise typically takes symmetric characteristics allows highly efficient median based filtering using ideas propose accsig efficient pathcharlike method resulting discussion also prepares ground second main part paper follow steps lai baker 1 using ttl without using returning icmp messages associated disadvantages introduce flexible packet quartet pq probe class probes replaced probe pacesetter pair framework define analyse 5 new estimation methods based delay variation peak detection determine key characteristics including susceptability different kinds error simulation based comparisons performed amongst new methods real network measurements two different network routes used illustrate methods compare pathchar clink full network based validation however beyond scope pa per whose main aim introduce packet quartet methods derive central properties finally several important segment local route international route 1 100mbps lan 100mbps lan 2x100mbps switched 2x100mbps switched 2 bottleneck 10mbps lan 10mbps lan 2x10mbps switched 3 100mbps fddi 4 155mbps atm 5 155mbps atm 2x155mbps atm 6 22mbps 7 unknown est 100mbps single hop 8 unknown est 10mbps single hop 9 suspected bottleneck estimated 2x2mbps 10 unknown estimated 22mbps 11 unknown estimated 100mbps 12 100mbps lan last link known ipsegment composition two test routes practical issues discussed detail particular common problem invisible hops ttl cannot decremented leads serious estimation errors one key drawbacks ttl based approaches behaviour proposed existing methods respect problem given thorough treatment shown detected cases corrected combining different packet quartet methods model route chain ordered hops h hop fifo queue deterministic service rate h followed transmission link rate h latency h packet dropped hop h due expired ttl field instant arrives without actually entering queue hop h physically hop model consistent store forward routers packet arrivals departures counted end last bit input queue seen part previous transmission link packet fully arrived either dropped transferred negligible time output queue queue modelled network measurements paper taken two oneway routes one laboratory two ip hops call segment long completely known exited country 12 segments long measured traceroute partially known detailed table high accuracy sender similar described 13 used capable sending arbitrary streams udp probes raw experimental data arrival departure timestamps probes collected modified tcpdump using modified software clock described 14 skew less 01 parts per million software measurement noise measured significant measurements per 10000 ii pathchar revisited begin generic definitions relating packets traversing single hop although equations hold true arbitrary packets paper index refers probe packets probe arrives hop appearing queue time instant begins service waiting time w 0 completes service time x 0 constant propagation delay 0 exits hop time 1hop delay therefore comparing two successive probes 1hop interdeparture time delay plays role pathchar variants based measuring roundtrip delay release ttl limited udp probes receipt corresponding icmp error messages label forward route hop ttl expires h ttl backward route hop icmp error message enters k ttl let k last hop backward route using equation 1 delay expressed hk ttl icmp since service time probe hop h expressed probe size size icmp messages fixed see exists deterministic linear relationship probe size delay exploited varying probe size filtering eliminate contribution waiting time terms thought kind noise pathchar measuring roundtrip delay many probes filtering based minima applied delay series aims select probes waiting times fact zero probes delay expressed c represents packet size independent remainder equation 6 operation performed number different probe sizes default values pathchar 45 clink 93 obtain samples function dp describing minima function probe size p finally slope fitted estimated dp function values equation 7 clear slope estimate corresponds link rates h determined perfoming procedure ttl values 1 number ip hops estimating h increase slope stage accsig method described change methodology one key respect resulting significant improvement efficiency change based novel approach observing analysing network route using delay variation probes rather delay introduce approach also basis packet quartet methods described section iii new delay variation based route description probing analysis typically centered fd g series pathcharlike methods time series receiver g packetpair type methods either purpose claim advantageous focus delay variation f g two reasons first part probe design therefore known f g includes allows richer structure choice ft g sec ond constant f g equivalent fd g like ft requires accurate clock rates measurement end toend clock synchronisation important practical advantage factthrough reliance slope estimates pathchar also based differences delay show advantages moving explicit delay variation framework development motivated repeated observations network measurements characteristic features delay variation histograms route delay simply sum individual hop delays delay variation hhop route written using equation 5 w h consider terms equation first expresses contribution probe service times deterministic effect independent cross traffic accumulates hops adjacent probes unequal service times second term due cross traffic thought kind random noise however nature noise depends critically upon interaction cross traffic probe stream network experiments observed probe streams probe separations range 100s ms produce characteristic symmetric delay variation histograms understood terms nature noise case follows recall busy periods queue time intervals server continuously active separate idle periods queue empty hop probe arrives different busy period achieved high probability sending well separated waiting term w h comes different busy period contains explicit probe component provided cross traffic change systematically measurement interval reasonable regard waiting times approximately iid sequence across probes hence w h symmetric near white noise hop mean strong assumption low correlations hops made indeed queue unstable able ensure probes arrive different busy periods sufficiently large separation figure 2a delay variation histogram given simulation stationary cross traffic fixed sized probes fact arrive hop different busy periods service time term cancels leaving waiting time terms observe argued behave symmetric noise however consecutive probes arrive busy period nature noise substantially differ ent briefly consider case section iid3 describe accumulation signature based observable serves basis new estimation methods constant probe size assuming x h accumulation term p 1 h vanishes corresponding peak histogram noise spreads instead probe sizes made alternate alternation essential orderings would produce different distri butions peak splits two distance twin peaks proportional quantity 1 h allows measured figure 2b seen context real measurement symmetric peaks combine symmetric noise produce symmetric bimodal distribution signature sec sec b fig 2 accumulation signature delay variation histograms 1 hop simula tion constant probe size service time cancels noise symmetric b 12 hop measurement alternating probe size peak splits signature emerges symmetric bimodal histogram reduce measurement error desirable increase signature increase distance peaks suggests constructing probe stream sizes alternate minimum maximum possible values rather using large number different packet sizes pathcharlike methods second order effect fact efficiency peak detection may depend packet size discussed delay variation framework inherently robust key assumption probes arriving different busy periods verified checking symmetry togram although nonstationarity cross traffic distort distribution practice remain approximately symmetric unless systematic change occurs course measurement level shift example one cross traffic streams results received delay variation histogram sum two symmetric components together nonsymmetric component consisting single value b accsig new link bandwidth estimation method section apply accumulation signature idea ttl scenario pathchar hence assume well spaced probes dropped hop h ttl icmp messages generated sent back sender along backward path formally consider icmp packets original probes undergone size change hop h ttl one use equation 8 write roundtrip sendertosender delay variation hk ttl w h hk ttl w h k number hops backward route k ttl hop icmp packet enters backward route icmp packets share common size independently size probe triggered generation second component equation becomes zero leaving accumulation term generated alternating initial probe sizes hop h ttl noise terms corresponding forward backward paths argument section iia noises symmetric resulting bimodal symmetric delay variation histogram resulting delay variation analogue equation 7 n symmetric noise term assuming time generate icmp packet independent probe size estimation link bandwidths performed recursively similarly pathchar clink group probes fixed limited ttl sent measure procedure repeated steadily increasing ttl receiver reached h determined difference estimates consecutive steps complete description accsig question peak detection histogram must addressed number different methods could applied perform task including kernel density estimation suggested 8 using conditional sample means quantiles throughout paper used following median related method found accurate kernel estimation avoids outlier sensitivity moments probe sizes alternate p two possible values assume p 1 p 2 two subsets defined depending parity symmetric right corresponds roughly parts histogram either side origin peaks detected taking medians subsets absolute values peak locations also relative error upper estimate lower pathchar clink accsig accsig pq1 pq2 pq3 pt1 measurement method relative error upper estimate lower b 22 mbps fig 3 relative error different methods 1hop segments last 2 nd segment 10mbps local route b 6 th segment 22mbps international route used provide informal interval estimate similar way clink 3 defined rate estimates corresponding closest two ttl 1 ttl furthest key advantage approach unlike methods pathchar variants attempt find minimum delay discard majority delay values accumulation signature utilises information probes received greatly reduces number probes need sent especially case longer routes higher link utilisations minimum detection filtering requires probes arrive empty queues hop along route c comparison pathchar clink full comparison accsig pathchar clink beyond scope paper would involve covering many different route traffic scenarios well tackling issues conduct truly fair comparison measure accuracy appropriately instead offer simple network based illustration comparative performance lightly loaded routes short medium length tween midnight 6 sender receiver timezones conditions expect method produce similar results well known heavy traffic conditions minimum delay detection problematic estimates pathchar variants typically suffer significant errors 3 1 accsig perform better circumstances due symmetry independence signa ture allows detection delay variation peak positions even probes traverse path minimum delay effect nature noise used advantage measurements performed two twelve segment route short route local lan fully known whereas international university melbourne wand group university waikato new zealand partially known fore segment mean hop ip level many consist multiple link layer hops indicated table rough measure fairness selected number probes transmitted accsig probe stream equal number used pathchar roughly twice clink default settings addition produced accsig estimates first quarter values used marked accsig corresponds half number used clink figure 3 shows relative errors link rate estimates produced different methods two selected 1hop segments methods introduced section iii results 1hop segments low rate similar figure 3b difference estimates three methods usually within 10 accsig performs better last hop route figure 3a rely generation icmp udp port un reachable packet incurs additional latency uses receiver timestamps instead however intrinsic accsig function current implementation 5050 bw estimates upper estimate lower 5050 bw estimates upper estimate lower 5050 number probe pairs bw estimates upper estimate lower segment 2 segment 6 segment 9 fig 4 efficiency accsig link rate estimates function number probe pairs international route segment 2 2hops b segment 6 1hop c suspected bottleneck segment 9 suspected 2hops expected benefit accsig efficient use probes sent quantity figure 4 plots sequence estimates based truncating received delay variation series international route emulate shorter probe streams see time convergence long term estimates varies little 10 probes 200 depending distance segment sender link rate larger distances increase accumulated cross traffic noise resulting slower convergence compare charts 4a 4b ever segment 9 away yet convergence faster segment 6 due fact delay variation increment induced hop inversely proportional rate segment 9 suspected bottleneck assumption probes arriving different busy periods fundamental accsig method possible obtain estimates quickly sending probes closely spaced noted however assumption key importance pathchar variants well reducing time measurement keeping number probes constant negative impact accuracy onepacket based methods case minimum filtering reason particularly clear probes closely follow relative error uncorrected est upper estimate lower relative error uncorrected est upper estimate lower pathchar clink accsig accsig pq1 pq2 pq3 pt1 measurement methods relative error uncorrected est upper estimate lower 100 mbps c 194 mbps correction invisible hops correction invisible hops correction invisible hops fig 5 relative error multiple hop segments 1 st segment local route 2x100mbps lan b 2 nd segment international route 2x10mbps lan c 9 th segment international route measured bottleneck 2x2mbps likely share busy periods probes least one router route therefore traversing system minimal delay required figure 5 three examples experiments given segments multiple hops pathchar clink accsig give similar estimates however half true link rate one main contributions paper point due invisible hops describe problem detail next section iid1 contribute resolution section iii practical issues measurement results reveal three methods sometimes suffer significant errors even case relatively low bandwidth segments section describes number factors significantly effect accuracy estimates generic shared three methods even widely others hold pathchar clink d1 invisible hops unfortunately real networks switching elements test decrease ttl value ip header therefore come practical purposes invisible ipttl based probing 15 example ethernet atm switches although store forward switching elements ip layer touch ips ttl illustrated figure 6 ip routers even configured decrease ttl result ttl based measurement methods sometimes give estimates corresponding ttl segments sequences hops ttl change rather individual hops example bandwidth estimate ip1 first stage clink pathchar acc sig route shown figure 6 corresponds link level real path representation path representation ip1 ip2 level sender receiver lan switch hop 3 hop 2 hop 1 ip router packets ipttl1 dropped fig 6 invisible hops lower view route shows hops upper test decrease ips ttl threehop twosegment local test route ip1 x using ttl 1 index segments generalises h ttl last hop pacesetter dropped convention h effect likely responsible errors estimates figure 5 original estimates marked uncorrected show significant estimation errors however using knowledge presence invisible hops effects detailed example equation 13 acc sig estimates corrected unfortunately correction impossible presence invisible hops unknown packet quartet based methods introduced section iii provide efficient means detection d2 high bandwidth links estimates high bandwidth links unfortunately unreliable support meaningful comparison understand case delay variation peak detection underlying accsig consider probes 1500 40 bytes 12sec error estimate increase inter peak distance two consecutive ttl values corresponding 6sec error single peak produces 10 error estimate 100mbps link accuracy peak detection mainly function number probes used amount cross traffic noise entering via waiting time components equation 9 increase ttl note pathchar clink estimates subject timestamping errors ranging 10s sec 100s ms lead similar estimation errors d3 invasiveness pathchar clink determine sending times probes default based roundtrip times noted 8 result loads high 60 10 mbps lan roundtrip delay 1ms especially highly utilised network routes approach lead probes joining queues busy period previous probe probe definition wont experience minimum delay minimum filtering step pathchar clink either filters probes case methods gather information form probes lead erroneous minimum delay estimates leading link rate estimation errors case accsig recursively applying lindleys equation 16 using equation 8 shown delay variation probe w h si last hop along route probe shared busy period probe 1 c si aggregated service time cross traffic entering queue probes comparing equations 8 14 clear accumulation signature hop si destroyed new effect significant number probes experience erroneous link bandwidth estimate result condition detected however definition peaks symmetry histogram lost estimates become er ratic suggestion case send probes increased spacing less invasive probably much efficient traditional wisdom simply transmitting probes limit invasiveness measurements paper probe streams accsig pq methods dimensioned remain 64kbps average increasing spacing probes naturally decrease probability sharing busy periods number probes remains measurement time increase proportionally d4 lower layer packet headers packet pair like methods based estimates service time single probe whereas underlying pathcharclink accsig based differences service times additional headers link layers affect packet pair based estimates investigated detail 11 leave unaffected results pathchar variant methods packet size change cancels thus different methods see different values important point understand regardless whether one prefers measure bandwidth seen ip link layer nonlinearities another practical problem arise delay nonlinear packet size shown 15 nonlinearities typically result lower layer effects layer 2 frag mentation network layer payload fragmented resulting additional lower layer headers decreases effective rate seen network layer another example could minimum frame size layer 2 example case ethernet cases spread different packet sizes used pathchar clink advantage accsig also use largeer number different sized probes possible expense increase peak detection errors d6 forwarding time time needed generate icmp message response udp packet constant example component depending packet size lead erroneous bandwidth estimates effect estimate given hop propagate ttl increased link rates extracted using sum previous ttl values error large last hop pathchar clink discussed iii packet quartets methods previous section rely accurate timing returning icmp packets resulting reliance appropriate router behaviour plus additional noise return paths key drawbacks one would prefer exploit ttls ability access hops individually along route way tailgater method described lai baker 1 one way derived deterministic model packet delay consists two phases first sending isolated probes using linear regression minimum delay size 1 h estimated second phase pairs packets sent consisting two packets sent backtoback packet smallest possible size tailgater follows largest possible nonfragmented packet limited ttl goal cause tailgater queue directly behind large packet hop ttl expires enabling accumulated service time measured hop final bandwidth estimates determined using minima filtering ttl combined components measured first phase pacesetter packet limited ttl probe packet delivered receiver sender receiver fig 7 packet quartets pacesetter packets limited ttl probes reach receiver drawbacks tailgater method include related minima filtering need perform two phases address issues introduce packet quartets pq see figures 7 8 flexible probe pattern underlying new family link bandwidth estimation methods packet quartet formed grouping two sequence packet pairs consisting probe packet closely following pacesetter packet limited ttl pairs similarly probes accsig method sent sufficiently separated avoid joining queues busy period within pairs opposite true probe pace setter designed busy period hop practical limitations achieving consequences discussed next paragraph apart pair spac ing packet quartets six parameters two probe sizes two pacesetter sizes p si 1 p si last hops pacesetters traverse dropping hops b follows discuss four packet pattern figure 7 forgotten however incremented order b reverse negating accumulation terms produce half symmetric histograms sender receiver packet 3 packet 2 packet 4 packet 1 hop hop b fig 8 packet quartets pacesetter packets 1 3 limited ttl probes packets 2 4 reach receiver within pair following effect important understand assume probe pacesetter backtoback latter arrived empty queue hop h store forward router behaviour probe enter queue interval x h 1 controlled previous hop whereas pacesetter leave queue time x h controlled hop h thus pointed 1 ability pacesetter guarantee probe queues behind bounded ratio probe pacesetter service times depends ratio link rates thus ratio packet sizes significant design issue practical limit applicability methods high speed links however separation pair members invalidate packet quartets three reasons first delay variation based model make clear essential probes pacesetters backtoback fundamental requirement share busy period second separation may persist hops probe catches pacesetters busy period pair resume role point finally neccessary pairs stay together enough make target signature large enough detected delay variation based model adopt convention probes packets observe measure arrive receiver section ii focus delay variation probes indexed pacesetter packets typically dropped reaching receiver classified probes instead manifest special components waiting times probes experience characterised known duration persistence across hops equation 8 obvious j delay variation hop j expressed lindleys equation connects waiting times successive packets infinite buffer states assume probe enter hop h join busy period pacesetter probes waiting time becomes c h si aggregate service time cross traffic packets arrived hop h arrival pacesetter instant h si probe h since definition arrival time hop h departure time hop h 1 last component rewritten h 1 assuming probe pacesetter also share busy period hop 1 recursively applying equations 15 17 18 delay variation probes general packet quartet becomes w h w h w h si interarrival time pacesetters first hop properties packet quartet delay variation qualitatively different depending following scenarios ttl values lie h number hops case corresponds probes sent sender discussed section ii regions quartet design space new methods defined properties limitations compared well methods section ii iv packet quartet link estimation methods section 5 canonical estimation approaches pq1 pq2 pq3 pt1 pt2 arising packet quartets described main properties derived simulations used illustrate properties meant test performance conditions similarly network comparisons provide basis discussion primary features methods important issues invisible hops rather full scale validation comparison tail gater method 1 provided implementation available expected included nettimer package however documentation states 16 pq1 sender receiver packet 3 packet 2 packet 4 packet 1 acc component sender acc component areceiver hop fig 9 packet quartets 0 ttl scenario illustrated figure 9 equation 19 reduces w h w h two service time specifically accumula tion components equation first accumulation signature due difference size pacesetters created hop 1 pace setters dropped second due difference size probes created hop receiver active would difficult determine term contributed proportion resulting value fortunately selectively eliminated choosing probes pacesetters equal size leads two specialised probe patterns form basis two new bandwidth estimation methods first define methods compare investigate properties remainder subsection collect non service time components equation 20 a1 method pq1 setting constant probe cancels second accumulation component leaving defining equation method pq1 equations 21 10 differ noise terms result link bandwidth estimates individual hops made exactly way accsig a2 method pq2 setting constant pacesetter cancels first accumulation component leaving defining equation method pq2 equations 21 22 formally similar methods defined different properties a3 pq1 pq2 compared essential difference pq2 determine bandwidth hop h ttl difference delay variations stages h ttl h ttl1 must taken instead h ttl h ttl 1 pq1 accsig pathchar variant methods one important consequence link bandwidth estimates segments including invisible hops different two methods estimates pq1 formed described equation 13 accsig pq2 obey effect shown figure 10 easily seen link level real path representation path representation ip1 ip2 level sender receiver lan switch hop 3 hop 2 hop 1 ip router packets ipttl1 dropped pathcharclinkaccsig pq1 based estimate pq2 based estimate fig 10 invisible hops pq1 pq2 produce different hop bandwidth estimates presence invisible hop bandwidth last hop hop 2 first segment measured true generally last hop segments containing invisible hops accessed effect exploits kind edge effect arising differences two equations second important consequence regards peak detection accuracy needed recall measuring distance symmetric peaks histogram basis accumulation signature based estimate accsig pq2 peak detection based difference probe sizes however necessarily small since definition packet quartets probes significantly smaller pacesetters also true difference result distance peaks pq2 significantly smaller pq1 hop makes pq2 intrinsically less accurate pq1 third consequence favors pq1 comparing equation 20 equation 9 find additional noise component c describing cross traffic arriving probes pacesetters heavily loaded hops term significantly bias estimates simplicity assume stationary cross traffic hop let components pair backtoback leaving hop 1 since pq1 probe size constant time period x 1 cross traffic may infiltrate probe pacesetter hop cross traffic components statistically identical tend cancel pq2 case probes sizes different fact deliberately different possible minimise sensitivity peak detection errors pq2 additional asymmetric cross traffic breaks symmetry distributions causing significant problems median based peak detection peak detection methods therefore used heavy network load a4 pq1 pq2 simulation results simulations results 6 hop route zero moderate cross traffic shown table ii accuracy pq2 drops sharply presence cross traffic whereas pq1 performs extremely well cases similar simulations 6 hop route two hops made invisible leaving 4 segments given table iii accsig results segments may correspond directly known link rates predicted hop mixing equations equation 13 pq1 accsig equation 23 pq2 pq1 easier interpret table iii ct see single hop segments recover link rate segments two hops rate method recovers half rate although less obvious cross traffic pq2 also gives values obey respective mixing equation method pq2 however performs less well cross traffic seen comparing methods ct ct columns table iii large differences pq1 pq2 seen evidence presence invisible hops a5 pq1 pq2 measurement based comparisons results selected segments 2 netork routes new methods shown figures 3 5 pq1 based estimates good agreement pathchar clink accsig results main difference pq1 number noise components depends number hops rather varying ttl across different stages measurement aggregate noise therefore lower roughly speaking second half route due lack backward path great advantage long routes feature pq1 shared pq2 another neither rely receiving icmp error messages eliminates forwarding time errors entirely cost advantages higher sensitivity peak detection errors example pq1 measurements performed using 1500 730 byte pacesetter packets followed probes pq2 measurements employed 1500 byte pacesetters followed 40 100 byte probes val ues given peak detection error would cause estimation error pq1 approximately twice large accsig ratio increases approximatly 20 pq2 pq2s higher sensitivity peak detection errors demonstrated first hop estimate two hop route fig 5 50 100mbps expected equation 23 pq2 based estimates 1 st 2 nd 8 th 9 th segments international route inconsistency nominal pq1 pq2 pq3 pt1 pt2 link bandwidth ct ct ct ct ct ct ct ct ct ct 100 100 100 207 100 143 100 143 inf 0 1 100mbps 100 100 9999 158 100 120 100 120 04 0 2 10mbps 4 2mbps 2 5 2mbps 2 202 2 308 2 200 2 198 2 024 ii simulation based link bandwidth estimates 6 hop route method column 1 cross traffic column 2 60 cross traffic load hop 4 30on hops pq1 discussed reveal invisible hops know seg ments 1 2 expect 9 b sender receiver packet 3 packet 2 packet 4 packet 1 hop hop b acc component sender edge component edge component b acc component breceiver acc component fig 11 packet quartets 0 b ttl scenario illustrated figure 11 unlike case b even probes sizes chosen pacesetter sizes also p accumulation term remains delay variation equation 19 reduces n ab denotes non service time terms special case becomes defining equation method pq3 method effect single hop isolated edge effect also different histograms single peak set assume known noise term symmetric char acteristics estimate unique peak easily obtained leading link bandwidth first hop access link rate sender usually known allowing remaining bandwidths estimated recursively equation 25 known estimated starting measurement 0 results discussion cases deferred section ivc note estimate one stage measurement used obtain estimate next potentially lead magnification errors case previously discussed pathchar variants pq1 pq2 estimates follow directly difference estimates two measurement stages pq3s estimates segments invisible hops suffer estimation errors different nature seen far understood setting equation 24 difference equations 24 25 bandwidth estimate case hop mixing equation seen iph ttl 1h ttl similar equation 13 sufficiently small pp ratio would give results packet sizes used measurements 1500 byte pacesetters 40 byte probes ratio 0026 b1 pq3 simulation results returning 6 hop simulation comparison table ii find pq3 performs similarly pq1 positive bias large link rates case invisible hops table iii consistent pq1 cross traffic errors nominal link bandwidth pq1 pq2 pq3 pt1 segment details ct ct ct ct ct ct ct ct 100 100 909 158 100 143 100 143 1 100mbps 100 100 909 105 100 120 100 120 100 100 909 78 100 103 100 103 5 506 167 183 507 518 507 509 2 10mbps 5 504 167 174 507 515 507 504 3 2mbps 1 iii simulation based link bandwidth estimates 6 hop route 2 hops 2nd 4th made invisible method column 1 cross traffic column 2 60 cross traffic load hop 3 else 30 b2 pq3 measurement based comparison returning figures 3 5 find estimates good agreement pathchar clink accsig results link bandwidths approximately 30mbps however differences seem slightly larger case pq1 differences could caused somewhat different estimation invisible segments well fact estimates equation 25 affected lower layer packet headers similar way packet pair based estimates discussed section iid4 pq3s sensitivity peak detection errors similar accsig advantage pq1 another advantage due fixed equal probe sizes pacesetter sizes achievable pacesetterprobe ratio higher pq1 pq2 allowing measurement wider spectrum hop bandwidths however possible magnification estimation errors important disadvantage method c pt1 special case packet quartets one pacesetter packet sent sender illustrated figure 12 effect reducing quartets triplets sender receiver packet 3 packet 2 packet 4 packet 1 acc component b1receiver acc component sender b edge component b fig 12 packet quartets packet sizes selected cause cancellation accumulation terms however impossible cancel terms simultaneously unless probes pacesetters size incompatible latters aim causng probes queue controlling pace hence two methods corresponding cancellation one accumulation term time defined setting probe cancels second accumulation component leaving defining equation method pt1 properties method similar pq3 link bandwidths case estimated estimate unique delay variation peak set comment regarding potential accumulation errors case method pq3 also valid effect invisible hops pt1s bandwidth estimates equation 27 exactly note pt1 holds similar relation tailgater method accsig pathchar clink con sequence causes error pt1s estimates shared tailgater important differences two result delay variation foundation replacing delay need two different probing phases minimum filtering linear regression c2 method pt2 setting constant pacesetter results cancellation first accumulation component leaving defining equation method pt2 unfortunately result increased sensitivity peak detection errors propagation errors method useless practice show completeness include hop mixing equation similar different equation 23 iph ttl 1h ttl1 c3 pt1 pt2 simulation results return final time 6 hop simulation comparison table ii striking result even cross traf fic pt2s sensitivity error propagation causes estimates deteriorate rapidly initial peak detection error case origin limited resolution simulation timestamps chosen equivalent 2 resolution timestamp representation measurement infrastructure tiny error becomes exponentially amplified constrast results pt1 generally good consistent pq3 expected true invisible hop results table iii pt1 c4 pt1 measurement results present measurement results case pt1 performs poorly figures 3 5 find estimates similar pq3 comments regarding effect link layer headers sensitivity peak detection errors propagation errors also hold note pt1 conjunction methods potential detect invisible hops let us assume knowledge 1 h ttl segments example using pq1 case x b remains unknown equation 28 corresponds service time probes last hop route segment containing invisible hop hops ie service time invisible hop however sensitivity peak detection errors becomes similar pq2 although propagation errors wont affect estimates b fixed however fact pt1s estimate potentially suffer link layer header error means pq2 seems efficient tool detecting invisible hop anatomy segments v investigating bottleneck based properties discussed pq1 pq2 estimating segments invisible hops see equations 13 23 results segments 8 10 international route pq1 101 098 222 mbps pq2 213 19 274 mbps concluded ninth hop consists two 2mbps hops conclusion supported independent measurements made using fundamentally different packetpair based methods 11 vi conclusions variety link bandwidth measurement methods presented exploit ability ipttl field target hops within route enable measurements multiple links approach novel use delay variation histogram based peak detection using medians rather delay series filtering minima information probe packet used resulting greater efficiency using less probes fixed accuracy first new method presented accsig uses returning icmp messages like pathchar clink gives similar results efficient icmp based methods however suffer greater noise due longer roundtrip path router dependent processing delays avoid packet quartets introduced 6 parameter probe stream class incorporating pairs consisting probes trapped behind larger pacesetter packets limited ttl values class 5 new measurement methods defined pq1 pq2 pq3 pt1 pt2 main characteristics analysed performance illustrated evaluated simulation accurate network measurements two routes one pt1 closely related terms ttl use existing tail gater method advantages delay variation based properties new methods summarized table vi respect several metrics practical importance described detail rows 14 give rankings best analysed detail consequences invisible hops fact ttl detects ip hops segments often consist multiple link layer hops methods shown fall 2 fundamental categories depending behaviour seg ments first group includes pathchar variants accsig pq1 pq3 pt1 pq2 pt2 belong second group invisible hops detected comparing results member group last invisible hop segment accessed cancelling terms methods example combining results pq1 pq2 group divided two subcategories defined hop mixing equations summarised table vi summary method pq1 best overall offering accurate estimates probes low noise accsig also efficient accurate pq2 also useful less ac curate whereas pq3 considerably less accurate pt1 similar pq3 even less accurate finally pt2 sensitive magnifies errors useless situations performance metric accsig pq1 pq2 pq3 pt1 pt2 sensitivity peak 2 3 detection errors 14 sensitivity lower layer headers 13 propagation sensitivity forwarding errors 12 mixing equation iv comparison new methods work needed fully characterise compare methods performance variety traffic conditions parameter settings addition methods automatically detect invisible hops fully resolve subject ongoing work r measuring link bandwidths using deterministic model packet delay packet dispersion techniques measure using pathchar estimate internet link characteristics congestion avoidance control characterizing endtoend packet delay loss inter net measuring bottleneck link speed packetswitched networks endtoend internet packet dynamics measuring bandwidth multifractal crosstraffic estimation endtoend available band measurement methodology dynamics relation tcp throughput packet size dependence packetpair like methods scope endtoend probing methods precision infrastructure active probing pc based precision timing without gps patchar tool infer characteristics internet paths nettimer tool measuring bottleneck link bandwidth tr congestion avoidance control measuring bottleneck link speed packetswitched networks endtoend internet packet dynamics using pathchar estimate internet link characteristics measuring link bandwidths using deterministic model packet delay pc based precision timing without gps endtoend available bandwidth ctr novak p taylor veitch distribution number arrivals subinterval busy period single server queue queueing systems theory applications v53 n3 p105114 july 2006 guojun jin brian l tierney system capability effects algorithms network bandwidth measurement proceedings 3rd acm sigcomm conference internet measurement october 2729 2003 miami beach fl usa matthew luckie tony mcgregor path diagnosis ipmp proceedings acm sigcomm workshop network troubleshooting research theory operations practice meet malfunctioning reality september 0303 2004 portland oregon usa sridhar machiraju darryl veitch franois baccelli jean bolot adding definition active probing acm sigcomm computer communication review v37 n2 april 2007 constantinos dovrolis parameswaran ramanathan david moore packetdispersion techniques capacityestimation methodology ieeeacm transactions networking ton v12 n6 p963977 december 2004 sridhar machiraju darryl veitch measurementfriendly network mfn architecture proceedings 2006 sigcomm workshop internet network management p5358 september 1115 2006 pisa italy neil spring david wetherall thomas anderson reverse engineering internet acm sigcomm computer communication review v34 n1 january 2004 mahajan neil spring david wetherall thomas anderson userlevel internet path diagnosis proceedings nineteenth acm symposium operating systems principles october 1922 2003 bolton landing ny usa