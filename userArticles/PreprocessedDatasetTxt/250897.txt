adaptive verlet method discuss integration autonomous hamiltonian systems via dynamical rescaling vector field reparameterization time appropriate rescalings eg based normalization vector field minimum particle separation nbody problem alter timereversal symmetry flow desirable maintain symmetry discretization standard form mechanical systems without rescaling achieved using explicit leapfrogverlet method show explicit timereversible integration reparameterized equations also possible parameterization depends positions velocities general rescalings scalar nonlinear equation must solved step one force evaluation needed new method also conserves angular momentum nbody problem use reversible schemes together step control based normalization vector field arclength reparameterization demonstrated several numerical experiments including double pendulum kepler problem threebody problem b introduction article consider numerical integration autonomous differential equations r n dt arise celestial mechanics 22 classical atomic molecular dynamics 12 many important theoretical practical situations direct integration simulation principal tool study problems fixed stepsize numerical integration nonlinear systems 11 leads difficulties particularly neighborhood singularities vector field article describes family efficient adaptive methods numerical solution initial value problems equation 11 based normalization dynamical scaling vector field recent research 17 14 10 focused development timestepping schemes preserve underlying geometrical structure flow system eg symplecticness case hamiltonian systems regardless whether scheme faithfully preserves available underlying structure accurate stable fixed stepsize numerical integration often requires excessively small timesteps particularly true integrating vicinity fixed points singularities principle possible incorporate stepsize variation mechanisms based local error estimates many advantages structurepreserving schemes appear lost stepsize varied using traditional approaches 4 3 7 consider approach based introduction time reparameterization given appropriate smooth scalarvalued function mm integrate differential equations ds ds department mathematics university kansas lawrence ks 66045 usa whuangmathukansedu supported part nsf epscor grant osr9255223 z department mathematics university kansas lawrence ks 66045 usa leimkuhlmathukansedu supported nsf grant nsf9303223 behavior trajectories extended phase space highly sensitive reparameterizations terms phase space orbits reparameterization irrelevant flow 12 preserves integral invariants 11 flow reparameterized 12 integrated appropriate fixedstepsize discretization scheme natural choice r given heuristic r kfk kk euclidean 2norm choice normalization vector field also viewed associating steps time directly steps arclength measured along phase space orbits choice indeed variants reparameterization idea used various applications example basing r separation particles manyparticle system singular potential 1 13 11 techniques 3 21 viewed framework r constructed based embedded local error estimate heuristics would retain approximate constant arclength projection solution accurate complicated control could incorporate estimate orbit curvature point related recent work 18 19 used reparameterization framework design schemes better conserve various integrals energy particularly interested systems based separated hamiltonian well known large systems types 1314 one encounters molecular dynamics computational cost simulation dominated force evaluations problems often solved explicit leapfrog verlet method second order symplectic timereversible symmetric requires one force evaluation per step large nbody problems much recent work concentrated finding methods handle singularities widely varying forces without evaluate full force field every integration step basing methods potentialspecific splittings sometimes achieve effect variable stepsize method see 20 article takes different approach rather trying adapt time stepsize directly according prescribed rescaling time 1314 using corresponds reparameterization based norm gradient hamiltonian hence according density flow lines along solution general reparameterization 1314 destroy hamiltonian structure timereversibility flow easily preserved coupling structure 1314 altered reparameterization natural generalization leapfrogverlet scheme retains features conservation angular momentum timereversibility becomes implicit example schemes 21 3 11 lead implicit integration strategies requiring evaluation forces gammarv several times per integration step main practical contribution article show implicitness removed use special discretization method treats reparameterization factor new variable propagated together physical variables call new method adaptive verlet actually discuss two variants method one based differentiation equation defining reparameterization factor based introduction algebraic equation solved tandem equations motion use ad hoc discretization scheme latter differentialalgebraic approach requires additional force evaluations step recommended method typical applications stress reparameterizations depending q based arclength additional work adaptive verlet method standard verlet consists solution single scalar quartic polynomial equation timestep efficient implementation would also possible many choices rescaling fact special case rescaling based either positions momenta equations become fully explicit control minimum maximum stepsizes also easily incorporated framework methods implemented various simple nonlinear models meant representative typical autonomous systems double pendulum kepler problem threebody problem found robust efficient experiments 2 background smooth f initial value problem 11 ut 0 least local solution given u 0 assume solutions exist time associated 11 thus flowmap oet takes given point u 2 r n point u solution 11 forward trajectory passing given point set 1g two ways trajectories unnatural describing solutions autonomous differential equations first 11 autonomous follows oet sequel write oet oe0 means inclusion initial time 0 description solutions inherently arbitrary second rescale vector field solving instead dt solution u unchanged except rescaling time reasons generally natural replace trajectory u 0 orbit u 0 defined set foetu 0 1g orbits scale translation invariant onestep method solving 11 computable approximation flow map ie map deltat r n kdeltatu 0 given stepsize deltat numerical forward orbit point u 0 discrete set g method said pth order accurate fixed k 0 independent deltat implicit midpoint method defined 11 second order accurate scheme popular method integrating separable system 1314 leapfrogverlet scheme deltat deltatrv q n1 4 w huang b leimkuhler scheme explicit requires one force evaluation per step 2nd order accurate hamiltonian system 1314 timereversibility flow consequence fact even function means integrating 1314 starting point deltat units forward time changing sign momentum integrating another deltat units returns us starting position flow map also symplectic meaning two form dq dp integral motion 6 17 geometric symmetries symplecticness timereversal impose strong restrictions possible types fixed points stability motion neighborhood fixed points recent research timestepping schemes concentrated finding numerical methods deltat share timereversibility andor symplecticness flow example leapfrog implicit midpoint methods timereversible also symplectic 6 16 implicit midpoint method gausslegendre generalizations preserves quadratic integral invariants 5 leapfrog scheme broader family lobatto iiiab pair partitioned rungekutta methods shown preserve angular momentum 17 constant stepsize used methods show remarkable long term stability respect energy error except presence large forces symplectic timereversible methods exhibit linear error growth periodic integrable cases 3 composition two symplectic timereversible maps symplectic timereversible natural consider varying stepsize step step stepsize selection strategies add layer complexity discrete dynamical system since stepsize becomes function dynamic variables 7 experiments standard variable stepsize integration heuristics disappointing example general stability energy linear growth errors integrable systems lost 16 3 timereversible variable stepsize methods used conjunction underlying symplectic schemes considered calvo hairer 3 observed recapture favorable features symplecticreversible schemes article mainly concerned treatment generic nonintegrable dynamics also observed linear growth errors 3 kepler problem reversible scheme 3 singularities normalization vector field interactions pair bodies coulomb potential r distance particles regularized introduction new coordinate system removes singularity nbody problem twobody interactions similarly regularized 1 13 15 singularity representing collision three particles cannot eliminated similar problems arise singular potentials means sort timestep contraction needed neighborhood singularities order resolve behavior accurately even without singularities unlikely single fixed timestep appropriate along whole orbit insight selection timestep obtained noting many problems norm gradient hamiltonian hence norm vector field large places time scale changes rapidly fixed stepsize integrator performs poorly norm gradient h measures fastest directed rate change hamiltonian hence fixed stepsize integrators appear fail points many orbits get squeezed together put another way fixed stepsize integrator may develop instabilities points density fig5a fig5b fig5d fig5c fig 1 fixed stepsize verlet method problem 35 flowlines system large example simple singularity system consider bond problem hamiltonian orbits system phase space consist two lobes closed curves separated line sample orbit shown fig 1a although orbit quite smooth timescale changes dramatically neighborhood origin path lower left extreme point orbit upper left point traversed extremely rapidly fig 1b rapid variation appears exceptionally steep derivative p applied fixedstepsize verlet scheme integrate bond problem results several orbits shown figs 1cd single fixed stepsize 00001 integration proceeds without difficulty even high energy levels long particle stays roughly right vertical line passing fixed point nearer origin curves breakup relatively low energy levels integrator becomes unstable fig 1d another type difficulty occurs equations motion possess isolated nearsingular points double pendulum unequal masses case cusplike turning points appear solution create difficulties fixed stepsize integrators although diagonal rescaling weighting variables sometimes remove nearsingular behavior generically feasible complicated problems mechanism needed improve situation consider local reparameterization time according 12 kfuk normalizes vector field viewed control arclength measured along phase space orbits traversed per unit time similar heuristic viewed normalizing arclength traversed along trajectory 6 w huang b leimkuhler per unit time although article focuses vector field normalization method could applied work many choices r example particle motion central forces may typically assume closest twobody approach determines largest force problem introduce control min r min represents smallest interparticle separation ff positive constant idea suggested 1 13 15 11 normalized vector field reasonable use fixed stepsize integration however sometimes necessary limit variation r avoid excessively small steps neighborhood singular points easy incorporate maximum minimum stepsize example given minimum time stepsize deltat min maximum time stepsize deltat max fictive timestep deltas set deltasdeltat min deltat bounded deltat min deltat max one drawback normalization becomes evident case separated hamiltonians 1314 normalized vector field separable means explicit schemes particularly leapfrogverlet cannot directly applied next section show verlet method modified provide efficient semiexplicit approach variable stepsize integration first show effectiveness combining reparameterization timereversible integration procedures example example 31 double pendulum consider double pendulum problem hamiltonian gravity constant 1 2 masses positions bobs related 1 2 equations motion make problem challenging gave two bobs different masses 1 hamiltonian nonseparable used symplectic timereversible implicit midpoint method fixed step size method little difficulty resolving x fig 2b x fig 2a timestep hh0 fig 2c timestep hh0 fig 2d fig 2 implicit midpoint scheme fixed stepsize double pendulum problem used computation ac solution smooth regions may fail near cusps result error increase dramatically jumps behavior illustrated fig 2 fixed stepsize 10 gamma4 succeeds resolve motion near cusps stepsize 10 gamma3 used however results instability energy poor resolution especially long time intervals remarkable stability energy observed smaller value deltat hallmark symplectic also timereversible methods partly explained backward error analysis symplectic methods see 10 17 cusp points occur points case 1 2 vector field nearly singular conclude norm vector field large vicinity unable integrate double pendulum stepsizes larger fixed stepsize method extremely wasteful terms computation since large stepsizes feasible smooth regions results integrating reparameterized equations time interval 0 50 summarized fig 3 scheme places many points neighborhood turning points uses large timesteps smooth segments incorporated stepsize minimum deltat restrict smallest steps taken vicinity cusp points 380 000 steps integration needed problem would required approximately 50 000 000 fixed steps similar accuracy 4 semiexplicit integration adaptive verlet method section turn attention mechanical system separated hamiltonian 8 w huang b leimkuhler time hh0 fig 4c time timestep fig 4d x fig 4b x fig 4a fig 3 implicit midpoint scheme normalized vector field double pendulum used computation modified equations motion 1314 reparameterized time dq ds ae dp ds p system longer solvable standard verlet method second order lobatto iiiab partitioned rungekutta formula 8 viewed generalization verlet method applied 4748 equations deltas starting view scheme map phase space one may also replace 410 two steps deltas deltas discretization following important features 8 reduces verlet timereversible iii symplectic problem hamiltonian ie preserves angular momentum higher order lobatto pairs retain features restrict second order method article equations 49410 implicit requiring solution nonlinear system step fact r scalar used develop relatively efficient newton solver based rankone updates however still efficient schemes possible 41 differentiating control subsection describe approach based introducing stepsize control new variable differential equation leads discretization algorithm requiring evaluation hessian potential energy functionor finite difference approximation two force evaluations per step next subsection see scheme improved differentiating equation ae rq p respect reparameterized time yields ds ds ds theta r q r idea treat coupled system q p ae illustrate choice similar scheme obtained upper lower bounds builtin r described r gamma2 p r q ds discretization resulting coupled system obtained partitioning variables q p ae using second order lobatto iiiab pair ae n 1p n 1411 ae n 1 ae ngamma 1 deltas deltas deltas ae n 1414 412 rewritten ae n 1 deltas get ae n multiplying ae 2 ae deltas observation 413 ae n 1p n 1 ae n 1p ngamma 1gamma deltasrv q n ae n 1ae ngamma 1 linear function ae n 1allows us conclude 415 cubic polynomial ae n 1for starting may use formulas ae n 1 ae n ae n 1 given convergence timereversibility scheme follow directly corresponding features underlying lobatto scheme introduction new scalar variables fact scheme longer symplectic destroy preservation angular momentum since assuming central forces n1 theta p n1 theta p n1 theta p ae n 1p n theta p experiments use precisely method described instead replaced 412 slightly different midpoint formula ae n 1 ae ngamma 1 deltasgq resulting scheme convergence order two linearized stability 411414 observed evident degradation performance cases looked many cases computation hessian matrix v 00 q intolerable expense situations suggest using approximation appropriately chosen ffl modification changes definition time reparameterization phase space dynamics requires two computations forces time step may useful efficient implementation observe forces computed two close points configuration space means forces evaluated based lists nearby interacting particles list used calculations 42 coupled differentialalgebraic system preferred approach view reparameterized equations dq ds ae dp ds ae coupled differentialalgebraic dae system 2 method previous section viewed regularization based differentiation constraints potential drift effects degrade numerical results long time interval integration since long time interval simulations precisely applications timereversible methods expected make substantial difference may important correct situation moreover would like find method require computation hessian matrix one force evaluation per step reasons propose instead following direct discretization coupled daes ae deltasrv ae n 1 ae ngamma 1 rqn method requires single evaluation gammarv step scheme derived based differentiating control reduce implicitness single scalar equation ae n 1ae n 1 ae ngamma normalized dynamics easily seen multiplying sides 423 ae 2 n 1 left quartic polynomial ae n 1 general situation arbitrary parameterization r would still obtain scalar nonlinear equation solve ae particular situation computation ae n 1becomes completely explicit ae n 1 2rqn depends p one simply reverse roles p q staggered discretization develop explicit method discretization 419421 index1 differentialalgebraic integrator 2 standard form easily seen second order accurate analyzed linearized stability scheme confirm boundedness convergence iteration standard assumptions smoothness vector field boundedness exact solution particular condition stability analysis go ae remains strictly bounded away zero along exact solution interest argument precisely analogous given x41 easily seen differentialalgebraic method conserves angular momentum method clearly timesymmetric set deltat ae n 1 solving 419 p n 1and substituting 420 obtain deltat n deltat n deltat deltat thus view method traditional variable stepsize version stormer rule starting differentialalgebraic scheme given values q could employ differentiated constraint approach previous section instead used following starting step good success deltas ae 1 rq 5 numerical experiments section give several numerical experiments using new schemes case integrated normalized vector field without minimum stepsize control maximum stepsize deltat used experiments conducted ieee floating point arithmetic using double precision machine excellent results also obtained bond problem 35 use normalization conjunction integrating large nbody problems typically appropriate since effects separated strong contributions force field unreasonably compounded determination stepsize outside wellstudied gravitational purely electrostatic nbody problem pairwise potential 1r see 1 13 aware systematic study appropriate time transformations numerical integration small problems considered experiments normalization vector field appears suitable choice 51 kepler problem kepler problem hamiltonian long standard benchmark numerical integration low eccentricities orbits integrated without difficulty using standard fixedstepsize verlet method one recovers good fidelity relevant features flow notable feature contrast standard results numerical integration error growth using symplectic method verlet linear time goals variable stepsize method obtain method robust respect variation eccentricity e uses small stepsizes orbits pass near origin thus improving efficiency also demonstrate similar behavior three different methods method based differentiation control method finite difference approximation evaluate hessian differentialalgebraic system figure 4 compare behavior three adaptive approaches give similar results experiment figure 5 see adaptive method easily outperforms fixed stepsize method observe fig 5a energy errors maximum time interval recorded adaptive method essentially constant independent eccentricity e fact relative energy errors decrease slightly increasing e number steps various energy errors shown fig 5b several orders magnitude smaller fixed stepsize fig 5b also shows second order convergence adaptive method fixed stepsize version difficult case shown fig 6 used adaptive scheme compute high eccentricity 14 w huang b leimkuhler hh0 fig2a hh0 fig2b hh0 fig2c time steps time stepsize fig2d time steps time stepsize fig2e time steps time stepsize fig2f fig 4 comparison three adaptive methods kepler problem f 0999 deltas 001 used figs differentiation formula b e difference formula c f algebraic formula adaptive fixed 1e fig3a adaptive fixed number steps fig3b 02 fig3c fixed stepsize 02 fig3d adaptive fig 5 comparison adaptive verlet differentialalgebraic method nonadaptive verlet methods kepler problem f plotted every 100 steps deltas 001 used b used deltas 001 used hh0 fig4a 5 fig4b fig 6 adaptive verlet differentialalgebraic method kepler problem used computation plotted every 100 steps 52 threebody problem final example looked classical problem well known present severe challenge standard numerical methods threebody problem gravitational electrostatic interactions three point particles problem recently treated detail 15 thorough study classical dynamics helium since insight quantum mechanics atom obtained understanding bifurcations phase space structures periodic orbits authors point quan titative classical studies complicated multidimensionality nonsepara bility unbound character motion governed singular longrange potentials problem also something benchmark celestial mechanics model calculation sought resolve formation binary pair triple following threebody nearcollision experiments regularize twobody collisions suggested 15 1 13 somewhat efficient integration probably possible however threebody approach stumbling block experiment 15 introduction fictive time time reparameterization separations two atoms frozen nucleus helium used improve behavior dynamical simulation using unit masses normalizing gravitational constants assigned initial positions momenta results applying adaptive method deltas 05 deltas 01 shown figs 7abc respectively latter two integrations produce nearly identical orbits since timesteps used figs 7def order magnitude smaller third case second conclude high probability successfully computed true motion notice qualitative change behavior timestep t33 time particles located small region fig 7a fig 7b fig 7c time timestep fig 7d time timestep fig 7e time timestep fig 7f fig 7 adaptive verlet method threebody problem ad 01 cf deltas 001 point 025 25 forces become large one particle ejected two form binary pair small stepsizes needed resolve close threebody interaction much larger stepsizes used resolve motion binary pair qualitative change also illustrated energy plots three calcu lations shown fig 8 average stepsizes used three variable stepsize simulations 0012 000081 0000073 attempted solve problem using fixed stepsizes disastrous results shown figs 9abc cases integration became completely unstable vicinity threebody approach energy errors extremely small early going rose dramatically suddenly event fig 10 shows closeup early behavior case stepsizes smaller orbit successfully integrated fixed stepsize method shown fig 11 6 conclusion long known use time reparameterizations improve behavior numerical methods dynamical systems particularly orbits pass neighborhood singular points vector field article introduced adaptive verlet method timereversible integrator reparameterized nbody problems shown robust efficient numerical experiments one limitation approach yet precise quantitative understanding relationship free parameter deltas accuracy orbit subject current work also investigating efficient higherorder adaptive timereversible methods working time energy error fig 8 fig 8 energy errors adaptive verlet method step refers deltas apply method constrained mechanical systems acknowledgement skeel read preliminary draft article provided useful comments 200200x fig 9a 200200x fig 9b x fig 9c time energy error fig 9d time energy error fig 9e time energy error fig 9f fig 9 fixed stepsize integration threebody problem ad time energy error fig 10b x fig 10a fig 10 fixed stepsize integration threebody problem vicinity 25 2 time energy error fig 10b x fig 10a fig 11 fixed stepsize integration threebody problem 20 w huang b leimkuhler r integration methods small nbody systems numerical solution initial value problems differentialalgebraic equations accurate longterm integration dynamical systems development variablestep symplectic integrators stability rungekutta methods trajectory problems canonical integration technique variable stepsize ruin symplectic integrator symplectic partitioned rungekutta methods matrix computations backward error analysis numerical integrators symplectic methods building better leapfrog numerical integration methods moleculardynamics numerical experimenters view fewbody problem explicit canonical methods hamiltonian systems classical mechanics twoelectron atoms chapman hall stability symplectic energymomentum algorithms nonlinear hamiltonian systems symmetry symplectic integration variable stepsize variable steps reversible integration methods aspects chaotic behavior solar system tr ctr b cano durn technique construct symmetric variablestepsize linear multistep methods secondorder systems mathematics computation v72 n244 p18031816 october b cano durn analysis variablestepsize linear multistep methods special emphasis symmetric ones mathematics computation v72 n244 p17691801 october ben leimkuhler efficient multiple timescale reversible integrator gravitational nbody problem applied numerical mathematics v43 n12 p175190 october 2002