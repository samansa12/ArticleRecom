means averaging group rotations paper give precise definitions different properly invariant notions mean average rotation mean associated metric so3 metric induced frobenius inner product gives rise mean rotation given closest special orthogonal matrix usual arithmetic mean given rotation matrices mean rotation associated intrinsic metric so3 riemannian center mass given rotation matrices show riemannian mean rotation shares many common features geometric mean positive numbers geometric mean positive hermitian operators give examples closedform solutions notions mean b angle rotation r kth root exp1 log r one eigenvalues largest positive real part one denote r1k case square root positive real part 22 metrics so3 straightforward way dene distance function so3 use euclidean distance ambient space m3 ie r1 two rotation matrices k kf frobenius norm induced euclidean inner product known frobenius inner product dened hr1 easy see distance biinvariant so3 ie df p r1q p df r1 r2 p q so3 another way dene distance function so3 use riemannian structure riemannian distance two rotations length shortest geodesic curve connects r1 given 4 moakher note geodesic curve minimal length may unique rt1 r2 involution words rt1 rotation angle connected two curves equal length case rotations said antipodal points so3 said cut point r1 vice versa riemannian distance 26 also biinvariant so3 indeed using fact 3 show drp r1q p remark 21 euclidean distance 25 represents chordal distance r2 ie length euclidean line segment space m3 except end points r1 r2 line segment lie so3 whereas riemannian distance 26 represents arclength shortest geodesic curve greatcircle arc lies entirely so3 passing r1 r2 remark 22 denotes angle rotation rt1 therefore theprotations r1 suciently close ie small df r1 r2 2 drr1 r2 23 covariant derivative hessian recall tangent space point r so3 space matrices rt skew symmetric normal space associated frobenius inner product r consists matrices n rt n symmetric 5 realvalued function fr dened so3 covariant derivative rf unique tangent vector r dt qt geodesic emanating r direction ie r expta hessian fr given quadratic form d2 dt2 qt geodesic tangent space r 24 geodesic convexity recall subset riemannian manifold said convex shortest geodesic curve two points x unique lies realvalued function dened convex subset said convex restriction geodesic path convex ie domain x 2 u 2 txmwhere exp exponential map x x denitions one readily see geodesic ball brq so3 radius r less around q convex realvalued function f denedon brq r less 2 geodesic balls radius greater equal convex3 mean rotation given set n points xn ird mean x given barycenter n points mean also variational property minimizes sum squared distances given points xn x2ird n1 de represents usual euclidean distance ird one also use arithmetic mean average n positive real numbers xn mean positive number many applications however appropriate use geometric mean average positive numbers possible positive numbers form multiplicative group geometric 1n 1n mean also variational property minimizes sum squared hyperbolic distances given data dhx log yj hyperbolic distance1 x seen set positive real numbers dierent notions mean associated dierent metrics follows extend notions mean group proper orthogonal matrices analogy ird plausible denition mean n rotation matrices minimizer so3 sum squared distances rotation matrix given rotation matrices represents distance so3 two distance functions 25 26 dene two dierent means definition 31 mean rotation euclidean sense ie associated metric 25 n given rotation matrices dened definition 32 mean rotation riemannian sense ie associated metric 26 n given rotation matrices dened minimum understood global minimum remark ird set positive numbers objective functions minimized convex domains therefore means well dened unique however so3 shall see objective functions 33 34 geodesically convex therefore means may unique proceed study two means note satisfy following desirable properties one would expect mean so3 counterparts properties means numbers namely 1we borrow terminology hyperbolic geometry poincare upper halfplane fact hyperbolic length geodesic segment joining points p y1 qa y2 y1 y2 0 j log y1 j see 26 6 moakher 1 invariance permutation permutation numbers 1 n 2 biinvariance r mean rotation frng mean rotation fp rnqg every p q so3 property follows immediately biinvariance two metrics dened 3 invariance transposition r mean rotation frng rt mean rotation frt remark biinvariance property sense counterpart homogeneity property means positive numbers left right multiplication needed rotation group commutative 31 characterization euclidean mean following proposition gives relation euclidean mean usual arithmetic mean proposition 33 mean rotation orthogonal projection r onto special orthogonal group so3 words mean rotation euclidean sense projection arithmetic mean r linear space m3 onto so3 proof orthogonal follows hand orthogonal projection r onto so3 given xn xn rn rtm xn rtn proposition 33 mean euclidean sense termed projected arithmetic mean reect fact orthogonal projection usual arithmetic mean m3 onto so3 remark 34 projected arithmetic mean seen related classical orthogonal procrustes problem 10 seeks orthogonal matrix closely transforms given matrix second one proposition 35 det r positive mean rotation euclidean sense given unique polar factor polar decomposition 10 r proof critical points objective function dened so3 corresponding minimization problem 33 elements so3 covariant derivative 35 vanishes using 28 get therefore critical points 35 rotation matrices r pnn1 r rtn r rt equivalently matrix dened symmetric since r orthogonal symmetric follows n2m therefore exists orthogonal matrix u eight possible square roots ut diag determine square root n2m corresponds minimum 35 require hessian objective function 35 r given 36 positive tangent vectors r 29 obtain hess therefore r given 36 hess b c ut rbu b 0 looking proper rotation matrix ie orthogonal matrix determinant one follows 36 det hess f positive tangent vectors r positive fact 35 four cpriticapl poinpts belonging consist apminimpum 1p 2 hence projected arithmetic mean given det r 0 coincides polar factor polar decomposition r course uniqueness fails smallest eigenvalue simple remark 36 case det degenerate case however r rank 2 ie nd unique closest proper orthogonal matrix r see 6 details hence dene mean rotation euclidean sense 32 characterization riemannian mean first compute derivative realvalued function hp p geodesic emanating r direction ra tangent space r angle rotation qt p ie 8 moakher dierentiate 38 get hp dt t0 sin angle rotation qt r used fact hp recall since skew symmetric symmetric matrix follows trqt help 24 obtain hp dt t0 fore covariant derivative h given second derivative 38 gives d2 sin cos let u orthogonal matrix b skewsymmetric matrix trqt easy see d2 sin rhs 310 always positive arbitrary b c ir 2 follows hess h positive tangent vectors denote objective function minimization problem 34 ie using covariant derivative g found therefore necessary condition regular extrema 311 310 conclude hessian hess g objective function 311 positive tangent vectors therefore equation 312 characterizes local minima 311 matter fact local maxima regular points ie points 311 dierentiable worth noting r r characterization riemannian mean given 312 similar characterization geometric mean 32 positive numbers however scalar case characterization 313 geometric mean unique solution characterization 312 multiple solutions hence necessary sucient condition determine riemannian mean lack uniqueness solutions 312 akin fact due existence cut point element so3 objective function 311 convex domain general closedform solutions 312 cannot found however special cases solutions given explicitly following subsections present special cases remark 37 riemannian mean may also called riemannian barycenter notion introduced grove karcher ruh 11 17 proven manifolds negative sectional curva ture riemannian barycenter unique 321 riemannian mean two rotations intuitively case mean rotation riemannian sense lie midway r1 along shortest geodesic curve connecting ie rotation r212 indeed straightforward computation shows r1rt1 r212 satisfy condition 312 alternatively equation 312 solved analytically follows first rewrite take exponential sides obtain multiplying sides rt1 r get rt1 equation two solutions so3 correspond local minima 311 however global minimum one corresponds taking square root equation eigenvalues positive real part ie rt1 r212 therefore two non antipodal rotation matrices r1 r2 mean riemannian sense given explicitly second equality easily veried premultiplying r1rt1 r212 r2rt2 equal makes clear g symmetric respect r1 r2 ie gr1 322 riemannian mean rotations oneparameter subgroup case matrices rn belong oneparameter subgroup so3 ie represent rotations common axis expect mean also subgroup one easily show equation 312 reduces saying r nth root rn therefore riemannian mean nth root yields minimum value objective function 311 case rotations lie single geodesic curve one show geometric mean gr1 r2 r3 three rotations r1 r3 3 rotation located 32 length shortest geodesic segment connecting r1 gr2 r3 ie rotation moakher explicit formula hold general case due inherent curvature so3 see discussion end example 2 rotations belong geodesic segment length less centered identity formula reduces 1n 1n see close similarity geometric mean positive numbers riemannian mean rotations expected since set positive numbers so3 multiplicative groups used intrinsic metrics dene mean reason call mean riemannian sense geometric mean 33 equivalence notions mean two rotations follow ing show two rotations projected arithmetic mean geometric mean coincide first prove following lemma lemma 38 let r1 r2 two elements so3 detr1 proof consider realvalued function dened 0 1 see function continuous assume f1 0 ie detr1 exists 0 1 hence must spectrum rt2 r1 proper orthogonal matrix cannot happen contradicts assumption detr1 general result lemma hold two rotations matrices see examples three rotation matrices determinant sum negative proposition 39 polar factor polar decomposition two rotation matrices given r1rt1 r212 proof let q proper orthogonal matrix positivedenite matrix qs unique polar decomposition r1 one easily verify rt1 r212 rt1 r212 positivedenite square root 2i inverse square root given hence polar factor since polar decomposition unique result proposition together previous lemma shows notions mean agree case two rotation matrices two rotations however notions mean coincide special cases present certain symmetries example 2 x 4 shall consider twoparameter family cases illustrating coincidence 4 analytically solvable examples section present two cases solve projected arithmetic mean geometric mean explicitly examples help us gain deeper concrete insight notions mean furthermore example 2 conrms intuitive idea symmetric cases notions mean agree 41 example 1 begin simple example rotation matrices want nd mean lie oneparameter subgroup so3 using biinvariance property reduce problem nding mean mean rotation 11 projected arithmetic mean arithmetic sum matrices positive determinant n2 hence projected arithmetic mean given matrices given polar factor polar decomposition sum performing decomposition nd thatn 2cos sin cos sin sin n mean well dened long mean agrees notionof directional mean used statistics literature circular spherical data 20 7 9 8 quantity 1 rn called circular variance measure dispersion circular data direction dened angle called mean direction directions dened geometric mean solutions 312 given cos l sin l 0 n 4sin l cos l 05 geometric mean rotation matrices therefore solution yields minimum value objective function 311 course seen x 3 geometric mean given explicitly 315 note even though elements oneparameter subgroup commute two rotations 315 316 dierent due choice kth root rotation matrix one eigenvalues largest positive real parts see consider case p rotation angle zaxis r rotation matrices rn n certain number 2 ir geometric mean rotation zaxis angle geometric mean rotation rotations given 41 coincides concept median direction circular data 20 7 remark 41 neither projected arithmetic mean geometric mean well dened one hand projected arithmetic mean dened hand objective function 311 geometric mean two local minima value namely r1rt1 r212 cut value andtherefore global minimum unique let f g functions dened rotation r zaxis angle ie f g restrictions objective functions 35 311 subgroup considered example fig 41 give plots f g sets data takes several dierent values clear neither 35 311 convex function 35 moakher projected arithmetic mean geometric mean10 ap4 ap4 ap fig 41 plots objective functions f g dierent values note constant g four local minima equal value consequently neither projected arithmetic mean geometric mean well dened smooth function 311 cusp points local maxima however given rotations located geodesic ball radius less 2 ie example angles ji jj objective functions restricted geodesic ball convex hence means well dened case illustrated fig 42 shows plots f g following sets data takes several dierent values projected arithmetic mean geometric mean8 ap4 ap4 fig 42 plots objective functions f g dierent values restricted 4 34 ie dashed lines objective functions indeed convex 42 example 2 second example consider n elements so3 represent rotations angle axes dened unit vectors sin sin n cos projected arithmetic mean straightforward computations show projected arithmetic mean given cos sin 0 cos cos 05 using halfangle tangent formulas obtain following simple relation geometric mean since rotation axes symmetric zaxis rotations share angle expect geometric mean rotation zaxis certain angle g furthermore symmetry also expect mean euclidean sense agrees one riemannian sense campbellbakerhausdor formula elements so3 23 coecients b c given therefore characterization 312 geometric mean reduces log rn bn log r matrix equation so3 equivalent system three nonlinear equations axes rotation rn symmetric zaxis cos follows log rn log r therefore system reduces following single equation angle g compared 42 indeed shows g therefore projected arithmetic mean geometric mean coincide example provides family mean problems parameterized projected arithmetic geometric mean coincide examine problem nding mean three rotations three coordinate axes 14 moakher angle biinvariance property means considered special case twoparameter family therefore mean three rotations rotatiopn angle axis generated vector 1 1 1t tan rotations r1 r3 form geodesic equilateral triangle so3 symmetry arguments geometric mean intersection three geodesic medians ie geodesic segments joining vertices geodesic triangle midpoints opposite sides geometry intersection located twothirds vertices triangle however case so3 due intrinsic curvature true ratio length geodesic segment joining one rotation geometric mean length geodesic median joining rotation midpoint geodesic curve joining two rotations plotted function angles fig 43065g0620 p4 p2 3p4 p fig 43 plot ratio geodesic distance one vertex barycenter geodesic distance vertex midpoint opposed edge geodesic equilateral triangle so3 departure 23 due curvature so3 increases length sides triangle 5 weighted means power means motivation work construct lter smooths rotation data giving relative orientations successive base pairs dna fragment see 19 details lter generalization moving window lters based weighted averages used linear spaces smooth noisy data construction lters direct analogy found arithmetic geometric means group positive numbers projected arithmetic geometric means group rotations led us introduction weighted means power means rotations discuss next definition 51 weighted projected arithmetic mean n given rotations dened mean satises biinvariance property using similar arguments projected arithmetic mean one show weighted projected arithmetic mean given polar factor polar decomposition matrix mean rotation 15 provided det positive definition 52 weighted geometric mean n rotations weights dened mean also satises biinvariance property using arguments similar used geometric mean show weighted geometric mean characterized n1 wn logrn definition 53 real number 0 jsj 1 dene weighted sth power mean rotation n rotations h note mw 1 weighted projected arithmetic mean elements so3 orthogonal trace operation invariant transposition weighted sth power mean weighted sth power mean therefore immediate weighted projected harmonic mean dened coincides weighted projected arithmetic mean natural generalization sth power mean positive numbers line fact positive numbers sth power mean given sth root arithmetic mean one note however 0 jsj 1 mean invariant action elements so3 surprise power mean positive numbers also satisfy homogeneity property set positive numbers 12 similarly set hermitian denite positive operators 25 natural ordering elements classical mean inequalities holds furthermore well known 12 25 sth power mean converges geometric mean goes 0 however group rotations natural ordering exists nonethe less one show rotations belong geodesic ball radius less centered identity projected power mean indeed convergesto geometric mean tends 0 analysis numerical algorithms computing geometric mean rotation use dierent notions mean rotation smoothing threedimensional orientation data published elsewhere acknowledgment author grateful professor j h maddocks suggesting problem valuable comments paper also thanks anonymous referee helpful comments r dierential geometry manifolds matrix computations jacobi elds finsler metrics compact lie groups application dierentiable pinching problem optimization dynamical systems maximum likelihood estimation matrix von misesfisher bingham distributions fitting smooth paths spherical data riemannian center mass mollier smoothing von misesfisher matrix distribution orientation statis tics continuum rod model sequencedependent dna structure statistics directional data mathematical introduction robotic manipula tion fitting smooth paths rotation data geometrical methods robotics optimization techniques riemannian manifolds hermitian semidenite matrix means related matrix inequalitiesan intro duction convex functions optimization methods riemannian manifolds equatorial distributions sphere tr ctr doug l james christopher twigg skinning mesh animations acm transactions graphics tog v24 n3 july 2005 kavan steven collins ji ra carol osullivan skinning dual quaternions proceedings 2007 symposium interactive 3d graphics games april 30may 02 2007 seattle washington xavier pennec intrinsic statistics riemannian manifolds basic tools geometric measurements journal mathematical imaging vision v25 n1 p127154 july 2006 christophe lenglet mikal rousson rachid deriche olivier faugeras statistics manifold multivariate normal distributions theory application diffusion tensor mri processing journal mathematical imaging vision v25 n3 p423444 october 2006 peter j basser sinisa pajevic spectral decomposition 4thorder covariance tensor applications diffusion tensor mri signal processing v87 n2 p220236 february 2007