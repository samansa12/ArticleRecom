bayesian computer vision system modeling human interactions abstractwe describe realtime computer vision machine learning system modeling recognizing human behaviors visual surveillance task 1 system particularly concerned detecting interactions people occur classifying type interaction examples interesting interaction behaviors include following another person altering ones path meet another forth system combines topdown bottomup information closed feedback loop components employing statistical bayesian approach 2 propose compare two different statebased learning architectures namely hmms chmms modeling behaviors interactions chmm model shown work much efficiently accurately finally deal problem limited training data synthetic alifestyle training system used develop flexible prior models recognizing human interactions demonstrate ability use priori models accurately classify real human behaviors interactions additional tuning training b introduction describe realtime computer vision machine learning system modeling recognizing human behaviors visual surveillance task system particularly concerned detecting interactions people occur classifying type interaction last decade growing interest within computer vision machine learning communities problem analyzing human behavior video 10320 8 17 149 11 systems typically consist low midlevel computer vision system detect segment moving object human car example higher level interpretation module classifies motion atomic behaviors example pointing gesture car turning left however relatively efforts understand human behaviors substantial extent time particularly involve interactions people level interpretation goal paper intention building systems deal complexity multiperson pedestrian highway scenes computational task combines elements aimachine learning computer vision presents challenging problems domains computer vision viewpoint requires realtime accurate robust detection tracking objects interest unconstrained environment machine learning artificial intelligence perspective behavior models interacting agents needed interpret set perceived actions detect eventual anomalous behaviors potentially dangerous situations moreover processing modules need integrated consistent way approach modeling persontoperson interactions use supervised statistical learning techniques teach system recognize normal singleperson behaviors common persontoperson inter actions major problem datadriven statistical approach especially modeling rare anomalous behaviors limited number examples behaviors training models major emphasis work therefore efficient bayesian integration prior knowledge use synthetic prior models evidence data situationspecific parameter tuning goal able successfully apply system normal multiperson interaction situation without additional training another potential problem arises completely new pattern behavior presented system system trained different sites previously unobserved behaviors definition rare unusual account novel behaviors system able recognize new behaviors build models behavior little single example pursued bayesian approach modeling includes prior knowledge evidence data believing bayesian approach provides best framework coping small data sets novel behaviors graphical models 6 hidden markov models hmms 21 coupled hidden markov models chmms 5 4 seem appropriate modeling classifying human behaviors offer dynamic time warping wellunderstood training algorithm clear bayesian semantics individual hmms interacting coupled chmms generative processes specify priors system found useful develop framework building training models behaviors interest using synthetic agents simulation agents yields synthetic data used train prior models prior models used recursively bayesian framework fit real behavioral data approach provides rather straightforward flexible technique design priors one require strong analytical assumptions made form priors 1 experiments found combining synthetic priors limited real data easily achieve high accuracies recognition different humantohuman interactions thus system robust cases examples certain behavior interaction described section 51 even examples except syntheticallygenerated ones paper structured follows section 2 presents overview system section 3 describes computer vision techniques used segmentation tracking pedestrians statistical models used behavior modeling recognition described section 4 section 5 contains experimental results synthetic agent data real video data section 6 summarizes main conclusions sketches future directions research finally summary chmm formulation presented appendix system overview system employs static camera wide fieldof view watching dynamic outdoor scene extension active camera 1 straightforward planned next version realtime computer vision system segments moving objects learned scene scene description method allows variations lighting weather etc learned accurately discounted 1 note priors form posteriors namely markov models moving object appearancebased description generated allowing tracked though temporary occlusions multiobject meetings extended kalman filter tracks objects location coarse shape color pattern velocity temporally ordered stream data used obtain behavioral description object detect interactions objects figure 1 depicts processing loop main functional units ultimate system 1 realtime computer vision input module detects tracks moving objects scene moving object outputs feature vector describing motion heading spatial relationship nearby moving objects 2 feature vectors constitute input stochastic statebased behavior models hmms chmms varying structures depending complexity behavior used classifying perceived behaviors figure 1 topdown bottomup processing loop note topdown bottomup streams information continuously managed combined moving object within scene consequently bayesian approach offers mathematical framework combining observations bottomup complex behavioral priors topdown provide expectations fed back perceptual system 3 segmentation tracking first step system reliably robustly detect track pedestrians scene use 2d blob features modeling pedes trian notion blobs representation image features long history computer vision 19 15 2 25 18 many different mathematical definitions usage compact set pixels share visual properties shared surrounding pixels properties could color texture brightness motion shading combination salient spatiotemporal property derived signal image sequence 31 segmentation eigenbackground subtraction system main cue clustering pixels blobs motion static background moving objects detect moving objects build adaptive eigenspace models background eigenspace model describes range appearances eg lighting variations day weather variations etc ob served eigenspace also generated site model using standard computer graphics techniques eigenspace model formed taking sample n images computing mean b background image covariance matrix c b covariance matrix diagonalized via eigenvalue decomposition b phi b eigenvector matrix covariance data l b corresponding diagonal matrix eigen values order reduce dimensionality space principal component analysis pca eigenvectors eigenbackgrounds kept corresponding largest eigenvalues give phi matrix principal component feature vector formed mean normalized image vector note moving objects dont appear location n sample images typically small significant contribution model consequently portions image containing moving object cannot well described eigenspace model except unusual cases whereas static portions image accurately described sum various eigenbasis vectors eigenspace provides robust model probability distribution function background moving objects eigenbackground images stored matrix called hereafter obtained well mean b project input image onto space expanded eigenbackground images x model static parts scene pertaining background therefore comput figure 2 background mean image blob segmentation image input image blob bounding boxes ing thresholding euclidean distance distance feature space dffs 16 input image projected image detect moving objects present scene given threshold note easy adaptively perform eigenbackground subtraction order compensate changes big shad ows motion mask input connected component algorithm produces blob descriptions characterize persons shape also experimented modeling background using mixture gaussian distributions pixel pfinder 26 however finally opted eigenbackground method offered good results less computational load 32 tracking trajectories blob computed saved dynamic track memory trajectory associated first order extended kalman filter predicts blobs position velocity next frame recall kalman filter best linear unbiased estimator mean squared sense gaussian processes kalman filter equations corresponds optimal bayes estimate order handle occlusions well solve correspondence blobs time appearance blob also modeled gaussian pdf rgb color space new blob appears scene new trajectory associated thus blob kalmanfiltergenerated spatial pdf gaussian color pdf combined form joint image space color space pdf subsequent frames mahalanobis distance used determine blob likely identity 4 behavior models section develop framework building applying models individual behaviors persontoperson interactions order build effective computer models human behaviors need address question knowledge mapped onto computation dynamically deliver consistent interpretations strict computational viewpoint two key problems processing continuous flow feature data coming stream input video 1 managing computational load imposed framebyframe examination agents interactions example number possible interactions two agents set n agents n n gamma 12 naively managed load easily become large even moderate n 2 even framebyframe load small representation agents instantaneous behavior compact still problem managing information time statistical directed acyclic graphs dags probabilistic inference networks pins 7 13 provide computationally efficient solution problems hmms extensions chmms viewed particular simple case temporal pin dag pins consist set random variables represented nodes well directed edges links define mathematical form joint conditional pdf random vari ables constitute simple graphical way representing causal dependencies variables absence directed links nodes implies conditional independence moreover family transformations performed graphical structure direct translation terms mathematical operations applied underlying pdf finally modular ie one express joint global pdf product local conditional pdfs pins present several important advantages relevant problem handle incomplete data well uncertainty trainable easier avoid overfitting encode causality natural way algorithms prediction probabilistic inference offer framework combining prior knowledge data finally modular parallelizable paper behaviors examine generated pedestrians walking open outdoor envi ronment goal develop generic compositional analysis observed behaviors terms states transitions states time manner 1 states correspond common sense notions human behaviors 2 immediately applicable wide range sites viewing situations figure 3 shows typical image pedestrian scenario figure 3 typical image pedestrian plaza observations states states observations figure 4 graphical representation hmm chmm rolledout time 41 visual understanding via graphical models hmms chmms hidden markov models hmms popular probabilistic framework modeling processes structure time clear bayesian seman tics efficient algorithms state parameter esti mation automatically perform dynamic time warping hmm essentially quantization systems configuration space small number discrete states together probabilities transitions states single finite discrete variable indexes current state system information history process needed future inferences must reflected current value state variable graphically hmms often depicted rolledout time pins figure 4 however many interesting systems composed multiple interacting processes thus merit compositional representation two variables typically case systems structure time space single state vari able markov models illsuited problems order model interactions complex architecture needed extensions basic markov model generally increase memory system durational model ing providing compositional state time interested systems compositional state space eg one simultaneous state variable well known exact solution extensions basic hmm 3 chains intractable cases approximation techniques needed 22 12 23 24 however also known exists exact solution case 2 interacting chains case 22 4 therefore use two coupled hidden markov models chmms modeling two interacting processes case correspond individual humans architecture state chains coupled via matrices conditional probabilities modeling causal tempo ral influences hidden state variables graphical representation chmms shown figure 4 graph seen chain state time depends state time chains influence one chain causal link appendix contains summary chmm formulation paper compare performance hmms chmms maximum posteriori map state estimation compute likely sequence states within model given observation sequence ng likely sequence obtained case hmms posterior state sequence probability p sjo given 1 set discrete states corresponds state time p ijj statetostate transition probability ie probability state time given system state j time gamma 1 following write p js prior probabilities initial state p output probabilities state ie probability observing given state time case chmms need introduce another set probabilities p js 0 correspond probability state time one chain given chain denoted hereafter superscript 0 state 0 new probabilities express causal influence coupling one chain posterior state probability chmms given 2 theta js denote states observations markov chains compose chmms direct reader 4 detailed description map estimation chmms coming back problem modeling human behaviors two persons modeled generative process may interact without wholly determining others behavior instead internal dynamics influenced either weakly strongly others probabilities js describe kind interactions chmms intended model efficient manner possible 5 experimental results goal system accurately interpret behaviors interactions within almost pedestrian scene little training one critical problem therefore generation models capture prior knowledge human behavior selection priors one controversial open issues bayesian inference address problem created synthetic agents modeling package allows us build flexible prior behavior models 51 synthetic agents behaviors developed framework creating synthetic agents mimic human behavior virtual en vironment agents assigned different behaviors interact well currently generate 5 different interacting behaviors various kinds individual behaviors interaction parameters virtual environment modeled basis real pedestrian scene obtained hand measurements typical pedestrian movement one main motivations constructing synthetic agents ability generate synthetic data allows us determine markov model architecture best recognizing new behavior since difficult collect real examples rare behaviors designing synthetic agents models best generalization invariance properties possible obtain flexible prior models transferable real human behaviors little need additional training use synthetic agents generate robust behavior models real behavior examples special importance visual surveillance task typically behaviors greatest interest also rare experiments reported considered five different interacting behaviors 1 follow reach walk together inter1 2 approach meet go separately inter2 3 approach meet go together inter3 4 change direction order meet approach meet continue together inter4 change direction order meet approach meet go separately inter5 note assume interactions happen moment time location provided precondititions interactions satisfied agent position orientation velocity measured data feature vector constructed consists 12 derivative relative distance two agents ff degree alignment agents magnitude velocities note feature vector invariant absolute position direction agents particular environment figure 5 illustrates agents trajectories associated feature vector example interaction 2 ie approach meet continue separately behavior 04 02alignment relative distance derivative relative distance figure 5 example trajectories feature vector interaction 2 approach meet continue separately behavior 511 comparison chmm hmm architectures built models previously described interactions chmms hmms used 2 3 states per chain case chmms 3 5 states case hmms accordingly complexity various interactions architectures corresponds different physical hy pothesis chmms encode spatial coupling time two agents eg nonstationary process whereas hmms model data isolated stationary process used 11 75 sequences training models depending complexity avoided overfitting optimal number training examples states interaction well optimal model parameters obtained 10 crossvalidation process cases models set full stateto state connection topology training algorithm responsible determining appropriate state structure training data feature vector 6dimensional case hmms whereas case chmms agent modeled different chain 3dimensional feature vector compare performance two previously described architectures used best trained models classify 20 unseen new sequences order find likely model viterbi algorithm used hmms nheads dynamic programming forwardbackward propagation algorithm chmms table 511 illustrates accuracy two different architectures interactions note superiority chmms versus hmms classifying different interactions significantly identifying case interactions present testing data accuracy synthetic data hmms chmms table 1 accuracy hmms chmms synthetic data accuracy recognizing interaction occurs inter accuracy classifying type interaction inter1 follow reach walk together inter2 approach meet go inter3 approach meet continue together ter4 change direction meet approach meet go together inter5 change direction meet approach meet go separately complexity time space important issue modeling dynamic time series number degrees freedom statetostate probabili tiesoutput meansoutput covariances largest bestscoring model 85 hmms 54 chmms also performed analysis accuracies models architectures respect number sequences used training figure 511 illustrates accuracies case interaction 4 change direction meeting stop continue together efficiency terms training data specially important case online realtime learning systems would ultimately andor domains collecting clean labeled data may difficult 901030507090number sequences used training accurancy single hmms coupled hmms curve synthetic data chmms false alarm rate detection rate figure first figure accuracies chmms solid line hmms dotted line one particular teraction dashed line accuracy testing without considering case interaction dark line includes case second figure roc curve synthetic data crossproduct hmms result incorporating generative processes joint product state space usually requires many sequences training larger number parameters case appears result accuracy ceiling around 80 amount training evaluated whereas chmms able reach approximately 100 accuracy small amount training result seems chmms architecture two coupled generative processes suited problem behavior interacting agents generative process encoded single hmm visual surveillance system false alarm rate often important classification accuracy ideal automatic surveillance system targeted behaviors detected closeto zero false alarm rate reasonably alert human operator examine analyze aspect systems performance calculated systems roc curve figure 511 shows quite possible achieve low false alarm rates still maintaining good classification accuracy 52 pedestrian behaviors goal develop framework detecting classifying learning generic models behavior visual surveillance situation important models generic applicable many different situa tions rather tuned particular viewing site one main motivations developing virtual agent environment modeling behaviors synthetic agents similar enough behavior humans models trained synthetic data directly applicable human data section describes experiments performed analyzing real pedestrian data using synthetic sitespecific models models trained data site monitored 521 data collection preprocessing using person detection tracking system described section 3 obtained 2d blob features person several hours video 20 examples following various types meeting behaviors detected processed feature vector x coming computer vision processing module consisted 2d x centroid mean position persons blob kalman filter state instant time consisting x represents filter estimation r components mean gaussian fitted blob color space framerate vision system 2030 hz sgi r10000 o2 computer lowpass filtered data 3hz cutoff filter computed every pair nearby persons feature vector consisting derivative relative distance two per sons jv norm velocity vector person degree alignment trajectories person typical trajectories feature vectors approach meet continue separately behavior interaction 2 shown figure 7 type behavior one displayed figure 5 synthetic agents note similarity feature vectors cases 522 behavior models results chmms used modeling three different haviors meet continue together interaction 3 meet split interaction 2 follow interaction 1 addition interaction versus interaction detection test also performed hmms performed 15velocity magnitudes 100 200 300 14 12 04 02alignment relative distance 100 200 300 derivative relative distance figure 7 example trajectories feature vector interaction 2 approach meet continue separately behavior much worse chmms therefore omit reporting results used models trained two types data 1 prioronly synthetic data models behavior models learned synthetic agent environment directly applied real data additional training tuning parameters 2 posterior syntheticplusreal data models new behavior models trained using starting points synthetic best models used 8 examples interaction data specific site recognition accuracies prior pos terior chmms summarized table 522 noteworthy 8 training examples recognition accuracy real data could raised 100 results demonstrates ability accomplish extremely rapid refinement behavior models initial prior models finally roc curve posterior chmms displayed figure 8 one interesting results experiments high accuracy obtained testing priori models obtained synthetic agent simulations fact priori models transfer well real data demonstrates robustness approach shows synthetic agent training system develop models many different types behavior avoiding thus problem limited amount training data apply models real human behaviors without additional parameter tuning training parameters sensitivity order evaluate sensitivity classification accuracy variations model parameters trained set models changed different parameters agents testing real pedestrian data prior posterior chmms chmms nointer 909 100 table 2 accuracy untuned priori models sitespecific chmms tested real pedestrian data first entry row interaction vs nointeraction accuracy remaining entries classification accuracies different interacting behaviors interactions inter1 follow reach walk together inter2 approach meet go inter3 approach meet continue together curve pedestrian data chmm false alarm rate detection rate figure 8 roc curve real pedestrian data dynamics factors 25 5 performance altered models turned virtually every case except inter1 follow inter action seems sensitive peoples relative rates movement 6 summary conclusions paper described computer vision system mathematical modeling framework recognizing different human behaviors interactions visual surveillance task system combines topdown bottomup information closed feedback loop components employing statistical bayesian approach two different statebased statistical learning archi tectures namely hmms chmms proposed compared modeling behaviors teractions superiority chmm formulation demonstrated terms training efficiency classification accuracy synthetic agent training system created order develop flexible interpretable prior behavior models demonstrated ability use priori models accurately classify real behaviors additional tuning training fact specially important given limited amount training data available acknowledgments would like sincerely thank michael jordan tony jebara matthew brand inestimable help insightful comments appendix forward ff backward fi expressions chmms 4 deterministic approximation maximum posterior map state estimation introduced enables fast classification parameter estimation via expectation maximization also obtains upper bound cross entropy full combina toric posterior minimized using subspace linear number state variables nheads dynamic programming algorithm samples highest probability paths compacted state trellis complexity ot cn c chains n states apiece observing data points interesting cases limited couplings complexity falls otcn 2 hmms forwardbackward baumwelch algorithm provides expressions ff fi vari ables whose product leads likelihood sequence instant time case chmms two statepaths followed time chain one path corresponds head represented subscript h another corresponds sidekick indicated subscript k head therefore new forwardbackward algorithm expressions computing ff fi variables incorporate probabilities head sidekick chain second chain indicated 0 illustration effect maintaining multiple paths per chain traditional expression ff variable single hmm transformed pair equations one full posterior ff another marginalized posterior ff ff jh ff jh ff fi variable computed similar way tracing back paths selected forward analysis collecting statistics using nheads dynamic programming transition matrices within chains reestimated according conventional hmm expression coupling matrices given r active perception vs passive per ception representation space paradigm concurrent evolving object de scriptions computers seeing action coupled hidden markov models modeling interacting processes alex pent land operations learning graphical models guide literature learning probabilistic networks data advanced visual surveillance using bayesian networks going active gesture recognition using partially observable markov decision processes building qualitative event models automatically visual input factorial hidden markov models tutorial learning bayesian networks automatic symbolic traffic scene analysis using belief networks unsupervised clustering approach spatial preprocessing mss imagery probabilistic visual learning object detection image sequences towards conceptual descriptions lafter lips face tracking classification clustering modeling prediction human behavior tutorial hidden markov models selected applications speech recognition boltzmann chains hidden markov models probabilistic independence networks hidden markov probability models mean field networks learn discriminate temporally distorted strings tr ctr koichi sato brian l evans j k aggarwal designing embedded video processing camera using 16bit microprocessor surveillance system journal vlsi signal processing systems v42 n1 p5768 january 2006 lang congyan xu de event detection framework video sequences based hierarchic event structure perception proceedings 5th wseas international conference signal processing robotics automation p307312 february 1517 2006 madrid spain pentland learning communities understanding information flow human networks bt technology journal v22 n4 p6270 october 2004 michael cheng binh pham dian tjondronegoro tracking video surveillance activity analysis proceedings 4th international conference computer graphics interactive techniques australasia southeast asia november 29december 02 2006 kuala lumpur malaysia iain mccowan daniel gaticaperez samy bengio guillaume lathoud mark barnard dong zhang automatic analysis multimodal group actions meetings ieee transactions pattern analysis machine intelligence v27 n3 p305317 march 2005 alberto avanzi franois brmond christophe tornieri monique thonnat design assessment intelligent activity monitoring platform eurasip journal applied signal processing v2005 n1 p23592374 1 january 2005 longin jan latecki roland miezianko dragoljub pokrajac reliability motion features surveillance videos integrated computeraided engineering v12 n3 p279290 july 2005 lucjan pelc bogdan kwolek recognition action meeting videos using timed automata machine graphics vision international journal v15 n3 p577584 january 2006 sangho park j k aggarwal recognition twoperson interactions using hierarchical bayesian network first acm sigmm international workshop video surveillance november 0208 2003 berkeley california sangho park mohan trivedi analysis query personvehicle interactions homography domain proceedings 4th acm international workshop video surveillance sensor networks october 2727 2006 santa barbara california usa maja mateti slobodan ribari ivo ipi qualitative modelling analysis animal behaviour applied intelligence v21 n1 p2544 julyaugust 2004 antoine manzanera julien c richefeu new motion detection algorithm based background estimation pattern recognition letters v28 n3 p320328 february 2007 rita cucchiara costantino grana andrea prati roberto vezzani computer vision techniques pda accessibility inhouse video surveillance first acm sigmm international workshop video surveillance november 0208 2003 berkeley california donatello conte pasquale foggia jeanmichel jolion mario vento graphbased multiresolution algorithm tracking objects presence occlusions pattern recognition v39 n4 p562572 april 2006 somboon hongeng ram nevatia francois bremond videobased event recognition activity representation probabilistic recognition methods computer vision image understanding v96 n2 p129162 november 2004 amit sethi mandar rahurkar thomas huang event detection using variable module graphs home care applications eurasip journal applied signal processing v2007 n1 p111111 1 january 2007 alex pentland tanzeem choudhury nathan eagle push singh human dynamics computation organizations pattern recognition letters v26 n4 p503511 march 2005 albert ali salah ethem alpaydin lale akarun selective attentionbased method visual pattern recognition application handwritten digit recognition face recognition ieee transactions pattern analysis machine intelligence v24 n3 p420425 march 2002 dong zhang daniel gaticaperez samy bengio iain mccowan guillaume lathoud multimodal group action clustering meetings proceedings acm 2nd international workshop video surveillance sensor networks october 1515 2004 new york ny usa maria cecilla mazzaro mario sznaier octavia camps model invalidation approach gait classification ieee transactions pattern analysis machine intelligence v27 n11 p18201825 november 2005 daniel dementhon david doermann video retrieval using spatiotemporal descriptors proceedings eleventh acm international conference multimedia november 0208 2003 berkeley ca usa ying luo tzongder wu jenqneng hwang objectbased analysis interpretation human motion sports video sequences dynamic bayesian networks computer vision image understanding v92 n23 p196216 novemberdecember rokia missaoui roman palenichka effective image video mining overview modelbased approaches proceedings 6th international workshop multimedia data mining mining integrated media complex data p4352 august 2121 2005 chicago illinois ruth aguilarponce ashok kumar j luis tecpanecatlxihuitl magdy bayoumi network sensorbased framework automated visual surveillance journal network computer applications v30 n3 p12441271 august 2007 yaser sheikh mubarak shah bayesian modeling dynamic scenes object detection ieee transactions pattern analysis machine intelligence v27 n11 p17781792 november 2005 youfu wu jun shen mo dai traffic object detections action analysis pattern recognition letters v26 n13 p19631984 1 october 2005 datong chen jie yang howard wactlar towards automatic analysis social interaction patterns nursing home environment video proceedings 6th acm sigmm international workshop multimedia information retrieval october 1516 2004 new york ny usa cen rao mubarak shah tanveer syedamahmood invariance motion analysis videos proceedings eleventh acm international conference multimedia november 0208 2003 berkeley ca usa tao xiang shaogang gong model selection unsupervised learning visual context international journal computer vision v69 n2 p181201 august 2006 tao xiang shaogang gong beyond tracking modelling activity understanding behaviour international journal computer vision v67 n1 p2151 april 2006 ulf ekblad jason kinser theoretical foundation intersecting cortical model use change detection aircraft cars nuclear explosion tests signal processing v84 n7 p11311146 july 2004 rmer rosales stan sclaroff framework headingguided recognition human activity computer vision image understanding v91 n3 p335367 september gianluca antonini santiago venegas martinez michel bierlaire jean philippe thiran behavioral priors detection tracking pedestrians video sequences international journal computer vision v69 n2 p159180 august 2006 datong chen jie yang robert malkin howard wactlar detecting social interactions elderly nursing home environment acm transactions multimedia computing communications applications tomccap v3 n1 p6es february 2007 sudeep sarkar daniel majchrzak kishore korimilli perceptual organization based computational model robust segmentation moving objects computer vision image understanding v86 n3 p141170 june 2002 alper yilmaz omar javed mubarak shah object tracking survey acm computing surveys csur v38 n4 p13es 2006 thomas b moeslund adrian hilton volker krger survey advances visionbased human motion capture analysis computer vision image understanding v104 n2 p90126 november 2006