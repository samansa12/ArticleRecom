constructing bayesian networks medical diagnosis incomplete partially correct statistics abstractthe paper discusses several knowledge engineering techniques construction bayesian networks medical diagnostics available numerical probabilistic information incomplete partially correct situation occurs often epidemiological studies publish indirect statistics significant unmodeled conditional dependence exists problem domain nothing replace precise complete probabilistic information still useful diagnostic system built imperfect data introducing domaindependent constraints propose solution problem determining combined influences several diseases single test result specificity sensitivity data individual diseases also demonstrate two techniques dealing unmodeled conditional dependencies diagnostic network techniques discussed context effort design portable device cardiac diagnosis monitoring multimodal signals b introduction bayesian networks bn emerged successful tools medical diagnostics many deployed real medical environments implemented offtheshelf diagnostic software spi87 sho93 wsb97 constructing large bns applications many ways similar knowledgeengineering process employed creation expert systems es however building bn usually difficult building es bn contains lot additional quantitative numeric information essential proper operation statistics filling numeric information always readily available often designer system make use indirect statistics instead example always clear combinations diseases determine outcome particular diagnostic test usually available positive negative predictive likelihoods test individual disease regardless diseases might present questions estimating conditional probability tables joint effects combinations diseases requires use partial statistics problem necessity illposed numbers estimated available order find reasonable solution constraints introduced usually depend problem domain propose solution situation outlined discuss advantages limitations another related problem area constructing bns medical diagnostics incorporation partial knowledge way network behave particular overconfident diagnoses usually dealt introducing additional nodes represent hidden pathological states behavior nodes sometimes explained terms boolean functions compositions thereof expressing knowledge terms cpts nodes however straightforward propose one solution based use generic logical nodes also propose alternative technique require inclusion new intermediate nodes section 2 reviews briefly bayesian networks process design section 3 discusses problem constructing networks partial statistics proposes solutions cases finding impact several diseases single lab test section 4 proposes two methods dealing overconfident diagnosis section 5 summarizes proposed solutions concludes paper constructing bayesian networks bayesian network efficient factorization joint probability distributions jpd set variables variable x domain possible values jpd specifies probability possible combination values variables jpd known inference performed computing posterior probabilities example three variable p q r exist domain interest compute query q r 1 summands numerator denominator probabilities atomic events read representation jpd one possible way represent jpd means multidimensional joint probability table jpt key combination values variables reasoning joint probability tables however exponential space time size jpt exponential number variables number atomic probabilities numerator denominator equation 1 exponential number variables mentioned query performing summation takes exponential time probabilistic reasoning used practical system efficient form representation reasoning necessary bayesian networks associated reasoning algorithms serve exactly purpose key efficient representation jpts reducing number probabilities stored accomplished introducing simplifying assumptions underlying jpd one assumption conditional independence two variables b said conditionally independent respect third variable c p ajc know value c knowledge value b change belief one convenient way representing assumptions conditional independence means directed acyclic graphs dag augmented local conditional probability tables lcpts graphs called bayesian probabilistic networks three small networks shown fig1 representing different independence assumption identifying variables interest problem domain next step building bayesian network identify variables conditionally independent possible create dag bayesian net lists statements independence practice however much simpler procedure used dag bayesian net closely related dag set propositional b c figure 1 three graphical representations conditional independence x 1 independent x 3 given x 2 b x 2 x 3 marginally independent conditionally dependent given x 1 c opposite x 2 x 3 marginally dependent conditionally independent given x 1 rules like employed rulebased expert systems next stage constructing bayesian net specify numbers lcpts graph task much harder constructing dag ideally designer net access statistical estimates probabilities lcpt medical studies example df79 contain numbers required construction lcpt often however estimates available following sections discusses several ways deal problem 3 constructing complete cpts partial statistics major issue building successful bayesian net applications determine entries local cpt tables nodes net ideally numbers estimated statistically obtained via expert judgment often however numbers known form required lcpts example two diseases 1 2 might cause finding f appear usually obtain sensitivity p two dis eases lcpt however need joint etc determining joint conditional probabilities simple conditionals illposed problem n diseases influencing finding lcpt finding node 2 n entries time 2n sensitivities specificities n diseases inferring 2 n numbers 2n givens illposed problem commercial belief reasoning packages would require 2 n point probabilities way obtain introduce additional constraints bias towards certain values entries assumptions independence ad hoc techniques constraints depend particular type interactions random variables hand noted problem lcpt compilation arises single finding caused two diseases lcpt finding node contain probabilities finding present possible combinations parent nodes diseases n parents finding node 2 n numbers specified usually instead sensitivities specificities finding sensitivity finding p measure prevalence finding f among people disease specificity p shows absence finding indicates absence disease two findings equal sensitivity respective specificities determine unambiguously presence finding indicates presence disease finding higher specificity better indicator disease one lower specificity sensitivity specificity data obtained prevalence statistics several reasons sensitivity specificity numbers easiest obtain modular represent objective relationship finding disease regardless diseases modeled entries lcpt hand depend diseases designer network decided model addition physicians relate easily type information provide fairly good estimates pearl pea88 pp 15 33 argued numbers ones likely available experiential knowledge probably represented explicitly cognitive structures particular disease physicians seem keep memory frame describing characteristics including sensitivity specificity estimates various symptoms findings n parent nodes representing diseases 2n sensitivities specificities available determining 2 n entries lcpt illposed problem mapping diseases findings however specific structure exploited turn problem underdetermined wellposed assumed diseases act independently produce finding f net effect diseases combined produce cumulative probability finding present finding caused disease similarly logical gate relationship though deterministic diseases acting alone cause finding appear probability nondeterministic gate known name noisyor studied extensively sri93 hb94 rd98 probabilities p also called link probabilities noisyor gate entry lcpt obtained h particular truth assignment parents f h subset nodes h set true h empty product term assumed one resulting entry lcpt zero result rarely true real problem domain even diseases known present might unmodeled diseases cause finding addition always measurement error certain number false positives detection finding inevitable order represent effect unmodeled diseases measurement errors leak term pl usually employed noisyor model conceptually unmodeled causes finding represented disease node l always present leak probability pl used directly equation 2 like link probability l always h order specify lcpt needed n link one leak probabilities determining numbers 2n sensitivities specificities longer illposed problem instead changed overdetermined one propose procedure estimating link leak probabilities first step estimate link probabilities disease link probability characteristic particular disease depend sensitivities specificities diseases determine sensitivity specificity disease second step estimate leak probability whole model based link probabilities determined first step leak probability characteristic whole gate decide add diseases later leak probability updated order estimate link probability p employ leaky noisyor model two possible causes f disease one hand combined action factors lead appearance f modeled unmodeled diseases measurement errors etc conceptually think one leak factor l always present corresponding leak probability p following equation 2 two causes second equation expresses fact p disease represents exactly combined effect diseases present two equations cases practical interest equation well behaved disease causes f indeed p link probabilities p known estimate leak probability whole node lets consider p specificity disease expresses probability finding present known present consider world permanently absent decompose specificity across possible hypothesis f jhp h lcpt entries p f jh expressed terms already found link probabilities p unknown leak term p l according noisyor solving p l obtain produce estimate p l combine appropriate manner consistent either simple weighted averaging weights example negated priors p diseases justification choice weights leak term p l needed disease present rate separate estimates p l consistent probably sensitivity specificity data suspect noisyor model appropriate particular set diseases following numerical example illustrates operation algorithm suppose two diseases tuberculosis 1 bronchitis 2 cause dyspnea breathlessness f given incidence two diseases well sensitivity specificity finding respect first step find link probabilities disease 0986 next step estimate leak probability noisyor gate two specificities already found link probabilities see two estimates leak probability fairly consistent use either average noisyor gate 4 dealing conditional dependence overconfidence assumptions conditional independence main factor simplifying jpd representing efficiently bayesian network strict conditional independence however rarely exists distributions coming real world two variables nearly conditionally independent effect making assumption usually significant however many situations making unwarranted assumption conditional independence severely impairs performance reasoning system one case observed two findings completely independent given disease overconfidence diagnosis end effect failing represent explicitly dependency yhl88 reasons overconfidence explained following example two symptoms disease cardiac tamponade dyspnea breathless ness breathing b 20 inhalations per minute clearly two findings related patient cardiac tamponade difficulty breath ing would likely patient breathing rapidly trying compensate air shortage fail represent dependency two findings time reported present posterior odds odjab disease increase product likelihoods lajd lbjd two findings multiplying two likelihoods clearly right know present establishing b bring substantial new information fail recognize effect posterior odds odjab become unreasonably high system said overconfident diagnosis likely trusted users long run reliable methods established medical community detection overconfidence underconfidence diffidence diagnostic systems hhb78a hhb78b methods require dataset diagnostic cases known diagnoses several strategies dealing conditional dependency findings simplest disregard findings diagnostic one example system iliad uses strategy cases wsb97 guaranteed avoid overconfidence indeed expense ignoring useful diagnostic information another strategy introduce intermediate nodes represent pathophysiological states also called clusters findings yhl88 solution shown fig 2a scheme findings determine truth value intermediate node latter influences disease node directly problem approach probabilities subnetwork known rarely case pathophysiological states usually unobservable 41 expressing boolean clusters one practically important situation probabilities subnetwork easy find boolean clusters example intermediate node representing pathophysiological state myocardial arrhythmias whenever one nodes corresponding various arrhythmias words node simple function nodes designer network uses qualitative information behavior network similarly principles constructing qualitative bayesian networks wel90 dh93 constructing lcpt gate trivial direction edges graph incompatible rest network fig 2b fig2b node simple nodes f 1 f 2 however also parent lcpt includes mixed entries findings f 1 f 2 disease node obvious entries even possible construct network would include causal anticausal edges general would like consistent arrows dag network either causal diagnostic direction one solution invert direction boolean rule make compatible rest network inversion mechanical procedure manipulates local structure probability tables network available feature development environments netica nor97a nor97b resulting network represents jpd original one factorization different noted inverting boolean rules extremal entries lcpts 0 1 degeneracies might occur example one way represent rule means following lcpt topology inverted fig 2c parents f 1 f 2 note inversion introduces new link f 2 f 1 lcpt f 1 include entry clearly truth assignment f 2 impossible rule entry p cannot filled reversal algorithm certainly value filled never used nevertheless reversal algorithms fail degenerate case better choice lcpt original network would example c b figure 2 aintroduction intermediate node bmixing causal anticausal links difficult clink reversal might introduce many unwanted links findings number ffl extremal values avoided reversal well behaved technique link reversal useful relatively small networks five antecedents rule larger rules number probabilities lcpts becomes prohibitively large reversal link new links added nodes markov blanket nodes connected link markov blanket node set nodes parents children parents children node pea88 example inversion rule 11 antecedents results network 8192 numbers lcpts computational effort hardly worth benefits using rule question ask whether numbers really necessary representing simple logical rule would desirable could obtain similar computational results smaller bayesian net example one shown fig 2a turns possible fig 2a shows gate edges pointing causal generative direction links leaves net theory possible construct net implements precise gate direction practice satisfactory build net exhibits similar behavior within arbitrarily close error bounds since commutative operators reasonable expect lcpts child nodes 2a identical enough specify one gate represented following lcpt p number ffl analogously lcpt node difference two types nodes much lcpt entries differ extremal values 0 1 smaller number ffl closer behavior gate true logical function least small smallest prior probability consequent node preferably smaller gate trivially expressed lcpt p means three gates arbitrary propositional rules expressed furthermore rules represented proposed bayesian subnetworks able propagate virtual uncertain evidence original propositional rules cannot mi jr mi mi 03 07 mi figure 3 segment network diagnosing myocardial infarction mi based detection st segment depression std five cardiac arrhythmias sinus tachycardia st sinus bradycardia sb atrial flutter afl atrial fibrillation afb junctional rhythm jr overconfident diagnosis avoided introducing intermediate node ca denoting cardiac arrhythmia lcpts arrhythmia nodes identical st figure 3 illustrates use intermediate cluster avoid overconfident diagnosis myocardial infarction mi several cardiac arrhythmias detected arrhythmias weak inconclusive indications mi supplemental role diagnosis finding depression st segment electrocardiogram std much stronger finding reflected lcpt however intermediate node ca present effect several cardiac arrythmias diagnosis might much stronger std node ca present matter many arrythmias detected combined effect one detected prevents overconfidence places emphasis predictive finding std 42 controlling degree conditional dependence inversion logical rules helps situations beliefs intermediate nodes expressed logical functions hard determine lcpts intermediate nodes instead introducing intermediate nodes try model explicitly dependence findings result modification shown fig 4a least one finding nodes parents disease node another finding corresponding mixed entries lcpt node hard obtain statistics usually available sensitivities specificities two findings addition designer system usually qualitative idea dependent two findings are1 b c figure 4 aexplicit control dependency b overconfident net created c inverse net built sampling conditional distribution p djf represented previous net entries lcpt corrected net reinverted type information fact sufficient construct subnetwork fig 4a special type double network inversion employed control explicitly degree dependency two findings idea technique obtain network marginally independent findings edges diagnostic direction opposite one sensitivity specificity parameters available lcpt network contains posterior probabilities disease given possible combinations findings cases overconfidence identified corrected directly lcpt satisfactory diagnosis achieved corrected network inverted original generative direction edges diseases findings second inversion additional links appear findings corresponding lcpts generated link reversal algorithm noted standard link reversal algorithm employed second inversion first one link reversal algorithms change direction edges resulting network represents joint probability distribution nor97a introduce links findings findings marginally dependent original network contrast need link reversal algorithm produces network marginally independent finding nodes preserves conditional probability distribution necessarily joint probability distribution former represented network marginally independent finding nodes links latter cannot inverting conditional probability distribution p djf done instantiating nodes original overconfident network fig 4b particular combination h truth values finding nodes belief updating reading posterior probability p djh node entering number lcpt node inverted net fig 4c process repeated possible truth assignments finding nodes instantiation produce one entry lcpt new network manual sampling original network straightforward tedious errorprone order facilitate inversion utility employed samples existing overconfident network creates another one represents conditional probability distribution utility used built means netica api library nor97b lcpt inverted net fig 4c corrected avoid overconfidence reinverted back causal direction results appearance additional link fig 4a procedure double inversion illustrated following numerical example involving aforementioned problem diagnosing cardiac tamponade given two findings breathlessness breathing data available incidence disease sensitivity specificity two findings addition knowledge two findings conditionally independent approximate idea conditional dependency first step build network type shown fig 4b using disease prior sensitivity specificity information two findings means belief updating network obtain marginal probabilities findings probabilities approximate case close p p respectively disease rare network used diagnostic reasoning instantiating finding nodes possible combinations truth values clearly see network overconfident first finding present posterior probability disease five times prior probability similarly second finding present posterior probability three times prior one however findings present posterior 148 times prior even though second finding add substantial new diagnostic information unreasonable increase posterior probability might lead imprecise diagnosis eliminated end build another network time type shown fig 4c priors network marginal probabilities findings found first step lcpt disease node filled posterior probabilities disease node first network appropriate corrections particular case following corrections seem reasonable two entries p dj remain network built links inverted general link reversal algorithm implemented package belief reasoning nor97a result network type shown fig 4a extra edge f 2 f 1 inserted order reflect fact two findings conditionally independent moreover lcpts finding nodes contain appropriate numbers otherwise hard come 5 conclusion building using probabilistic networks medical diagnosis requires reliable methods knowledge engineering methods borrowed general practice constructing probabilistic systems others adapted problem domain paper described several techniques methods described compiling local conditional probability tables partial statistics mappings diseases findings proposed solution problem estimation parameters leaky noisyor gates significantly easier use methods assessment require statistics specificity sensitivity findings overconfidence diagnosis major problem probabilistic diagnostic systems handling successfully crucial factor acceptance diagnostic systems medical decision makers two methods proposed deal major reason overconfidence unmodeled conditional dependence methods used correct numbers local conditional probability tables bayesian network unmodeled conditional dependence suspected means double linkreversal technique amount conditional dependence findings controlled precisely also findings clustered means logical rules rules represented efficiently proposed bayesian subnetworks serve logical gates r analysis probability aid clinical diagnosis coronaryartery disease efficient reasoning qualitative probabilistic networks tractable inference algorithm diagnosing multiple diseases new look causal independence netica application users guide netica api programmers library probabilistic reasoning intelligent systems impact causal independence adolescence ai medicine field come age probabilistic expert systems medicine generalization noisyor model probabilistic diagnosis using reformulation internist1qmr knowledge base knowledge engineering health informatics fundamental concepts qualitative probabilistic networks clustered knowledge representation increasing reliability computerized expert systems tr ctr ferat sahin etin yavuz ziya arnavut nder uluyol fault diagnosis airplane engines using bayesian networks distributed particle swarm optimization parallel computing v33 n2 p124143 march 2007 fabio gagliardi cozman cassio polpo de campos jaime shinsuke propositional relational bayesian networks associated imprecise qualitative probabilistic assessments proceedings 20th conference uncertainty artificial intelligence p104111 july 0711 2004 banff canada