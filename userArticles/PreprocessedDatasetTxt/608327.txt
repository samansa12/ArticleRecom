satellite image deblurring using complex wavelet packets deconvolution blurred noisy satellite images illposed inverse problem direct inversion leads unacceptable noise amplification usually problem regularized inversion process recently new approaches proposed rough deconvolution followed noise filtering wavelet transform domain herein developed second solution thresholding coefficients new complex wavelet packet transformsemi parameters automatically estimated use complex wavelet packets enables translational invariance improves directional selectivity remaining complexity new hybrid thresholding technique leads high quality results exhibit correctly restored textures high snr homogeneous areas compared previous algorithms proposed method faster rotationally invariant better takes account directions details textures image improving restoration images deconvolved way used restoration step proposed inserted directly acquisition chain also provide starting point adaptive regularization method enabling one obtain sharper edges b introduction problem presented reconstruction satellite image blurred noisy data degradation model represented equation observed data x original image n additive noise assumed gaussian white stationary represents circular convolution point spread function psf h positive possesses shannon property deal real satellite image deblurring problem proposed french space agency cnes problem part simulation future spot 5 satellite noise standard deviation psf h assumed known deconvolution problem illposed noise contaminates data inversion process strongly amplifies noise regularization done thus deconvolve observed image recovering details without amplifying noise process used estimate x degraded data must preserve textures enable results visually correct moreover noise remain small homogeneous regions many methods proposed regularizing problem introducing priori constraints solution 4 9 23 however preserve textures since textures taken account regularizing model achieve better deconvolution authors 1 19 21 prefer use waveletbased regularizing function approaches drawback iterative means time consuming always appropriate deconvolving satellite data images large authors donoho et al 6 mallat kalifa 16 proposed denoising image deconvolution without regularization images represented using wavelet wavelet packet basis denoising process done basis method iterative provides fast implementation simple inversion observation equation 1 frequency space gives unacceptably noisy solution denoise compact representation chosen order separate signal noise well possible representation said compact approximates signal small number parameters coecients decomposition given basis noise amplified deconvolution process colored furthermore coe cients noise independent wavelet basis thus basis must adapt covariance properties noise covariance nearly diagonal 15 wrt basis decorrelate noise coecients much possible fourier basis achieves diagonalization energy signal concentrated small number coecients basis vectors spatially localized fourier transform suitable thresholding method good compromise use wavelet packet basis 5 since nearly realizes two following essential conditions ie signal representation sparse noise covariance operator nearly diagonalized 15 many types wavelets transforms used construct packet basis exhibit dierent properties depending spatial frequency localization separability wrt rows columns decimated real wavelet transforms ecient satellite image deconvolution produce artefacts since transform shift invariant avoid artefacts resulting image averaged possible integer translations also possible use shift invariant transforms redundancy generally high depends depth transform anyway two techniques major drawback slowing algorithm main motivation work solve problem computationally ecient manner way enable translation invariance without much loss computational time using complex wavelets 17 18 wavelets also provide better restoration separating 6 directions real separable wavelets take account two directions order achieve necessary neardiagonalization deconvolved noise covariance implemented complex wavelet packet algorithm essential contributions following 1 designed new transform complex wavelet packet transform better directional selectivity complex wavelet transform exhibiting shift rotational invariance properties 2 proposed algorithm fully automatic since based bayesian approach necessary parameters estimated maximum likelihood 3 proposed new hybrid technique consisting combining two dierent meth ods regularization wavelet thresholding obtain optimal deconvolution results 4 performs inversion much faster shift invariant real transforms reconstructs features various orientations better paper organized follows first section ii detail compute proposed complex wavelet packet transform properties new transform section iii present bayesian thresholding framework used estimate unknown coecients observed data explain compute variance deconvolved noise sections iiia iiic devoted presentation dierent prior models put wavelet coecients homogeneous noninformative inhomogeneous priors section iiic2 detail hybrid technique used estimate adaptive parameters latter model used algorithm proposed section iv finally present section v comparison classical algorithms used satellite image deconvolution demonstrate superiority proposed method ii complex wavelet packets build complex wavelet transform kingsbury 17 developed quadtree al gorithm noting approximate shift invariance obtained real biorthogonal transform doubling sampling rate scale achieved computing 4 parallel wavelet trees dierently subsampled thus redundancy limited 4 compared real shift invariant transforms shift invariance perfect level 1 approximately achieved beyond level transform algorithm designed optimize translation invariance therefore involves two pairs biorthogonal filters odd h g even h e g e level simply nondecimated wavelet transform using h reordered 4 interleaved images using parity defines 4 trees b c j 1 tree processed separately real transform combination odd even filters depending tree transform achieved fast filter bank technique complexity extended original transform applying filters h g detail subbands thus defining complex wavelet packet cwp transform 13 14 new transform exhibits invariance properties original complex wavelet transform tree corresponding transform given fig 1 filter bank used decomposition illustrated fig 2 subbands indexed p q tree impulse responses shown fig 3 related partitioning frequency space given fig 4 demonstrate ability separate 26 directions chosen decomposition tree compared real separable transforms define two directions rows columns provides near rotational invariance gives selectivity better represents strongly oriented textures thus separating better noise furthermore compared original complex wavelet transform separates 6 directions directional selectivity higher instead dividing approximation space define new orientation wavelet packet decomposition processes detail subbands strongly oriented detail subband level 1 isolates area frequency space defined mean direction dispersion enabling one select range directions around orientation subband decomposed 4 new subbands means corresponding frequency area splits 4 new areas define new orientations shown fig 4 really complex transform since based continuous complex mother wavelet nevertheless quadtree transform practice properties complex transform wrt shifting input image perfectly invertable computationally ecient complex coecients obtained combining dierent trees together index subbands k detail subbands jk parallel trees b c combined form complex subbands z jk z jk linear transform represented matrix following way z jk jk z jk thresholding magnitudes z without modifying phase enables us define nearly shift invariant filtering method reconstruction done tree independently using dual filters results 4 trees averaged obtain 0 ensure symmetry trees thus enabling desired shift invariance iii bayesian thresholding let us denote x deconvolved image without regularization subband k variables x denote one cwp coecients corresponding respectively observation original image x suppose h invertible ie zeros fourier space since noise n white gaussian equ 1 multiplied h 1 gives cwp domain obtain expression noise coecients n let us recall equ 2 complex coecient obtained summing subtracting coecients 4 trees b c compute covariance real imaginary parts find coecients z noise coecients tree symmetry assumptions covariance null since covariances en n dierent trees equal distribution noise defined joint distribution n r assume coecients independent given subband dierent subbands given scale also scales approximation enables fast thresholding technique handle possible correlations subbands neighbour coecients covariance matrix noise supposed nearly diagonal chosen basis see fig 6 fig 7 consider noise variables also independent wavelet packet basis assume noise variance constant subband k compute k considering undecimated transform noise n performed linear operator convolution impulse response w k obtained inverse cwpt dirac f denotes fourier transform estimate unknown coecients within bayesian framework 22 demonstrated 14 approach provides slightly better results minimax risk calculus real satellite data compute map estimate use bayes law calculate expression posterior probability p x given distribution noise homogeneous prior model generalized gaussian distributions used model real wavelet coecients 20 22 also propose use model cwp subbands prior probability k prior parameter p k exponent however assume variables independent within given subband also dierent subbands shown fig 5 complex density bidimensional function depends magnitude exhibits radial symmetry generally separable p 2 set given density function magnitude phase uniformly distributed exponent p k set fixed value subbands simplify computation indeed parameter specified must estimated quite complex justified improvement results large size images parameter k computed eciently various methods maximum likelihood example choose estimate automatically histogram given subband obtain following expression map using prior law possible demonstrate equivalent apply thresholding operator p k magnitude coecient 14 complex wavelets leads following equations shows obtained x keeping phase thresholding magnitude reduces simple soft thresholding elsewhere thus classical filtering method naturally arises bayesian approach resulting thresholding functions smoother exponent prior law 7 become linear 2 p k 1 realistic satellite images functions become discontinuous thresholding functions numerically computed solving equation 10 wrt fig 8 shows behaviour functions dierent values p k experimental studies shown provides ecient model satellite images 14 b noninformative jereys prior possible use dierent approach subband modeling approach proposed 8 within wavelet based image denoising framework based following assumption inference procedure invariant changes amplitude scale means prior probability law must keep behaviour even rescaled setting example case classical gaussian laplacian models author uses following prior called noninformative prior corresponds extremely heavytailed distribution approximately describes original wavelet coecients unfortunately improper resulting posterior density function integrable therefore alternative fully bayesian framework chosen consists treating real imaginary part coecient zeromean gaussian variable variance 2 defines adaptive model since coecient dierent variance variance supposed follow jereys hyperprior distribution ie equivalent p 1 within bayesian context thus model remains homogeneous even though adaptive gaussian model used intermediately address problem improper distribution estimation performed two steps estimate variance 2 using x estimate unknown coecient using express p 2 x need p signal noise gaussian respective variances 2 2 k p also hyperprior 13 equivalent map estimate inhomogeneous gaussian model gives following expression see next section complete proof combining equations 14 15 obtain following estimate call noninformative thresholding function j advantage method need parameter estimation since parameter however drawback especially visible homogeneous areas residual noise quite apparent variance higher previously presented homogeneous model probably comes lack robustness estimation method remark remove prior law estimation 2 done mle gives function like threshold 2 2 instead 4 2 insucient since magnitude noise variance equal 2 2 thus hyperprior makes estimation robust doubling threshold value still sucient remove noise peaks large constant areas hereafter detail robust method filter complex wavelet packet subbands c inhomogeneous prior model c1 model generalized gaussian model presented previously chosen seems match correctly original coecient distribution heavytailed another possible way capture property define inhomogeneous model adapts local characteristics subbands approaches spatial adaptivity real wavelet domain found literature example 3 simplify let us choose gaussian model variance parameter dierent coecient enables us dierentiate edges textures high intensity homogeneous areas generally correspond low values coecients since parameters dierent one variable another histogram subband heavytailed behaviour even distribution variable gaussian denote 2 variance real imaginary part original coecient prior law parameters prior distribution known unknown variables estimated computing map fully bayesian technique use property 5 recall expression noise distribution 6 combine equ 17 obtain therefore map given compute minimum dierentiate wrt real imaginary parts gives two equations recombined form equation complex numbers r xr gives inhomogeneous map estimate c2 adaptive parameter estimation dicult problem approach estimate adaptive parameters model shown 12 mle robust applied incomplete data ie estimation made noisy data indeed many parameters observed data robustness becomes sucient estimation made original image x good approximation image still sucient provide useful parameter estimates use complete data approach estimate variances 2 consider equ 17 complete data mle defined assumimg independence obtain factor 2 comes dimensionality distribution obviously access original coecients take transform coecients approximate original image instead experiments shown satisfactory approximation provided nonlinear regularizing algorithm rhea detailed 11 essentially consists variational method based functions 4 minimization criterion penalizes noisy solutions preserves edges preceded automatic parameter estimation step compute hyperparameters regularizing model method certainly perfect residual noise remains visible constant areas however filter noise well deconvolved noise thresholding technique choose use noninformative threshold previous section require additional parameter estimation proposed algorithm consists obtaining desired approximate original image using rhea 11 filtering cwpt result using equ 16 estimating adaptive parameters using complete data mle equ 20 estimating unknown coecients computing map equ 19 addition computation deconvolved noise variance also need compute variance 2 2 k residual noise approximate image let us denote thresholded transform coecients approximate original image supposed suciently exempt noise contain sucient information enable texture edge recovery homogeneous areas edges fine since used edgepreserving method followed ecient noise thresholding still explain coecients related textured areas suciently high avoid strong attenuation using equ 19 areas variational method used completely remove textures even visually sharp suciently present approximate image enable correct reconstruction using method detailed finally known using equ 19 20 estimate coecient compute expression thresholding function minimizes bayesian risk estimator defined denotes expectation wrt distribution x find exactly form equ 21 take approximate original coecient instead bayesian minimum risk methods lead expression means chosen model good since corresponding estimator provides minimum risk case wiener filtering 10 computing map gaussian assumptions signal noise gaussian distributions equivalent minimizing risk linear estimator wrt attenuation factor therefore two approaches equivalent gaussian case iv deconvolution algorithm adaptive model described equ 17 provides much better results visually wrt snr homogeneous model described equ 7 details better preserved constant areas cleaner keep model final version proposed algorithm also compared scheme classical approach 6 minimum risk computation various models 14 consistently exhibits better results initial deconvolution made cosine transform space instead fourier space avoid artefacts near borders image proposed algorithm called cowpath complex wavelet packet automatic thresholding consists following steps see fig dct discrete cosine transform observation deconvolution divide f h practice divide f h small since coecients f h null inverse dct result gives x cwp transform x computation approximate original image apply rhea algorithm 11 nonlinear regularization automatic parameter estimation cwp transform computation k using known h see equ 4 computation k residual noise approximate original image using known h see 14 details thresholding approximate image coecients using jereys noninformative prior estimation parameters inhomogeneous gaussian model see equ 20 coecient thresholding computing map see equ 21 inverse cwp transform gives estimate x variance residual noise homogeneous areas needed denoise approximate original image using image parameter estimation computed manner variance deconvolved noise ie using equation similar equ 4 computation assume constant regions correspond quadratic regularization possible use sums fourier space refer 14 details main characteristic algorithm use two dierent methods regularization wavelet thresholding obtain hybrid technique whose results better results single regularization method wavelet thresholding decorrelated deconvolved noise residual noise approximate original image higher quality deconvolved image possible replace nonquadratic regularizing model rhea algorithm simple quadratic model advantages enable single step deconvolution frequency space make parameter estimation step deterministic fast nonquadratic case need mcmc method 11 edges sharp nonquadratic model approximate image suciently accurate provide correct estimation inhomogeneous parameters subband model snr dierence original accelerated algorithms 01 db spot 5 simulation image shown fig 13 complexity algorithm 115 log operations per pixel 1980 oppix 512 512 image use accelerated version based previously described quadratic model 15 log image represents 4 pentium ii 400 mhz machine v satellite image deblurring simulation fig 10 shows 128x128 area extracted original image n mes spot 5 simulation 25 resolution provided french space agency cnes fig 11 shows psf fig 12 shows observed image fig 13 shows image deconvolved proposed algorithm b comparison dierent methods 1 quadratic regularization 23 nearly equivalent parametric wiener filter gives results also equivalent isotropic diusion edges filtered well noise seen fig 14 therefore impossible obtain sharp details noisefree homogeneous areas time thus snr remains low 197 db insucient noise removal areas 2 nonquadratic regularization 4 9 resulting image rhea algorithm 11 exhibits sharp edges compared result shown previously however noise remains homogeneous regions textures attenuated snr 220 db result used approximate original image illustrated fig 15 3 real wavelet packets 15 proposed complex wavelet packet transform two times faster shift invariant real wavelet packet transform based symmlet4 wavelets much directionally selective real wavelet packet thresholding gives snr equal 218 db see fig 16 illustration 4 proposed method faster methods provides highest snr 222 db textures oriented features sharp regular homogeneous regions remain noise free seen fig 13 vi conclusion proposed new complex wavelet packet transform make ecient satellite image deconvolution algorithm transform exhibits better directional shift invariance properties real wavelet packet transforms lower computational cost proposed deconvolution method superior competing algorithms satellite images faster accurate fully automatic essential novelty proposed algorithm consists hybrid approach two radically dierent methods combined produce deconvolved image higher quality result method individually finally quadratic model used speed greatly increased opens path real time processing image sequences onboard image processing satellites using specialized chips furthermore new type approach extended results improved handle dicult cases dierent types blur higher noise variance possible take account various levels noise dierent convolution kernels indeed wavelet packet decomposition tree unique adapted noise statistics case noninvertible blur motion blur forbids use nonregularized inversion fourier domain therefore case regularized deconvolution replace rough inversion used proposed method improvement adaptive gaussian model could also provided choosing accurate distribution capture heavytailed distribution wavelet packet coecients example adaptive generalized gaussian models could investigated furthermore including dependence dierent scales means multiscale hidden markov trees could perhaps enable better separation small features deconvolved noise types models would certainly better model edges propagate across scales enable reconstruction eciently vii acknowledgements authors would like thank jerome kalifa cmapx ecole polytechnique interesting discussions nick kingsbury signal processing group dept eng university cambridge complex wavelets source code collaboration peter de rivaz institution kind remarks french space agency cnes providing image n mes spot 5 simulation r wavelet domain image restoration using edge preserving prior models bayesian theory spatial adaptive wavelet thresholding image denoising wavelet analysis signal processing denoising soft thresholding spatial adaptation via wavelet shrinkage bayesian waveletbased image estimation using noninformative priors stochastic relaxation image restoration method least squares restauration minimax et deconvolution dans une base dondelettes miroirs wavelet packet deconvolutions dualtree complex wavelet transform new ecient tool image restoration enhancement wavelets key intermittent information theory multiresolution signal decomposition wavelet representation wavelet regularization method di bayesian inference wavelet based methods regularization incorrectly posed problems tr