stability diagonal pivoting method partial pivoting lapack linpack solve symmetric indefinite linear systems using diagonal pivoting method partial pivoting strategy bunch kaufman math comp 31 1977 pp 163179 proof stability method appeared literature tempting argue diagonal pivoting method stable given pivoting strategy growth factor small show argument false general give sufficient condition stability condition satisfied partial pivoting strategy multipliers unbounded nevertheless using specific approach able prove stability partial pivoting thereby filling gap body theory supporting lapack linpack b introduction lapack renowned numerical reliability algorithms employs lapack users guide 1 states almost algorithms lapack well linpack eispack normwise back ward stable 1 p 74 algorithms covered statement known stable appropriately weakened senses analyses back claims stability spread throughout research literature last 35 years writing book accuracy stability numerical algorithms 14 realised proof literature stability method used lapack linpack solving symmetric indefinite linear systems furthermore stability direct consequence existing results purpose paper prove stability method thereby fill gap body theory supporting lapack linpack remainder introduction briefly describe method anal ysed diagonal pivoting method partial pivoting strategy bunch kaufman 5 let 2 ir nthetan symmetric nonzero find permutation pi integer e nonsingular compute factorization ngammas process repeated recursively n gamma theta n gamma schur complement department mathematics university manchester manchester m13 9pl england nanhighamnanetornlgov work supported engineering physical sciences research council grants grh52139 grh94528 n j higham result factorization l unit lower triangular block diagonal diagonal block dimension 1 2 factorization essentially symmetric block form gaussian elimination pivoting costs n 3 3 flops 1 cost cholesky factorization positive definite matrix plus cost determining permutations pi method computing block ldl factorization called diagonal pivoting method given factorization 12 nonsingular linear system readily solved substitution solving 2 theta 2 linear systems corresponding 2 theta 2 diagonal blocks strategy choosing pi crucial achieving stability bunch parlett proposed complete pivoting strategy requires whole active submatrix searched stage factorization therefore requires n 3 6 comparisons bunch 3 proved diagonal pivoting method complete pivoting satisfies backward error bound almost good gaussian elimination complete pivoting bunch kaufman 5 devised partial pivoting strategy searches two columns stage requires 2 com parisons lapack driver routines xsysv simple xsysvx expert routines xsifaxsisl use diagonal pivoting method partial pivoting solve linear system symmetric indefinite coefficient matrix describe partial pivoting strategy suffices define pivot choice first stage factorization recall denotes size pivot block algorithm 1 bunchkaufman partial pivoting strategy algorithm determines pivot first stage diagonal pivoting method partial pivoting applied symmetric matrix 2 ir nthetan nothing stage elimination r minfi 2 ja i1 ja 11 j ff else ja 11 joe ff 2 else ja rr j ffoe choose pi swap rows columns 1 r else choose pi swap rows columns 2 r jpiapi 1 flop floating point addition subtraction multiplication division understand partial pivoting strategy helps consider note pivot one 11 rr theta a11 arr rather since matrix replaced r1 value constant 178 determined regarding ff free parameter equating bound element growth two stages bound element growth one see 5 14 details growth factor defined diagonal pivoting method way gaussian elimination k ij elements schur complements arising course factorization derivation constant ff easy show partial pivoting larger bound elimination partial pivoting gepp seems gepp large element growth rare practice 5 9 2 stability diagonal pivoting method since growth factor diagonal pivoting method partial pivoting bounded usually small practice follow method stable sense gepp tempting argument one neither used warned existing literature however easy show argument false exhibiting example diagonal pivoting method small growth factor unstable example produced partial pivoting 2 theta 2 pivot followed 1 theta 1 pivot gammaffl gammaffl gamma15 growth factor ae n 1 yet klk1kak1 unbounded ffl 0 suggests factorization however computed may provide stable way solve linear systems finite precision arithmetic instability confirmed matlab experiment unit roundoff solved linear system two different ways first computed factorization 21 using diagonal pivoting method specified 11 taking 2 theta 2 pivot first step using gepp 4 n j higham table backward error computed solution indefinite system order 3 diagonal explicit pivoting factors solve linear systems involving pivot comparison evaluated explicit formulae ldl factors 21 used explicit inverse d1 2 1 2 solving linear system involving table 21 shows normwise relative backward error computed solution b x see 16 14 th 71 proof latter equality would order u stable solution method ffl decreases computations become unstable note stability obtained 11 take natural 1 theta 1 pivot 11 instead ill conditioned 2 theta 2 pivot a1 2 1 2 interestingly though 2 theta 2 pivot shares chosen bunchkaufman partial pivoting strategy property indefinite partial pivoting stable example conclude small growth factor enough guarantee stability diagonal pivoting method sufficient condition stability obtained regarding block ldl factorization computed diagonal pivoting method special case block lu factorization error analysis block lu factorization given demmel higham schreiber 8 suitable modification analysis gives following result linear systems involving 2 theta 2 pivots solved normwise backward stable fashion condition modest constant c n sufficient ensure diagonal pivoting method produces factorization small relative residual provides computed solutions linear systems small backward error unfortunately condition 22 hold partial pivoting strategy bunch kaufman shown following example ffl 0 diagonal pivoting method partial pivoting produces factorization ffl 0 klk1kdk1kl k1 kak1 1 indeed multipliers unbounded even 1 theta 1 pivots lead arbitrarily large elements l following example shows partial pivoting selects worth emphasizing large elements factor matrix necessarily imply factorization unstable example point ldl factorization symmetric positive definite matrix ratio klk1kak1 arbitrarily large yet factorization guaranteed stable one example ffl 0 conclusion existing results lu factorization block lu factorization directly imply stability diagonal pivoting method partial pivoting proof stability must make use particular properties partial pivoting strategy claims stability found literature paper bunch kaufman parlett 6 linpack users guide 9 p 519 cases residual bounds form stated without proof p polynomial prove result form theorem 42 backward error result computed solution note much bunchs analysis diagonal pivoting method 3 specific complete pivoting analysis readily yield results partial pivoting rest paper present new analysis show partial pivoting indeed stable pivoting strategy diagonal pivoting method 3 background results error analysis collect section standard error analysis results needed later model floating point arithmetic take u unit roundoff results quote remain true weaker model accommodates machines without guard digit 14 x24 provided constants increased slightly introduce constant carries implicit assumption nu 1 useful properties proofs following results found 14 first matrix multiplication nthetan nonsingular triangular matrix system solved substitution 6 n j higham third linear system nthetan solved without breakdown gaussian elimination without pivoting computed solution satisfies u l b u computed lu factors use norm defined kabk best bound form holds 4 error analysis 41 2 theta 2 linear systems crucial error analysis follows backward error result solution linear systems involving 2 theta 2 pivots note notation algorithm 1 pivot 11 r1 r1 rr subsection later analysis convenient tabulate conditions must hold 2 theta 2 pivot selected 41a 41b 41c 41d fourth inequality consequence previous two note 41c implies oe 6 0 suppose first linear systems solved gepp 41a computes lu factorization r1 rr 11 r1 11 r132 4 r1 rr 0 r1 gamma 11 rr 33 backward error result u j r1 r1 using 41d follows using numerical value ff specified algorithm 1 strictly append bound account replacing j b u j bound jljju j omit second order term moment reinstate later note result 42 holds trivially 1 theta 1 pivot e main alternative using gepp solve systems use explicit inverse e done implementations diagonal pivoting method partial pivoting lapack linpack see auxiliary routine xlasyf lapack xsifa linpack lapack linpack solved evaluating r1 11 r1 delta rr r1 rr r1 r17 5 b corresponds using explicit formula inverse 2 theta 2 matrix equivalently cramers rule scaling avoid overflow term r1 delta rr r1 appears potential source instability since arbitrary 11 r1 rr relative error computed b unbounded however exploiting condition 41d 2 theta 2 pivot rewrite 2 obtain satisfactory error bound b using model 31 11 r1 delta rr r1 1 4 implies 14 lemma 31 r1 delta rr r1 hence 2 straightforward show denoting matrix 43 z 8 n j higham using a3 oettliprager theorem 15 14 th 73 implies strictly second order term added bound time account fact jxj rather jbxj appears righthand side 44 conclusion whether linear system involving 2 theta 2 pivot solved gepp using explicit inverse integer constant c worth stressing result hold arbitrary 2 theta 2 symmetric matrix ewe fully exploited pivoting conditions derivation 42 componentwise backward error analysis carry componentwise backward error analysis diagonal pivoting method make one assumption pivoting strategy 45 holds 2 theta 2 pivots convenience assume without loss generality interchanges needed amounts redefining pap 12 begin consider first stage factorization using notation 11 submatrix l l j jth column l jth column c 45 hence overall assume schur complement computed remaining stages diagonal pivoting method factorize schur complement assume inductively computed factors u constant depending n gamma u therefore computed factors b l b satisfy 0 2 schur complement computed 21 bound 49 ensues 46 inequalities using 47 48 overall hence dn u clearly form pnu ou 2 p linear polynomial analyse substitution stages ldl factorization used solve linear system 32 45 computed solutions three systems ly thus jdeltaaj bounded 49 bringing back account row column interchanges obtain following result theorem 41 let 2 ir nthetan symmetric let b x computed solution linear system produced diagonal pivoting method pivoting strategy linear systems involving 2 theta 2 pivots 45 holds n j higham p linear polynomial pap b factorization computed diagonal pivoting method bound 410 analogous bound 33 holds gaussian elimination already seen assumption 45 theorem 41 holds partial pivoting strategy bunch kaufman provided linear systems solved gepp using explicit inverse easy show assumption also holds complete pivoting strategy bunch parlett conditions interestingly 2 theta 2 pivots e arise bunchparlett strategy gepp applied identical gaussian elimination complete pivoting 43 normwise analysis partial pivoting show diagonal pivoting method stable particular pivoting strategy need show matrix j b suitably bounded specialise partial pivoting partial pivoting b l arbitrarily large stability immediate consequence theorem 41 therefore need look closely elements matrix j b j simplicity bound matrix jljjdjjl j containing exact factors makes second order change overall bounds since initially examine contribution blocks l produced first stage factorization delicate part analysis take full account interchanges notation note jl first bound 1 theta 1 pivot f vector elements trivially bounded max consider 2 theta 2 pivot algorithm 1 dictates pi 11 swaps rows columns 2 r noted earlier 11 r1 r1 rr using a1 41a next need bound g jl 21 jjejjl first consider 1 theta 1 pivot cases 1 2 algorithm 1 ff case 1 oe ff case 2 case 3 ff 1 theta 1 pivot 2 theta 2 pivot case 4 algorithm 1 using a2 oe using 41b remaining blocks jljjdjjl j composed blocks l make factors schur complements every schur complement satisfies ae n growth factor hence applying bounds recursively 2 2 block 411 deduce pessimistic bound mention passing early drafts paper weaker version 45 jej bound replaced jej 2 still able obtain satisfactory bound k jljjdjjl indicating partial pivoting somewhat tolerant 2 theta 2 systems solved might thought analysis n j higham using bound 414 theorem 41 obtain following normwise backward stability result partial pivoting theorem 42 let 2 ir nthetan symmetric let b x computed solution linear system produced diagonal pivoting method partial pivoting strategy bunch kaufman linear systems involving 2 theta 2 pivots solved gepp use explicit inverse p quadratic theorem 42 form wilkinsons result gepp applied nonsymmetric system see eg 14 x92 though course numerical value ae n usually different two methods 5 discussion backward error matrix deltaa 49 necessarily symmetric 415 general however take deltaa 415 symmetric cost increasing bound factor n following result bunch demmel van loan 4 sorensen van loan 10 x532 modify bunchkaufman partial pivoting strategy redefining algorithm 1 small change pleasing effect ensuring positive definite matrix interchanges done bunchkaufman strategy 1 theta 1 pivots used case time leaves growth factor bound unchanged analysis remains valid variant sparse symmetric matrices duff reid coauthors compute block using pivoting strategy different bunch kaufman 11 12 13 describe strategy 13 applies first stage factorization 11 defined acceptable 1 theta 1 pivot point view numerical stability ja i1 j tolerance matrix 11 r1 r1 rr acceptable 2 theta 2 pivot among acceptable pivots one chosen best preserves sparsity according particular sparsity criterion conditions 51 52 ensure klk1 bounded multiple gamma1 implies bounds growth factor hence kdk1 stability pivoting strategy therefore immediate since 22 satisfied interesting contrast bunchkaufman strategy involves fixed amount searching pivot reasons stability subtle whereas duff et al strategy directly forces stability bounding multipliers gives fixed amount searching bunchkaufman strategy emphasize aim work obtain rigorous backward error bound diagonal pivoting method partial pivoting actual performance method affected size growth factor work needed investigate behaviour growth factor less known growth factor gaussian elimination partial pivoting although unboundedness klk1 preclude backward stability implications practical behaviour method see ashcraft grimes lewis 2 thorough study dense sparse matrices finally mention implementation diagonal pivoting method partial pivoting lapack 20 unstable klk1 large pointed explained 2 potential instability stems replacing symmetric rank2 update two rank1 updates via use eigendecomposition problem corrected future release lapack acknowledgements pleasure thank philip gill michael saunders valuable comments particularly early stages work also thank jim bunch des higham john lewis suggesting improvements draft manuscripts appendix appendix bound three matrix expressions involving 2 theta 2 pivot partial pivoting 11 r1 r1 rr first note using 41d hence using 41d next 14 n j higham finally r accurate symmetric indefinite linear equation solvers analysis diagonal pivoting method strong stability algorithms solving symmetric linear systems stable methods calculating inertia solving symmetric linear systems decomposition symmetric matrix direct methods solving symmetric indefinite systems linear equations stability block lu factorization society industrial applied mathematics solving linear systems vector shared memory computers factorization sparse symmetric indefinite matrices direct solution sets linear equations whose matrix sparse accuracy stability numerical algorithms compatibility approximate solution linear equations given error bounds coefficients righthand sides compatibility given solution data linear system tr