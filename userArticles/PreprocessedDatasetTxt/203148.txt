approximate analysis readerwriter queues analyze performance queues serve readers writers readers served concurrently writers require exclusive service approximately analyze firstcomefirstserve fcfs readerwriter queue derive simple formulae computing waiting times capacity assumption poisson arrivals exponential service extend analysis handle onewriter queue queue includes writeintention locks simple analyses present used rulesofthumb designing concurrent systems b introduction analyses database operating system concurrency control algorithms handle case exclusive access practice however many concurrency control algorithms use shared exclusive locks shared locks important increasing concurrency reducing serialization delays paper describes queues model reader writer access shared resource readers place r read locks writers place w write locks number r locks may held simultaneously one w lock may placed given time addition r w locks incompatible cannot held simultaneously queuing discipline manages lock access fair readers starve writers vice versa common fairness criterion fcfs lock ff arrives lock fi grant ff granting fi fcfs lock queuing mechanism obeys following protocol job service finishes first job queue reader grant access readers first writer first job writer grant lock writer addition queue empty readers service reader arrives grant lock reader see figure 1 call type lock queue fcfs readerwriter queue fcfs rw queue short also analyze variation fcfs rw queue variation call onewriter queue one writer queue time reader arrival rate much larger writer arrival rate onewriter queue many applications example analysis communications driver 15 use onewriter queue model queues writeintention locks ruw queues ruw queue incoming stream consists r u locks r locks compatible u locks u locks compatible u locks occasionally upgrade w locks exclusive ruw queue model writeintention locks often used concurrent data structures 3 multigranularity locking 4 model develop predicts expected waiting time r w u locks addition model predict probability w lock queue determine whether resource serve offered load several analyses read write access shared resource context database performance 23 17 6 example tay 23 handles readonly requests modifying formulae probability lock conflict assumes queuing shared data rare problem queuing shared data modeled context replicated databases assumed k copies file two different copies file may read simultaneously coffman et al 7 analyze saturated queue write request preempts current readers 8 coffman gelenbe plateau analyze queue except readers may begin reading copy file soon written baccelli coffman 2 analyze preemptive queue poisson arrivals nelson iyer 18 analyze nonpreemptive queue job arrivals poisson processed fcfs order read operations receive exponentially distributed service write operations receive phase distributed service exponential distribution example phase distribution nelson iyers analysis thought exact analysis approximate fcfs rw queue readers writers receive fcfs service k readers may served simultaneously analysis requires iteration step involves multiplication k k matrices courcoubetis et al 10 1 analyze queuing systems k queues ordinary customers require service one queue locking customers require service queues simultaneously thomasian nicola 24 26 25 use vacationing server model study optimal control readerwriter queue courcoubetis reiman 9 use system k queues ordinary locking customers study optimal control readerwriter queue reiman wright 20 19 provide exact analysis stability first queueing system described paper permit arbitrary reader writer service times permit writer arrival process arbitrary renewal process authors also provide lower upper bounds lock waiting times heavy traffic approximation paper two main contributions first contribution simple formulae predicting capacity waiting times fcfs rw queuing system formulae provide simple rules thumb designing concurrent systems 12 11 second contribution paper analysis onewriter queue ruw queue best knowledge queuing systems treated approximation fcfs rw queue difficulty analyzing readerwriter queue two different classes customers receive different types service writers tractable two classes receive exclusive fcfs service therefore approximate readerwriter queue fcfs queue aggregate customer writer together readers immediately ahead queue aggregate customer arrival rate w service time equal service time writer plus service time readers immediately ahead need calculate service time readers entered queue entering writer previous writer two cases either entering writer finds another writer queue writers queue another writer queue entering writer must wait readers entered writer arrivals otherwise writer must wait readers survived yet finished service writer entered use following symbols definitions analysis reader arrival rate reader service rate probability writer queue writer utilization expected time serve aggregate customer writer readers arrived previous writer current writer must wait expected time writer must wait readers arrived previous writer previous writer still queue upon arrival current writer expected time writer must wait readers arrived previous writer previous writer finished current writer arrived expected waiting time writer expected waiting time reader time serve n readers r number readers arrive seconds time writer finds another writer queue number surviving readers service time time customer spends receiving service service period total time customer spends queue service timewaiting time main result section theorem 1 probability writer queue ae w satisfies r r results need perform analysis time n concurrent readers served reader served concurrently rate r dt prs r n proof model situation puredeath process let state k condition k readers left let p k probability system state k time system state k time reader die rate k r model p 0 description system leads following system differential equations dpn dt gamman r pn dt dt initial conditions pn solution differential equations r 1p k1 xe krx dx solution recurrence last differential equations tells us dp0 dt corollary 1 1i 3 proof dt r r last step application combinatorial identity found 21 page 4 ffl tools calculate expected time needed serve readers front writer w another writer queue w enters need calculate number readers entered queue entering writer previous writer suppose time writer arrivals let random variable r number readers arrive seconds readers poisson arrival rate r distribution calculate distribution number readers arrive arrival two writers find unconditional distribution r need know distribution probability interarrival period lasts least seconds given arriving writer finds least one writer queue probability interarrival period lasts least seconds service period waiting time plus service time previous writer lasts least seconds let tw random variable represents interarrival time writers find queue utilized dt prtw dt printerarrival time delta prprevious writer still queue k normalizing constant suppose already know expected service time aggregate customer 1 probability writer queue ae model aggregate queue mm1 queue know service period distribution waiting time service time 13 probability previous writer served seconds dt using distribution tw get dt prt w tdt r 1r r r ra ra leads lemma 2 expected time serve readers front writer arriving queue already contains writer r proof randomize r using r calculate unconditional expectation r r ar order solve sum apply abels transformation 16 page 36 deltax k r let k n1 k k using wellknown expansion ln1 substitute value substitute w ae w multiply leading constants get r r r next must calculate expected waiting time serving readers case writer enters queue finds readers queue cannot use expected value already calculated readers may left queue writer enters queue calculation distribution number readers queue writer arrives intractable instead distribution calculate expected number readers still queue consider three points time respect particular writer w enters queue finds writers queue occasion point previous writer entered queue occasion b point previous writer left queue occasion c point w enters queue see figure 2 reader arrivals departures independent consider expected number surviving readers ab bc separately need know lengths intervals ab bc arrival distribution memoryless length bc exponential distribution parameter w find approximation distribution length ab way found approximation distribution tw probability ab lasts least seconds probability previous writers service period lasts least seconds writer interarrival time least seconds dt consider survivors bc first probability reader enters queue time reader entered queue seconds c survive probability therefore expected number surviving readers bc seconds long unconditional distribution n bc r becomes r 1r wr next consider survivors ab expected number survivors ab expected number readers arrived ab survived bc suppose probability surviving bc p k readers arrived ab expected number survivors n ab r k p equals kp remove dependence n ab r k p k need know distribution number arrivals ab since distribution ja bj distribution u w number readers arrive ab distribution r k0 kp ra ra interval bc seconds long probability surviving using get unconditional distribution n ab r get r 1r expected number survivors w arrives order calculate expected waiting time assume number surviving readers geometric distribution mean 1 r number surviving readers calculate mean manner lemma 2 get lemma 3 expected time serve readers front writer finds writers queue arrives r know expected service time aggregate customer use fact ae values r e r u get r r proving theorem 1ffl find ae w find root ae w equation done iteratively nonlinear equation solving package queue stable ae w 1 correct ae w found try solving queue mm1 queue arrival rate w service rate 1aw system expected waiting time ae waw waiting time aggregate customer waiting time reader writer must also wait readers ahead finish corollary 2 aggregate queue modeled mm1 queue expected waiting times reader writer customers 201 mg1 model also consider server network exponential stages probability ae w service expected 1w seconds expected r u seconds probability service expected 1w seconds expected r e seconds laplace transform service time server given ae w r expected waiting time mg1 queue given 13 pg190 x service time server value x 2 found differentiating laplace transform twice evaluating zero gives corollary 3 aggregate queue modeled mg1 queue expected waiting times reader writer customers e 21 maximum throughput theorem 1 used predict maximum throughput corollary 4 maximum throughput w r w r satisfy e r 1w gamma1 w proof theorem 1 solve r ffl note stability condition derived 20 19 application find maximum throughput queue proportion readers writers constant corollary 5 r maximum writer arrival rate corollary 5 implies increasing reader service rate better increasing writer service rate opposite true theorem 1 also used find arrival rates ae 22 comparison experiments rw queue simulator built experiments run six hundred thousand samples taken results simulator compared analytical results table 1 shows comparison mm1 model simulation analytical calculation ae w therefore r u r e usually close results simulator match best r w becomes worse r much larger w seen figure 4 mm1 model gives good predictions expected lock waiting times r w r increases waiting times predicted mm1 model tend become pessimistic seen figure 3 table 2 shows comparison mg1 model simulation r ae w mg1 model better approximation mm1 model rate reader arrivals close rate writer arrivals aggregate customer service distribution approximated well exponential distribution rate reader arrivals becomes large contribution readers service time becomes greater service time distribution better approximated hyperexponential distribution rule thumb choosing best model use following rule thumb r w 5 use mg1 model otherwise use mm1 model figures 5 6 show maximum writer reader arrival rate decreases increasing reader writer arrival rate respectively graphs show cutoff point writer arrival rate reader arrival rate may increased almost arbitrarily writer arrival rate decreases largely due fact r e r u depend logarithmically r increases aggregate customers service time require exponential increases reader arrival rate 3 onewriter queue section analyze readerwriter queue one writer ever queue protocol onewriter queue fcfs rw queue fcfs readers served concurrently assume writers arrive rarely compared readers let us calculate eww expected waiting time w lock need know distribution number r locks front w lock w lock enters queue w locks arrive rarely distribution number r locks queue approach steadystate mm1 distribution n r number r locks queue w lock arrives 13 let ww n waiting time w lock n r locks queue w lock enters corollary 1 r combining 17 corollary 1 unconditional distribution ww r 5 find formulax exponential integral algebraically obtained g 1 x cant expect simplify closed form combining 18 19 get theorem 2 expected waiting time w lock onewriter queue let us next calculate expected waiting time r lock r lock waits w lock queue ahead r lock arrives w lock service r lock wait renewal time w lock service since assuming exponentially distributed service times expected renewal time 1w probability r lock arrive w lock service w w r lock arrive w lock waiting probability eww one w lock queue time r lock wait service time w lock 1w plus remaining time serve readers ahead w lock renewal time w waiting time distribution 13 given first moment waiting time distribution 2 second moment already calculated first moment eww need calculate second moment lemma 1 distribution time n readers finish service dt prs r n using distribution number readers 17 distribution ww dt next find second moment ijo dt io ir io order simplify sum let us express recursive relation since first sum simply g ngamma1 21 second sum therefore problem reduces finding simpler form gn function simple difference suggests consider v x exponential generating function gn try find relationship leads solution derivative operator let us calculate difference exponential generating function assuming dv dx x linear differential equation apply formula solution first order linear differential equations 22 dv dx r p dx z qe r p gammar e x x order find value constant c evaluate v 0 find function g 2 x also transcendental function cannot hope simplify v x using formula v x 24 formula renewal time 21 get lemma 4 expected residual time ww calculated r 1 ww calculate ew r gives theorem 3 expected wait reader onewriter queue throughput onewriter queue limited arrival rate always writer queue expected length time w lock queue 1w eww using theorem 2 get corollary 6 throughput onewriter queue limited proof arrival rate service rate equals one always w lock queue therefore arrival rate must less equal service rate ffl 31 asymptotics functions g 1 x g 2 x transcendental functions cannot simplified familiar functions power series forms arent completely satisfactory calculations either g 1 g 2 grow slowly maximum terms power series grow rapidly even relatively small values x 35 limited precision algorithms cannot calculate functions fortunately g 1 g 2 simple asymptotic representations function g 1 x related exponential integral exponential integral 14 x e gammat dt following asymptotic expansion 14 x use first asymptotic expansion use r 0 x bound e 1 x therefore approximate g 1 x error less e gammax x use asymptotic form g 1 x get asymptotic formula g 2 x integrating zero removable singularity therefore break interval integration 0 x two parts 0 x first interval integrate power series representation g 1 x get value g 2 second interval integrate asymptotic form r x constant c 2 9891 evaluated using power series g 2 evaluate g 2 error bounded x dx e gammax x 2 dx 4 readerwriteupgradewriter queue section use results section 3 analyze readerwriteupgradewriter queue ruw queue uses three types locks read writeupgrade write locks abbreviate sa r u w locks respectively w denote arrival rates r u locks r u respectively assume proportion u locks upgrade w locks denote service rates r w locks r w respectively service time u lock depends waiting time w lock assume r ae u u locks rarely upgraded w locks result r ae w writer arrivals rare assumptions results previous section apply assumptions safe queue applied concurrent btree algorithms example 3 11 r locks blocked w lock u lock may blocked w lock another u lock w lock comes conversion request current u lock blocked r locks currently service thus r locks block u locks blocking w lock conversion leads us consider strategy modeling ruw queue two queues one r w locks one u locks rw queue r locks served simultaneously w lock enters queue w lock must wait preceding r locks finish service obtaining control queue r locks enter queue w lock must wait w lock finishes service u queue u locks receive fcfs service u lock service might upgraded w lock w lock blocks u locks therefore rw queue u queue coupled increasing service time u lock expected service period waiting time service time w lock list waiting times three types locks w waiting time w lock time preceding r locks finish r waiting time r lock prw lock waitingw servicetime surviving rs finish prw lock servicetime w finish service u waiting time u lock waiting time customer fcfs queue arrival rate u service time service period c probability u lock converts w lock u expected time service u lock lock upgrade w lock u expected time service u lock upgrades w lock therefore input parameters queue r u r u u u theorem 2 gives expected wait w lock theorem 3 gives expected wait r lock needs done calculate expected wait u lock expected service time single u lock therefore utilization u lock queue ae model u lock queue mm1 queue 13 theorem 4 expected waiting time u lock ruw queue since w locks generated u locks throughput ruw queue limited service u locks corollary 7 throughput ruw queue limited u g1 rr r 41 comparison experiments ruw queue built experiments run six hundred thousand samples taken table 3 shows comparison analytical simulator results since onewriter queue ruw queue similar comparison applies onewriter queue also comparison shows analytical model predicts waiting times well accuracy analytical model improves reader arrival rate increases conclusions developed simple yet accurate model fcfs readerwriter queue performance present formulae predict shared resource capacity waiting times read write locks arrival rates produce desired system loading formulae simple enough used rule thumb system designer extend analyses handle onewriter queues writeupgrade locks present formulae predict lock waiting times estimate capacity shared resource locking queues analyzed paper used many areas concurrent data structures 11 communications channels 15 r construction stationary regime queues locking concurrency operations btrees concurrency control recovery database systems introduction theory infinite series modeling parallel access shared data optimization number copies distributed database optimal control queuing system simultaneous service requirements stability queuing system concurrent service locking performance concurrent data structure algorithms framework performance analysis concurrent btree algo rithms queueing systems calculation special functions gamma function spider systems ltd difference equations probabilistic models database locking solutions analysis replicated database stability latency concurrentx exclusivey performance analysis concurrentread exclusivewrite combinatorial identities differential equations applications historical notes locking performance centralized databases analysis threshold policy scheduling readers writers analysis threshold policy scheduling readers writers performance evaluation threshold policy scheduling readers writers tr