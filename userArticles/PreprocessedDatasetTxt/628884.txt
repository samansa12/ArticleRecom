lambertian reflectance linear subspaces abstractwe prove set lambertian reflectance functions mapping surface normals intensities obtained arbitrary distant light sources lies close 9d linear subspace implies general set images convex lambertian object obtained wide variety lighting conditions approximated accurately lowdimensional linear subspace explaining prior empirical results also provide simple analytic characterization linear space obtain results representing lighting using spherical harmonics describing effects lambertian materials analog convolution results allow us construct algorithms object recognition based linear methods well algorithms use convex optimization enforce nonnegative lighting functions also show simple way enforce nonnegative lighting images object lie near 4d linear space apply algorithms perform face recognition finding 3d model best matches 2d query image b introduction one basic problems vision understand variability lighting affects images object produce even lights isotropic distant smooth lambertian objects produce infinitedimensional sets images belhumeur kriegman 1 recent experimental work 7 12 30 indicated set images produced object wide range lighting conditions lies near low dimensional linear subspace space possible images used construct efficient recognition algorithms handle lighting variations paper explain empirical results analytically use understanding produce new recognition algorithms light isotropic distant object describe intensity function direction light nonnegative function surface sphere approach begins representing functions using spherical harmonics analogous fourier analysis surface sphere model way surfaces turn light image look reflectance function surface normal assuming unit albedo show reflectance functions produced analog convolution lighting function using kernel represents lamberts reflection kernel acts lowpass filter 992 energy first nine components use nonnegativity light prove lighting conditions ninedimensional linear subspace example accounts 98 variability reflectance function suggests general set images convex lambertian object approximated accurately low dimensional linear space show analytically derive subspace object model allows us better understand several existing methods example show linear subspace methods shashua 25 moses 20 use linear space spanned three first order harmonics omit significant dc component also leads us new methods recognizing objects unknown pose lighting conditions particular discuss harmonic basis used linearbased object recognition algorithm replacing bases derived performing svd large collections rendered images furthermore show enforce nonnegative light projecting constraint space spanned harmonic basis constraint recognition expressed nonnegative leastsquares problem solved using convex optimization leads algorithm recognizing objects varying pose illumination resembles georghides et al 9 works analytically derived lowdimensional space use harmonic basis case allows us rapidly produce representation images object poses determined runtime finally discuss case first order approximation provides adequate approximation images object set images lies near 4d linear subspace case express nonnegative lighting constraint analytically use expression perform recognition particularly efficient way without iterative optimization techniques popular object recognition represent set images object produce using low dimensional linear subspaces space images ullman basri 28 analytically derive representation sets 3d points undergoing scaled orthographic projection shashua 25 moses 20 later also 22 31 derive 3d linear representation set images produced lambertian object lighting changes ignoring attached shadows hayakawa 13 uses factorization build 3d models using linear representation koenderink van doorn 18 extend 4d space allowing light include diffuse component researchers collected large sets images performed pca build representations capture within class variations 16 27 4 variations due pose lighting 21 12 30 hallinan 12 epstein et al 7 yuille et al 30 perform experiments show large numbers images lambertian objects taken varied lighting conditions lie near lowdimensional linear space justifying representation recently analytically derived convex representations used belhumeur kriegman 1 model attached shadows georghides et al 8 9 use representation object recognition spherical harmonics used graphics efficiently represent bidirectional reflection distribution function brdf different materials eg cabral 3 westin et al 29 koenderink van doorn 17 proposed replacing spherical harmonics basis zernike polynomials since brdfs defined half sphere nimeroff et al 23 dobashi et al 5 teo et al 26 explore specific lighting configurations represented efficiently linear combination basis lightings eg daylight dobashi et al 5 particular use spherical harmonics form basis dzmura 6 first point process turning incoming light reflection described terms spherical harmonics representation truncating high order components reflection process written linear transformation low order components lighting recovered inverting transformation used analysis explore ambiguities lighting extend work deriving subspace results reflectance function providing analytic descriptions basis images constructing new recognition algorithms use analysis enforcing nonnegative lighting independent contemporaneous work ramamoorthi hanrahan 24 described effect lambertian reflectance convolution like dzmura use analysis explore problem recovering lighting reflectances also preliminary comments topic found jacobs belhumeur basri15 summary main contribution paper show analytically find low dimensional linear subspaces accurately approximate set images object produce carve portions subspaces corresponding nonnegative lighting conditions use descriptions recognition modeling image formation consider convex object illuminated distant isotropic light sources assume surface object reflects light according lamberts law 19 relatively simple model analyzed used effectively number vision applications set images lambertian object obtained arbitrary light termed illumination cone belhumeur kriegman 1 objective analyze properties illumination cone analysis useful consider set reflectance functions obtained different illumination conditions reflectance function also called reflectance map see horn 14 chapters 1011 associated specific lighting configuration defined light reflected sphere unit albedo function surface normal reflectance function related image convex object illuminated lighting configuration following mapping every visible point objects surface inherits intensity point sphere normal intensity scaled albedo point discuss effect mapping later section 21 image formation analog convolution let denote unit sphere centered origin let point surface let n denote surface normal p p also expressed unit vector using following notation sin oe sin sin oe cos oe 1 coordinate frame poles set 0 0 sigma1 denotes solid angle p 0 0 1 varies latitude oe varies longitude since assume sphere illuminated distant isotropic set lights points sphere see lights coming directions illuminated identical lighting conditions consequently configuration lights illuminate sphere expressed nonnegative function oe expressing intensity light reaching sphere direction oe furthermore according lamberts law difference light reflected points entirely due difference surface normals thus express light reflected sphere function r oe whose domain set surface normals sphere according lamberts law light ray intensity l reaches surface point albedo forming angle surface normal point intensity reflected point due light given l maxcos 0 2 reflectance function use light reaches point multitude directions light reflected point would sum continuous case integral contribution direction denote example intensity point 0 0 1 given z 2z k oe sin ddoe 3 similarly intensity r oe reflected point obtained centering k p integrating inner product sphere thus operation produces r oe analog convolution sphere refer convolution write kernel convolution k circularly symmetric halfcosine function convolution obtained rotating k center aligned surface normal p still leaves one degree freedom rotation kernel undefined since k rotationally symmetric ambiguity disappears 22 properties convolution kernel fourier basis convenient examining results convolutions plane similar tools exist understanding results analog convolutions sphere surface spherical harmonics set functions form orthonormal basis set functions surface sphere denote functions hnm n pnm cos e imoe 5 pnm associated legendre functions defined nm dz nm z course paper sometimes convenient parameterize hnm function space coordinates x rather angles spherical harmonics written hnm x polynomials degree n x may express kernel k lighting function harmonic series linear combinations surface harmonics primarily take advantage analog convolution theorem surface harmonics immediate consequence funkhecke theorem see eg 10 theorem 341 page 98 convolution function domain equivalent multiplication harmonic domain rest section derive representation k harmonic series use derivation show k nearly lowpass filter specifically almost energy k resides first harmonics allow us show possible reflectances sphere lie near low dimensional linear subspace space functions defined sphere appendix derive representation k harmonic series short since k rotationally symmetric pole appropriate choice coordinate frame energy concentrates exclusively zonal harmonics harmonics coefficients harmonics thus express k z 2z kh n0 oe sin ddoe 8 tedious manipulation detailed appendix obtain energy 375 50 1172 059 012 004 cumulative energy 375 875 9922 9981 9993 9997 lower bound 375 75 9796 9948 9980 9990 table 1 top row shows energy captured nth zonal harmonic lambertian kernel 0 n 8 middle row shows energy accumulated order n energy represents quality nth order approximation r oe measured relative squared error bottom row shows lower bound quality approximation due nonnegativity light omitted contribute energy relative energies given percents first coefficients example 5 13 graph representation coefficients shown figure 1 energy captured every harmonic term measured commonly square respective coefficient divided total squared energy transformed function total squared energy half cosine function given z 0 table 1 shows relative energy captured first several coefficients seen kernel dominated first three coefficients thus second order approximation already accounts 9922 energy approximation half cosine function written quality approximation improves somewhat addition fourth order term deteriorates 875 first order approximation used figure 2 shows 1d slice lambertian kernel various approximations 23 approximating reflectance function fact lambertian kernel energy concentrated low order terms implies set lambertian reflectance functions well approximated low dimensional linear space space spanned small set call harmonic reflectances harmonic reflectance r nm oe denotes reflectance sphere illuminated harmonic light hnm note harmonic lights generally positive everywhere correspond real physical lighting conditions abstractions explained every reflectance function 0040812 figure 1 left right graph representation first 11 coefficients lambertian kernel relative energy captured coefficients accumulated energy 04 04 04 figure 2 slice lambertian kernel solid approximations first left dotted second middle fourth right order r oe approximated excellent accuracy linear combination small number harmonic reflectances evaluate quality approximation consider first example lighting generated point source z direction point source delta function reflectance sphere illuminated point source obtained convolution delta function results kernel due linearity convolution approximate reflectance due point source linear combination first three zonal harmonics r 00 r 20 account 9922 energy words min k lambertian kernel also reflectance sphere illuminated point source z direction similarly first fourth order approximations yield respectively 875 9981 accuracy sphere illuminated single point source direction z direction reflectance obtained would identical kernel shifted phase shifting phase function distributes energy harmonics order n varying overall energy n maintained quality approximation therefore remains nth order approximation need use harmonics n n recall 2n every order n consequently first order approximation requires four harmonics second order approximation adds five harmonics yielding 9d space third order harmonics eliminated kernel need included finally fourth order approximation adds nine harmonics yielding 18d space seen energy captured first coefficients k 1 n directly indicates accuracy approximation reflectance function light includes single point source light configurations may lead different accuracy better approximations obtained light includes enhanced diffuse components lowfrequency worse approximations anticipated light includes mainly high frequency patterns however even light includes mostly high frequency patterns accuracy approximation still high consequence nonnegativity light lower bound accuracy approximation light function derived follows simple show nonnegative function amplitude dc component must least high amplitude components 1 one way see representing function nonnegative sum delta functions sum amplitude dc component weighted sum amplitudes dc components different delta functions amplitude frequency may reach level often lower due interference consequently nth order approximation worst scenario obtained amplitudes frequencies 1 note obtain amplitude nth component must normalize coefficient multiplying 2n1 consequently coefficient dc component may smaller components amplitude may funkhecke theorem applies amplitudes higher n saturate amplitude dc component amplitude orders set zero case relative squared energy becomes table 1 shows bound obtained several different approximations seen using second order approximation involving nine harmonics accuracy approximation light function exceeds 9796 fourth order approximation involving accuracy exceeds 9948 note bound computed 14 tight since case higher order terms saturated yields function negative values consequently worst case accuracy may even higher bound 24 generating harmonic reflectances constructing basis space approximates reflectance functions straightforward done analytically construct basis simply invoke funkhecke theorem recall space spanned harmonic reflectances ie reflectances obtained unit albedo sphere illuminated harmonic lights reflectances result convolving half cosine kernel single harmonics due orthonormality spherical harmonics convolution cannot produce energy harmonics consequently denote harmonic light hnm reflectance due harmonic harmonic scaled formally readily verified harmonics order n different phase share scale factor c n therefore left determine c n determine c n important enforce nonnegative lighting sections 32 33 use fact halfcosine kernel k image obtained light delta function centered z direction transform delta function given image produces coefficients k n given 9 c n determines much harmonic scaled following convolution therefore ratio k n respective coefficient delta function first harmonic reflectances given gamman n r construction harmonic reflectances useful express harmonics using space coordinates x rather angles oe done substituting following equations angles first nine harmonics become superscripts e denote even odd components harmonics respectively njmj according sign fact even odd versions harmonics convenient use practice since reflectance function real notice harmonics simply polynomials space coordinates invariably use hnm oe hnm x denote harmonics expressed angular space coordinates respectively 25 reflectances images point analyzed reflectance functions obtained illuminating unit albedo sphere arbitrary light objective use analysis efficiently represent set images objects seen varying illumination image object certain illumination conditions constructed respective reflectance function simple way point object inherits intensity point sphere whose normal intensity scaled albedo words given reflectance function rx z image point p surface normal wish discuss accuracy low dimensional linear approximation models images affected mapping reflectance function images make two points first worst case make approximation arbitrarily bad second typical cases make approximation less accurate two components turning reflectance function image one rearrangement x position points particular surface normal appears one location unit sphere may appear completely different location image rearrangement effect approximation represent images linear subspace coordinate represents intensity pixel decision pixel represent coordinate arbitrary changing decision rearranging mapping x surface normal merely reorders coordinates space second significant difference images reflectance functions occlu sion shape variation albedo variations affect extent surface normal sphere helps determine image example occlusion ensures half surface normals sphere facing away camera produce visible intensities discontinuous surface may contain surface normals surface planar patches contain single normal extended region extremes curvature point determine extent surface normal contributes image albedo similar effect point black zero albedo surface normal effect image terms energy darker pixels contribute less image brighter pixels overall effects captured noticing extent reflectance point unit sphere influences image range zero entire image give example show worst case make approximation arbitrarily bad first one notice single point loworder harmonic approximation function arbitrarily bad related gibbs phenomenon fourier domain consider case object sphere constant albedo example adapted belhumeur kriegman 1 light coming direction opposite viewing direction illuminate visible pixels shift light slightly illuminates one pixel boundary object varying intensity light give pixel desired intensity series lights every pixel rim sphere n pixels set images get fully occupies positive orthant ndimensional space obviously points space arbitrarily far 9d space happening energy image concentrated surface normals approximation happens poor however generally things bad general occlusion render arbitrary half normals unit sphere invisible albedo variations curvature emphasize normals deemphasize others general normals whose reflectances poorly approximated emphasized reflectances expect approximation reflectances entire unit sphere good pixels produce intensities visible image therefore assume subspace results reflectance functions carry images objects thus approximate set images object linear space spanned call harmonic images denoted b nm images object seen harmonic light images constructed 22 follows note b 00 image obtained constant ambient light contains every point simply surface albedo point scaled constant factor first order harmonic images figure 3 show first nine harmonic images model face top row contains zeroth harmonic left three first order harmonic images right second row shows images derived second harmonics negative values shown black positive values white b 1m images obtained cosine lighting centered three main axes images every point three components surface normals scaled albedos additional constant see discussion past use images section 3 higher order harmonic images contain polynomials surface normals scaled albedo figure 3 shows first nine harmonic images derived 3d model face write explicitly combining equations 21 23 let p denote ith object point let denote vector objects albedos albedo p similarly let three vectors length contain x z components surface normal example n xi ith component n x x component surface normal p let n x 2 denote vector n x 2 similarly example finally write v denote componentwise product vector v matlabs notation product scales components vector albedo associated point produced component n x x components surface normals scaled albedos using notation first nine harmonic images become q12 n yz q4 n x b e recognition developed analytic description linear subspace lies near set images object produce show use description recognize objects although method suitable general objects give examples related problem face recognition assume image must compared data base models 3d objects assume pose object already known identity lighting conditions example may wish identify face known facing camera may assume either human automatic system identified features eyes tip nose allow us determine pose face data base data base big allow human select best match recognition proceeds comparing new image model turn compare model compute distance image nearest image model produce present two classes algorithms vary representation models images linear subspace used directly recognition restrict subset linear subspace corresponds physically realizable lighting conditions stress advantages gain analytic description subspace available contrast previous methods pca could used derive subspace sample objects images one advantage analytic description know provides accurate representation objects images subject vagaries particular sample images second advantage efficiency produce description subspace much rapidly pca would allow importance advantage depend type recognition problem tackle particular interested recognition problems position object known advance computed runtime using feature correspondences case linear subspace must also computed runtime cost important finally show use 4d linear subspace analytic description subspace allows us incorporate constraint lighting physically realizable especially simple efficient way 31 linear methods straightforward way use prior results recognition compare novel image linear subspace images correspond model dzmura 6 also makes suggestion produce harmonic basis images model described section 25 given image seek vector minimizes kba gamma ik b denotes basis images b p theta r p number points image r number basis images used discussed nine natural value use r r 4 provides greater efficiency offers even better potential accuracy every column b contains one harmonic image b nm images form basis linear subspace though orthonormal one apply qr decomposition b obtain basis compute q p theta r matrix orthonormal columns r r theta r matrix r theta r identity matrix compute distance image space spanned b kqq gamma ik cost qr decomposition opr 2 assuming p r contrast prior methods sometimes performed pca sample images find linear subspace representing object hallinan 12 performed experiments indicating pca produce five six dimensional subspace accurately models face epstein et al 7 yuille et al 30 describe experiments wider range objects indicate images lambertian objects approximated linear subspace three seven dimensions specifically set images basketball approximated 944 3d space 991 7d space images face approximated 902 3d space 953 7d space georghides et al 9 render images object find 11d subspace approximates images numbers roughly comparable 9d space according analysis approximates images lambertian object additionally note basis images object generally orthogonal cases quite similar example z components surface normals object vary much harmonic images quite similar vs z may cause components less significant lowerdimensional approximation fairly accurate sampled images used typically r p pca requires ops 2 also matlab pca thin rectangular matrix seems take exactly twice long qr decomposi tion therefore practice pca matrix constructed georghides et al would take 150 times long using method build 9d linear approximation models images 9 one might expect p 10000 effect relative costs methods may significant pose known ahead time computation takes place line pose computed run time advantages method become great also interesting compare method another linear method due shashua 25 moses 20 shashua points absence attached shadows every possible image object linear combination x z components surface normals scaled albedo therefore proposes using three components produce 3d linear subspace represent models images notice three vectors identical scale factor basis images produced first order harmonics method equivalence clear algebraicly also explain follows first order harmonic images images object subjected lighting condition described single harmonic funkhecke theorem ensures components kernel describing reflectance function irrelevant image except first order components shashuas work basis images generated using point source lighting function contains harmonics kernel used full cosine function angle light surface normal kernel components first harmonic components lighting irrelevant image either case basis images due first set harmonics therefore interpret shashuas method also making analytic approximation models images using low order harmonics however previous analysis tells us images first harmonic account 50 percent energy passed halfcosine kernel furthermore worst case possible lighting contain component first harmonic notably shashuas method make use dc component images ie zeroth harmonic images produced perfectly diffuse light source nonnegative lighting must always significant dc component koenderink van doorn 18 suggested augmenting shashuas method diffuse component results linear method uses four significant harmonic basis images although koenderink van doorn propose apparently heuristic suggestion without analysis reference harmonic representation lighting 32 enforcing positive light take arbitrary linear combinations harmonic basis images may obtain images physically realizable corresponding linear combination harmonics representing lighting may contain negative values rendering images may require negative light course physically impossible section show use basis images enforcing constraint nonnegative light belhumeur kriegman 1 shown set images object produced nonnegative lighting convex cone space possible images call illumination cone show compute approximations cone space spanned harmonic basis images specifically given image attempt minimize kba gamma ik subject constraint light nonnegative everywhere along sphere straightforward method enforce positive light infer light images inverting convolution would yield linear constraints components ha 0 columns h contain spherical harmonics hnm unfortunately naive method problematic since light may contain higher order terms cannot recovered low order approximation images object addition harmonic approximation nonnegative light may times include negative values forcing values nonnegative lead incorrect recovery light describe different method project illumination cone 1 onto low dimensional space use projection enforce nonnegative lighting first present method use number harmonic basis images nonnegative lighting function written nonnegative combination delta functions representing point source denote ffi 0 oe 0 function returning nonzero value integrating 1 lighting function represents point source direction project function onto first harmonics need look harmonic transform delta function since inner product ffi 0 oe 0 function f returns simply f harmonic transform delta function given mgamman projection delta function onto first harmonics therefore obtained taking sum first terms suppose nonnegative lighting function oe expressed nonnegative combination delta functions j obviously due linearity harmonic transform transform nonnegative combination transforms delta functions coefficients jx mgamman likewise image object illuminated expressed nonnegative combination jx mgamman b nm harmonic images defined previous section given image objective recover nonnegative coefficients j assume consider approximation order n denote number harmonics required spanning space matrix notation denote harmonic functions h h theta r number sample points sphere columns h contain sampling harmonic functions rows contain transform delta functions denote b basis images b p theta r p number points image every column b contains one harmonic image b nm finally denote objective solve nonnegative least squares problem min kbh gamma ik st 0 29 project image rdimensional space spanned harmonic images solve optimization problem smaller space apply qr decomposition b described previously obtain min r r theta r q rvector note method similar presented georghides et al 8 primary difference work low dimensional space constructed model using harmonic basis images georghides et al perform similar computation projecting images 100dimensional space constructed using pca images rendered models tenmodel data base also need explicitly render images using point source project lowdimensional space representation projection images simply h 33 recognition four harmonics simplification obtained set images object approximated first order four harmonics required case one dc component representing appearance object uniform ambient light three basis images also used shashua attempt minimize kba gamma ik b p theta 4 subject constraint light nonnegative everywhere along sphere determine constraints projecting delta functions onto space spanned first four harmonics however projection takes particularly simple form consider first order approximation given mgamman using space coordinates approximation becomes let first order approximation nonnegative lighting function nonnegative combination delta functions readily verified combination cannot decrease zero order coefficient relative first order ones consequently nonnegative combination delta functions must satisfy equality obtained light delta function see 32 therefore express problem recognizing object 4d harmonic space minimizing kba gamma ik subject 34 four harmonic case harmonic images albedos components surface normals scaled albedos scaled factor therefore natural use directly hide scaling coefficients within constraints let image object illuminated using 19 23 n x respectively albedo surface normal object point using unscaled basis images n x n n z equation written substituting obtain b 2 simplifies figure 4 test images used experiments consequently find nearest image space spanned first four harmonic images nonnegative light may minimize difference two sides 36 subject 38 problem general form show appendix b diagonalizing b simultaneously introducing lagrange multiplier problem solved finding roots six degree polynomial single variable lagrange multiplier manipulation solving minimization problem straightforward 34 experiments experimented recognition methods using database faces collected nec japan database contains 3d models 42 faces including models albedos red green blue color channels query images use 42 images ten individuals taken across seven different poses six different lighting conditions shown figure 4 experiment query images compared model methods first obtain 3d alignment model image using algorithm 9d nonnegative lighting 4d nonnegative lighting figure 5 roc curves recognition methods blicher roy 2 brief features faces identified hand 3d rigid transformation found align 3d features corresponding 2d image features methods pay attention image pixels matched point 3d model face also ignore image pixels maximum intensity since may saturated provide misleading values finally subsample model image replacing theta square average values preliminary experiments indicate subsample quite bit without significantly reducing accuracy experiments ran algorithms subsampling 16theta16 squares original images 640 theta 480 methods produce coefficients tell us linearly combine harmonic images produce rendered image coefficients computed sampled image applied harmonic images full unsampled image process repeated separately color channel model compared image taking root mean squared error derived distance rendered face model corresponding pixels image figure 5 shows roc curves three recognition methods 9d linear method methods enforce positive lighting 9d 4d curves show percentage query images correct model classified among top k k varies 1 40 4d positive lighting method performs significantly less well others getting correct answer 60 time however much faster seems quite effective simpler pose lighting conditions 9d linear method 9d positive lighting method pick correct model first 86 time data set difference two algorithms quite small compared sources error may include limitations model handling cast shadows specularities also includes errors model building pose determination processes fact examining results found one pose one person grossly wrong human operator selected feature points wrong order eliminated six images six lighting conditions used pose results general subject future work consider sort analysis may applied complex imaging situations include specularities cast shadows however section make one basic remark situations note lowdimensional set images also result lighting low dimensional occur lights diffuse sun behind clouds lighting due interreflections case lighting may well approximated low order harmonics lighting linear combination small number harmonics images linear combination produced scene rendered separately harmonics lowdimensionality due simply linearity lighting fact sum two images produced two lighting conditions image produced sum lighting conditions therefore true general imaging assumptions including cast shadows specularities also note specular objects bidirectional reflection distribution function brdf generally much sharply peaked cosine function provides intuition specular objects affected highorder harmonic components lighting extreme case mirror entire lighting function passes reflectance function preserving components lighting therefore expect specular objects low order approximation image set less accurate representation terms harmonic images may still provide useful approximation however consistent experiments epstein et al 7 conclusions lighting arbitrarily complex many cases effect objects lambertian show simple ninedimensional linear subspace capture set images produce explains prior empirical results also gives us new effective way understanding effects lambertian reflectance lowpass filter lighting moreover show 9d space directly computed model lowdegree polynomial functions scaled surface normals description allows us produce efficient recognition algorithms know using accurate approximation models images compare models images 9d space captures least 98 energy models images enforce constraint lighting positive performing nonnegative least squares optimization 9d space willing settle less accurate approximation compute positive lighting best matches model image solving sixdegree polynomial one variable evaluate effectiveness algorithms using data base models images real faces appendix harmonic transform lambertian kernel lambertian kernel given denotes solid angle light direction surface normal harmonic transform k defined mgamman coefficients knm given z 2z kh nm oe sin ddoe without loss generality set coordinate system sphere follows position one poles center k represents angle along longitude varies 0 oe represents angle along latitude varies 0 2 coordinate system k independent oe rotationally symmetric pole consequently energy split zonal harmonics harmonics coefficients every 6 0 vanish next determine explicit form coefficients k n first limit integration positive portion cosine function integrating 2 z 2z 0 cos h n0 sin z 0 cos h n0 sin p n z associated legendre function order n defined substituting z 1zp n zdz turn computing integral z 1zp n zdz integral equal z 1z integrating parts yields2 n n z dz z 1d dz first term vanishes left z 1d dz ngamma2 dz ngamma2 formula vanishes obtain2 n n ngamma2 dz ngamma2 take derivative terms whose exponent less since evaluating derivative terms whose exponent larger thus term whose exponent survives denote coefficient b ngamma2 n odd b n even case ngamma2 dz ngamma2 z obtain z 1zp n derivation holds n 2 special cases handled separately first case p 0 second case p 1 integral becomes consequently recognition four harmonics finding nearest image 4d harmonic space subject constraint light nonnegative general form n theta 4 b n theta 1 b 4 theta 4 representation columns contain unscaled images b image recognized method present however used arbitrary nonsingular matrix b first solve linear system check solution satisfies constraint done must seek minimum occurs constraint satisfied equality divide solution two parts first part convert problem form min z ck st z dz 0 later show turn new problem sixth degree polynomial first assume wlog b resides column space since component b orthogonal space affect solution problem furthermore since b lies column space assume 4 theta 4 full rank b 4 theta 1 achieved example using qr decomposition define b 0 ab possible full rank implying problem equivalent using method presented golub van loan 11 see second edition pages 466471 especially algorithm 871 simultaneously diagonalize b produce nonsingular matrix x x denotes identity matrix 4 theta 4 diagonal matrix thus obtain denotes inverse x x gammat denotes transpose denote obtain min z ck st z desired form step 2 point attempt solve problem form min z ck st z solve minimization problem using lagrange multipliers min z ck taking derivatives respect x get z first equation get since diagonal components z given multiplying denominator becomes sixth degree polynomial polynomial efficiently accurately solved using standard techniques use matlab function roots plug solutions determine x indicated choose real solution minimizes optimization criteria acknowledgements grateful bill bialek peter blicher mike langer warren smith insightful comments suggestions great assistance us also grateful rui ishiyama shizuo sakamoto johji tajima helpful comments providing us data experiments r set images object possible lighting conditions fast lightingrendering solution matching 2d image database 3d models bidirectional reflection functions surface bump maps training models shape sets examples quick rendering method using basis functions interactive lighting design 5 sigma 2 eigenimages suffice empirical investigation lowdimensional lighting models illumination cones recognition variable lighting faces many generative models recognition variable pose illumination geometric applications fourier series spherical harmonics matrix computations lowdimensional representation human faces arbitrary lighting condi tions photometric stereo light source arbitrary motion comparing images variable illumination application karhunenloeve procedure characterization human faces bidirectional reflection distribution function expressed terms surface scattering modes generic bilinear calibrationestimation problem photometria sive de mensura et gradibus luminus colorum et umbrae face recognition generalization novel images visual learning recognition 3d objects appearance dimensionality illumination manifolds appearance matching efficient rerendering naturally illuminated environ ments personnal communication photometric issues 3d visual recognition single 2d image efficient linear rerendering interactive lighting de sign eigenfaces recognition recognition linear combinations models predicting reflectance functions complex surfaces determining generative models objects varying illumination shape albedo multiple images using svd integrability heoretical analysis illumination pcabased vision systems tr ctr g narasimhan shree k nayar practical analytic single scattering model real time rendering acm transactions graphics tog v24 n3 july 2005 pei chen david suter analysis linear subspace approaches computer vision pattern recognition international journal computer vision v68 n1 p83106 june 2006 feng xie linmi tao estimating illumination parameters real space application image relighting proceedings 13th annual acm international conference multimedia november 0611 2005 hilton singapore ronen basri david jacobs ira kemelmacher photometric stereo general unknown lighting international journal computer vision v72 n3 p239257 may 2007 frdo durand nicolas holzschuch cyril soler eric chan franois x sillion frequency analysis light transport acm transactions graphics tog v24 n3 july 2005 ameesh makadia christopher geyer kostas daniilidis correspondencefree structure motion international journal computer vision v75 n3 p311327 december 2007 smith edwin r hancock facial shapefromshading recognition using principal geodesic analysis robust statistics international journal computer vision v76 n1 p7191 january 2008 zhanfeng yue wenyi zhao rama chellappa poseencoded spherical harmonics face recognition synthesis using single image eurasip journal advances signal processing v8 n1 p118 january 2008 aaron hertzmann steven seitz examplebased photometric stereo shape reconstruction general varying brdfs ieee transactions pattern analysis machine intelligence v27 n8 p12541264 august 2005 ravi ramamoorthi pat hanrahan signalprocessing framework reflection acm transactions graphics tog v23 n4 p10041042 october 2004 wang xiao wang jufu feng subspace distance analysis application adaptive bayesian algorithm face recognition pattern recognition v39 n3 p456464 march 2006 ravi ramamoorthi dhruv mahajan peter belhumeur firstorder analysis lighting shading shadows acm transactions graphics tog v26 n1 p2es january 2007 sangil choi chunghoon kim chongho choi shadow compensation 2d images face recognition pattern recognition v40 n7 p21182125 july 2007 christossavvas bouganis mike brookes multiple light source detection ieee transactions pattern analysis machine intelligence v26 n4 p509514 april 2004