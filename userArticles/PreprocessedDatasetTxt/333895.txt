backward error analysis numerical integrators backward error analysis become important tool understanding long time behavior numerical integration methods true particular integration hamiltonian systems backward error analysis used show symplectic method conserve energy exponentially long periods time results typically based two aspects backward error analysis shown modified vector fields qualitative properties share given problem ii estimate given difference best interpolating vector field numerical method aspects investigated recently example benettin giorgilli j statist phys 74 1994 pp 11171143 hairer ann numer math 1 1994 pp 107132 hairer lubich numer math 76 1997 pp 441462 paper aim providing unifying framework simplification existing results corresponding proofs approach backward error analysis based simple recursive definition modified vector fields require explicit taylor series expansion numerical method corresponding flow maps abovecited works application discuss long time integration chaotic hamiltonian systems approximation time averages along numerically computed trajectories b introduction paper consider relationship solutions given system ordinary differential equations vector fields dt numerical approximations solutions associated modified equations dt vector fields formulated terms asymptotic expansion stepsize ffit ie chosen numerical solution formally inter preted increasing index accurate solution modified equation previous papers backward error analysis differential equations include warming hyett 38 griffiths sanzserna 12 beyn 6 feng 10 fiedler scheurle 11 sanzserna 31 another early reference related ideas moser 24 discusses approximation symplectic map near equilibrium flow map hamiltonian vector field recently general formulas computation modified vector fields derived hairer 16 calvo murua sanzserna 7 nettin giorgilli 5 reich 26 papers neishtadt 25 benettin giorgilli 5 hairer lubich 18 question closeness numerical approximations solutions modified equations addressed konradzusezentrum takustr 7 d14195 berlin current address department mathematics statistics university surrey guildford surrey gu2 5xh uk sreichsurreyacuk particular shown papers difference made exponentially small stepsize ffit ie provided vector field z numerical one step method psi ffit real analytic appropriate constants phi ffit denotes timeffitflow map vector field index ffit chosen difference minimized backward error analysis utmost importance understanding qualitative behavior symplectic methods 32 hamiltonian problems shown hairer 16 calvo murua sanzserna 7 reich 26 benettin giorgilli 5 symplectic discretizations modified vector fields hamiltonian special cases see also papers auerbach friedman 4 yoshida 40 hamiltonian structure modified equations implies symplectic integrator almost preserves total energy exponentially long period time 25 23 5 18 similarly adiabatic invariant hamiltonian system rapidly rotating phase also preserved exponentially long periods time provided symplectic method used 29 fact symplectic methods lead modified equations hamiltonian special instance called geometric properties backward error analysis mean following vector field z belongs certain class vector fields like integral preserving divergencefree vector fields numerical approximation phi ffit also preserves corresponding quantities modified vector fields class z besides symplectic methods special instances geometric aspects discussed see example papers reich 26 hairer stoffer 20 gonzalez higham stuart 13 paper revisit backward error analysis using simple recursive scheme definition modified vector fields first proposed author unpublished report 26 main advantage formulations require taylor series expansions numerical one step method psi ffit flow maps phi ffit terms step size ffit used papers benettin giorgilli 5 hairer 16 hairer lubich 18 turn allows simple characterization 1 geometric properties modified vector fields rather simple proof exponentially small truncation error 11 approach close one discussed benettin giorgilli 5 sense consider general one step methods 2 use direct approach 3 however different techniques used discuss detail x4 x5 consider numerical integration chaotic hamiltonian system symplectic method discuss approximation timeaverages along numerically computed trajectories assume poincare section 14 defined corresponding poincare section uniformly hyperbolic backward error 1 general idea already found report 26 hairer lubich 18 consider methods represented pseries 19 note rungekutta partitioned rungekutta methods fall category 3 contrast indirect approach used neishtadt 25 one step method first interpolated flow timedependent vector field averaging time used obtain optimal approximating timeindependent vector field analysis shadowing lemma 33 used show numerically computed trajectory stays close exact solution exponentially long periods time large deviation theorem 36 allow us discuss convergence long time averages along numerically computed trajectories anisotropic kepler problem 15 serve us numerical illustration problem requires application symplectic variable stepsize method first discussed author technical report 27 independently hairer 17 2 modified vector field recursion let us consider smooth vector field dt discretization one step method 19 assume psi ffit u ae r n r n smooth map method order p 1 ie x 2 u phi ffitz timeffitflow map differential equation 21 described introduction look family vector fields phi ffit equivalently ffit sufficiently small phi 1x denotes timeoneflow map vector field xffit family modified vector fields xffit ffit 0 formally defined terms asymptotic expansion stepsize ffit ie formally infinite sequence vector fields fdeltax g i1 1 obtained taylor series expansion one step method psi ffit ie x identity map comparison series expansion timeoneflow map phi 1xffit terms ffit vector fields deltax chosen two series coincide term term general approach followed benetttin giorgilli 5 hairer 16 two papers differ way taylor series expansions written lead exactly sequence vector fields fdeltax g i1 1 obviously deltax method order p give recursive definition modified vector field xffit require explicit taylor series expansion recursion introduced author unpublished report 26 first formally introduce truncated expansions means obviously let us assume x ffit chosen difference time oneflow map x ffit numerical one step method psi ffit offit i1 suggests consider following recursion deltax indeed definition deltax i1 implies x i1 ffit defined 23 generates timeoneflow map offit i2 away numerical method psi ffit seen thus eqs 23 24 recursively define modified vector fields x 1 recursion started x 1 ffitz generated sequence course equivalent sequences obtained using taylor series expansions described 16 5 throughout paper exclusively work recusion 2324 x3 shown leads simple characterization geometric properties modified vector fields x4 explicit estimates difference timeoneflow map modified vector field x ffit numerical method given like point results also 16 5 18 20 13 derived using explicit taylor series expansion flow map numerical method however feel application recursion leads simplification presentation results 3 geometric properties backward error analysis section consider differential equations 21 whose corresponding vector field z belongs certain linear subspace g infinite dimensional lie algebra 4 smooth vector fields r n 211 assumption given linear subspace g infinite dimensional lie algebra smooth vector fields r n let us assume corresponding subset g infinite dimensional frechet manifold 21 diffeomorphisms r n 4 algebraic operation lie bracket xy two vector fields x 3 id g defined set vector fields x psi 0 oneparametric family diffeomorphisms psi 2 g smooth psi linear space lie algebra hamiltonian vector fields r n example subset canonical transformations 1 important aspect differential equations corresponding flow map phi tz forms oneparametric subgroup g 211 especially context long term integration desirable discretize differential equations type way corresponding iteration map psi ffit belongs subset g phi tz call integrators geometric integrators following result concerning backward error analysis geometric integrators first stated unpublished report 26 theorem 31 let us assume vector field z dt belongs linear subspace g lie algebra smooth vector fields r n let us assume furthermore geometric integrator subspace g ie psi ffit 2 g ffit 0 sufficiently small perturbed vector fields x defined recursion 2324 belong g ie proof statement certainly true us assume also holds ffit 0 sufficiently small since ffit 0 sufficiently small well deltax g implies x i1 ffit 2 g required remark often linear subspace g fact subalgebra lie bracket 3 g property needed theorem 31 let us discuss five examples example 1 consider subspace g vector fields preserve particular first integral f r n r fact space subalgebra lie bracket 31 words imply show differentiate 32 wrt x gives procedure applied 33 using identities definition 31 34 yield desired result corresponding subset g given f preserving diffeomorphisms psi ie fact let psi smooth family f preserving diffeomorphisms psi x psi since thus id apply theorem 31 particular numerical method modified vector fields x possess f first integral result recently derived gonzalez higham stuart 13 using contradiction argument pi example 2 consider lie subalgebra divergencefree vector fields z ie corresponding subset g volume preserving diffeomorphisms ie det id g namely x psi x trace x psi x 0 thus numerical method psi ffit volume conserving modified vector fields x divergencefree result formulated gonzalez higham stuart 13 using contradiction argument pi example 3 let involution 5 2 r nthetan given consider subspace g vector fields z r n satisfy timereversal symmetry subspace subalgebra lie bracket 31 corresponding subset g given timereversible diffeomorphisms psi ie psi let psi 2 g smooth psi theta spsi implies x psi g follows id apply theorem 31 thus numerical method psi ffit satisfies timereversal symmetry modified vector fields x timereversible result first proven hairer stoffer 20 using ideas 26 pi example 4 let f g denote poisson bracket linear poisson manifold lie algebra hamiltonian vector fields p given dt r smooth function corresponding subset g given set smooth diffeomorphisms p preserve poisson bracket f g 1 let psi family maps g psi smooth functions f condition vector field x locally hamiltonian since p simply connected vector field also globally hamiltonian 3 discrete evolution 22 satisfies psi ffit 2 g ffit 0 psi ffit called symplectic method follows theorem 31 modified vector fields hamiltonian vector fields p result also found 5 16 26 symplectic method expanded pseries vector fields x ffit globally hamiltonian even phase space p ae r n simply connected 16 result applies symplectic rungekutta partitioned rungekutta methods furthermore symplectic methods defined generating function third kind 32 also always globally hamiltonian 5 statement true symplectic methods based composition exact flow maps 40 pi example 5 let us consider differential equations matrix lie group g ae r nthetan 35 general time independent differential equations g written form dt 5 involution nonsingular matrix satisfies ae r nthetan lie algebra g many recent papers see 8 references therein devoted methods preserve lie group structure ie n 2 g implies n1 2 g thus psi ffit diffeomorphism defined submanifold g ae r nthetan fact submanifold characterized least locally set nonlinear equations denote f f integral preserving map ie f ffi psi g following example 1 know modified vector fields well given vector field satisfy hence modified vector fields x ffit vector fields g give rise modified differential equations type dt g see 28 results backward error analysis numerical methods manifolds pi 4 truncation error backward error analysis like derive explicit estimate norm vector fields deltax i1 difference timeoneflow map phi 1x ffit numerical approximation psi ffit assume vector field z 21 real analytic also introduce following notations let b r denote complex ball let us consider compact subset k ae r n phase space constant r 0 given real analytic vector field bounded b r define also define b find estimate deltax i1 defined 24 need estimates mappings appearing right hand side 24 start estimate map psi ffit lemma 41 let us assume vector field z 21 real analytic compact subset k phase space constants k r 0 also assume numerical method psi ffit real analytic exists constant k proof given assumptions flow map z zphi tz x dt defined complex valued 2 c integral right hand side independent path zero complexified flow map satisfies z jjzphi tz xjj jdtj 1 consistency numerical method implies exists constant deltak 0 complexified map psi take k remark let us consider sstage rungekutta method coefficients ij1 fb g i1 19 satisfying 1 assume rungekutta method uniquely 6 defines real analytic map psi stepsizes 2 c j j rk 41 follows fact stated assumptions stage variables brk vector field z bounded constant k similar statement holds partitioned rungekutta methods pi theorem 42 let assumptions lemma 41 satisfied exists family real analytic vector fields order method family modified vector fields xffit satisfies estimate r 6 implicit method solution obtained fixpoint iteration j j sufficiently small p 1 constant depending order p method example proof know x 1 psi ffit method order p 1 thus jjx 1 jj r j jm deltax next find estimate difference timeoneflow map phi 1x 1 map psi using 41 42 obtain since mappings real analytic difference offit p1 obtain estimate 5 1 using 24 next show 1 estimate true compare 43 proceed induction first note replace parameter ff 2 0 1 formula ff j 0067 yields ff 2 0 1 2 c j used 0891 46 2 particular substitute j j j ff 45 use inequality 46 derive 1 next introduce vectorvalued real analytic function observe 1 used x 2 b ffr k implies phi tx j x 2 find estimate difference timeoneflow map phi 1x j map psi using 41 47 obtain since mappings real analytic difference offit j1 obtain estimate 5 1 using 24 finally obtain verifies 44 next need estimate difference timeoneflow map map psi ffit compact set k using 48 immediately r family vector fields xffit defined taking optimal number ffit iterations take ffit integer part thus ffit completes first part proof according 45 difference modified vector fields xffit z given r r next use ffit r c obtain r e r r p 1 chosen j 2 remark proof theorem 42 similar spirit one given benettin giorgilli 5 exponentially small difference optimal interpolating vector field neartotheidentity map however couple important differences explicitly take order method account ii directly derive estimates difference flow maps phi 1x psi ffit instead using taylor series expansions phi 1x psi ffit corresponding estimates elements series believe simplifies proof theorem 42 iii introducing parameter ff 2 0 1 shrink domain definition vector fields x iteration index increases feel simplifies proof iv 18 work directly estimate given vector field z instead making assumptions map psi ffit rather pessimistic constants entering estimates seem main disadvantage approach pi elaborate version proof theorem 42 found 30 5 application ergodic hamiltonian systems let us consider real analytic hamiltonian system dt dt together smooth function r 2n r interested evaluating timeaverage along trajectory qt pt hamiltonian system 5152 ie assume exists equal microcanonical ensemble average corresponding hamiltonian ie assume system 5152 ergodic 7 even mixing 37 thus r aq p z z inner product ffie gamma h let us write equations 5152 compact form dt hamiltonian h preserved flow map phi th let us assume hypersurface 0 constant energy 7 precise ergodicity system implies time average equivalent ensemble average except set initial conditions measure zero compact subset r 2n also assume constant jjrxhxjj fl 1 x 2 0 implies 0 smooth dimensional compact submanifold furthermore family hypersurfaces sufficiently small smooth compact well fact diffeomorphic define open subset u phase space u e2gammadeltaedeltae far made fairly generic assumptions sequel become specific ensure hamiltonian system 5152 ergodicmixing first step construct poincare return map 14 let r smooth function positive constant jf hgxj fl 2 level sets deltas 0 sufficiently small let us assume defines poincare section following way x 2 positive number solution xt 0 initial condition xt 0 positive number called poincare return time point x knowing poincare return time x 2 define global poincare map assume poincare return times p x x 2 v bounded constant interested solutions particular level set constant energy simplicity take level set 0 sufficient consider restricted defined restriction pi thus reduced study dynamical properties hamiltonian system 5152 energy shell 0 study properties poincare ergodic mixing map hamiltonian system ergodic mixing 0 note pi 0 volume preserving ie det x pi 0 assume pi 0 uniformly hyperbolic map ie linearization x pi 0 x x possesses strictly expanding contracting directions 1436 stochastic behavior deterministic map investigated example 36 point four main results ffl unique invariant density 0 invariant pi 0 furthermore 0 given lebesgue measure ffl autocorrelation function ha holder continuous function exponentially fast ie appropriate constant ffl timeaverages along trajectories fx g i1 n pi 0 satisfy central limit theorem ffl timeaverage hain along trajectories pi 0 initial value x satisfy large deviation theorem specific 39 given c 0 hc 0 large n 1 results proven see example 36 carefully studying properties corresponding frobeniusperron operator defined definition 51 call hamiltonian system 5152 introduced properties poincare hyperbolic particular assume level sets constant energy compact submanifolds ii constant global poincare map pi defined uniformly hyperbolic map restricted poincare return times p x x 2 v bounded constant k 0 v constant let e h perturbation h x 2 u ffl 0 call e h fflperturbation h lemma 52 property poincare hyperbolic stable ffl perturbations hamiltonian h provided ffl sufficiently small proof assumption jjrxhxjj fl 1 level sets implies sets persistent small perturbations furthermore exists constant perturbed hamiltonian h x 2 v thus poincare map also defined perturbed hamiltonian h uniform hyperbolicity also stable small perturbations poincare map 2 let us discretize 5152 symplectic real analytic integrator psi ffit order 1 assumption assume backward error analysis applied compact subset k u ae k corresponding perturbed hamiltonian denoted e ie x 2 k constants let stepsize ffit sufficiently small perturbed hamiltonian system also poincare hyperbolic simplicity shift modified hamiltonian e hffit hx 0 let us introduce couple notations perturbed system unperturbed system define compact level sets f open set e u replacing h e h definition without loss generality assume e u ae k furthermore e deltas corresponding sets e v e defined obvious way finally global poincare map e pi reduced poincare map e pi 0 introduced unperturbed system without loss generality assume ae e extend discrete time map psi ffit map psi 2 0 ffit using exact flow map phi e h modified problem interpolation 2 0 ffit map extended ffit obvious way 8 composition k steps psi ffit one step phi dt e thus correspondence definition global poincare map e define x 2 e poincare return times e p x x 2 e v definition e pi lemma 52 implies constant e sup follows backward forward error analysis 18 constant x 2 e v ffit sufficiently small importantly let fx g i1 n numerically computed sequence points x corresponding sequence map e pi x sequence fx g respectively generates two sequences real numbers fe g fs g f e fes g respectively defined e 8 resulting map discontinuous multiples stepsize ffit smooth interpolation could defined needed context paper e obviously e drift values e per step away zero exponentially small sums linearly number steps energy conserving property symplectic method discussed benettin giorgilli 5 hairer lubich 18 exponentially slow drift follows sequence fs g lipschitz constant e words start initially e points computed numerically poincare map b pi stay exponentially small neighborhood e exponentially many iterates b pi since numerical method order p 1 compact manifolds f offit p away ie modified hamiltonian e h fflperturbation hamiltonian h ffl ffit p thus sequence fx g also stay offit p neighborhood long number iterates n satisfies appropriate constant shadowing lemma 33 applied sequence fx g i1 n proposition 53 exists exact trajectory fx g i1 n poincare map pi 0 numerically computed sequence fx g i1 n stays offit p neighborhood shadowing exact trajectory provided number iterates n satisfies 54 proof first project sequence fx g i1 n onto using search direction orthogonal manifold denote result fx g projected sequence fx g sequence fx g offit p close provided n satisfies 54 local error per step exact poincare map pi numerical poincare map b pi also order p stepsize ffit follows standard forward error analysis thus shadowing lemma 33 uniformly hyperbolic maps applied poincare map projected sequence fx g shadowing distance offit p shadowing result also applies sequence fx g let us assume want compute ensemble average smooth r certain accuracy c 0 large deviation theorem hyperbolic maps tells us probability obtain ensemble average desired accuracy time average along single trajectory goes one exponentially fast length n trajectory increased numerically compute approximative trajectory system 5152 know proposition 53 trajectory offit p close exact trajectory exponentially many integration steps n let us denote time average along exact trajectory hai e n numerically computed time average hain n satisfying bound type 44 thus obtain following proposition 54 let 5152 poincare hyperbolic realanalytic system discretize symplectic method order p 1 stepsize ffit timeaverage hain observable along numerically computed trajectory fxn gn1 n satisfies 55 hai e n timeaverage along exact trajectory number steps n satisfies bound type 54 furthermore assume want compute ensemble average within given accuracy c 0 assume simplicity constant c larger difference time averages 55 always true sufficiently small stepsizes ffit probability obtain average desired accuracy time average along numerically computed trajectory goes one exponentially fast number integration steps n increased taking maximum number 54 steps probability made double exponentially close one 53 ffit 0 example numerical example look following planar anisotropic kepler problem 15 dt dt initial conditions chosen note angular momentum l conserved define poincare section 0 record sequence points conservation energy implies thus defined sequence restricted subset subset awkward shape transformed rectangle means area preserving transformation 102 corresponding poincare map hyperbolic ie stable unstable manifolds intersect transversally dynamics encoded binary bernoulli shift 15 main computational difficulty consists existence weak singularity remove singularity scale equations motion introducing time transformation implies new time norm vector field remains bounded time transformation introduced transformed equations motion still hamiltonian constant stepsize symplectic method used integrate transformed system let us describe general assume hamiltonian function hq scaling function aeq given following zare szebehely 41 introduce modified hamiltonian function corresponding hamiltonian equations motion extended phase space r 2n theta r 2 particular let us consider case p0 59511 simplified hypersurface constant energy scaled vector field desired hamiltonian anymore therefore suggested author 27 independently hairer 17 hamiltonian equations 59511 discretized symplectic method example equations discretized symplectic euler method ie method explicit variable q unfortunately implies method first order ffi however method symplectic therefore time time average time time average time average time time average time actual stepsize 22time angular momentum time total energy b fig 51 time evolution average hrin mean distance shown four different initial conditions equal initial energy evolution error energy angular momentum actual stepsize bottomright figure shows intersections trajectory poincare section x1 x2 coordinates one thousand intersections plotted hamiltonian conserved offi exponentially long periods time secondorder symplectic discretization obtained using secondorder lobatto iiiab partitioned rungekutta formula 34 ie resulting scheme implicit aeq approach applied anisotropic kepler problem scaling function chose initial values equations motion integrated using second order symplectic method 512 005 time average observable aq along trajectory computed according recursive formula hain n time average computed four different initial conditions evolution corresponding time averages hri n found fig 51a different lengths time intervals due fact number steps stepsize ffi taken leads different actual stepsizes ffit n within tolerance c 004 averages converge value 133 fig 51b total energy h angular momentum l variation actual stepsize found particular trajectory also plotted intersections trajectory q x x theoretically points fill rectangle uniform way invariant meassure lebesgue meassure one thousand points plotted uniform distribution satisfied quite well pi acknowledgements like thank ernst hairer chus sanzserna andrew stuart claudia wulff comments earlier version paper referees making valuable suggestions r lie group structure diffeomorphism groups invertible fourier integrals operators applications geometrical methods theory ordinary differential equations mathematical methods classical mechanics hamiltonian interpolation near identity symplectic mappings application symplectic integration algorithms numerical methods dynamical systems modified equations odes aspects backward error analysis numerical odes formal power series numerical algorithms dynamical systems discretization homoclinic orbits invisible chaos scope modified equations qualitative properties modified equations dynamical systems bifurcations vector fields chaos classical quantum mechanics backward analysis numerical integrators symplectic methods variable time step integration symplectic methods lifespan backward error analysis numerical integrat ors solving ordinary differential equations reversible longterm integration variable step sizes inverse function theorem nash moser lectures hamiltonian systems separation motions systems rapidly rotating phase numerical integration generalized euler equations backward error analysis numerical integrators higher order semiexplicit symplectic partitioned rungekutta methods constrained hamiltonian systems preservation adiabatic invariants symplectic discretization dynamical systems symplectic integrators hamiltonian problems overview rigorous verification trajectories computer simulation dynamical systems symplectic partitioned rungekutta methods stochastic dynamics deterministic systems introduction ergodicity theory modified equation approach stability accuracy finitedifference methods large deviations dynamical systems construction higher order symplectic integrators time transformations extended phase space tr ctr p f tupper computing statistics hamiltonian systems case study journal computational applied mathematics v205 n2 p826834 august 2007 ernst hairer important aspects geometric numerical integration journal scientific computing v25 n1 p6781 october 2005 yk zou wj beyn manifolds connecting orbits discretizations dynamical systems nonlinear analysis theory methods applications v52 n5 p14991520 february b cano durn analysis variablestepsize linear multistep methods special emphasis symmetric ones mathematics computation v72 n244 p17691801 october p calvo portillo high order variable step equistage initializers better standard starting algorithms journal computational applied mathematics v169 n2 p333344 15 august 2004 brian e moore sebastian reich multisymplectic integration methods hamiltonian pdes future generation computer systems v19 n3 p395402 april fong eric darve adrian lew stability asynchronous variational integrators proceedings 21st international workshop principles advanced distributed simulation p3844 june 1215 2007 jess izaguirre scott hampton shadow hybrid monte carlo efficient propagator phase space macromolecules journal computational physics v200 n2 p581604 november 2004 b cano durn technique construct symmetric variablestepsize linear multistep methods secondorder systems mathematics computation v72 n244 p18031816 october