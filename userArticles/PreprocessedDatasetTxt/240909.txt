mean square discrepancy randomized nets one popular family low dicrepancy sets snets recently randomization nets preserves net property introduced article formula mean square l2discrepancy 0 snets base b derived formula computational complexity os logn s2 large n bm number points moreover root mean square l2discrepancy 0 snets show on1logns12 n tends infinity asymptotic order known lower bound l2discrepancy arbitrary set b introduction multidimensional integrals sdimensional unit cube c may approximated sample mean integrand evaluated point set p n points contrast ordinary sets p may multiple copies point niederreiter 1992 p 14 quadrature error depends uniformly points p distributed unit cube much integrand varies constant example dp l 1 star discrepancy niederreiter 1992 definition 21 v f variation f sense hardy krause koksmahlawka inequality niederreiter 1992 theorem 211 z research partially supported hong kong rgc grant 949538 hkbu frg grant 9696ii01 address department mathematics hong kong baptist university kowloon tong hong kong email fredhkbueduhk url httpwwwmathhkbueduhkfred permission make digital hard copies part work personal classroom use granted without fee provided copies made distributed profit direct commercial advantage copies show notice first page initial screen display along full citation copyrights components work owned others acm must honored abstracting credit permitted copy otherwise republish post servers redistribute lists use component work works requires prior specific permission andor fee permissions may requested publications dept acm inc 1515 broadway new york ny 10036 usa fax 1 212 8690481 permissionsacmorg acm transactions modeling computer simululation 1997 bounds form definitions dp v f appear literature well good set p quadrature one small discrepancy sets found smaller discrepancies simple random points sets often called quasirandom points calculating l 1 star discrepancy particular set impractical unless n small requires operations much effort directed towards finding quasirandom sequences asymptotically small discrepancies n tends infinity snets niederre iter 1992 chapter 4 one example comparison l 2 star discrepancy easier compute requiring 2 operations using naive algorithm onlogn operations using algorithm heinrich 1996 owen 1995 1996a 1996b proposed randomization snets preserves net properties aim obtain probabilistic quadrature error estimates similar manner one would simple monte carlo quadrature article formula mean square l 2 discrepancy randomized 0 nets derived requires os logn mathematical operations evaluate n andor tend infinity l 2 discrepancy randomized nets shown decay like matching asymptotic lower bound obtained roth 1954 remainder section define snets describe owens randomization also generalized l 2 discrepancy arises quadrature error bounds recently derived author defined section 2 mean square l 2 discrepancy computed simple random samples randomized 0 snets asymptotic behavior l 2 discrepancy studied section 3 article concludes discussion point may written base b bnary digits z ij range 0 b gamma 1 let z denote space sdimensional nonnegative integer vectors b k1 different ways choose first bnary digits point z z specified snet contains least one point every possible choice first k digits provided oek small enough definition 1 let nonnegative integers 0 let positive integer snet base b set p containing c possible choice first k bnary digits 12 exist b mgammaoek points p digits provided smaller value tends imply net better uniformity smaller discrep ancy set snet fuller discussion snets see niederreiter 1992 chapter 4 owen randomizes digits points given snet p 0 obtain new snet p every digit index every coordinate index obtains random digit z ij contributes random point z 2 p randomized net p satisfies following assumptions assumption 1 z 2 p digit z ij uniformly distributed set 1g b two points z z random vectors z mutually independent c two points corresponding points randomized net suppose j 0 share first k j digits st digits different ii random vector z k j 1j z 0 uniformly distributed set mutually independent mutually independent assumptions 1a 1b imply marginal probability distribution uniform c z mutually inde pendent assumption 1c maintains correlation different points p necessary retaining net properties thus low discrepancy simple random sample assumptions 1a 1b also satisfied instead assumption 1c one z 1j z mutually independent z 6 z 0 sg set coordinate indices u let juj denote number points u let c denote jujdimensional unit cube involving coordinates u likewise let z u jujdimensional nonnegative integer vectors notation allows us distinguish spaces dimension different coordinate directions l p star discrepancy sometimes defined l p norm difference empirical distribution associated sample p uniform distribution unit cube denotes number points set k k p denotes l p norm although definition appropriate admit error bound like 11 values p suitable definition hickernell 1997 1p p u denotes projection sample p cube c u means one term definition bound form 11 based definition derived zaremba 1968 hickernell 1997 p l p star discrepancy general difficult compute except case reduces double sum hickernell 1997 derived family quadrature error bounds form 11 l p discrepancies p p include star discrepancy special case discrepancy simplest compute let fi arbitrary positive constant arbitrary function 0 1 whose first derivative essentially bounded satisfies z 1 dx generalized l 2 discrepancy defined hickernell 1997 oe denotes quadratic bernoulli polynomial abramowitz stegun 1964 chapter 23 star discrepancy obtained choosing another choice fi yields discrepancy derived hickernell 1996 similar figure merit p ff used study lattice rules sloan joe 1994 eq 48 several different choices fi discussed hickernell 1997 l 2 discrepancy defined 14 also written theta choosing fi according 15 setting equation yields formula 2s 13 originally derived warnock 1972 gamman l 2 discrepancy appear worstcase quadrature error bounds 11 also arises averagecase quadrature error analysis let e f denote expected value space integrands choice space integrands determines specific form discrepancy sacks ylvisacker 1970 ritter 1995 case star discrepancy studied wozniakowski 1991 morokoff caflisch 1994 2 computing mean square l 2 discrepancy let e denote expected value space random sets p section compute efd 2 p simple random samples randomized 0 nets kinds samples satisfy assumptions 1a 1b allows simple treatment terms 14 involving z j z 0 difficult term jz since expected value depends correlation z z 0 lemma 1 p random set satisfying assumptions 1a 1b proof assumption 1a z j uniformly distributed 01 assumption 1b components z mutually independent expectation product j product expectations combining two results implies 14 written ae oe using binomial theorem rewrite product completes proof lemma simplify 21 one must calculate j case p simple random sample straightforward show 2 substituting expression 21 calculation leads oe simplification gives following theorem theorem 1 p simple random sample formula serves benchmark presumably superior quasirandom sets p since mean square generalized l 2 discrepancy gamma1 generalized discrepancy typically gamma12 simple random sample mean square discrepancy randomized 0 snet given following theorem two major steps calculation contained lemmas 2 3 theorem 2 let p 0 snet randomized according assumption 1 let rl defined partial binomial sum r mean square discrepancy p l theta first step proof theorem calculate 3ejz randomized net obtain formula analogous 22 lemma 2 suppose p randomized snet satisfying assumption 1 z z 0 two points p components z j z 0 share first k j digits follows proof j th components z j z 0 share first k j digits different st digits original j 0 j came first k j digits different k st digits case assumption 1c implies distributed according assumption 1cii ffi ffi 0 uniformly distributed 0 1 compute mean square l 2 discrepancy randomized net one must count many points share exactly first k j digits possible k u 2 z u result 0 snets result contained lemma seems impossible extend calculation snets 0 snet defined precisely enough example 1 snet may also 0 snet lemma 3 suppose p 0 snet randomized fixed z let k u denote number points z 0 2 p z j z 0 share exactly k j digits j 2 u finite k u r proof consequence definition 1 points z k u digits z oek holds case assume 26 holds k u oek u strictly greater shown imply 26 holds oek u holds oek u induction k 0 implies b mgamma 0 points z first k 0 digits z written u means k j k 0 represents z assumed true oek since different k u u oek u sum u may rewritten r simplify double sum index r replaced r order summation reversed identity binomial coefficients prudnikov et al 1986 section 425 equation 47 simplifies inner sum substituting formula sum back completes proof 26 proof theorem 2 combining results lemmas 2 3 sum 21 written asn 2 ku2z u ku2z u every oek u also positive integer l l distinct u allows 21 written l theta thereby completing proof 24 follows 2 therefore os 2 operations required calculate os 2 nontrivial values rl sums l 25 involve total oms terms mean square l 2 discrepancy randomized 0 nets calculated os logns 2 operations n andor tend infinity order much smaller required compute l 2 discrepancy arbitrary set p quite similar thus root mean square 2u p calculated using arguments theorems 1 2 theorem 3 p simple random sample efd theorem 4 let p 0 snet randomized according assumption 1 u nonempty subset efd l 6 theta 3 asymptotics n equivalently approaches infinity one would like know quickly mean squared l 2 discrepancy tends zero calculated asymptotic analysis formulas theorems 2 4 theorem 5 let p 0 snet randomized according assumption 1 efd proof dependence 25 29 lies term square brackets call l asymptotic form obtained rewriting sum infinite sum since follows 28 definition rl 24 used simplify expression r r implies r large binomial coefficient delta asymptotic reversing order summation one compute asymptotic form l r r r b gamma2 r asymptotic expected mean square discrepancy involves sum l l factor significant term occurs therefore completes proof 31 similar argument used prove 32 note asymptotic behavior efd 2 p independent function constant asymptotic behavior efd 2u p independent constant fi well prime power dimensions exist 0 snets base niederreiter 1992 theorem 454 case large coefficient tends zero faster exponentially stirlings 1 4 discussion mean square random variable equal square mean plus square standard deviation particular upper bound mean standard deviation 2 p thus theorem 5 asymptotic order lower bound derived roth 1954 kuipers niederreiter 1974 p102 refined lower bound give explicit constant see also niederreiter 1978 equation 310 p 972 12 gamma12 lower bound l compare lower bound l 2 star discrepancy p asymptotic behavior randomized 0 snets coefficients bs plotted figure 1 clear bs tends zero much faster dimension increases reason could lower bound tight ii average discrepancy 0 snets much worse discrepancies especially good 0 snets iii optimal discrepancy obtained coefficient figure 1 comparison solid bs dashed kind point set p clear author reason likely given lower bound l 2 p zero one derive upper bound likelihood randomized 0 snet large discrepancy nonnegative l replacing new constant ff 2 equal right hand side equation gives ff particular 1 randomized 0 snets l 2 discrepancy greater 10 g figure 2 shows root mean square l 2 star discrepancy randomized 0 nets base plotted versus n formula 25 values fi given 15 dimensions considered prime numbers 2 13 n runs 10 10 comparison root mean square asymptotic l 2 discrepancy 31 root mean square l 2 star discrepancy simple random sample 23 lower bound l 2 star discrepancy 41 also shown figure 3 similar figure 2 except shows l 2 symmetric discrepancy defined hickernell 1997 contrast 15 symmetric discrepancy defined x invariant x replaced 1 gamma x symmetric discrepancy change p reflected plane x 12 like star discrepancy symmetric discrepancy geometric interpretation subset coordinate indices u planes passing point x u parallel faces cube c u divide cube 2 juj intervals rectangular solids interval consists points vertex cube point x u intervals denoted odd even depending sum coordinates corresponding vertex example even interval x even odd according whether juj even odd let j e denote union even intervals l 2 symmetric discrepancy defined figures 2 3 root mean square l 2 discrepancies nets approach asymptotic behaviors quickly lower dimensions asymptotic values discrepancies increase n initially term increasing n e sgamma12 discrepancies nets decay zero faster increasing sample size discrepancies simple random samples number logn factors asymptotic behavior discrepancy nets increases dimension see theorem 5 thus reducing advantage simple random samples effect pronounced symmetric discrepancy star discrepancy larger value fi former formula 16 shows 2 p sum 2u p 2 weights fi 2juj larger value fi accentuates importance terms large juj terms decay zero slowly according theorem 5 large small value fi inherently better rather reflects personal choice although decreasing fi decreases increases variation norm integrand corresponding quadrature error bound thus tradeoff effect varying fi discussed hickernell 1997 numerical experiments indicate root mean square discrepancy randomized 0 snet base never greater simple random sample regardless choice fi however conjecture yet proven equations 11 31 imply randomized 0 snets sup variation integrand v f defined hickernell 1997 fixed integrand f similar smoothness conditions owen 1996b showed randomized 0 snets additional power n gamma1 latter result discrepancy discrepancy discrepancy discrepancy discrepancy discrepancy figure 2 root mean square l 2 star discrepancy randomized 0 snets base versus n ffi asymptotic behavior root mean square l 2 star discrepancy simple random sample solid lower bound l 2 star discrepancy dashed discrepancy discrepancy discrepancy discrepancy discrepancy discrepancy figure 3 root mean square l 2 symmetric discrepancy randomized 0 snets base versus n ffi asymptotic behavior root mean square l 2 symmetric discrepancy simple random sample solid due integrand fixed advance choosing randomized net quadrature former result integrand chosen pessimistically picking specific randomized net one may wonder computed mean square l 2 discrepancy mean l 2 discrepancy mean l p discrepancy general answer convenience square l 2 discrepancy appears simple enough form allow mean value computed acknowledgments author would like thank profs harald niederreiter art owen valuable comments suggestions r handbook mathematical functions formulas discrepance de suites associees un systeme de numeration en dimension efficient algorithms computing l 2 discrepancy quadrature error bounds applications lattice rules generalized discrepancy quadrature error bound uniform distribution sequences random number generation quasimonte carlo methods equidistributed latin hypercube samples monte carlo variance scrambled equidistribution quadrature scrambled net variance integrals smooth functions integrals series average case analysis numerical problems irregularities distribution statistical design integral approximation lattice methods multiple integration computational investigations low discrepancy point sets average case complexity multivariate integration tr random number generation quasimonte carlo methods quasirandom sequences discrepancies quadrature error bounds applications lattice rules monte carlo variance scrambled net quadrature generalized discrepancy quadrature error bound ctr friedrich pillichshammer root mean square weighted l stefan heinrich fred j hickernell rongxian yue optimal quadrature haar wavelet spaces mathematics computation v73 n245 p259277 january 2004 art b owen monto carlo extension quasimonte carlo proceedings 30th conference winter simulation p571578 december 1316 1998 washington dc united states shu tezuka henri faure ibinomial scrambling digital nets sequences journal complexity v19 n6 p744757 december michael g hilgers quasimonte carlo methods cash flow testing simulations proceedings 32nd conference winter simulation december 1013 2000 orlando florida fred j hickernell dream quadrature rule journal complexity v19 n3 p420427 june dick friedrich pillichshammer multivariate integration weighted hilbert spaces based walsh functions weighted sobolev spaces journal complexity v21 n2 p149149 april 2005 hee sun hong fred j hickernell algorithm 823 implementing scrambled digital sequences acm transactions mathematical software toms v29 n2 p95109 june art b owen variance alternative scramblings digital nets acm transactions modeling computer simulation tomacs v13 n4 p363378 october art b owen latin supercube sampling highdimensional simulations acm transactions modeling computer simulation tomacs v8 n1 p71102 jan 1998