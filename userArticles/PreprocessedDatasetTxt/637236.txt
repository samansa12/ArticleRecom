case study ospf behavior large enterprise network open shortest path first ospf widely deployed ip networks manage intradomain routing ospf linkstate protocol routers reliably flood link state advertisements lsas enabling build consistent global view routing topology reliable performance hinges routing stability yet behavior large operational ospf networks well understood paper provide case study eharacteristics dynamics lsa traffic large enterprise network network consists several hundred routers distributed tens ospf areas connected lans private lines network focus lsa traffic analyze class lsas triggered ospfs softstate refresh b class lsas triggered events change status network c class duplicate lsas received due redundancy ospfs reliable lsa flooding mechanism derive baseline rate refreshtriggered lsas automatically network configuration information also investigate finer time scale statistical properties traffic including burstiness periodicity synchronization discuss root causes eventtriggered duplicate lsa traffic well steps identified reduce traffic eg localizing failing router changing ospf configuration b introduction operational network performance assurances hinge stability performance routing system understanding behavior routing protocols crucial better operation management ip networks pa per focus open shortest path first ospf 1 widely deployed interior gateway protocol igp ip aman shaikh university california santa cruz ca 95064 email amansoeucscedu chris isett siemens medical solutions malvern pa 19355 email chrisisettsmedcom albert greenberg matthew roughan joel gottlieb falbertroughanjoelgresearchattcom networks today control intradomain routing despite widespread use behavior ospf large commercial ip networks well understood paper provide case study dynamic behavior ospf large enterprise ip network using data gathered deployment novel passive ospf monitoring sys tem knowledge case study represents first detailed report ospf dynamics large operational ip network ospf linkstate protocol router generates link state advertisements lsas create maintain local consistent view topology entire routing domain tasks related generating processing lsa traffic form major chunk ospf process ing fact ospf lsa storms cripple network unheard 2 therefore understanding dynamics lsa traffic vital manage ospf networks understanding also lead realistic workload models used variety purposes like realistic simulations scalability studies therefore focus lsa traffic case study specifically introduce general methodology associated predictive model investigate lsa traffic reveals network topology dynamics failure modes enterprise network investigation provides highly available reliable connectivity customers facilities applications databases residing data center salient features network ffl ospf used routing data center ospf domain consists 15 areas 500 routers paper presents dynamics ospf 8 areas including backbone area covering 250 routers one month period april 2002 ffl ospf domain hierarchical structure application database servers root customers leaves domain uses ethernet lans extensively connectivity contrast isp networks rely point point link technologies ffl customers connected leased lines ospf network data center eigrp 1 run leased lines customer reachability information learnt via eigrp subsequently imported ospf domain contrast many isp networks propagate external reachability information using internal instance bgp ibgp 1 believe salient characteristics enterprise network common wide class networks understand characteristic lsa traffic enterprise network classify traffic three classes refreshlsas class lsas triggered ospfs softstate refresh mechanism ffl changelsas class lsas triggered events change status network ffl duplicatelsas class extra copies lsas received result redundancy ospfs reliable lsa flooding mechanism section v provide simple formula predict rate refreshlsa traffic parameters determined using information available router configuration files measurements confirm prediction accurate understand finer grained refresh traffic characteristics propose carry simple timeseries analysis case study analysis revealed routers fall two classes different periodic refresh behavior turned two classes ran two versions router operating systems cisco ios measurements showed refresh traffic synchronized across routers contrast basu riecke 3 reported evidence synchronization ospf model simulations believe day day variations operational context tends break synchronization arising initial conditions saw evidence forcing functions however push network towards synchronization baselined refreshlsa traffic move analysis traffic triggered topology changes section vi isolate changelsas attribute either internal external topology changes internal changes changes topology ospf domain whereas external changes changes reachability information imported eigrp found bulk changelsas due external changes addition overwhelming majority changelsa traffic came persistent yet partial failure modes internal changelsas arose failure modes within single router bulk external changelsas arose single eigrp session flapping due congestion link interestingly one critical internal router failure case impending failure eluded snmp based fault performance management system showed prominently spikes changelsa traffic result lsa measurements proactive maintenance carried moving network away operating point additional router failure would catas trophic networkwide impact ospf uses reliable flooding disseminate lsas certain level duplicatelsa traffic ex pected however case study observed certain asymmetries duplicatelsa traffic initially surprising given complete symmetry physical network design section vii however closer look revealed asymmetries logical ospf control plane topology analysis led method reducing duplicatelsa traffic altering routers logical ospf configurations without changing physical structure network related work part previous studies ospf model simulationbased 3 4 concentrated measuring ospf implementation behavior single router small testbed 5 exception paper labovitz et al 6 authors analyzed ospf instability regional isp network however work first comprehensive analysis ospf lsa traffic lead development realistic networkwide modeling parameters simulation scenarios greatest interest interesting work related isis 1 convergence isp networks potential much faster convergence appeared talks internet drafts packet design 7 8 realm interdomain routing numerous studies published behavior bgp internet examples 6 9 10 studies yielded many interesting important insights igps ospf need similar tention believe paper first step direction ii ospf fundamentals lsas ospf link state routing protocol meaning router within domain discovers builds entire view network topology topology view conceptually directed graph router represents node topology graph link neighboring routers represents unidirectional edge link also associated weight administratively assigned configuration file router using weighted topology graph router computes shortest path tree root applies results build forwarding table assures packets forwarded along shortest paths terms link weights destinations 11 refer computation shortest path tree spf computation resultant tree spf tree scalability ospf domain may divided f cborder router border router112 area 2115 f ospf domain g f fig 1 left right figure depicts example ospf topology view topology router g shortest path tree calculated g though show ospf topology undirected graph simplicity reality graph directed areas determining two level hierarchy shown figure 1 area 0 known backbone area resides top level hierarchy provides connectivity nonbackbone areas numbered 1 2 ospf assigns link exactly one area routers links multiple areas called border routers example routers c g border routers figure 1 every router maintains separate copy topology graph area connected router performs spf computation topology graph thereby learns reach nodes areas connected general router learn entire topology remote areas ie areas router links instead learns weight shortest paths one border routers node remote areas thus computing spf tree area router learns border router use intermediate node reaching remote node ad dition reachability external ip prefixes associated nodes outside ospf domain injected ospf x figure 1 roughly reachability external prefix determined prefix node linked router injects prefix ospf link state advertisements lsas routers running ospf describe local connectivity link state advertisements lsas lsas flooded reliably routers network routers use build consistent view topology described earlier flooding made reliable mandating router acknowledge receipt every lsa receives every neighbor flooding hopbyhop hence depend routing set lsas routers memory called link state database conceptually forms topology graph router worth noting term lsa commonly used describe ospf messages entries link state database lsa essentially two parts identifier three parameters uniquely define topological element eg link network b rest contents describing status topological element ospf uses several types lsas describing different parts topology every router describes links neighboring routers given area router lsa router lsas flooded within area thus said arealevel flooding scope thus border router originate separate router lsa every area connected example router g figure 1 describes links e f area 0 router lsa links h area 2 router lsa ospf uses network lsa describing routers attached broadcast network eg ethernet lans lsas also arealevel flooding scope section iib describes ospf operation broadcast networks detail border routers summarize information one area another originating summary lsas summary lsas routers learn nodes remote areas example information flooding scope router routers ospf links belonging area area network routers attached broadcast network area summary nodes remote areas reachable border router area external external prefixes reachable asbr domain lsa taxonomy router g figure 1 learns b summary lsas originated c summary lsas arealevel flooding scope mentioned earlier ospf allows routing information imported routing protocols eg rip eigrp bgp router imports routing information protocols ospf called border router asbr asbr originates external lsas describe external routing infor mation figure 1 routers learn x external lsas originated asbr external lsas flooded entire domain irrespective area boundaries hence domainlevel flooding scope table summarizes taxonomy ospfs lsas change network topology requires affected routers originate flood appropriate lsas stance link two routers comes two ends originate flood router lsas new link included moreover ospf employs periodic refresh lsas even absence topological changes every router periodically flood selforiginated lsas default value refresh period minutes refresh mechanism jittered driven timer expiration due reliable flooding lsas router receive multiple copies change refresh triggered lsa term first copy received router new copies subsequently received du plicates note lsa types introduced table orthogonal refresh change triggered lsa new versus duplicate instances lsa b ospf operation broadcast network noted introduction enterprise network makes extensive use ethernet lans provide broadcast capability ospf represents broadcast networks via hubandspoke topology one router elected designated router dr dr originates network lsa representing hub describing links repre senting spokes routers attached broadcast network provide additional resilience routers also elect backup designated router bdr becomes new dr dr fails ospf flooding broadcast network two step process 1 router attached network sends lsa dr sending special multicast group drrtrs dr bdr listen group 2 dr turn floods lsa back routers network sending another special multicast allrtrs routers network listen group bdr participates drrtrs group remain sync dr however bdr flood lsa allrtrs unless dr fails iii enterprise network instrumentation section first describe ospf topology enterprise network used case study describe ospf monitoring system deployed network collecting lsas providing realtime monitoring ospf network enterprise network topology enterprise network provides highly available reliable always connectivity customers facilities applications databases residing data center see figure 2 network designed provide high degree reliability faulttolerance customer premise routers connected data center routers via leased lines instance eigrp runs endpoints leased line routers data center form ospf domain focus pa per customer reachability information learnt via eigrp imported external lsas ospf domain domain consists cisco routers switches scal ability ospf domain divided 15 areas forming hubandspoke topology servers hosting applications databases connected area 0 backbone area whereas customers connected routers nonbackbone areas certain details topology nonbackbone areas relevant analysis figure 3 shows topology nonbackbone area two routers termed b1 b2 connected areas backbone area every nonbackbone area serve ospf border routers nonbackbone area 50 routers shown figure area consists two ethernet lans routers area connected lans routers b1 b2 connections lans provide interconnection two lans routers area connected exactly one two lans ospf domain data center customersite applications customersite servers customersite customersite customersite fig 2 enterprise network topology routers area customerpremise router routers external eigrp border rtr border rtr r r fig 3 structure nonbackbone ospf area areas connected via two border routers b1 b2 since customerpremise routers eg r 0 figure 3 part ospf domain data center routers part eigrp domain routes one protocol injected ensuring connectivity thus router r area figure 3 connected customer router r 0 injects eigrp routes ospf external lsas route injection ospf carefully controlled configuration b ospf monitoring architecture ospf monitor consists two basic components lsars lsa reflectors lsags lsa aggregators 4 design lsars extremely simple devices connect directly network capture ospf lsas reflect lsag processing case study lsars connect lans join appropriate multicast groups receive lsas least one lsar connected area study point point deployment lsars form partial adjacencies adjacencies fall short full ospf adjacencies sufficient receive ospf traffic lsars speak enough ospf capture ospf lsa traffic however design rules possibility lsar getting advertised potential use routing regular traffic code complexity concentrated lsags case study deployed single lsag network lsars reliably feed lsas lsag aggregates analyzes lsa stream provide realtime monitoring fault management capability lack space paper go details monitoring system architecture deployed three lsars one lsag running four linux servers lsar number interfaces connected different areas lsars currently monitor area zero seven nonbackbone areas covering total 250 routers lsars connected lans configured monitor lsas sent multicast group allrtrs one advantage approach lsar establish adjacencies routers remains completely passive invisible ospf domain since lsar listens group allrtrs lsa traffic seen essentially identical seen regular ie nondr nonbdr router lan iv results carried following steps analyze lsa traffic ffl baseline analyze refreshlsa traffic baseline protocol dynamics arising soft state refresh specifically predict rate refreshlsa traffic information obtained router configuration files carry timeseries analysis finer time scale characteristics ffl analyze fix anomalies take closer look changelsa traffic identify root causes operational setting heavyhitter root causes correspond failure modes identifying failure modes incipient stages enables proactive maintenance ffl analyze fix protocol overheads take closer look duplicatelsa traffic identify root causes identify configuration changes reducing traffic get general sense nature observed lsa traffic consider figure 4 figure shows number refresh change duplicate lsas received per day april 2002 four ospf areas ospf areas monitored exhibited similar patterns behavior first note refreshlsa traffic roughly constant throughout month areas small dip refresh traffic april 7 statistical artifact due rolling clocks forward one hour switch number lsas day number lsas per day april 2002 refresh lsas change lsas duplicate lsas2000600010000 number lsas day number lsas per day april 2002 refresh lsas change lsas duplicate lsas area 0 b area 210003000500070009000 number lsas day number lsas per day april 2002 refresh lsas change lsas number lsas day number lsas per day april 2002 refresh lsas change lsas duplicate lsas c area 3 area 4 fig 4 number refresh change duplicate lsas received lsar day april daylight savings time second four areas show differences change duplicatelsa traffic backbone area area refreshlsa traffic two orders magnitude greater change duplicate lsa traffic nonbackbone areas similar physical topologies show markedly different change duplicatelsa traffic area 2 changelsa traffic significant though duplicatelsa traffic negligible area 3 note significant duplicatelsa traffic negligible traffic finally area 4 saw negligible traffic change duplicate lsas reasons variations lsa traffic patterns become apparent sections vi vii v refreshlsa traffic predicting refreshlsa traffic first let us consider determine average rate nr refreshlsas received given router r purposes calculation assume set lr unique lsaidentifiers router rs linkstate database constant network elements introduced withdrawn use term lsa interchangeably lsaidentifier let f l denote average rate refreshes given lsa l linkstate database l2lr f l 1 let denote set lsas originated routers ospf domain l set routers receive given lsa l set lr expressed together eq 1 determines nr thus see estimating refreshlsa traffic router requires determining three parameters ffl set lsas originated routers ospf domain ffl lsa l l set routers receive l ffl lsa l associated refreshrate f l l next describe estimate three parameters configuration files routers number lsas day number lsas per day april 2002 refreshlsas actual number lsas day number lsas per day april 2002 refreshlsas actual refreshlsas expectedconfig area 2 b area 3 fig 5 expected refreshlsa traffic versus actual refreshlsa traffic two ospf areas a1 parameter determination determine possible use information available router configuration files particular hard count exact number internal lsas using configuration files example router configuration file specifies ospf area associated interface router derive number router lsas given router originates counting number unique areas associated routers interfaces hand impossible estimate exact number external lsas configuration files general number external lsas depend prefixes dynamically injected ospf domain however one use heuristics determine external lsas using filtering clauses configuration files control external route injection calculating parameter l lsa l equivalent counting routers flooding scope l count easily determined constructing ospf topology area structure configuration files estimate refreshrate f l lsa l crude option use recommended value 30 minutes ospf specification 12 practice better estimates obtained combining configuration information published information router vendors refresh algorithm determined three parameters networks router configuration files using automated router configuration analysis tool netdb 13 specifically computed set router network summary external lsas estimated external lsas using heuristic every external prefix explicitly permitted via configuration fact injected external lsa turned heuristic underestimated number external lsas 10 owing injection morespecific prefixes present filters within configuration files refreshrates tool first determined operating system version router configuration files consulted table refresh rates using operating system version index table populated information published vendor website 14 15 figure 5 shows expected refreshlsa traffic per day versus actual number lsas received lsar two areas clearly actual refreshlsa traffic predicted b timeseries analysis section report timeseries analysis refreshlsa traffic analysis revealed traffic periodic expected recently paper basu riecke 3 suggested lsa refreshes different routers could become synchronized tested hypotheses found refresh traffic synchronized across different routers b1 periodicity refreshlsa traffic timeseries analysis revealed routers fall two classes ffl first class refreshperiod minutes exhibits strong periodic behavior ffl second class refreshperiod 33 min utes jittered refresh pattern turned analysis picked differences refresh algorithms associated different releases router operating system specifically first class routers ran ios 11 111 112 whereas second class routers ran ios 12 120 121 122 ospf implementation ios 11 follows simple refresh freqency cycles per hour lsas per minute fig 6 refreshlsa traffic routers running ios 11 upper graph shows timeseries hours typical day lower graph shows powerspectrum analysis timeseries strategy router scans ospf database every minutes refreshes lsas reflooding network 15 figure 6 shows example timeseries obtained binning lsas sampling intervals size 1 minute horizontal line upper graph shows average lsa rate based bins seems obvious graph periodicity timeseries test determine period plot power spectrum timeseries lower graph figure based longer 1 week sample data power spectrum shows distinct peak frequency 2 cycles per hour period subsequent peaks harmonics distinct peak conclude timeseries shows strong periodicity refresh algorithm underwent change ios 113 introduced 15 router running ios 12 timer expires every refreshint seconds upon expiry timer router refreshes lsas whose last refreshtime refreshint configurable default 4 min utes furthermore timer jittered since routers enterprise network use default expect refresh interval 32 minutes smallest multiple 4 greater minutes effect seen upper graph figure 7 shows lsa refresh pattern routers running ios 12 power spectrum lower graph figure shows data strong component 179 cycles per hour roughly 33 minutes expected correspondingly chosen bin size data 67189 seconds minimize aliasing results notice freqency cycles per hour lsas per minute fig 7 refreshlsa traffic routers running ios 12 upper graph shows timeseries hours typical day lower graph shows powerspectrum analysis timeseries considerably noise spectrum due jitter algorithm b2 synchronization refreshlsa traffic suggested lsa refreshes likely synchronized undesirable consequence sent nearly simultaneously creating burst lsa traffic router 3 analyze refreshlsa traffic see bursty traffic appears general burstiness lsa traffic received router depends two things ffl burstiness refreshlsa traffic originated single router ffl synchronization refreshlsas originated different routers observed lsas originated single router usually clumped together refresh ios 11 expected since router refreshes lsas expiry single timer even ios 12 observed lsas originated single router clumped together specifically summary external lsas originated routers tend refreshed big bursts explains periodic spikes seen figures 6 7 next consider refreshlsas coming different routers interact recent paper 3 suggested lsa refreshes different routers likely syn chronized mechanism creates synchronization related startup routers however general network related phenomena synchronization real problem forces driving system toward synchronization case example see 16 17 synchronization occurs result dynamics system pushing towards time period1800 seconds number routers time periods2015 seconds number routers b ios 11 b ios 12 fig 8 number routers whose lsas received within one second intervals lsar one refresh cycles routers belong area 8 synchronization similar manner huygens clock synchronization problem 18 understand synchronization real problem system pushed towards consider real network would rare routers network rebooted simultaneously time though individual links routers added dropped restarted time topology changed way little part synchronization broken larger network often topology changes occur synchronization broken quickly cases might cause problems furthermore always small drift periodic signal drift breaks synchronization time moreover weak coupling 16 ospf lsa refresh process ie lsas generation router driven routers finally addition jitter ios 12 onwards quickly removes synchronization routers force driving system towards synchronization unlikely seen outside simulations enterprise network observed refresh traffic different routers strongly synchronized figure 8a b show number routers area 8 whose lsas received lsar one second interval duration typical refresh cycle neither graphs display evidence strong synchronization routers also performed stastical tests show least time scales minute lsa traffic different routers synchro nized appears uniformly distributed minute refresh period larger time scales apparent weak correlation see clustering routers 075 figure 8a degree correlation seen practical importance even statistical anomaly area 8 chosen contained good mix routers ios 11 12 areas show similar characteristics vi changelsa traffic figure 4 shows areas receive significant changelsa traffic section first classify lsas whether indicate internal external changes look underlying causes internal changes conveyed router network lsas within area change occurs summary lsas outside area external changes conveyed external lsas figure 9 shows number change lsas month april figure provides curves selected areas accounting 99 corresponding lsa traffic april figure 9 shows external changes constitute largest component changelsas generated net work external changes area 2 dominate seen areas figure 9c among internal changes occurred area 0 figure 9a internal changelsas area 0 propagated areas since network configured allow summary lsas representing default route 00000 nonbackbone areas spike figure 9b due border router withdrawing reannouncing summary lsas root cause analysis saw area 0 accounted internal changes seen april turns almost changes due internal error crucial router area 0 router dr lans area 0 error would episodes lasting minutes problematic router would drop reestablish adjacencies routers lan accordingly flurry changelsas gener fchange lsas day number change lsas router area 5 number change lsas day number change lsas summary per day april 2002 number change lsas day number change lsas external per day april 2002 area 6 router network lsas b summary lsas c external lsas fig 9 changelsa traffic day april graph shows areas together account 99 changelsa april example areas 0 1 2 6 account 99 external number lsas day number lsas per day april 2002 router network lsas area 0 router network change lsas area 0 change lsas due problematic router2060100140 number lsas hour number lsas per hour april 16 2002 router network lsas area 0 router network change lsas area 0 change lsas due problematic router entire april b april 16 fig 10 effect problematic router number router network lsas area 0 ated episode episode lasted minutes episodes day data suggests episodes network risk partitioning fact partitioned april episodes account 99 total internal changelsas observed area 0 figure 10a shows number router network lsas day april figure 10b shows statistic hour one days area 0 witnessed episodes april 19th acting data gathered ospf monitor operator changed configuration problematic router prevent becoming dr rebooted result network stabi lized changes area 0 topology vanished inter estingly illustrates potential ospf monitoring localizing failure modes proactively fixing network serious failures occur figure 9c shows among areas area 2 witnessed maximum number external changes april large percentage changes caused flapping external link one routers call area 2 maintains link customer premise router call b runs eigrp mentioned section iiia router imports 4 eigrp routes ospf 4 external lsas closer inspection network conditions revealed eigrp session b started flapping link b became overloaded leads router repeatedly announcing withdrawing eigrp prefixes via external lsas flapping link b happened nearly every day april 9 pm 3 link flaps accounted 82 total external changelsas 99 total external changelsas witnessed area 2 time writing paper network operator still looking ways minimizing impact external eigrp flaps without impacting customers connectivity performance vii duplicatelsa traffic section iv remarked area 3 received significant duplicatelsa traffic almost 33 total lsa traffic area hand area 2 saw negligible duplicatelsa traffic since processing duplicate lsas wastes cpu resources important flsas day number lsas per day april 2002 total lsas area 2 total change lsas area 2 total change lsas due flappers20060010004 8 12 number lsas hour number lsas per hour april 11 2002 total lsas area 2 total change lsas area 2 total change lsas due flappers entire april b april 11 fig 11 effect flapping external link area 2 external lsas stand circumstances lead duplicatelsa traffic areas others see detailed analysis ospf control plane connectivity explains variation duplicate lsa traffic seen areas 2 3 leads configuration change would reduce duplicate lsa traffic area 3 general believe analysis provide operational guidelines lowering level duplicate lsa traffic cost small tradeoffs network responsiveness causes duplicatelsa traffic enterprise network study areas identical physical connectivity thus initially came surprise one area saw significant duplicatelsa traffic another area turns though areas identical physical structure difference lsas propagate areas gives rise differences observed duplicatelsa traffic recall areas lanbased dr bdr behave differently routers lan described section iib dr bdr send lsas routers monitoring systems lsar lan whereas routers send lsas dr bdr thus lsa propagation behavior lan depends strongly routers play role dr bdr routers connected rest network analysis rather intricate recall every area two lans lsar attached one lans let us denote lan lsar resides lan 1 lan lan 2 recall b1 b2 connected lans routers connected one lans denote b1 b2 bpair rest routers lan1 router lan2router based lan routers reside since bpair routers connected lans role play lan 1 dr bdr regu lar important determining whether lsar receives duplicatelsas indeed bpair routers difference role areas 2 3 gives rise different duplicatelsa traffic two areas arrive four cases based roles bpair routers play lan 1 case 1 fdr bdrg case 2 fdr regularg case 3 fbdr regularg case 4 fregular regularg understand cases leads duplicatelsa traffic lan 1 given area model lsa propagation lan 1 controlplane diagram figure 12 diagram shows links routers send lsas addition figure shows one copies lsa l may propagate lsar via bpair routers suppose lsa l originated lan2router bpair routers receive copies l lan 2 interfaces propagate lsa lsar lan 1 denote copies l propagated via b1 b2 l1 l2 respectively figure 12 figure makes clear cases 1 3 lead duplicatelsas whereas cases 2 4 table ii shows cases encounter different areas note area 3 encounters case 3 whereas area 2 encounters case 2 explains area 3 receives duplicate lsa traffic area 2 note cases 1 3 whether lsar actually receives multiple copies lsa l depends lsa arrival times various routers example consider case 1 whether bpair routers send lsa l lsar depends order lsa arrives two routers least one bpair routers case 1 b case 2 l1 l2 case 4 c case 3 lsar lsar lsar lsar fig 12 controlplane diagram lan 1 different roles played bpair routers figure also shows different copies lsa l arrive lsar via bpair routers l1 l2 copies lsa l area dr lan 1 bdr lan 1 case area 4 b2 lan 1 rtr case 2 area 5 b2 b1 case 1 area 6 b2 b1 case 1 area 8 lan 1 rtr b2 case 3 ii dr bdr lan 1 various areas must send lsa lsar lan 1 however whether router also sends lsa lsar depends order lsa arrival router router receives lsa lan 2 first sends lsa lsar resulting duplicate seen lsar hand router receives lsa lan 1 first send lsa lsar case lsar receive duplicatelsa similar argument made regarding case 3 summarize lsa originated lan2router may get duplicated lan 1 cases 1 3 arrives particular order different routers figure 13 shows number duplicatelsas originated various routers two representative areas duplicate lsas seen lsar originated lan2routers bpair routers lsar see duplicate lsas lsas originated lan1router irrespective router dr bdr lan 1 lsar receives single copy lsa originated lan1router dr figure 14 shows fraction total lsas originated lan2routers duplicated figure indi cates even cases 1 3 duplicate susceptible lsas actually duplicated observed within given area percentage lsas originated lan2routers become duplicated remains roughly constant days however percentage varies widely across areas understanding behavior requires understanding finer time scale behavior routers volved ongoing work number duplicate lsas day number duplicate lsas per day april 2002 total duplicate lsas lan2routers total duplicate lsas b1 total duplicate lsas b2 total duplicate lsas number duplicate lsas day number duplicate lsas per day april 2002 total duplicate lsas lan2routers total duplicate lsas b1 total duplicate lsas b2 total duplicate lsas lan1routers area 3 case fig 13 duplicatelsa traffic various routers b avoiding duplicatelsas uncovered causes duplicatelsas explore ways reduce volume enterprise network operator avoid duplicatelsas force case 2 4 controlling router becomes dr andor bdr lan 1 depends complex election algorithm executed routers lan input algorithm priority parameter configurable interface router higher priority greater chance winning election though priorities provide partial control result operator cannot force case 2 apply even network operator assigns highest priority one bpair zero priority routers lan 1 guarantee high priority router become dr fortunately operator force case 4 apply ensuring neither bpair routers become dr bdr lan 1 accomplished setting priority two routers 0 become ineligible become dr bdr 12 whether forcing case 4 sensible depends least two factors first dr bdr play important role lan bear greater ospf processing load regular routers lan therefore operator ensure suitable routers taking account load hardware capabilities become dr bdr second factor subtle typically reducing duplicatelsas requires reducing number alternate paths lsas take reliable flood ing increase lsa propagation time turn increase convergence time case lsas originated lan 2 undergo extra hop routers lan 1 receives means lsa propagation time may increase fraction day fraction lan 2 lsas get duplicated april 2002 area 3 area 6 area 8 fig 14 fraction lsas originated lan2routers get duplicated case 4 forced viii conclusions paper provided case study ospf behavior large operational network specifically introduced methodology ospf traffic analysis treating lsa traffic generated softstate refresh topology change redundancies reliable flooding turn provided general method predict rate refresh lsas router configuration information found measured refreshlsa traffic rates matched predicted rates also looked finer time scale behavior refresh traffic refresh period different routers conformance expected behavior ios versions though lsas originated single router tend come bursts found evidence synchronization across routers may reduce scalability concerns would arise refresh synchronization present leading spikes cpu bandwidth usage found lsas indicating topology change mainly due external changes unexpected since network imports customer reachability information ospf domain prone change customers added dropped connectivity changed moreover since customers connected leased lines reachability information likely volatile internal external topology changes persistent partial failure modes produced vast majority change lsas associated flapping links interest ingly internal changelsa traffic pointed intermittently failing router leading preventative action protect network fair say time new way view networks introduced route monitoring case new phenomena observed leading better network visibility control though wider studies needed suspect persistent partial failure modes typical development strategies stabilizing ospf would benefit focusing modes study observe instance networkwide meltdown networkwide stability also investigated nature duplicate lsa traffic seen network analysis led simple configuration change reduces duplicate traffic without impacting physical structure network findings case study specific enterprise network duration study similar studies ospf networks enterprise isp studies longer durations needed enhance understanding ospf dynamics forms part future work furthermore isp setting intend join ospf bgp monitoring data analyze interactions protocols another direction future work develop realistic workload models ospf emulation test simulations methodology predicting refreshlsa traffic first step direction workload models also used conjunction work ospf processing delays single router 5 investigate network scalability acknowledgments grateful jennifer rexford matt grossglauser comments paper thank russ miller encouragement guidance operational deployment finally thank anonymous reviewers comments r routing internet one rogue switch buckle atts net work stability issues ospf rout ing opsf topology server design evaluation experience blackbox ospf measurement experimen tal study internet stability widearea network failures toward millisecond igp convergence isis routing qwest backbone recipe subsecond isis convergence internet routing stability origins pathological internet routing instability ospf version 2 ip network configuration intradomain traffic engineering cisco systems ospf lsa group pacing synchronization periodic routing messages oscillations chaos flow model switching system tr synchronization periodic routing messages internet routing instability routing internet 2nd ed stability issues ospf routing experience blackbox ospf measurement ospf ctr renata teixeira aman shaikh tim griffin jennifer rexford dynamics hotpotato routing ip networks acm sigmetrics performance evaluation review v32 n1 june 2004 aman shaikh albert greenberg ospf monitoring architecture design deployment experience proceedings 1st conference symposium networked systems design implementation p55 march 2931 2004 san francisco california aman shaikh rohit dube anujan varma avoiding instability graceful shutdown multiple ospf routers ieeeacm transactions networking ton v14 n3 p532542 june 2006 yin zhang matthew roughan carsten lund david l donoho estimating pointtopoint pointtomultipoint traffic matrices informationtheoretic approach ieeeacm transactions networking ton v13 n5 p947960 october 2005 yin zhang matthew roughan carsten lund david donoho informationtheoretic approach traffic matrix estimation proceedings conference applications technologies architectures protocols computer communications august 2529 2003 karlsruhe germany ruoming pang mark allman mike bennett jason lee vern paxson brian tierney first look modern enterprise traffic proceedings internet measurement conference 2005 internet measurement conference p22 october 1921 2005 berkeley ca yin zhang zihui ge albert greenberg matthew roughan network anomography proceedings internet measurement conference 2005 internet measurement conference p3030 october 1921 2005 berkeley ca haining wang cheng jin kang g shin defense spoofed ip traffic using hopcount filtering ieeeacm transactions networking ton v15 n1 p4053 february 2007