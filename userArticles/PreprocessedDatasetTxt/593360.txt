excluding symmetries constraintbased search introduce new method called isymmetry excluding search ses excluding symmetries constraint based search knowledge first declarative method applied iarbitrary symmetries sesmethod based notion symmetric constraints used modification general constraint based search algorithm method influence search strategy furthermore used either full set symmetries subset symmetrieswe proof correctness completeness symmetry exclusion properties method show apply sesmethod special case geometric symmetries rotations reflections permutation symmetries furthermore give results practical applications b introduction many search problems one faced existence symmetries symmetries give rise many dierent solutions found search procedure considered similar often one interested also getting symmetric solutions every found solution without exclusion symme tries whenever solution found proven inconsistent search problem search algorithm still considers symmetric solutions symmetries give rise often exponential amplication search space hence symmetry exclusion promises eciently prune search tree eg consider constraint problems nite domain variables geometric interpretation nqueens problem squaretiling problem set squares given sizes must exactly xed square complex realworld problem lattice protein structure prediction problem 2 shown nd solutions problem using constraint programming techniques case dierent solutions symmetric generated using ections rotations problems symmetric solutions generated performing permutations variables valuations like map coloring graph coloring problem following consider search problems stems constraint satisfaction problems csp common approach transform problem specif ically csp c 1 csp c 2 excludes least symmetries original problem c 1 unfortunately symmetry exclusion often straightforward imple ment even redesigned every special problem enumeration strategy leaded exibility program structure introduced thus widespread usage symmetry exclusion strongly hindered complexity often symmetry exclusion done small set symmetries cases symmetry exclusion implemented distracted programmers attention important tasks paper present new approach symmetry exclusion works modifying search algorithm technique modifying search algorithm exclude symmetries already used literature contrast known approaches approach knowledge rst declarative method applied arbitrary symmetries dened declar atively furthermore restrict search strategy ie symmetry exclusion done independently search strategy important since many constraint problems major part knowledge problem encoded search strategy implemented method concurrent constraint programming language oz 10 using programmable search engine described 9 method implemented system handles implication via allows modify search procedure additional constraints added one branch branching step related work previous work symmetry exclusion modifying search algorithm handled restricted forms symmetries 7 notion interchangeable values introduced two values b interchangeable variable v every solution maps v corresponding valuation maps v b also solution method 3 handles permutations domain values case binary constraints thus eg alldistinct constraint translated binary inequalities implies ecient propagation methods distinct cannot applied furthermore works introducing symmetry excluding form constraint propagation modied form domain propagation thus method cannot make use interval propagation 1 4 consider propositional calculus symmetries permutations boolean variables methods apply general constraint satisfaction problems symmetry exclusion algorithm presented 8 essentially implementation application method solve practical problems compared greater detail section 3 example symmetry exclusion method works problem specic transformation constraint satisfaction problem 5 introduce symmetry breaking predicates true smallest solution within equivalence class ordering xed advance thus search strategy encounters nonminimal according prexed ordering solution rst excluded symmetry breaking predicates implies every search strategy possible given prexed ordering contrast prexed ordering symmetrical solutions excluded method implies respect useddened search strategies much possible 1 overview paper start introductory example explaining basic ideas method preliminaries present formal de nition wells completeness correctness proofs section 3 additionally show method guarantees exclude specied symmetries proofs indicate subset symmetries enough exclude complete symmetry group section 4 treat geometric symmetries show dene symmetric constraints present results applying problem complex problem section 5 consider symmetries generated permuting values variables eg symmetries occur graph coloring problem proof case sucient exclude subset transposition order exclude permutations fur thermore present results applying method random instances graph coloring introductory example start simple example explain main concepts consider nqueens problem array q1n whose elements take values 1n states queen position j consider symmetry corresponding ection axis 2 parallel xaxis sequel denoted rx clearly every solution nqueens rxsymmetric version also solution nqueens hence want exclude symmetric solutions use method rst introduce symmetric versions constraints inserted search procedure one kind constraint j distribution queens board satisfying j rxsymmetric distribution satisfy j hence constraint rxsymmetric version constraint similarly get rxsymmetric constraint qi j qi n j following write rx c denote rxsymmetric constraint c method works adding additional constraints right branches search tree exclude symmetric solutions encountered right branch consider following search tree 10queens problem indicate constraints added symmetry exclusion via frames clearly search strategy depends constraint store method symmetry exclusion prunes search tree must uence way solutions encountered since constraint store changed symmetry exclusion interpreted intuitively follows topmost branch search solution right branch satisfying q1 5 rxsymmetric solution satisfy q1 5 hence symmetric solution already encountered earlier left branch q1 5 reason close topmost right branch second right branch labeled q2 6 3 want exclude rxsymmetric solutions found right branch hence would like add constraint rx right branch would exclude many solutions prerequisite rxsymmetric solution found right branch solution rxsymmetric version satises q1 5 solutions satisfying conditions solutions satisfy 5 hence add condition 5 exactly eect achieve adding second right branch since constraint store contains already q1 5 preliminaries x rstorder signature including equality set variables constraints literals constraint formulae quantierfree formulae identify c denotes set constraints set constraints c c interpreted conjunction constraints contained c freely mix set notation conjunction set free variables c denoted vc x standard interpretation domain describes constraint theory following assume xed constraint set c pr describing problem solved assignment partial function say possible partial assignment satises short total assignment 0 0 j write every constraint set c syntactically determines set variables x assignment x 2 x exists x many problems one interested subset variables whose valuations uniquely determine valuation auxiliary variables captured denition solution variables denition 1 solution variables let x v set variables x solution variables set c 9 exists unique satisfying short solution variables set x say x solution c denote set x solutions c following x x hence use term solution short x solution c write kck short kck x denition 2 symmetry symmetry c pr bijective function symmetry set c pr set symmetries operating kc pr k symmetry group symmetry set c pr group note every symmetry c pr also 1 symmetry c pr denote identity function kc pr k id cpr symmetry def inition clearly set symmetries c pr group many cases want consider symmetries since either many intuitive characterization case consider subset symmetries may group 3 symmetry excluding search trees dene notion search tree need symmetry exclusion describe eects applying constraint solver constraint set c function p c returns closure c constraint propagation clearly p c jj c usually search tree labeled tree nodes labeled constraints constraint store edges labled constraints negated constraints single node v form c c store root node labeled p c pr additionally need symmetry exclusion store node v positive negative constraints used along path root v generate node v denition 3 search tree let nite binary rooted ordered tree whose egdes labeled literals whose nodes labeled triples constraint sets tree search tree c pr following conditions 1 root node label p c pr 2 every binary node form store c c store c l store store intuitively reason distinguishing positive negative constraints cn describes previously found solutions ie denote partial ordering nodes induced note force c l store resp c r store equivalent c store c resp c store c reason add additional constraints search excluding symmetries since c store describes constraints valid node v set node v label state general properties search tree presence symmetries denition 4 expanded c pr complete sreduced trees search tree completely expanded every unary node either determines x search tree c pr complete every 2 kc pr k leaf v symmetry set c pr search tree c pr complete wrt every leaf v search tree sreduced every leaf v note 1 equivalent 8s 2 8v 0 closed inversion show produce sreduced search tree c pr complete wrt rst dene symmetries operate constraints following assume every constraint c every constraint c 0 sets c pr solutions ag every c usually dierent constraints c 0 k hence x function con constraints ks con ck next sections give examples construct function proposition 1 let con dened con distributes boolean operators ie kcc 0 ks con cs con ks con c ks con ck hence identify con homomorphic extension constraint sets arbitrary formulae state general mechanism generating search tree sreduced denition 5 sexcluding let symmetry set search tree c pr sexcluding every binary node v form store c c store c l prove sreducedness c pr completeness wrt sexcluding search trees state proposition precise eect adding implications denition 5 c r store convenience write c v store access store label c store v binary node v refer left child v l right child v r proposition 2 let symmetry set sexcluding search tree every symmetry 2 every node v c v store con c v notational convenience introduce notation c path c pr good intuition think c path v describing constraint store v simple symmetry excluding search tree reducedness completeness essentially corollaries following proposition lemma 1 let symmetry set every sexcluding search tree c pr satises every node v v proof proof tree induction root valid since v vk assume proven claim binary node v store c c store left child v l claim follows immediately induction hy potheses since v l v r show kv r note vr subdivides two subsets v kg according denitions c path v r equivalent c path v c show kv r k kc path v ck vr show every v 0 v rst case v 0 v let 2 kc path v 0 k 62 kvk induction hypotheses since kv r k kvk immediately implies 62 kv r k second case v 0 6 v v 0 v r ie v 0 subnode v l let k 2 kv l k con c p c thats contradiction denition sexcluding search tree remains shown kv r k kc path v r k vr let 62 kv r k show 62 kc path v r k vr following cases 1 62 kc path v r k 3 follows immediately 2 2 kc path v r k 62 kvk show 2 vr 2 kc path v r k implies 2 kc path vk henceforth 2 v induction hypotheses 3 2 kc path v r k 2 kvk show since store least one 2 6j c denition sexcluding tree fix one symmetries proposition 2 get hence 1 exists denition symmetries satises 1 c path valuation 2 kc path v l k shows set dened 4 theorem 1 let symmetry set every sexcluding search tree c pr sreduced proof fix symmetry 2 let v leaf fg show every node v 0 v 0 v kv 0 v 0 node v 0 v kv follows contradiction 62 kvk lemma 1 understand sexcluding search tree may exclude symmetries actually declared directly hence investigate completeness property sexcluding search trees theorem 2 let symmetry set every sexcluding search tree c pr c pr complete wrt 0 0 closure composition inversion proof show c pr complete wrt 0 0 closure composition ie every 2 kc pr k leaf v hence x 2 kc pr k exists leaf v 0 2 kc path v 0 k denition 5 two cases 1 2 kv 0 k yields immediately kv 5 proven 2 62 kv 0 k lemma 1 follows 2 v 0 1 2 path v 00 k induction get sequence symmetries leaf v n1 since 0 closure claim 5 follows given example symmetry excluding search trees secion 5 symmetrie group permutation excluded subset transpositions indicated theorem able give detailed comparison 8 sbds method therein essential symmetry exclusion restricted case search tree branches constraints form v ar al case constraint collected c p form v ar c p partial assignment restricted sbdsmethod consider case symmetry dened permutation rst al n node v search tree branches v ar al constraint added method excluding symmetry v ar denition ar antecedence nothing else test whether leaves c p ie partial assignment node v unchanged thus entailment evaluated removed directly right subnode v restricted sbds method essentially replaces entailment test test whether symmetry leaves assignment unchanged symmetries excluded test decided node corresponding implication would integrated method even corresponding implication would delay test later point note implementation symmetry exclusion add implications form con c v search procedure hence one change search procedure implementing symmetry exclusion antecedents implications computed search eciently using observation antecedences added implications ancestor nodes prexes ones added ospring precise let v node branches constraint c let v l resp v r left resp right daughter con c v l therefore computation condition con c p done incrementally maintain boolean variables reason implementation need one variable symmetry containing values con c p 4 geometric symmetries give concrete example symmetries namely geometry symme tries treat special case points z although method restricted case exemplify symmetry constructions two dimensions give example exclusion additional symmetries indicated theorem 2 denition geometric symmetries many problems one encodes twodimensional position object using nite domain integer variables examples nqueens tiling problem complex realistic example three dimensions lattice protein structure prediction problem 2 symmetries z 2 exactly structure general case z dened ane mappings map z onto z ie matrix orthogonal matrix property set columns fv equals fe j e unitvector z g eg z 2 matrix 0 1 denotes rotation 90 z 2 8 symmetries consisting identity 4 ections x yaxis two diagonals 3 rotations 90 180 270 z 3 48 symmetries including identity vector v yet xed two dierent approaches xing symmetry consider z 2 example methods work dimensions well rst case every possible solution lies within xed square general case within hypercube 2 equivalent proposition integers xmin 2 kc pr k 2 technique extended case hypercube xed advance thus minimal square around position objects dened points every solution call frame problem c pr nqueens problem board knowing frame problem c pr x vector v symmetries consider example problem whose frame dened 0 3 2 furthermore consider three symmetries ection yaxis rotation 90 rotation 180 name 1 2 3 following corresponding mappings dened matrices as1 as2 as3 dened corresponding mappings frame symmetry compatible dened frame frame mapped ie fv j 0 2g given matrix exists v condition satises 3 matrices as1 as2 as3 get 3 2 2 3 3 2 excludes symmetry characterized as2 nally get second case know point remain unchanged symmetries case know symmetries dened p remaining part dene symmetric constraints use specic example leave point 5 5 x consider two symmetries ection yaxis rotation 90 said corresponding mappings suppose modeled points using variables want dene ry con 90 con constraints kind constraints c denition con c analo gous symmetric constraints ry con con must express constraint valid ry resp 90 every possible restrict valuation know ry con con analagously get ry con 90 con note ry c type c ie variable hold c 90 c turn example exclude one symmetry exclusion method excludes compositions symmetry shows cases symmetry exclusion method excludes symmetries contained symmetry set indicated theorem 2 use articial example show existence case example 1 let c pr geometric constraint problem variables xy x domain 010 associated furthermore suppose c pr 6 6 solution apply rotational symmetries x point 5 5 implies 4 4 4 also solutions c pr consider following sexcluding search tree constraints added symmetry exclusion framed box solution 4 6 rotated 90 excluded symmetry exclusion 1 furthermore solution 4 excluded 2 symmetry exclusion method 6 rotated 180 hence although contains 90 symmetry 180 90 excluded method note 6 4 6 rotated 270 excluded may found 2 clearly case geometric symmetries full symmetry group usually small enough include symmetries wanted show eects excluding subset full symmetry group using simple example next section permutation give example exclusion transpositions allows exclude permutations results applied method lattice protein structure prediction 2 hard combinatorical problem following table shows number solutions search steps runtimes nding minimal energy structures 4 sequences rst case without symmetry exclusions symmetry exclusion second part without sym excl sym excl ratio seq length noex nnoex tnoex ex nex tex noex ex nnoex nex ex added simple exclusion methods cases reason 16 instead 48 symmetries left s1 s2 6 one see table nearly linear speedup number search steps close linear speedup runtime s3 simple exclusion apply gives rise 48 symmetries furthermore optimal conformations symmetric ones similar implies less speedup since detecting symmetric solution harder permutation symmetries following consider nite domain integer problems variables domain n associated following denote permd set permutations transd set transpositions ie permutations exchange two elements permd denote set symmetries permute values variables x denition 6 let x set solution variables set value permutations x dened symmetry set subset transposition symmetries x dened analogously consider search trees branch constraints one single constraints forms interesting part search tree branches constraints one single transd excluding tree even x reduced thus need exclude quadratically many transpositions exclude exponentially many permutations case theorem 3 let c pr problem x permd symmetry group let x transd excluding search tree every branch v constraint c used branch one free variable x x permd reduced proof sketch consider permutation corresponding symmetry consider node l cx know x must dierent x let transposition let corresponding symmetry exclusion transposition would exclude solution show node considered 1 2 kv l k shown assumption search tree uses constraints one graph coloring noted graph coloring example problem value permutations symmetries graph coloring problem follows given graph e set colors admissible coloring c g mapping vertices v set colors satisfying constraint v minimal set colors still nd admissible coloring problem colorings considered symmetric permuted colors compare two implementations solver problem rst one naive implementation uses simple rst fail heuristic implementation symmetry exclusion second implementation full exclusion symmetries simple extension rst one added symmetry exclusion mechanism note due theo rem suces handle set transpositions instead handling group permutations get full symmetry exclusion give results randomly generated problem instances dier ent problem sizes problem size symmetry excl without symmetry excl ratio verts edges colors cloned failed time cloned failed time cloned time 6 conclusion future work introduced rst method exclude arbitrary symmetries constraintbased search contrast many methods found literature method restrict search strategy method based declarative description symmetries form symmetric constraints usually obtained easily given completeness correctness proofs well proof method exclude considered symmetries case full symmetry group large method handle arbitrary subsets full symmetry group shown case permutation symmetries sucient exclude quadratically many transposition exclude exponentially many permutations method implemented constraintbased search machinery handles implications allows introduce additional userdened constraints search holds modern constraint programming systems since method general plan investigate logicbased search methods symmetry exclusion used fur thermore intend investigate general conditions subset full symmetry group allows exclude symmetries case permutations r alfonso san miguel aguirre constraint techniques solving protein structure prediction problem study symmetry constraint satisfaction problems tractability symmetries propositional calculus symmetry breaking predicates search problems thierry boy de la tour eliminating interchangeable values constraint satisfaction prob lems symmetry breaking search constraint programming oz programming model tr ctr c law j h lee symmetry breaking constraints value symmetries constraint satisfaction constraints v11 n23 p221267 july 2006 rolf backofen sebastian constraintbased approach fast exact structure prediction threedimensional protein models constraints v11 n1 p530 january 2006