integer multiflow maximization generalizing twocommodity flow theorem rothschild whinston oper res 14 1966 pp 377387 multiflow theorem lovsz acta mat akad sci hungaricae 28 1976 pp 129138 cherkasky ekonommat metody 13 1977 pp 143151 karzanov lomonosov mathematical programming larichev ed institute system studies 1978 pp 5966 1978 proved minmax theorem maximum multiflows original proof quite long technical relies earlier investigations metrics main purpose present paper provide relatively simple proof theorem proof relies locking theorem another result karzanov lomonosov polymatroid intersection theorem edmonds combinatorial structures applications r guy h hanani n sauer j schnheim eds gordon breach 1970 pp 6987 completeness also provide simplified proof locking theorem finally introduce notion node demand problem another application locking theorem derive feasibility theorem concerning itthe presented approach gives rise combinatorial polynomialtime algorithms b introduction e two undirected graphs v call path g h admissible connects two nodes x xy 2 f g called supply graph h demand graph elements terminals elements v called inner nodes maximization problem consists finding maximum number edgedisjoint hadmissible paths h consists one edge mengers theorem gives answer general problem npcomplete even special case g eulerian graph called eulerian degree every node even however important special cases problem tractable rothschild whinston 1966 proved maxflow mincut type theorem g inner eulerian h consists two edges say pair g inner eulerian degree dv even every inner node v another result due independently l lovasz 1976 bv cherkasskij 1977 solve maximization problem h complete graph g inner eulerian 1978 av karzanov mv lomonosov found common generalization two theorems original proof rather lengthy technical certainly much difficult two special cases mentioned details proofs described karzanov 1979 lomonosov 1985 later karzanov 1985 1987 exhibited another proof based splittingoff technique gave rise strongly polynomial solution algorithm however latter proof also rather complicated main contribution paper relatively simple proof theorem karzanov lomonosov proof relies two ingredients socalled locking theorem another result karzanov lomonosov department operations research eotvos university muzeum krt 68 budapest hungary h1088 research author partially supported hungarian national foundation scientific research grants otka t17580 partially carried author visited imag universite de grenoble bp 53 38041 grenoble cedex france institute system analysis prospect imag universite j fourier bp 53 38041 grenoble cedex france research first author partially supported european project donet 1978 polymatroid intersection theorem j edmonds 1970 completeness also provide simplified proof locking theorem since ingredients solved combinatorial polynomialtime algorithm approach gives rise alternative strongly polynomialtime algorithm capacitated maximization problem question faster karzanov 1985 follows distinguish oneelement set fxg element x set x element let denote union x vector use notation family pairwise disjoint nonempty subsets set called subpartition two elements set x called tsset 2 x 62 x integervalued vector function called even values even integer polyhedron p use notation graph e cut x denotes set edges precisely one endnode x cardinality denoted dx called degree function g let dx denote number edges one x gamma gamma x let easy prove satisfies following identities every pair xy subsets v let b two disjoint subsets v path connecting element element b called bpath path connecting two distinct elements called apath b g simply b stands maximum number edgedisjoint bpaths mengers theorem one may consider fractional version edgedisjoint paths problem let g h hmultiflow briefly multiflow x mean family fp paths g along nonnegative coefficients ff p connects endnodes demand edge x called integervalued ff integer p connects element element b h complete bipartite graph bipartition b speak bflow hmultiflow x let xe e xt ends called cadmissible xe ce every e 2 e 2 locking problem e graph v subset terminal nodes subset notation abbreviated g confusion arise throughout paper assume current g inner eulerian lovasz 1976 cherkassky 1977 proved following theorem theorem 21 inner eulerian pair g maximum number edgedisjoint paths equal equivalent formulation follows theorem 21 given inner eulerian pair g family f edgedisjoint paths g f contains paths ending 2 words single family edgedisjoint paths includes maximum families edgedisjoint simultaneously 2 karzanov lomonosov 1978 extended theorem formulate result let us say family f edgedisjoint paths locks subset f contains apaths furthermore say f locks family l subsets f locks members l theorem 21 asserts family f paths locks singletons always possible find family edgedisjoint paths locks specified family l answer general shown following example l consists three pairwise crossing sets two subsets xy called crossing none fig 1 example indicates natural require l 3crossfree family l subsets called three pairwise crossing members locking theorem 22 karzanov lomonosov 1978 karzanov 1984 lomonosov 1985 let g inner eulerian l 3cross free family subsets family edgedisjoint paths locks l proof slightly weaker version sketched karzanov lomonosov 1978 present proof relies idea splitting used already karzanov 1984 technically simpler splitting pair adjacent edges graph g means operation replaces e f new edge connecting x way may introduce parallel edges x resulting graph denoted g ef proof may assume gamma 2 l 2 l 2 l adding gamma l affects neither 3crossfreeness lockability also assume g connected proceed induction number edges incident elements number zero statement trivial therefore edge st going show edge theorem follows since induction family f paths g ef locking l path uses new edge h g ef arisen splitting e f revise f replacing p e f 21 revised f locks l g proof since analogously therefore 11 claim follows ffl call set x v tight closed complementation tight g inner eulerian pair edges precisely tight set x x 2 22 three maximal tight tssets proof let xy z maximal tight tssets since l 3crossfree two three sets x z say noncrossing either first two cases x tight contradicting maximality x last case applying claim 1 contradicting existence edge st ffl let denote set neighbours claim 3 possible cover two tight tssets proof suppose xy x tight tssets let ff ds symmetry may assume ff fi implies dxs x hand since fl positive claims 2 3 edge satisfying 22 21 holds proof locking theorem complete ffl ffl one may interested possible locking theorems rather 3crossfreeness property assumed family l 2 locked negative side karzanov pevzner 1979 showed every l including three pairwise crossing sets graph g subset nodes g inner eulerian family paths locking members l hand locking theorems restrictions imposed relationship g family l example let g planar eulerian graph let denote nodes outer face cyclic order define l consist subsets form though l 3cross free k 4 locking theorem holds theorem equivalent planar dualization result hurkens schrijver tardos 198889 need slight extension theorem 22 let z nonnegative integervalued function family f edgedisjoint paths called mindependent every terminal 2 end mt members f let denote maximum number edgedisjoint mindependent apaths say family f edgedisjoint paths mlocks subset f independent contains apaths furthermore say f mlocks family l subsets f mlocks members l following theorem straightforward consequence theorem 22 used proof theorem 43 theorem 23 let g innereulerian l 3cross free family subsets let z vector mt dt even 2 family f edgedisjoint paths mlocks l proof let g 0 graph arising g splitting every node 2 following sense add new node 0 along mt parallel edges 0 replace edge xt g xt 0 result immediately follows theorem 22 applied g 3 flows polymatroids nonnegative setfunction called polymatroid function 1 2 b monotone increasing e 3 b submodular ie degreefunction graph g satisfies properties 1 3 typically 2 polyhedron p b fx called polymatroid called integral every vertex p integervalued concept polymatroid introduced j edmonds 1970 proved polymatroid uniquely determines defining polymatroid function furthermore polymatroid integral b integervalued polymatroid p b face bb p b called basis polyhedron elements bases edmonds also proved following result theorem 31 edmonds 1970 integral polymatroid p b integervalued vector x 2 p b integervalued basis x polymatroid intersection theorem edmonds states linear system two polymatroids totally dual integral tdi need following consequence theorem 32 edmonds 1970 two polymatroid functions b defined power set furthermore b integervalued maximum attained integer vector follows vector x p p b bipartition fa bg b integralvalued x e graph endowed capacity function c subset nodes cadmissible bflow x every v 2 ag f submodular monotone increasing multiterminal version maxflow mincut theorem vector 2 r belongs pa mx f x therefore pa polymatroid furthermore c integervalued cadmissible integervalued bflow x e eulerian graph subset nodes define c partition denote direct sum polymatroids lemma 33 let q integer basis p family f edgedisjoint paths connecting distinct members 2 endpoint exactly qt paths f proof 2 let x minimal subset v claim sets disjoint indirectly contradicting minimality x claim family f 0 edgedisjoint paths g connecting distinct x using edges induced x f 0 contains ending x 1 k indeed apply theorem 21 pair g graph g 0 arises g contracting x node denoted 0 g since q basis p family f 0 qt connecting 2 endnode qt members f 0 member erase edges outside x denote f family resulting paths glueing together paths f 0 paths f obtain family f paths satisfying requirements ffl lemma 34 let q integer basis p integer vector q independent family f paths mlocks contains least qt 2 paths connecting distinct members proof lemma 33 q implies q since f mlocks connecting k lemma follows ffl remark since q basis f contains qt f contains qt 2 paths connecting distinct members number paths f precisely qt 2 need fact let b two partitions let l ab let h demand graph uv edge h x 2 l includes u v setfunction defined seen polymatroid function define b j analogously b b polymatroid functions let p p b polymatroids defined b respectively arbitrary even vector p p b h 0 2 h edgedisjoint hadmissible paths proof since g eulerian p a2 p a2 integral polymatroid applying theorem 31 p a2 x 0 2 obtain even bases p 0 analogously even bases b p b b 0 define vector mt maxm b even hence since l 3cross free apply theorem 23 let f denote family mindependent paths provided theorem jf going prove number h 0 hadmissible paths f least h note path hadmissible precisely connects two nodes belonging member l applying lemma 34 choice p p q obtain gammam 2 paths f endnodes member analogously endnodes member b hence note element 2 need endnode exactly 0 members family assured lemma 35 comments see beginning section 6 4 maximization e supply graph throughout section assume pair g inner eulerian dv even every stands degree function g maximization form edgedisjoint paths problem consists finding maximum number g h edgedisjoint hadmissible paths easily get upper bound let us call subpartition v admissible x stable clearly value called value subpartition let g h denote minimum value admissible subpartition following example shows equality general fig 2 two known special cases equality holds theorem 21 shows case h complete graph reformulating theorem 21 theorem 41 suppose g inner eulerian demand graph h complete another special case h consists two edges theorem 42 suppose g inner eulerian h consists two edges theorem rothschild whinston actually proved following simpler form theorem 42 rothschild whinston 1966 suppose g inner eulerian h consists two edges minimum cardinality 0 cut x g equivalence two forms 0 may proved follows since cut x provides admissible partition special form clearly 0 see direction let p fx minimal admissible subpartition g k minimum since jt j 4 exactly two terminal nodes connected h furthermore say would also admissible partition whose value bigger fx another optimal admissible partition hence k 3 two members p say x 1 x 2 contains one terminal node two terminal nodes say connected h replacing x 1 x 2 another minimal admissible subpartition contradicting minimum choice k ffl let us call graph bistable two partitions b x 2 xy edge h precisely x belong different parts different parts b easily seen graph bistable complement linegraph bipartite graph also shown bistable graphs family maximal stable sets h partitioned two parts consisting disjoint sets clearly clique generally complete kpartite graph bistable 2k 2 also bistable therefore theorems 21 22 special cases following theorem 43 karzanov 1985 lomonosov 1985 suppose g inner eulerian bistable g proof slightly weaker halfintegral version sketched already karzanov lomonosov 1978 reader may feel bistable demand graphs form rather peculiar class graphs may larger natural classes graphs holds karzanov pevzner 1979 however showed bistable contains isolated nodes supply graph g section 6 outline original plan proof intended use polymatroid intersection theorem point attempt failed perhaps help reader understand led invoke locking theorem proof proof 41 g see direction first prove theorem follows special case graph completely eulerian suppose theorem true eulerian want prove g h g inner eulerian let k denote set nodes g odd degree since g inner eulerian k k empty done new node let 0 let e respectively maximum minimum question concerning g assumption obviously optimal solution maximization problem concerning every edge xt x 2 k path solution thus optimal admissible subpartition since every edge xt x 2 belongs hence mgammafxg admissible subpartition g h therefore conclude let b two partitions defining bistable graph h note stable set h subset 2 b let b defined 31 since p a2 p b2 integral polymatroids theorem 32 exist even vector 0 p p b bipartition fa bg hence g hence proof complete find admissible subpartition value end let us assume maximal subset b gamma satisfy 42 claim indeed 0 bipartition fa would also satisfy 42 contradicting maximal choice note choice b role b fully symmetric 2 nonempty exists set x last equality follows 42 definition analogously nonempty exists set j assume x j chosen minimal let nonemptyg lemma 44 k admissible subpartition value proof clearly element belongs least one member k show one claim 0 hence 44a must hold otherwise element 2 x would violate 43 also every 44b true element 2 j proper subset j contradicting minimal choice j hence proof 44 complete claim k subpartition assume contrary l k 6 kl 2 k definition k 44 minimal choice members k implies definition k admissible value lemmata 35 44 42 proof theorem 43 complete ffl ffl section briefly outline proof gives rise strongly polynomial combinatorial algorithm capacitated case informally polynomialtime algorithm strongly polynomial number steps depend magnitude occurring capacities costs input algorithm consists two graphs e g endowed nonnegative rational capacity function assume two partitions xy 2 f contains one x note graph h given incidence matrix one test h efficiently bistability namely decide first enumeration whether 2jt j maximal stable sets h answer yes h bistable answer h bistable intersection graph maximal stable sets bipartite output algorithm consists cadmissible hmultiflow x admissible subpartition v moreover c integervalued eulerian sense ffi c v even every node v 2 v output x integervalued well actually assume c integervalued eulerian case one multiply capacities 2n n denotes least common denominator capacities c inner eulerian apply reduction described section 4 obtain completely eulerian case first remark proof locking theorem immediately provides polynomialtime algorithm setsystem l ab c identically 1 difficult show general integervalued eulerian c every step one splits much capacities possible algorithm strongly polynomial cf karzanov 1984 follows comment use polymatroid intersection algorithm construct even vector 0 admissible subpartition occurring proof theorem 43 disjoint sets xy v let c x denote value flow x help maxflow mincut mfmc computation c x computed strongly polynomial time set function defined analogously b polymatroids defined b known polymatroid theory p c eulerian a2 b2 integervalued hence p a2 p b2 integral polymatroids therefore z integervalued vector p even vector p p b 0 v maximum polymatroid intersection theorem 32 bipartition fa bg combinatorial strongly polynomial algorithm due p schonsleben 1980 compute z hence 0 fa bg algorithm works oracle available minimize vector case oracle indeed constructed invoking mfmc algorithm way one obtains purely combinatorial strongly polynomial algorithm computing 0 b satisfying 42 using proofs claims 1 2 proof theorem 43 one may compute strongly polynomial time integervalued maximum multiflow admissible subpartition minimum value karzanov 1985 described direct way compute 0 minimal admissible subpartition method consists one mfmc computation appropriately defined auxiliary digraph jv jjt j nodes complexity ojt jjv j n denotes complexity mfmc computation network n nodes next even basis p defined proof theorem 43 constructed jaj resp jbj mfmc computations thus vector defined 44 computed 0 ojt jjv j steps mlocking problem solved applying ojv splittingoff operations every node v 2 operation consists finding jajjbj maximum flows g requires ojv j 2 jajjbjjv j ojv j 2 jt jjv j operations thus overall complexity algorithm ojv one uses mfmc algorithm complexity upper bound running time algorithm compared complexity algorithm karzanov 1985 6 nodedemand problems reader might feeling invoking locking theorem proof contains seemingly unnecessary twist fact originally tried prove theorem 43 using following natural direct approach example show attempt failed recall polymatroid intersection theorem ensured existence maximum even vector 0 precisely g h theorem 43 would follow existed system hfeasible paths 2 endnode precisely 0 unfortunately system need always exist shown following example figure demand graph h defined partitions ffv admissible subpartition value 3 maximum g h 3 hand three hadmissible edgedisjoint paths g namely p 1 hence value primal dual optima 3 easily checked system paths optimal solution bad thing two nodes v 1 v 4 endnodes one odd number paths therefore hope obtain paths first determining optimal even vector 0 intersection two polymatroids question find hadmissible paths node 2 endnode 0 furthermore one must insist evenness 0 since locking theorem true vectors incidentally vector 0 2 2 2 0 optimal element polymatroid intersection fa g bipartition satisfying 42 vector arising proof 2 2 2 2 theorem 23 applied obtain family f four paths namely among paths p 4 nonhadmissible obtain optimal solution maximization problem though direct approach maximization problem prove successful led us following problem considered sake e graph z demand function nodedemand problem consists finding system hadmissible paths terminal endnode precisely mt paths call problem also vector feasible solution exists nodedemand problem called eulerian inner eulerian mtdt even 2 call demand graph h twocovered onecovered every node 2 belongs two exactly one maximal stable sets h note bistable graphs always twocovered 5element circuit example twocovered bistable shown graph h twocovered h complement line graph trianglefree graph theorem 61 suppose nodedemand problem defined g hm eulerian h two covered feasible following condition holds every stable h proof since stable h solution nodedemand problem path endnode endnode gamma among ms paths mx may end x gamma hence least ms must end outside x 61 follows prove sufficiency first observe family l maximal stable sets h 3crossfree indeed contradiction let stable sets h pairwise crossing since h 2 distinct elements stable maximal stable set containaing b c distinct element b c well would belong two maximal stable sets contradicting h twocovered stable set h proof recall defined maximum number edgedisjoint paths connecting x 2 endnode mx ot version menger theorem apply edgedisjoint undirected version menger theorem graph arising g adding two new nodes respectively connected node x resp gamma mx new parallel edges x denotes set minimum attained 61 claim follows ffl apply theorem 23 g ml consider path system f provided theorem l collection maximal stable sets h solution node demand problem proof let element l maximal stable set h since f locks f contains connecting gamma shows node x endnode precisely mx members f path f endnode must endnode every node x h belongs maximal stable set h x endnode precisely mx members f moreover since every pair nonadjacent nodes x h belong maximal stable set h path f may connect x f consists hfeasible paths ffl ffl remark condition theorem 62 may formulated equivalent form taking 61 see 61 implies every maximal stable set z h conversely claim 61 follows 61 indeed let z maximal stable set h including ms mx z 61 follows 61 advantage maximal stable sets twocovered graph 2jt j hand proof slightly easier work 61 r solution problem multicommodity flows network combinatorial methods solve cutdetermined multiflow problems finite infinite sets multicommodity flow problems integervalued optimal solutions class maximum multicommodity flows integervalued optimal solutions systems flows undirected networks mathematical programming complete description class cutnondetermined maximum multicommodity flow problems combinatorial approaches multiflow problems combinatorial approaches multiflow problems connectivity properties eulerian graphs ganzzahlige polymatroid intersections algorithmen tr ctr michael lomonosov return path packing european journal combinatorics v25 n1 p3553 january 2004