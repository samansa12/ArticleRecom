spectral algorithm seriation consecutive ones problem applications ranging dna sequencing archeological dating sparse matrix reordering recurrent problem sequencing elements way highly correlated pairs elements near given correlation function f reflecting desire pair elements near find permutations pi property piipijpik fij ge fik fjk ge fik seriation problem generalization wellstudied consecutive ones problem present spectral algorithm problem number interesting features whereas previous applications spectral techniques provide bounds heuristics result algorithm correctly solves nontrivial combinatorial problem addition spectral methods successfully applied heuristics variety sequencing problems result helps explain justify applications b introduction many applied computational problems involve ordering set closely coupled elements placed near underlying problem diverse applications genomic sequencing sparse matrix envelope reduction graph linear arrangement well less familiar settings archaeological dating paper present spectral algorithm class problems unlike traditional combinatorial methods approach uses eigenvector matrix order elements main result approach correctly solves important ordering problem call seriation problem includes well known consecutive ones problem 5 special case formally given set n elements sequence wish bijectively map elements integers also symmetric real valued correlation function sometimes called similarity function reflects desire elements near sequence wish find ways sequence elements correlations consistent permutation elements k although may exponential number orderings described compact data structure known pqtree 5 review next section correlation functions allow consistent sequencing consistent ordering possible say problem well posed determining ordering correlation function call seriation problem reflecting origins archaeology 29 33 work supported mathematical information computational sciences division us doe office energy research work sandia national laboratories operated us doe contract deac0494al85000 sandia multiprogram laboratory operated sandia corporation lockheed martin company us doe dept mathematics university michigan 2072 east hall ann arbor mi 48109 atkinsjemathlsaumichedu z scientific computing computational mathematics gates bldg 2b stanford univ stanford 943059025 bomansccmstanfordedu x applied numerical mathematics dept sandia national labs albuquerque nm 871851110 bahcssandiagov consecutive ones problem c1p closely related ordering problem 1matrix c consecutive ones property exists permutation matrix pi column pic ones form consecutive sequence matrix consecutive ones property consecutive ones problem find permutations shown kendall 19 reviewed x6 c1p special case seriation problem algorithm orders elements using value eigenvector laplacian matrix formally define x2 eigenvectors related graphs studied since 1950s see example survey books cvetkovic et al 8 7 early work involved eigenvectors adjacency matrices laplacian eigenvectors first studied fiedler 10 11 independently donath hoffman 9 recently number attempts apply spectral graph theory problems combinatorial optimization example spectral algorithms developed graph coloring 3 graph partitioning 9 28 envelope reduction 4 examples found survey papers mohar 23 24 however previous applications techniques used provide bounds heuristics cases approximation algorithms 2 6 14 nphard problems small number previous results eigenvector techniques used exactly solve combinatorial problems including finding number connected components graph 10 coloring kpartite graphs 3 finding stable sets independent sets perfect graphs 16 paper describes another application spectral methods closely related general method semidefinite programming applied successfully many combinatorial problems eg maxcut max2sat14 graph coloring18 see alizadeh1 survey semidefinite programming applications combinatorial optimization result important several reasons first provides new insight wellstudied consecutive ones problem second important practical problems like envelope reduction matrices genomic reconstruction thought variations seriation example biological experiments errorfree genomic reconstruction problem would precisely c1p unfortunately real experimental data always contain errors attempts generalize consecutive ones concept data errors seems invariably lead npcomplete problems 31 15 spectral heuristic based upon approach recently applied problems found highly successful practice 15 result helps explain empirical success revealing errorfree case technique correctly solve problem places spectral method stronger theoretical footing cross heuristic exact algorithm similar comments apply envelope reduction matrices dense envelopes closely related matrices consecutive ones property recent work shown spectral techniques better practice existing combinatorial approaches reducing envelopes 4 result sheds light success another way interpret result provide algorithm c1p generalizes become attractive heuristic presence errors designed decision algorithms consecutive ones property existing combinatorial approaches c1p break errors fail provide useful approximate orderings however goal analyze approach approximation algorithm rather prove correctly solves errorfree problem instances paper organized following way next section introduce mathematical notation results matrix theory need later also describe spectral heuristic ordering problems motivates remainder paper theorem underpins algorithm proved x3 proof requires use classic theorem matrix analysis several additional results x4 lead us algorithm analysis x5 review connection c1p x6 2 mathematical background 21 notation definitions matrix concepts useful correlation function defined considered real symmetric matrix permutation elements corresponds symmetric permutation matrix permutation matrix elements formed permuting rows columns fashion question whether ordering problem well posed also asked property matrix specifically suppose matrix permuted reflect consistent solution ordering problem offdiagonal matrix entries must nonincreasing move away diagonal formally say matrix rmatrix 1 symmetric ij ik ij ik diagonal entries rmatrix unspecified symmetrically permuted become rmatrix say prer note prer matrices correspond precisely wellposed ordering problems also rmatrix property preserved add constant offdiagonal entries assume without loss generality offdiagonal values nonnegative permutation natural numbers ng x column vector ie denote x permutation x ie similarly symmetric permutation ie denote e vector whose entries 1 e vector consisting zeros except 1 position identity matrix symmetric matrix reducible exists permutation b c nonempty square matrices permutation exists irreducible b c irreducible refer irreducible blocks say eigenvalue corresponding vector x eigenvector n theta n real symmetric matrix n eigenvectors constructed pairwise orthogonal eigenvalues real assume eigenvalues sorted increasing value refer n algebraic multiplicity eigenvalue class matrices named w robinson first defined property work seriation methods archaeology 29 defined number times occurs root characteristic polynomial value occurs called simple eigenvector simple eigenvalue unique normalization write 0 say nonnegative elements ij nonnegative real vector x monotone define laplacian symmetric matrix diagonal matrix ij minimum eigenvalue eigenvector orthogonal e vector ones called fiedler value corresponding eigenvector called fiedler vector 2 alternatively fiedler value given min fiedler vector vector x achieves minimum satisfying constraints 0 irreducible hard show fiedler value smallest nonzero eigenvalue fiedler vector corresponding eigenvector notationally cavalier refer fiedler value vector really mean la 22 pqtrees pqtree data structure introduced booth lueker efficiently encode set related permutations 5 pqtree set rooted ordered tree whose leaves elements u whose internal nodes distinguished either pnodes qnodes pqtree proper following three conditions hold 1 every element u appears precisely leaf 2 every pnode least two children 3 every qnode least three children two pqtrees said equivalent one transformed applying sequence following two equivalence transformations 1 arbitrarily permute children pnode 2 reverse children qnode conveniently equivalence class represented pqtree corresponds precisely set permutations consistent instance seriation problem x5 describe algorithm uses laplacian eigenvectors construct pqtree instance seriation problem 23 motivation spectral methods definitions describe simple heuristic seriation problem motivate remainder paper heuristic heart complex algorithms devise underlies many previous applications spectral algorithms 17 begin constructing simple penalty function g whose value small closely correlated elements close define unfortunately minimizing g nphard due discrete nature permutation 13 instead approximate function h continuous variables x minimize maintains much structure g define note h unique minimizer since value change add constant x component avoid ambiguity need add constraint like still trivial solution 2 recognition work miroslav fiedler 10 11 x zero need second constraint like 1 resulting minimization problem well defined minimize 1 subject solution continuous problem used heuristic sequencing merely construct solution vector x sort elements x sequence based upon sorted order one reason heuristic attractive minimization problem elegant solution rewrite hx x l f x correlation matrix constraints require x unit vector orthogonal e since la symmetric eigenvectors satisfy constraints consequently solution constrained minimization problem fiedler vector even problem well posed sorting entries fiedler vector generates ordering tries keep highly correlated elements near mentioned technique used variety sequencing problems 4 15 17 algorithm describe remainder paper based upon idea however encounter ties entries fiedler vector need recurse subproblem encompassing tied values way able find permutations make prer matrix r matrix 3 key theorem main result modification simple heuristic presented x23 actually algorithm wellposed instances seriation problem completely proving require us deal special cases multiple fiedler vectors ties within fiedler vector cornerstone analysis classical result matrix theory due perron frobenius 27 particular formulation found page 46 30 theorem 31 perronfrobenius let real nonnegative matrix define 1 aem eigenvalue 2 vector x 0 ready state prove main theorem theorem 32 rmatrix monotone fiedler vector proof proof uses perronfrobenius theorem 31 nonnegative vector theorem consist differences neighboring entries fiedler vector laplacian first define matrix 2 ir ngamma1thetan 0 note vector x 0 easy verify 1 define g show sx eigenvector x eigenvector la x 6 ffe transformation second third line follows la holds equations eigenvalue la eigenvectors la e hence eigenvalues eigenvalues la zero eigenvalue removed eigenvectors differences neighboring entries corresponding eigenvectors la easily seen sla ik gamma i1k since assumption rmatrix ik i1k j j use fact l ik gamma l i1k rmatrix property conclude consequently offdiagonal elements nonpositive let fi value greater eigenvalues nonnegative eigenvalues share set eigenvectors theorem 31 exists nonnegative eigenvector corresponding largest eigenvalue also eigenvector corresponding smallest eigenvalue sx x fiedler vector la since nonnegative corresponding fiedler vector la nondecreasing theorem follows note since sign eigenvector unspecified fiedler vector could also nonincreasing theorem 33 let prer matrix simple fiedler value fiedler vector repeated values let 1 respectively 2 permutation induced sorting values fiedler vector increasing decreasing order 1 2 rmatrices permutations produce rmatrices proof first note since fiedler value simple fiedler vector unique multiplicative constant next observe x fiedler vector x fiedler vector applying permutation merely changes order entries fiedler vector let permutation rmatrix theorem 32 x monotone since x fiedler vector since x repeated values must either 1 2 theorem 33 provides essence algorithm seriation problem restrictive fiedler value must simple contain repeated values show remove limitations next section 4 removing restrictions several observations seriation problem simplify analysis first note add constant correlation values set solutions unchanged consequently assume without loss generality smallest value correlation function zero note subtracting smallest value correlation values change whether matrix prer algebraic formulation translates following lemma 41 let symmetric matrix let real ff vector x fiedler vector iff x fiedler vector without loss generality assume smallest offdiagonal entry zero proof definition laplacian follows l n dimension l eigenvector x la eigenvalues simply shifted ffn eigenvectors preserved justify first step algorithm subtracts value smallest correlation every correlation accordingly make assumption prer matrix smallest diagonal entry zero next observe reducible seriation problem decoupled irreducible blocks matrix correspond connected components graph nonzero values correlation function solve subproblems induced connected components link pieces together arbitrary order formally following lemma lemma 42 let irreducible blocks prer matrix let permutation block submatrix rmatrix permutation formed concatenating make become rmatrix terms pqtree permutations children single pnode proof lemma 41 assume entries irreducible blocks non negative consequently correlation elements within block always least strong correlation elements different blocks also definition irreducibility element within block must positive correlation another element block hence ordering makes rmatrix must interleave elements different irreducible blocks long blocks ordered rmatrices ordering blocks make rmatrix since correlations across blocks identical preliminaries assume smallest offdiagonal value zero matrix irreducible following three lemmas theorem show sufficient ensure fiedler vector unique multiplicative constant lemma 43 let n theta n rmatrix monotone fiedler vector x maximal interval x proof without loss generality assume x nondecreasing since gammax also fiedler vector show rk sk since rmatrix elements rk sk must also equal consider rows r equation l sk gamma l rk x since la laplacian know l sk gamma l rk x r gamma x k l sk gamma l rk l sk gamma l rk used fact x nondecreasing terms sum nonnegative terms must exactly zero assumption x k 6 x r consequently l 2 j result follows following lemma essentially converse proof requires detailed algebra fundamental follows consequently proof relegated end section lemma 44 let irreducible n theta n rmatrix 1 n interval rk sk fiedler vector x lemma 45 let irreducible rmatrix fiedler vector interval x fiedler vector proof first apply lemma 43 conclude k use conjunction lemma 44 obtain result theorem 46 irreducible rmatrix fiedler value 2 simple eigenvalue proof assume 2 repeated eigenvalue produce contradic tion let x two linearly independent fiedler vectors x nondecreasing siny 0 let smallest value makes z must exist since x linearly independent lemma 45 indices repeated values x indices repeated values z coupled monotonicity x implies z monotone lemma 45 indices repeated values z must repeated x gives desired contradiction remains handle situation fiedler vector repeated values following theorem shows repeated values decouple problem pieces solved recursively theorem 47 let prer matrix simple fiedler value fiedler vector x suppose repeated value fi x define j k indices 1 2 x 3 rmatrix ordering iff reversal expressed rmatrix ordering submatrix aj j induced j k restrictions rmatrix ordering k respectively proof theorem 32 know rmatrix ordering x monotone elements must appear elements j elements k must appear elements j lemma 43 2 j hence orderings elements inside j must indifferent ordering outside j vice versa consequently rmatrix ordering elements j depends aj j algorithmically theorem means break ties fiedler vector recursing submatrix aj j j corresponds set repeated values distinct values fiedler vector constrain rmatrix orderings repeated values need handled recursively language pqtrees distinct values combined via qnode components subtrees qnode must expanded recursively proof lemma 44 first recall fiedler value value obtained min ij 2 fiedler vector vector achieves minimum note replace matrix least large elementwise comparison x lax cannot decrease vector x consider aj j diagonal block indexed j definition rmatrix values aj j must least large rs however rs must greater zero otherwise rmatrix property statement theorem would make matrix reducible remainder proof proceed two stages first force offdiagonal values aj j rs show result modified matrix extend result original matrix stage 1 define matrix b identical outside bj j offdiagonal values b within bj j set ff rs follows hypotheses b rmatrix define note rmatrix property define ffi consider eigenvalue equation matrix eigenvectors lb eigenvalues shifted rows lb j identical consequently either elements x j equal equivalent show irreducibility complete proof stage 1 assume look contradiction introduce new matrix b follows ff otherwise since b rmatrix b least large b elementwise 2 define vector x unit vector direction note following chain inequalities last inequality strict since b combine inequality due fiedler 10 l ii observation min l ii ffi obtain 2 n true equality holds throughout implying contradicts 3 2 ff proof stage 1 complete stage 2 show b fiedler vectors since elementwise least large b vector z z la z z lb z stage 1 know fiedler vector b satisfies x vector contribution sum 2 bj j zero contribution also zero applied aj j since b identical outside aj j bj j fiedler vector b gives upper bound fiedler value follows fiedler vectors b also fiedler vectors vice versa 5 spectral algorithm seriation problem bring preceding results together produce algorithm wellposed instances seriation problem specifically given wellposed correlation function generate consistent orderings given prer matrix algorithm constructs pqtree set permutations produce rmatrix spectralsort algorithm presented fig 1 begins translating correlations smallest 0 separates irreducible blocks one children pnode recurses one block sorts elements children qnode based values fielder vector ties entries fiedler vector algorithm invoked recursively input n theta n prer matrix u set indices rowscolumns output pqtree encodes set permutations rmatrix begin 1 ff min i6j ij 1 gamma ffee irreducible blocks corresponding index sets else 3 else else fiedler vector la number distinct values x indices elements x jth value fig 1 algorithm spectralsort prove algorithm correct step 1 justified lemma 41 requires time proportional number nonzeros matrix identification irreducible blocks step 2 performed breadthfirst depthfirst search algorithm also requiring time proportional number nonze ros combining permutations resulting blocks pnode correct lemma 42 step 3 handles boundary conditions recursion step 4 fiedler vector computed sorted repeated elements fiedler vector qnode permutation correct theorem 33 steps 3 4 dominant computational steps discuss run time recursion step 5 justified theorem 47 note algorithm produces tree whether prer determine whether prer simply apply one generated permutations result rmatrix permutations pqtree solve seriation problem otherwise problem well posed expensive steps algorithm spectralsort generation sorting eigenvector since algorithm invoke recursively operations occur problems size n n time eigen calculation matrix size n n runtime algorithm spectralsort formal analysis complexity eigenvector calculation simplified noting prer matrix matters dominance relationships matrix entries without loss generality assume entries integers less n 2 observation possible compute components fiedler vector sufficient precision components correctly sorted polynomial time sketch one way done although dont recommend procedure realworld implementation let denote specific eigenvalue l case fiedler value computed polynomial time discussed 25 compute corresponding eigenvector x symbolically solving pz characteristic polynomial l gaussian elimination field p 21 pz irreducible obtain solution x component x given polynomial z bounded integer coefficients note letting z eigenvalue force x true eigenvector pz reducible try fail solve equation instead find factorization pz proceed replacing pz factor containing root yields polynomial formula x identify equal elements eg method 22 decide order remaining components evaluate root sufficient precision compute x numerically sort since algebraic cannot arbitrarily close 22 polynomial precision sufficient practice eigencalculations mainstay numerical analysis community calculate eigenvectors corresponding highest lowest eigenvalues like fiedler vector method choice known lanczos algorithm iterative algorithm dominant cost iteration matrixvector multiplication requires om time algorithm generally converges many fewer n iterations often n 26 however careful analysis reveals dependence difference distinct eigenvalues 6 consecutive ones problem ordering rmatrix closely related consecutive ones problem mentioned x1 0 1matrix c consecutive ones property exists permutation matrix pi column pic ones form consecutive sequence 3 matrix property without rearrangement ie petrie form 4 called p matrix analogous rmatrices say matrix consecutive ones property prep consecutive ones problem restated given prep matrix c find permutation matrix pi pic pmatrix 3 authors define property terms rows instead columns 4 sir william f petrie archaeologist studied mathematical methods seriation 1890s close relationship pmatrices rmatrices following results due dg kendall proved 19 33 lemma 61 c pmatrix rmatrix lemma 62 c prep rmatrix c pmatrix theorem 63 let c prep matrix let cc let pi permutation matrix pic pmatrix piapi rmatrix theorem allows us use algorithm spectralsort solve consecutive ones problem first construct apply algorithm note elements small nonnegative integers apply one permutations generated algorithm c result pmatrix permutations produce c1p orderings c c1p orderings run time technique competitive linear time algorithm problem due booth lueker 5 however unlike approach spectralsort algorithm break presence errors instead serve heuristic several combinatorial problems shown equivalent consecutive ones problem among recognizing interval graphs 5 12 finding dense envelope orderings matrices 5 one generalization pmatrices matrices unimodal columns unimodal sequence sequence nondecreasing reaches maximum nonincreasing matrices called unimodal matrices 32 kendall 20 showed results 61 63 also valid unimodal matrices regular matrix product replaced matrix circle product defined note pmatrices special case unimodal matrices circle product equivalent matrix product 0 1matrices kendalls result implies spectral algorithm correctly identify order unimodal matrices acknowledgements indebted robert leland innumerable discussions spectral techniques sorin istrail insights consecutive ones problem constructive feedback earlier version paper indebted david greenberg experimental testing approach simulated genomic data nabil kahale showing us simplify proof theorem 32 also appreciate highly constructive feedback provided anonymous referee r interior point methods semidefinite programming applications combinatorial optimization spectral technique coloring random 3colorable graphs graph coloring using eigenvalue decomposition spectral algorithm envelope reduction sparse matrices testing consecutive ones property near optimal algorithm edge seperators preliminary version recent results theory graph spectra spectra graphs theory application lower bounds partitioning graphs algebraic connectivity graphs property eigenvectors nonnegative symmetric matrices application graph theory incidence matrices interval graphs analysis spectral envelopereduction via quadratic assignment problems physical mapping sts hybridization algorithmic strategies challenge software evaluation geometric algorithms combinatorial optimiza tion optimal linear labelings eigenvalues graphs approximate graph coloring semidefinite program ming incidence matrices abundance matrices seriation archaeology design analysis algorithms algebraic numbers laplacian spectrum graphs laplace eigenvalues graphs survey algebraic complexity computing polynomial zeros lanczos algorithm selective orthogonalization zur theorie der matrizen partitioning sparse matrices eigenvectors graphs method chronologically ordering archaeological deposits matrix iterative analysis approximation consecutive ones matrix augmentation problem mathematics archaeological historical sciences techniques data analysis seriation theory tr ctr antonio robleskelly edwin r hancock graph edit distance spectral seriation ieee transactions pattern analysis machine intelligence v27 n3 p365378 march 2005 jordi petit experiments minimum linear arrangement problem journal experimental algorithmics jea 8 aristides gionis teija kujala heikki mannila fragments order proceedings ninth acm sigkdd international conference knowledge discovery data mining august 2427 2003 washington dc anil menon aspects binary cmac unimodularity probabilistic reconstruction neural processing letters v22 n3 p263276 december 2005 antti ukkonen mikael fortelius heikki mannila finding partial orders unordered 01 data proceeding eleventh acm sigkdd international conference knowledge discovery data mining august 2124 2005 chicago illinois usa huaijun qiu edwin r hancock graph matching clustering using spectral partitions pattern recognition v39 n1 p2234 january 2006 sebastian lange martin middendorf design aspects multilevel reconfigurable architectures journal signal processing systems v51 n1 p2337 april 2008