stochastic integration rules infinite regions stochastic integration rules derived infinite integration intervals generalizing rules developed siegel obrien siam j sci statist comput 6 1985 pp 169181 finite intervals random orthogonal transformations rules integrals surface unit msphere used produce stochastic rules integrals two types rules combined produce stochastic rules multidimensional integrals infinite regions normal studentt weights example results presented illustrate effectiveness new rules b introduction common problem applied science statistics numerically compute integrals form statistics applications function p may unnormalized unimodal posterior density function g function approximate expected value needed interested problems p approximately multivariate normal nm sigma multivariate studentt sigma cases standardizing transformation form determined possibly using numerical optimization point logp maximized sigma inverse negative hessian matrix logp c lower triangular cholesky factor sigma transformed integrals take form wjjxjjfxdx studentt approximation p good fx accepted publication siam journal scientific computing partially supported nsf grant dms9211640 accurately approximated low degree polynomial x motivates construction stochastic multidimensional polynomial integrating rules integrals type integration problem traditionally handled using montecarlo algorithms see book davis rabinowitz 1984 recent paper evans swartz 1992 simple montecarlo algorithm estimating might use points x randomly chosen probability density proportional wjjxjj montecarlo algorithm importance sampling algorithm original problem estimating eg often effective cases resulting fx approximately constant algorithm low accuracy slow convergence however important feature simple montecarlo algorithms availability practical robust error estimates let oe e denote standard error sample ff r gammaff dt new methods describe considered refinement montecarlo importance sampling algorithm simple montecarlo importance sampling results exact whenever importance modified integrand constant methods exact whenever importance modified integrand low degree polynomial methods also provide robust error estimate sample standard error new onedimensional integration rules develop generalizations rules derived interval 11 weight siegel obrien 1985 work extends earlier work hammersley handscomb 1964 also considered construction stochastic integration rules finite intervals work also partly based work haber 1969 introduced word stochastic generalized montecarlo rules development stochastic multidimensional integration rules requires additional change variables radialspherical coordinate system let z z z1 z 1wrr z z1 wrjrj numerical approximations propose use products stochastic integration rules radial interval gamma1 1 weight wrjrj mgamma1 stochastic rules polynomial degree surface unit msphere averages properly chosen samples rules provide unbiased estimates standard errors samples used provide robust error estimates estimates development partially motivated work deak 1990 used transformation spherical coordinate system combined random orthogonal transformations develop method computing multivariate normal probabilities consider using higher degree rules basic radial integration rules use combinations symmetric sums hgammaae2 radial rule rh takes form given points fae g weights fw g determined r polynomial degree 2n 1 points fae g randomly chosen r unbiased estimate fixed points fae g selection weights standard integration rule construction problem want degree rule sufficient k odd integer equation automatically satisfied r integration operator symmetric define p h r p h r even degree lagrange interpolating polynomial h follows standard interpolation theory p h r weights fw g need make r degree integrals even degree lagrange basis functions following theorem theorem 1 points fae g distinct nonnegative real numbers weights fw g defined degree 2n describe choose points fae g r unbiased estimate h order accomplish need find joint probability density function pae z 1z 1 integrable h explicitly show conjecture general form p n 3 let use fact thatz 1r case randomly density 2ae z 1cae2ae z 1ae degree three rule h choose ae 0 randomly density 2ae m1 wae z 1r 3 ae 2ae m1 wae dae z 1ae z 1ae z 1ae m1 wae z 1ae degree five rule h choose ae 0 randomly joint density k determined condition 1 need show efr 5 h three terms r 5 consider start first one find z 1z 1aeffi 0 second term find z 1z 1ae z 1z 1ae z 1ae z 1ae z 1z 1ae z 1z 1ae r 5 symmetric ae ffi last term r 5 also expected value h2 shown efr 5 results section proposition 1 proposition 1 points fae g rules r 2n1 given 1 weights given 2 chosen probability density proportional ae m1 r unbiased degree 2n proved 2 form probability density n 2 conjectured natural generalization siegel obrien theorem 51 1985 practical problems associated generating random aes density n 2 focus cases 3 stochastic spherical integration rules spherical surface integrals approximated averages random rotations appropriately chosen rules spherical surface let z integration rule approximates integral function sz surface um unit msphere defined z z 1 q theta orthogonal matrix also integration rule um furthermore polynomial degree sq sqz degree sz q chosen uniformly see stewart 1980 polynomial degree sq unbiased random degree rule um many choices could used consider rules given book stroud 1971 pages 294296 review paper mysovskikh 1980 pages 236237 rules combine radial rules degree 1 3 5 list simple degree 1 rule surface content um z point um simple degree 3 rule 1 j th position rule uses 2m values sz different degree 3 rule mysovskikh 1980 j th vertex regular msimplex vertices um degree 3 rule 3 slightly expensive use 3 leads efficient general degree 5 rule mysovskikh 1980 sgammay points j determined taking midpoints edges msimplex vertices projecting midpoints onto surface um values sz degree five rule extends 3 stroud 1971 page 294 u j one points fully symmetric set determined possible permutations sign changes coordinates point r 2 4 stochastic sphericalradial integration rules section combine stochastic radial rules stochastic spherical rules produce random rules many ways could done natural approach form stochastic product rule sr qae f spherical surface rule radial rule r rule takes form r degree sr qae f also degree stroud 1971 theorem 231 q uniformly random orthogonal matrix ae random chosen correct density r sr qae f unbiased estimate following theorem theorem 2 ae random density given proposition 1 degree 2n1 q theta uniform random orthogonal matrix wjjxjjfxdx whenever f degree 2n wjjxjjfxdx integrable f give three examples sr rules degree one rule constructed 1 r 1 ae q unnecessary uniform random vectors z um give unbiased rules degree three rule constructed 3 r 3 degree five rule constructed 5 r 5 w w ae f sr 3 qae respectively sample one rules generated sample average used estimate standard error sample used provide error estimate comparison purposes examples section 6 use sr 0 f denote one point rule fz components z chosen normal01 sr 0 f simple montecarlo rule multivariate normal weight 5 implementation details algorithms section focus integrals form wjjxjjfxdx integrals type determined explicit formulas radial rule weights along explicit methods generating random radial rule points also discuss multivariate studentt weight first consider rule sr 1 ae case 2 therefore ae probability density ae proportional ae degrees freedom standard statistical procedure generate random ae density monahan 1987 standard procedure generating uniformly random vectors z um consists first generating x components x random normal01 setting z xjjxjj however combined procedure generating random vectors aez must equivalent generating random z wjjzjj therefore need generate components z random normal01 simpler procedure propose following algorithm random degree one rules degree one sphericalradial rule integration algorithm 1 input ffl f nmax 2 3 repeat b generate random x x normal01 c 4 output oe v n input ffl error tolerance input nmax provides limit time algorithm output oe e standard error integral estimate algorithm computes v using modified version stable onepass algorithm chan lewis 1979 unscaled sample standard error oe e usually error bound approximately 68 certainty users algorithm desire higher degree confidence scale oe e appropriately example scale factor 2 increases certainty level approximately 95 error estimates obtained scaling oe e algorithm algorithms section used caution low n values error estimates based use central limit theorem infer sample averages sr approximately normal careful implementation algorithms section could include nmin parameter andor use larger scale factor oe e small n values large n scaled oe e provide robust statistically sound error estimate long multivariate normal model adequately represents tails posterior density posterior densities thicker tails often efficiently reliably handled using multivariate studentt model one technique monitoring discussed monahan genz 1996 consider studentt weight see density ae proportional r change variable shows proportional beta see devroye 1986 generating methods random aes uniformly random vectors z um needed sr 1 easily generated also show ju jt formula formula multivariate normal case making appropriate changes line 3b 3c previous algorithm modified algorithm could produced next consider rule sr 3 qae integration parts therefore probability density ae proportional ae m1 e gammaae 2 2 chi density m2 degrees freedom propose following algorithm stochastic degree three rules degree three sphericalradial rule integration algorithm 1 input ffl f nmax 2 3 repeat b generate uniformly random orthogonal theta matrix q c generate random ae chim 4 output oe v n random orthogonal matrices q generated using product appropriately chosen random reflections see stewart 1980 methods discussed devroye 1986 p 607 consider studentt weight case integration parts shows therefore require 2 case sr 3 becomes analysis shows r m1 proportional beta m2 density random aes sr 3 easily generated making appropriate changes lines 3c 3e previous algorithm modified algorithm could produced finally consider rule qae weight little algebra shows order develop algorithm qae need set regular msimplex unit vertices g use set given stroud 1971 page 345 correcting minor misprint v joint probability density ae ffi proportional aeffi m1 e gammaae 2 standard probability density transformation standard densities consider integral make change variables r 2 finally let sin sin z 1p function q m1 proportional standard betam density first inner integral resulting ae ffi second ae ffi cases equally likely sr 5 symmetric ae ffi loss generality always using ae ffi therefore choose r chi2m q betam density distributed joint probability density proportional aeffi m1 e gammaae 2 note changes variables could also used provide practical method generating corresponding ae ffi siegel obrien 1985 finite interval rules question addressed paper propose following algorithm stochastic degree five rules degree five sphericalradial rule integration algorithm 1 input ffl f nmax 2 compute msimplex vertices fv j g 3 repeat b generate uniformly random orthogonal theta matrix q set fv j g c generate random r chi2m set ffl 4 output oe v n consider studentt weight shown gamma2 gamma4 0 must 4 case could also produce formula sr 5 however found easy method generating random aes ffi needed r 5 consider anyway large gamma rules already developed multivariate normal weight effective possibly significant overhead cost sr 3 sr 5 rules generation random orthogonal matrices using algorithm given stewart 1980 shown cost generating one matrix q approximately 4m 3 3 floating point operations flops plus cost generating 2 2 normal01 random numbers sr 3 rules columns q used evaluation points 2m integrand values overhead cost per integrand value 2m 2 3 flops plus cost generating m4 normal01 random numbers integrand evaluation point available expect cost evaluation integrand least om components input variable integrand however application problems statistics posterior density often complicated expression made combination standard elementary functions evaluated using input variable components combined problem data see second example next section therefore om integrand evaluation cost measured flops expect constant om large 2m 2 3 flops generation evaluation point integrand evaluation significant unless large sr 5 rules q overhead cost per evaluation point drops approximately 2m3 flops plus cost m4 normal variates significant compared integrand evaluation cost typical statistics integration problems also note need m2 respectively rules sr 1 sr 0 per integrand evaluation normal variate overhead higher two lowest degree rules overall except simple integrands large values expect overhead costs four rules significant compared integrand evaluation cost 6 examples begin simple example following table results obtained using sr rules table test results sr rules values oe e oe e oe e oe e 1000 results expected much smaller standard errors higher degree rules second example use seven dimensional proportional hazards model problem discussed dellaportas wright 1991 1992 posterior density given aet first transform ae using x logae model p multivariate normal approximation use computing mode c logae logp added scaling constant e 20719 prevent problems underflow following table show results use sr rules approximate 2 expected vales integration variables constant table normalizing constant respective sr rules used computed value table 2 test results sr rules 120000 f 2 values integrand oe e oe e oe e oe e example sr 3 sr 5 rule results standard errors smaller sr 0 sr 1 rule standard errors factors average one half decrease standard errors inversely proportional square root number samples approximately four times much integrand evaluation work would needed problem using sr 0 sr 1 rules obtain errors comparable errors sr 3 sr 5 rules results good previous problem higher degree sr rules still approximately four times efficient lower degree rules degree five rule better degree three rule problem standardizing transformation problem apparently close enough multivariate normal rule degree higher three produce better results find significant difference running times needed four algorithms results table 2 supports analysis relative importance overhead costs different rules two examples section meant illustrate use algorithms given paper much extensive testing needed order carefully compare algorithms methods available numerical integration problems applied statistics testing work recently done methods refer interested reader paper monahan genz 1996 testing work still progress 7 concluding remarks shown derive low degree stochastic integration rules radial integrals normal studentt weight functions also shown new rules combined stochastic rules surface sphere provide stochastic rules infinite multivariate regions multivariate normal studentt weight functions results examples suggest averages samples rules provide accurate integral estimates simpler montecarlo importance sampling methods standard errors samples provide robust error estimates new rules r computing standard deviations accuracy methods numerical integration positive imbedded integration bayesian analysis numerical integration strategy bayesian analysis numerical quadrature cubature integration strategies problems statistical inference computing science statistics 24 monte carlo methods stochastic quadrature formulas continuous univariate distributionsi algorithm generating chi random variables comparison omnibus methods bayesian computation approximation multiple integrals using interpolatory cubature formulae unbiased monte carlo integration methods exactness low order polynomials efficient generation random orthogonal matrices application condition estimation approximate calculation multiple integrals tr