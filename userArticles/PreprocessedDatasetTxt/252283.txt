images preimages random mappings present general theorem used identify limiting distribution class combinatorial schemata example many parameters random mappings covered way particular derive limiting distribution points given number total predecessors b introduction random mapping 2 fn fn mean arbitrary mapping ng ng every mapping equal probability n n main purpose paper obtain limit theorems n tends innity special parameters random mappings eg number image points since every random mapping 2 fn equal probability suces count number radom mappings 2 fn satisfying special property eg number image points equals k dividing number n n get probability interest order get limit distribution n 1 necessary know exact value evaluate numbers asymptotically shalll show done singularity analysis proper bivariate generating function noted limit distributions random mappings well known compare 4 16 main goal provide general method derive limit theorems particular use bivariate generating functions singuarity analysis especially able characterize unknown limit distribution number points xed number total predecessors gaussian distribution basic combinatorial concept labelled combinatorial constructions relation exponential generating functions big advantage combinatorial constructions mark parameter constructions directly leads bivariate generating function number objects according size value parameter interest marking random mappings every mapping 2 fn identied functional graph g ng eg ng obvious component g consists cycle least loop every cyclic point root labelled tree see figure 1 hence interprete mapping 2 f set cycles trees since restriction structure trees usually known cayley trees recursively described root followed set trees structures f concept labelled combinatorial structures synthetized ph flajolet 11 see also 17 let us give short description structures let c combinatorial stucture labelled elements let jcj denote size c 2 c c number elements size n labelled means always n isomorphic elements dier labels furthermore associate labelled combinatorial structure c exponential generating function x jcj jcj advantage generating functions correspondence special combinatorial constructions special operations corresponding generating functions example labelled combinatorial structure c product c 1 c 2 note c 1 c 2 set theoretic cartesian product transform labelling labelling labelling ng c 2 c 1 c 2 since k isomorphic element c 1 n k isomorphic elements c 2 c 1k n k according 4 hence m1m applying concept random mappings exponential generating function generating function cayley trees given big advantage combinatorial constructions formally mark parameter constructions symbol like u marking directly leads bivariate generating function number objects according size value parameter interest example interested number trees graphs random mappings mark trees combinatorial construction formally leads log1 exactly generating function n u k numbers f nk random mappings k trees graph representation note number trees exactly number cyclic points interested number components mark get next use marking method describe special parameters related image preimage points points distance cycle first discuss preimages cyclic points purpose let denote cyclic points random mapping precisely interested noncyclic points distance cyclic points d1 x 1 exponential generating function random mappings points contained marked proof let x u denote exponential generating function labelled rooted trees nodes distance 0 root marked obviously tx directly leads txpoints indegree r another interesting parameter number points j 1 xed integer denote solution pr pr xu r 1 r 1 exponential generating function random mappings points marked proof according recusive structure cayley trees nodes indegree r followed r subtrees hence bivariate generating function trees variable u marking nodes indegree r m6r cyclic point functional graph random mapping indegree r indegree r 1 corresponding trees proves notice expression bivariate generating function simpler neglect edges cyclic points ie cyclic points marked indegree r 1 non cyclic points marked indegree r actually consider sequences cayley trees instead random mappings lemma 2bis exponential generating function sequences cayley trees marked nodes indegree r u lemma 2 points rantecedents finally want count points total number preimages equals r 0 denote solution r x r r r r exponential generating function random mappings points proof proof lemma 2 rst mark nodes total number preimages r cayley trees node marked root tree total size r root considered preimage hence get 14 r coecient x r series expansion functional equation 9 get lagranges inversion theorem cyclic points random mapping points corresponding component functional graph preimages hence component cyclic points bivariate generating function u marking number points r preimages r rr number forests composed components total size r directly gives 15 2 dth iterate points also interesting consider dth iterate image points lemma 4 set u solution exponential generating function random mappings points 2 marked proof clearly h x exponential generating function cayley trees height cayley trees dth iterate image points points distance leaf hence u bivariate generating function trees nodes leaf distance marked satises 16 random mappings since cyclic points dth iterate image points get leads 17 2 case points indegree r expression bivariate generating function simpler neglect edges cyclic lemma 4bis exponential generating function random mappings marked points distance leaf subtree lemma 4 direct dth iterate points dicult example combinatorial point view case dth iterate image points nonimage points ng words count nodes connected directed path length nonimage point nevertheless rather easy subcase edges cyclic points neglected ie problem reduced problem inside trees although small change turn corresponding limiting distibutions dier also case lemmas 2 4 vs lemmas 2bis 4bis lemma 5 set e e c xy 0 u solution log 1 exponential generating function random mappings marked points connected leaf path length contain cyclic edges note root tree size 1 also leaf proof let denote generating function cayley trees nodes leaf distance marked generating function leaves marked generating function trees leaf distance root x represents trees root distance lemma 5bis let c x l x u dened lemma 5 let f x u exponential generating function random mappings points 2 ng marked proof results points leaves random mappings cycles importance 2 situation gets delicate addition interpretations 1 x u 2 x u observe 12 x u corresponds trees leaf distance 1 root leaf distance 2 root sake shortness use terms 1 tree resp tree leaf distance 1 resp 2 root set w corresponds additionally marking 1 trees 2 trees way corresponds marking twice 2 trees 1 trees show end proof generating function corresponds cycle trees nodes leaf distance 2 marked amkl see counts number cycles length containing k l followed 2 tree since m1m log 1 immediately get 22 therefore remains interprete 23 problem cycle forces additional mark next root cycle next root marked ie corresponding tree 2 tree example cycle length contains 2 tree immediately clear 1 correct corresponding function whereas case cycle containing 2 trees generating function interest 1 2 remaining cases consider cycle containing exactly k 0 k 2 trees l 0 l trees followed tree 2 tree note l l 1 l 1 number arrangements labelled cycle length cases corresponding generating function 1 proves 23 2 3 general theorems generating function combinatorial structure bivariate generating function parameter interest marked ie cx cx interested asymptotic distribution parameter system combinatorial objects size n n tends innity purpose introduce sequence random variables dened pr denotes probability problem reduces nding limiting distribution xn important analytic schema related combinatorial constructions se quence set cycles cx u 1 ax u next three theorems study schema ax u algebraic singularity u squareroot type a1 1 according analytic properties ax u limiting distribution xn shown either gaussian rayleigh convolution gaussian rayleigh case global limit result convergence distribution functions accompanied local limit result convergence densities let us rst state precisely general form analytic schemas consideration hypothesis h let cx nk c nk x n u k power series two variables nonnegative coecients c nk 0 cx 1 radius convergence 0 suppose cx u expresses cx local representation r ju 1j jx uj argx u 6 0 0 xed real number gx u hx u u analytic functions furthermore functions satisfy addition x u singularity circle convergence analytically continued region jxj hypothesis limiting distribution xn cx u depends 0 1 g u 1 1 stated following three theorems theorem 1 let cx u bivariate generating function satisfying h const ju 1j g u 1 0 sequence random variables dened rayleigh limiting distribution ie r density x exp x 0 expected value variance given r moreover following local law exp uniformly k 0 theorem 2 let cx u bivariate generating function satisfying h xn gaussian limiting distribution ie expected value variance given furthermore local law form exp uniformly k 0 theorem 3 let cx u bivariate generating function satisfying h limiting distribution xn convolution gaussian rayleigh distribution ie dened theorem 2 expected value variance given 4 n local law form exp exp uniformly k 0 z xexp dt 36 corresponding rayleigh distribution supported negative real axis similar local law holds remark noticed condition g theorems real restriction fact turns case g dicult one limiting distribution cases also found g 1 0 cx u local representation form r hand g 1 0 algebraic singularity dominating one hence weierstrass preparation theorem dx u local representation form u analytic functions satisfying 1 6 0 cases 37 38 apply benders theorem 5 compare also 6 7 get asymptotic normality 0 1 0 evaluating expected value shows 0 1 cannot positive const see also 14 case limiting distribution gaussian g 1 0 discrete g 1 0 example derivated geometric law schema cx finally want remark assumption const theorem 1 weakened 0 however proof would little bit complicated furthermore example known 0 const proving theorems 123 see section 5 want motivate theorems importance relation random mappings 4 applications random mappings section apply theorems obtain limiting distributions various parameters random mappings noted obtained results known intention provide results applying one general principle underlying point combinatorial specication random mappings cayley trees together analytic form cayley trees series imply bivariate generating functions constructed section 2 satisfy hypothesis h 41 analytic frame basic property solutions functional equations usually algebraic singularities squareroot type proposition 1 let f x u power series three variables nonnegative coecients f 0 0 suppose system equations positive solutions 0 0 x 0 0 supposed minimal contained region convergence f x u 0 41 exists unique analytic solution nk nk x n u k nonnegative coecients nk 0 ax u local representation r ju 1j jx uj argx u 6 0 gx u hx u analytic functions satisfy xed real number furthermore gcd nk 0 singularity circle convergence ju 1j exists 0 ax u analytically continued region jxj x proof proposition 1 combination implicit function theorem weierstrass preparation theorem cf 7 8 easy see connection random mappings combinatorial constructions solution ax u satisfying 1 functional equation type 42 used construct nal generating function less form cx u 1 ax u hence directly apply theorems obtain kind asymptotic distribution 42 distribution parameters examples mentioned section 2 cover three types limiting distribu tions gaussian rayleigh convolution noted applications 24 5 small structural modications neglecting cyclic edges lead dierent limit laws sake shortness mention weak convergence law however cases local law asymptotic expansions mean variance hold application 1 16 let xn denote number non cyclic points xed distance 0 cycle random mappings size n proof proposition 1 follows tx local representation kind ax bx analytic functions around x e 1 2 furthermore use taylor series expansion x u c lk u 1 l xe see x representation kind x 2 hence apply theorem 1 2 application 2 4 let r 0 xed integer let xn denote number points j 1 er proof let another application proposition 1 provides local representation r consequently 2 hence obain pr xu r pr xu r 1 r 1 g 1 2 system equations implicit dierentiation gives f 00 1 f pp f 3 x f pp f x thus apply theorem 2 2 application 2bis let r 0 xed integer let xn denote number nodes indegree r sequence cayley trees total size n 2 application 2 special case r 1 limiting distribution gaussian since proof case 1 equal 0 except 1 hence convolution results theorem 3 2 application 3 let r 0 xed integer let xn denote number points mappings 2 fn proof first notice analytic factor exp 15 uence parameters interest 0 1 00 1 therefore neglect hence proceed proof application 2 consequently obtain gaussian limiting distribution 2 application 4 let 0 xed integer let xn denote number points 2 e proof proof almost proof application 2 2 want mention mean value already determined 13 application 4bis let 0 xed integer let xn denote number points distance leaf subtree random mappings size n 2 application 4 e proof case hence convolution result 2 application 5 let 0 xed xn denote number nodes connected leaf path length containing cyclic edge random mappings size n dy c 1 limiting distribution gaussian special case proof proof runs along lines preceding ones apply theorem 3 since application 5bis let 2 f0 1 2g xed let xn number points ng 2 application 5 ie 2e 1e 1e e 1 e 1e 1e 2 2e 2e 1e e 1 e 22e 1e 2e 1 proof especially case calculate carefully cases case 2 combinatorial description much volved nevertheless may conjectured limiting distribution still gaussian 5 proof theorems proofs theorems 123 proceed following way first derive asymptotic expansions mean value variance prove weak limit theorem using characteristic functions nally establish corresponding local limit theorem procedure seems redundant fact aim prove special theorems provide example general method analyze asymptotic distribution parameter combinatorial constructions 51 preliminaries rst list useful formulae related gaussian rayleigh distributions lemma 6 let hankel contour starting e 2i 1 passing around 0 tending 1 then2i z e z z z 1e itx xe x 2 2 dx r z te u 2 2 du denotes characteristic function rayleigh distribution proof suces compare taylor expansion around hankel intregral representation z e z z z hand z 1x used duplication formula function 2 lemma 7 let lemma 6 then2i z e z e z z proof 53 54 follow immediately substitution lemma 8 let lemma 6 real constants then2izz z iw dz dw 55 proof since sides 56 interpreted analytic functions around real axis suces prove 56 case 0 case use substitutions apply polar substitution sin getz1 r dr z r dz iz dr dr 22 3exp integral solved using substitution z e residue theorem z dz z residues calculated completes proof lemma 82 52 proof theorem 1 rst derive asymptotic expansions mean value variance since get 1 hence similarly get next determine characteristic function xn n since ee itxn expand x n cx u purpose use cauchys formula z cz u dz z n1 following path integration jj major part hankel contour first let us concentrate path 1 using substitution get2i dz z n1 ds ze ds ne ds e log 2 n immediately get 60 lemma 62i dz z n1 2g make use fact 1 0 1 0 observe c nk 0 singularity circle convergence cx u local representation 56 hence follows c log n zcz u dz z n1 consequently 57 58 61 62 ee itxn 2g thus proved weak limit theorem order prove local limit theorem use cauchys formula z z cz u du dz z see 59 properly chosen mapping u 7 cz u polar singularity residue 1 hence transform way that2i z cz u du z cz u du g exp zz cz u du dz z n1 zexp ds np exp 4n elementary considerations obtain log n hence choosing estimate remaining integral zz cz u du dz z nally proved local limit theorem 53 proof theorem 2 c u 1 immediately get little bit rened analysis since determine z cz u dz z n1 use following path integration log arg log jj r directly get applying lemma 72i dz z n1 ze ds remains estimate integral 2 done proof theorem 1 since log n order prove local law use cauchys formula z z cz u dz z n1 du 1g proof weak limit theorem jtj g suciently small u 2 suciently small 0 first let direct approximation note jsj 1 z n u hence obtain using methods 12 saddle point like integration compare 92i 2 z dz z n1 du z ze itk n 1 ds dt exp therefore proof nished remaining integrals suciently small z dz z n1 du next get2i 2 z z cz u dz z n1 du since juj 1 suciently small constants finally since cz u bounded u 2 3 z 2 z z cz u dz z n1 du completes proof local theorem 54 proof theorem 3 proof theorem 2 get use normalization path integration 63 theorem 2 obtain applying lemma 62i dz z n1 ze ds exp r remaining integral 2 estimated hence proved weak convergence property order prove local law proceed proof theorem 2 concentrate path integration 1 1 remaining integrals negligible direct approximation yields2i 2 z dz z n1 du z ze itk n 1 nt ds dt hence application lemma 8 easy tail estimates complete proof theorem 3 6 conclusions main purpose paper provide general techniques obtain limiting distribution parameters combinatorial constructions second paper planed series papers 10 devoted topic theorems 13 considered examples analytic theorems providing link combinatorial constructions asymtotic distributions seem proper theorems discuss random mappings authors convinced methods presented preceding proofs used many dierent problems basic ideas singularity analysis introduced flajolet odlyzko 12 saddle point approximation random mappings widely intensively discussed literature eg kolchins book 15 probabilistic approach via branchning processes presented whereas aldous pitman 3 use completely dierent probabilistic concept related aldous continuum random trees 1 2 concept generating functions goes back arney bender 4 flajolet odlyzko 13 could identify many limiting distribution provided asymptotic expansions mean variance one gap could lled application 3 mentioned arney bender 4 discussed little bit general case namely number immediate predecessors point fgj arbitrary must contained subset nonnegative integers ie corresponding tree function x satises functional equa tion corresponding generating function mappings proposition 1 follows contains number 2 squareroot singularity around similar situation classical case especially adapt combinatorial constructions general case obtain analog results applying theorems r continuum random tree continuum random tree iii brwonian bridge asymptotics random map pings central local limit theorems applied asymptotic enu meration central local limit theorems applied asymptotic enumeration asymptotic distributions multivariate darboux method enumeration problems height distribution leaves rooted trees bivariate asymptotic expansion coe marking combinatorial constructions generating functions limiting distriubutions elements general theory combinatorial structures singularity analysis generating func tions random mapping statistics special limit distributions new york limit distribution number nodes low strata random mapping tr ctr bernhard gittenberger nodes large degree random trees forests random structures algorithms v28 n3 p374385 may 2006 cyril banderier philippe flajolet basic analytic combinatorics directed lattice paths theoretical computer science v281 n12 p3780 june 3 2002