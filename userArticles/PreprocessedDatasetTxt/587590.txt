affine invariant convergence analysis inexact augmented lagrangiansqp methods affine invariant convergence analysis inexact augmented lagrangiansqp methods presented theory used construction accuracy matching iteration errors truncation errors arise inexact linear system solvers theoretical investigations illustrated numerically optimal control problem burgers equation b introduction paper concerned optimization problem following type minimize jx subject suciently smooth functions x real hilbert spaces types problems occur example optimal control systems described partial dierential equations solve p use augmented sequential quadratic programming technique developed 11 method dierential equation treated equality constraint enforced lagrangian term together penalty functional present algorithm secondorder convergence rate depends upon secondorder sucient optimality condition comparison sqp methods augmented lagrangiansqp method advantage global behavior certain examples found less sensitive respect starting values region secondorder convergence rate reached earlier see eg 11 15 17 shall point penalty term augmented lagrangian functional need implemented rather realized firstorder lagrangian update augmented lagrangiansqp methods applied problem p essentially newton type methods applied kuhntucker equations augmented optimization problem newton methods behavior dierent linear transformations studied several authors see 5 6 7 8 10 instance paper combine lines work present ane invariant setting analysis implementation augmented lagrangiansqp methods hilbert spaces ane invariant convergence theory inexact augmented lagrangiansqp methods presented theoretical results used construction accuracy matching iteration errors truncation errors arise inexact linear system solvers paper organized follows 2 augmented lagrangiansqp method introduced necessary prerequisites given ane invariance introduced karlfranzensuniversitt graz institut fr mathematik heinrichstrae 36 a8010 graz austria konradzusezentrum fr informationstechnik berlin zib takustrae 7 14195 berlin germany weiserzibde work author supported deutsche forschungsgemeinschaft dfg sonderforschungsbereich 273 volkwein weiser 3 4 ane invariant convergence result augmented lagrangiansqp method presented two invariant norms optimal control problems analyzed 5 inexact lagrangiansqp method studied 6 last section report numerical experiments done optimal control problem burgers equation onedimensional model nonlinear convectiondiusion phenomena 2 augmented lagrangiansqp method let us consider following constrained optimal control problem minimize jx subject real hilbert spaces throughout distinguish functional dual space riesz representation hilbert space hilbert space x endowed hilbert space product topology brevity set let us present example p illustrates theoretical investigations used numerical experiments carried 7 details refer reader 18 example 21 let denote interval 0 1 set given define space w 0 hilbert space endowed common inner product controls state w 0 given weak solution unsteady burgers equation robin type boundary conditions ie satisfies x yt x ft denotes duality pairing h 1 dual suppose f l recall w 0 continuously embedded space continuous functions 0 l 22 denoted c0 l see eg 3 p 473 therefore 21a makes sense every controls u v associate cost tracking type jy u z l 2 q 0 fixed let introduce bounded operator whose action defined ey u v l 2 0t h ey u given g h 1 mapping 1 neumann solution operator associated optimal control problem written form p c 0 augmented lagrange functional associated p defined following assumption rather standard sqp methods hilbert spaces supposed hold throughout paper assumption 1 let x x reference point j e twice continuously frechetdierentiable mappings j e lipschitzcontinuous neighborhood x b linearization e operator e x surjective c exists lagrange multiplier satisfying firstorder necessary optimality conditions frechetderivative respect variable x denoted prime exists constant 0 ker e ker e denotes kernel null space e remark 22 context example 21 write x proved 18 assumption 1 holds provided z l 2 q suciently small next proposition follows directly assumption 1 proof refer 12 13 instance proposition 23 assumption 1 holding x local solution p furthermore exists neighborhood unique solution 22 neighborhood mapping x l c x bounded quadratic func tion fact referred augmentability l c formulated next proposition proof refer reader 11 4 volkwein weiser proposition 24 exist neighborhood u x constant c 0 mapping x l c x coercive whole space x x u remark 25 due assumption 1 proposition 24 convex neighborhoods x jx ex twice frechetdierentiable second frechetderi vatives lipschitzcontinuous ux c l 0 x coercive kernel e x point z unique solution 22 u exist 0 c 0 x c c 23 shorten notation let us introduce operator x u firstorder necessary optimality conditions 22 expressed find x numerically solve os newton method frechetderivative operator f c u given denotes adjoint operator e x remark 26 assumptions 1 holding exists constant c 0 satisfying see eg 9 p 114 bz denotes banach space bounded linear operators z formulate augmented lagrangiansqp method algorithm 1 choose c solve x linear system set back b remark 27 since x hilbert spaces equivalently obtained solving linear system setting equation 27 corresponds newton step applied os form iteration requires implementation e c algorithm 1 see 11 case example 21 requires least one additional solve poisson equation 3 ane invariance let arbitrary isomorphism transform x variable thus instead p study whole class equivalent transformed minimization problems subject e transformed solutions setting g c firstorder necessary optimality conditions form applying algorithm 1 os get equivalent sequence transformed iterates theorem 31 suppose assumption 1 holds let starting iterates algorithm 1 applied optimality conditions os os respectively sequences iterates welldefined equivalent sense proof first note frechetderivative operator g c given 33 prove 32 use induction argument assumption identity 32 holds suppose 32 satisfied k 0 implies using step b algorithm 1 follows 33 conclude utilizing step algorithm 1 get desired result due previous theorem augmented lagrangiansqp method invariant arbitrary transformations b state space x nice property course inherited convergence theory termination criteria 4 develop invariant theory example 32 usual local newtonmysovskii convergence theory cf 14 p 412 ane invariant leads unsatisfactory description domain local convergence consider optimization problem subject unique solution x associated lagrange multiplier note jacobian f 0 depend context remark 25 choose neighborhood 6 volkwein weiser x c x x fig 31 illustration example 32 contour lines cost functional constraint areas occupied subplots b neighborhood ux gray kantorovich ball theoretically assured convergence white original problem formulation c ux kantorovich ball better formulation ux kantorovich ball better formulation plotted coordinates original formulation defining newtonmysovskii theory essentially guarantees convergence starting points kantorovich region denotes spectral norm symmetric matrices 2 euclidean norm choice u resulting 1945 section kantorovich region plotted figure 31b dierent choice coordinates however yields significantly dierent result transformation problem 34 written subject neighborhood u better constants 1859 result section kantorovich region shown figure 31c transformed back space figure 31d reveals much larger domain theoretically assured convergence better formulation problem however evident contrast convergence theory invariant linear transformations automatically includes best formulation remark 33 invariance newtons method limited transformations type 31 fact newtons method invariant arbitrary transformations domain image space ie behaves exactly af c f c special gradient structure optimization context meaningful transformations coupled due chain rule meaningful transformations result transformations underlying optimization problem ie transformations domain space image space constraints type x general transformations possibility define norm invariant way since domain image space constraints transformed x reason dierent types transformations studied dierent problems see eg 6 7 10 4 ane invariant convergence theory formulate convergence theory termination criteria terms appropriate norm use norm invariant transformation 31 definition 41 let z u norms z z r z u called ane invariant os f c zz z z u z z 41 call z zu continuous family invariant norms os every r z z z u z z u using ane invariant norms able present ane invariant convergence theorem algorithm 1 theorem 42 assume assumption 1 holds constants continuous family ane invariant norms z zu operator f c satisfies z 0 1 z u z z coz z z u co denotes convex hull k n let h suppose h 0 2 level set lz 0 closed iterates stay u residuals converge zero rate k 8 volkwein weiser additionally f c z k1 z k f c z k z k 45 proof induction assume lz k closed h k 2 k 0 due remark 25 neighborhood u assumed convex z 0 1 f c z k z conclude ds ds 0 1 applying 42 43 h z k ds holds z k z k exists 0 1 z k ie contradiction hence z k1 z k 2 thus h k1 h 2 closed every cauchy sequence lz k1 converges limit point lz k 44 continuity norm also contained lz k1 hence lz k1 closed finally using 46 result 45 obtained remark 43 choose simplicity sharpness definition level set lz sharpened somewhat careful estimate term theorem 42 guarantees lim k h ensure z k z z k require canonical norm z z bounded appropriately ane invariant norms z corollary 44 addition assumptions theorem 42 exists constant c 0 z z u iterates converge solution z proof assumption theorem 42 thus z k kn cauchy sequence lz 0 u since lz 0 closed claim follows remark 25d actual implementation algorithm 1 need convergence monitor indicating whether assumptions theorem 42 may violated termination criterion deciding whether desired accuracy achieved 45 new iterate z k1 accepted whenever f c z k1 z k f c z k z k 47 otherwise assumptions theorem 42 violated iteration considered nonconvergent use norm z k old new iterate permits ecient implementation since many cases norm f c z k1 z k defined terms z derivative need evaluated new iterate factorization f c z k available via direct solver reused negligible cost even convergence test fails iterative solver used z k1 general provides good starting point computing z k1 additional cost introduced convergence monitor minor sqp iteration terminated solution z k1 soon user specified tolerance tol use norm z k allows ecient implementation 5 invariant norms optimization problems remains done construction continuous family invariant norms section introduce two dierent norms 51 first invariant norm first norm takes advantage parameter c augmented lagrangian mentioned remark 25 exists c 0 l c z coercive x z u c c hence operator belongs bz c c let us introduce operator z u c 0 51 since l c z selfadjoint z u c z selfadjoint well due 23 operator c z coercive z u c c thus z u norm z c c proposition 51 let c c every z u mapping volkwein weiser defines ane invariant norm 22 proof let z u arbitrary since 12 defines norm z c c f c z continuously invertible remark 26 follows z norm z prove invariance property 41 let l c denote augmented lagrangian associated transformed problem 31 setting r 33 conclude u using 53 54 obtain gives claim order show continuity 42 required theorem 42 need following lemma lemma 52 suppose c c exists constant 0 z z u z z z z u proof let z z u 51 52 infer assumption c z continuously invertible utilizing lipschitz assump tion 55 second additive term righthand side estimated note implies inserting 57 56 claim follows proposition 53 let hypotheses lemma 52 satisfied z zu 3 2continuous family invariant norms f c z z 58 z z u introduced 23 proof 53 follows estimate additive terms righthand side separately using lemma 52 find applying 53 55 obtain hence using 12 volkwein weiser follows z zu 3 c e 2continuous family invariant norms finally z z infer 58 52 second invariant norm 51 introduced invariant norm provided augmentation parameter algorithm 1 satisfies c c many applications constant c explicitly known thus l c x 1 need bounded c 0 c c x given 51 might singular overcome diculties define second invariant norm based splitting x least coercivity l 0 x ker e x utilized even though thus defined norm used larger value c may improve global convergence properties see 16 section 23 begin let us introduce bounded linear operator c lemma 54 every x u c 0 operator c x isomorphism proof let r x arbitrary equation c x equivalent due remark 26 operator f c x continuously invertible x u c 0 thus uniquely determined 59 claim follows define bounded linear operator r c x u c 0 510 note r c x coercive selfadjoint next introduce invariant norm z z u r 1 r 2 z shorten notation write r c z 12 c z first additive term proposition 55 every z u mapping given 511 ane invariant norm os equivalent usual norm z proof let z u arbitrary since r c z coercive c z continuously invertible follows z defines norm indeed equivalent usual norm z prove invariance property 41 x u 5 utilizing 33 511 512 invariance property follows following proposition guarantees z zu continuous family invariant norms os proposition 56 suppose exists constant 0 z z u z z z z u proof previous proposition use following lemmas lemma 57 assumption proposition 56 holding z x follows ker e proof let using 510 511 obtain c 0 operator r c z continuously invertible furthermore r c z selfadjoint thus applying 513 second additive term righthand side 514 estimated inserting bound 514 claim follows lemma 58 let assumptions theorem 56 satisfied z r x proof arbitrary r x set 1 using 59 513 estimate z z 14 volkwein weiser claim follows proof proposition 56 let z z utilizing 511 lemmas 57 58 find z z therefore z hence z zu 32continuous family invariant norms remark 59 note lipschitz constant second norm involve c e hence independent choice c contrast choosing c small may lead large lipschitz constant first norm thus aect algorithm example 510 let us return example 32 using second norm theoretically assured ane invariant domain convergence shown figure 51 compared figures 31 b shape size clearly similar noninvariant domain convergence better formulation definition change coordinates change x fig 51 illustration examples 32 510 neighborhood ux gray ane invariant domain theoretically assured convergence white 53 computational eciency ane invariance two norms developed previous sections come free evaluation norms involved evaluation standard norm nevertheless computational overhead first norm defined 51 almost negligible since general implemented one additional matrix vector multiplication requires however suciently large parameter c hand second norm defined 52 works arbitrary c 0 requires one additional system solve jacobian dierent right hand side case factorization matrix available computational overhead negligible compare cpu times exact newton method 7 however system solved iteratively additional system solve may incur substantial cost case first norm preferred 54 connection optimization problem solving optimization problems type p feasibility optimality relevant quan tities well reflected proposed norms z let z x using taylors theorem see 19 p 148 continuity l 0 obtain first norm z second norm based partitioning f c x correspondingly splitting newton correction optimizing direction tangential constraints manifold feasibility direction f c x 1 z recall thus proximity solution ane invariant norms measure quantities interested solving optimization problems addition error lagrange multiplier optimizing directions lagrange multiplier component respectively 6 inexact augmented lagrangiansqp methods taking discretization errors truncation errors resulting iterative solution linear systems account consider inexact newton methods inner residual remains z inexact newton methods studied non ane invariant setting dembo eisenstat steihaug 4 bank rose 1 volkwein weiser slightly stronger assumptions suitable control inner residual similar convergence theory established 4 note exact ane invariance preserved case inner iteration ane invariant theorem 61 assume assumption 1 holds constants continuous family ane invariant norms z zu operator f c satisfies z 62 0 1 z u z z z define level sets suppose z 0 u lz 0 closed inner residual r k resulting inexact solution newton correction 61 bounded iterates stay u residuals converge zero k rate f c z k1 z k1 f c z k z k 65 proof analogously proof theorem 42 one obtains ds 66 0 1 using 66 62 42 63 find 0 1 z k ds z k z k 61 63 thus setting 67 f c z k z k z k using 64 follows 64 f c z k z k z k1 u 0 1 coz k z k 2f c z k z k contradicts 610 thus z k1 u furthermore inserting therefore lz k1 lz k closed next corollary follows analogously corollary 44 corollary 62 addition assumptions theorem 61 exists constant c 0 cf c z z z z u iterates converge solution z os actual implementation inexact newton method following theorem 61 need satisfy accuracy requirement 64 thus need error estimator inner iteration computing k also easily computable estimates lipschitz constants case suitable theoretical values derived setting 66 readily obtain z k hence lower bound z k unfortunately norms involve solutions newton type systems therefore cannot computed exactly assuming relative accuracy evaluating norms respectively define actually computable estimate volkwein weiser would like select k accuracy matching condition 64 unfortunately due local sampling global lipschitz constant inexact computation norms estimate k possibly small translating possibly large tolerance inexact newton correction order compensate introduce safety factor 1 require approximate accuracy matching condition hold obvious choice would 1 propositions 53 56 infer order magnitude thus take estimate currently ignoring c e using first norm convergence monitor 47 used detect nonconvergence inexact setting however convergence monitor may also fail due k chosen large therefore whenever 47 violated reduction k promising eg newton correction recomputed reduced k remark 63 inner iteration used approximately solving newton equation 61 provides orthogonality relation z k z k scalar product z k induces ane invariant norm estimate 611 tightened substituting k furthermore norm z k exact newton correction computationally available permits construction algorithms robust even large inaccuracies k application conjugate gradient method confined null space linearized constraints 2 augmented lagrangiansqp methods focus future research 7 numerical experiments section devoted present numerical tests example 21 illustrate theoretical investigations previous sections solve p apply socalled optimizethendiscretize approach compute approximate solution discretizing algorithm 1 ie discretizing associated system 26 context example 21 x reduce size system take advantage relationship sqp steps u v controls sqp step lagrange multiplier fact infer algorithm 1 inserting 71 26 obtain system unknowns note second frechetderivative lagrangian given solution u v 26 computed follows first solve x x z q obtain u v 71 details refer reader 18 time integration use backward euler scheme spatial variable approximated piecewise linear finite elements programs written matlab version 53 executed pentium iii 550 mhz personal computer run 71 neumann control first example choose grid given 50 50 solve 21 apply newton method time step algorithm needs one second cpu time value cost functional 0081 turn optimal control problem choose desired state zt view choice z nonlinear convection term yy x 21b interprete problem determining u way counteracts uncontrolled dynamics smoothes discontinuity transports left increases discretization 72 leads indefinite system 73 starting values algorithm 1 take volkwein weiser taxis xaxis optimal optimal controls u v taxis fig 71 run 71 residuum yt zt l 2 optimal controls table run 71i decay fc z k1 z k first norm first solve 73 lufactorization matlab routine lu theory 4 applies according 4 stop sqp iteration case f c z 0 z 0 large factor 10 3 righthand side 74 might big avoid situation algorithm 1 terminated 74 addition holds augmented lagrangiansqp method stops four iterations cpu times dierent values c found tables 76 77 let us mention algorithm needs 1027 seconds divergence algorithm 1 proved 15 set admissible starting values reduces whenever c enlarges value cost functional 0041 figure 71 residuum yt zt l 2 solution 21 optimal state plotted furthermore optimal controls presented decay f c z k1 z k first invariant norm given 53 dierent values c shown table 71 recall invariant norm defined c c unfortunately constant c 0 unknown proceed follows choose fixed value c compute table run 71i values k dierent c table run 71i decay fc z k1 z k second norm level sqp iteration whenever k greater zero coercivity direction sqp step otherwise c needs increased table 72 present values k observed numerically k positive increased c increased next tested second norm introduced 511 augmented method stops four iterations needs 974 seconds cpu time thus invariant norms lead similar performance algorithm 1 decay f c z k1 z k found table 73 ii solve 73 inexact generalized minimum residual gmres method matlab routine gmres preconditioner gmres method took incomplete lufactorization matrix utilizing matlab function luincd1e03 matrix p discretization heat operator xx homogeneous robin boundary conditions x preconditioner used newton steps chose 6 introduced estimators constants denoted k k respectively thus k 0 calculate k k determine k1 follows first norm f c z k z k z k already determined computation previous newton correction thus case second norm f c z k z k z k calculated given tolerance k tests take k k 0 starting values choose test four strategies choice turns obtain best performance respect cpu times hence following 22 volkwein weiser table run 71ii decay fc z k z k first norm table run 71ii values k test examples take decay f z k z k presented table 74 algorithm 1 stops seven iterations let us mention c estimates k coercivity constant positive particular augmented lagrangiansqp method best performance table 75 values estimators k presented table 76 cpu times first norm presented turns performance inexact method change significantly dierent values k since solve additional linear system level sqp iteration order compute second norm first norm leads better performance inexact method respect cpu time compared part cpu time reduced 50 one takes first norm case second norm reduction 45 77 finally test inexact method using decreasing k choose 1 turns strategy speeds inexact method norms expected theoretical complexity model developed 7 run 72 robin control choose 10 0 desired state taken zt first solve 73 lufactorization take starting values stopping criteria run 71 augmented lagrangiansqp method stops four iteration needs 105 seconds cpu time discrete optimal solution plotted figure 72 table 78 follows 47 satisfied exact 975 968 969 table run 71ii cpu times seconds first norm first norm second norm exact 975 974 table run 71ii cpu times seconds norms numerically let us mention 0 3 positive c needed cpu times refer tables 710 711 ii solve 73 inexact gmres method preconditioner take run 71 choose k decay f z k z k presented table 79 part find k 0 test runs needed cpu times shown tables 710 711 see inexact augmented lagrangiansqp method gmres much faster exact one using lufactorization first norm cpu time reduced 55 second norm 50 k 03 04 05 06 07 moreover example best choice c smaller values k method speed significantly run 71 test inexact method using decreasing k choose 1 run 71 strategy speeds inexact method significantly norms reduction 9 compared cpu times fixed k compare table 711 table run 72i decay fc z k1 z k dierent c volkwein weiser0501 0505taxis optimal state tx 113optimal controls u v taxis fig 72 run 72 optimal state controls table run 72ii decay fc z k z k exact 1051 1057 1057 table run 72ii cpu times seconds first norm first norm second norm exact 1051 1055 table run 72ii cpu times seconds norms r global approximate newton methods subspace cascadic multigrid method mortar elements mathematical analysis numerical methods science technology newton methods nonlinear problems local inexact newton multilevel fem nonlinear elliptic problems finite element methods navierstokes equations inexact gauss newton methods parameter dependent nonlinear problems augmented lagrangiansqpmethods hilbert spaces application control coecient problems optimization vector space methods first secondorder necessary sucient optimality conditions infinitedimensional programming problems iterative solution nonlinear equations several variables nonlinear functional analysis applications tr ctr anton schiela martin weiser superlinear convergence control reduced interior point method pde constrained optimization computational optimization applications v39 n3 p369393 april 2008 volkwein lagrangesqp techniques control constrained optimal boundary control burgers equation computational optimization applications v26 n3 p253284 december