stochasticperturbation global optimization algorithm distance geometry problems present new global optimization approach solving exactly inexactly constrained distance geometry problems distance geometry problems concerned determining spatial structures measurements internal distances arise structural interpretation nuclear magnetic resonance data prediction protein structure problems naturally formulated global optimization problems generally large difficult global optimization method present related previous stochasticperturbation global optimization methods finding minimum energy configurations several key differences important success computational results show method readily solves set artificial problems introduced mor wu 343 atoms set considerably difficult protein fragment problems introduced hendrickson method solves problems 377 atoms exactly finds nearly exact solution remaining problems 777 atoms preliminary results indicate approach good promise helping solve distance geometry problems b introduction distance geometry problems concerned determining spatial structures measurements internal distances arise structural interpretation nuclear magnetic resonance data prediction protein structure methods calculating conformations biological molecules distance constraints become important tool structural biochemistry solving distance geometry problem context would determine threedimension shape protein critical understanding chemical biological properties general reviews distance geometry problem relationship structure chemical molecules see crippen havel6 havel8 kuntz thomason oshiro10and brunger nilges1 distance geometry problem naturally formulated nonlinear global optimization objective function constructed distance constraints satisfied global solutions prob lem simple objective function defined enforce constraints optimization problem believed computationally intractable general shown strongly npcomplete one dimensional case 6 13 strongly nphard higher dimension case 14 large number methods solving distance geometry problems proposed crippen havel6 havel8 hendrickson9 glunt hayden raydan7 wu12 13 method present paper based stochasticperturbation global optimization approach4 2 3 5 several new features purpose paper describe approach demonstrate capabilities difficult distance geometry problems larger context research continue develop understand capabilities stochasticperturbation global optimization methodology found successful several largescale global optimization problems arising molecular chemistry stochasticperturbation algorithm combines first stochastic phase identifies initial set local minimizers second deterministic phase moves low even lower local minimizers second phase incorporating partially separable structure problem work smalldimensional global optimization subproblems local minimizers fulldimensional space selection small dimensional subproblems important algorithmic features specific distance geometry problem experimented algorithm wus artificial problems 12 protein fragment problems hendrickson9 artificial problems even first phase find exact solutions great success protein fragment problems considerably difficult found exact solutions solutions problems 377 atoms 1131 parameters another important issue dealing distance constraints may exist molecular structure satisfying given distance con straints due measurement experimental errors practice lower upper bounds distances specified instead exact distances therefore algorithm intended deal exact inexact distance geometry problems larger protein problems hendrickson9 777 atoms 2331 parameters algorithm found approximate solutions maximum relative error distance 004 computational successes problems considerable size appear indicate algorithm powerful tool solving distance geometry problems remainder paper structured follows section 2 describes distance geometry problems current approaches developed problems section 3 describe stochasticperturbation algorithm used deal distance geometry problems framework algorithm outlined several new features discussed sec tion followed extensive experimental results method distance geometry problems section 4 section 5 contains brief conclusions comments future research 2 distance geometry problems mentioned earlier solving distance geometry problems important tool determining threedimensional structure molecule ideal case distance geometry problems concerned finding positions 3 subset atom pairs given distance atom j usually many fewer 2 2 elements small subset pairwise distances known may exist solution x distance con straints due error theoretical experimental data exam ple guaranteed happen data atoms violate triangle inequality general distance geometry problem lower upper bounds distances specified instead exact values case distance geometry problem find set positions x l ij k x l ij u ij lower upper bounds distance constraints respectively distance geometry problems constraints 21 22 naturally phrased nonlinear global optimization problem objective function constructed constraints satisfied global minimizers optimization problem one simple approach utilize paper penalize unsatisfied constraints formulate distance geometry problem terms finding global minimizers function ij2s l 2 approach taken wu13 order compare results wu12 also use following function exact problem ij2s w ij positive weights function 24 exact distance geometry problems l ij clearly solves problem 22 x global minimizer fx 24 problem 21 solution x equivalent global minimizer function 25 function value 0 difficulty solving distance geometry problem arises several sources first problem strongly npcomplete one dimension strongly nphard higher dimension6 14 13 therefore unlikely efficient algorithm solving cases problem found also huge numbers local minimizers functions 24 25 makes challenging locate basin attraction global minimizer shown function 25 exponential number local minimizers9 another important aspect distance geometry problems large contain hundreds atoms thus even calculation local minimizer makes heavy demands computer time previous work chemists distance geometry problems depends intrinsic properties chemical structure solu tions often methods use special heuristics based chemical properties generate initial configurations perform local optimizations method hendrickson9 particular interest paper difficult test problems use taken paper hen dricksons method also utilizes chemical structure information works well test problems generated bovine pancreatic ribonucle ase protein containing 124 amino acids relies assumption distances highly accurate contrast general global optimization approaches distance geometry problem utilize information solution structure utilizing problemspecific information may ultimately desirable important understand capabilities general global optimization approaches distance geometry problems work type includes multistart method wus continuation approach 12 13 former set starting points randomly generated local minimization performed method simple easy implement highly unreliable context distance geometry problems usually large huge number local min imizers continuation approach original function transformed smoother function fewer local minimizers series local optimization algorithms applied transformed function tracing minimizers back original function experimental results wu show approach markedly superior multistart method following section describe stochasticperturbation algorithm distance geometry problem algorithm general global optimization method applies exact inexact problems utilize smoothing approach work wu approach could readily combined smoothing techniques indeed experience minimum energy conformation problems showing combination smoothing stochasticperturbation global optimization approach promising framework see eg 15 3 stochasticperturbation global optimization method new algorithm distance geometry problems based stochasticperturbation global optimization method constructed solve largescale global optimization problems approach successfully applied lennardjones problems 4 water cluster problems 2 protein conformation problems 3 basic framework global optimization method distance geometry problems outlined algorithm 31 method combines initial phase locates low local minimizers second phase moving low even lower local minimizers first phase full dimensional random sample generated domain space randomly independently placing atom worst configurations discarded better ones improved selecting moving atom pair atoms function value configuration falls specified threshold level subset improved configurations used start points full dimensional local optimization algorithm local minimizers found phase passed second phase improvement second phase local minimizer successively selected improvement discussed pair atoms chosen smallscale stochastic global optimization algorithm applied configuration two atoms variables remainder configuration fixed followed full dimensional local minimizations starting best configurations resulted smallscale global optimization step lowest new configurations merged list local minimizers phase iterated fixed number times key feature approach phases make use strategies work small subset atoms initial phase approach used improve sample points sampling one atom pair atoms time step 1b leaving remaining atoms temporarily fixed pair atoms chosen pair algorithm 31 framework largescale global optimization algorithm distance geometry problems 1 initial generation configurations phase sampling full domain randomly generate coordinates sample points sampling domain evaluate fx new sample point discard sample points whose function value global cutoff level b oneatomtwoatom sampling improvement remaining sample point energy sample point threshold value repeat ffl select atom contributes function value pair atoms violates ideal distance ffl randomly sample location selected atoms ffl replace atoms sample point new sample coordinates give lowest energy value c start point selection select subset improved sample points step 1b start points local minimizations fulldimensional local minimizations perform local minimization start point selected step 1c collect number best minimizers improvement phase 2 2 improvement local minimizers phase number iterations select configuration list fulldimensional local min imizers select local minimizer pair atoms optimized transform configuration multiplying position atom relative center mass configuration constant factor 125 20 larger c twoatom small global optimization apply global optimization algorithm expanded configuration two atoms chosen step 2a variables fulldimensional local minimization apply local minimization procedure using atoms variables lowest configurations resulted twoatom global optimization merge new local minimizers merge new lowest configurations existing list local minimizers constraint distance given problem formulation refer constrained pair atoms constrained pair atoms used step 1b sampling done distance atoms always constraint value ffi ij second phase small subproblem approach used move constrained pair atoms existing configuration new positions via smallscale global optimization step 2c small global optimization locates best possible position selected atoms current configuration remaining atoms temporarily fixed step 2c samples constrained pair atoms distance kept constraint value small subproblem steps efficient due partial separability objective functions distance geometry problem make cost evaluating function one two atoms moved much less expensive cost full function evaluation atom pair atoms chosen smallscale steps one seems potential improving overall configuration moving atom pair phase 1 atom contributes overall function value thus appears greatest potential reducing function value selected phase 2 alternatively phase 1 constrained pair atoms worst violation ideal distance selected early experiments also employed oneatom smallscale global optimization heuristic second phase experimental results suggested difficult problems twoatom approach effective locates lower configurations oneatom strategy many problems two strategies equally effective reason used twoatom approach phase 2 may cases moving one atom enough force configuration region attraction current local minimizer choice local minimizer improve phase 2 important heuristic method experimentation previous problems concluded strategy balances selecting breadth configurations working best current configurations effective approach used distance geometry problem another important feature algorithm 31 expansion step step b phase 2 expands configuration around center mass prior smallscale global optimization expansion step used first minimum energy water cluster problems significantly improved ability phase 2 iteration find improved configurations improvement apparently due expansion creating room move atom atoms variables smallscale global optimization local optimization step contracts configuration new hopefully improved local minimizer physical analogy expansion heating annealing drawback expansion local minimizations phase 2 become expensive initial intuition expansion would appropriate distance geometry problems leads large violations distance constraints found algorithm without expansion step didnt perform well phase 2 step 2d configurations returned local minimizer step started step 2a possibly due relatively small number constraints distance geometry problems means atom involved small number distance constraints therefore moving pair atoms doesnt change configuration sufficiently current local minimum found expansion step added smallscale global optimization step far successful producing significantly different improved configurations experimented different expansion factors range 125 25 problems expansion factor 125 20 effective problems expansion factor 20 25 helpful order consistent stochastic aspect algorithm test problems next section expansion factor chosen randomly 125 20 final useful feature implementation captured algorithm 31 progression problems approach mean difficult problems solve sequence problems form 24 increasingly tight constraints ie lower upper bounds distances phase 1 applied first problem loosest constraints phase 2 applied problem best configurations previous looserconstrained problem forming starting set configurations phase 2 next tighterconstrained problem motivation approach came experimentation easier problems applying algorithm 31 problem directly successful difficult problems noticed finding global minimizer function 24 directly much difficult starting work distance geometry problem looser distance constraints gradually tighting constraints applied phase 2 expected accuracy approach sense similar continuation methods additional advantage real problems may know exactly accurate given distances approach find solutions best accuracy possible fact chemists care finding reasonable solutions exact solutions approach coincides idea yields algorithm tailored find reasonable configurations 4 experimental results run algorithm set artificial distance geometry problems wu 12 13 set protein fragment test problems generated hendrickson9 problems given exact distances order exactly inexactly constrained problems function 24 used l 2 values epsilon given later test problems large hundreds thousands atoms therefore implemen tation used limited memory bfgs algorithm11 perform full dimensional local minimizations whereas smallscale local minimizations within smallscale global optimization step used standard method experiments conducted intel paragon multiprocessor artificial distance geometry problems 12 13 molecule atoms located threedimensional lattice integer 1 problem determine structure molecule given ffi ij 2 r integer 1 first experiment artificial problem find global minimizers using exact function 25 using w first problem domain b domain 2b r fval gval global fval gval global 343 table 41 phase 1 results artificial problems function 25 ran phase 1 molecules starting domain space domain 2b problems reported 12 13 oneatom moves used step 1b numerical results presented table 41 fval gval global number function gradient evaluations global solutions total minimizers respectively although phase 1 cant find global solution either smaller domain space larger one last two problems recall phase 1 simply designed provide initial configurations second phase accounts work algorithm experience problems already solved phase 1 particularly difficult global optimization problems note also phase 1 sense similar multistart algorithm except oneatom twoatom steps compared multistart results 12 phase 1 works quite well context also ran artificial problems using exact version function 24 ie results runs given table 42 oneatom moves used step 1b table 42 shows using function 24 phase 1 already finds global solutions problem cases indicates particularly difficult global optimization problems comparison table 41 seems indicate using exact version function 24 creates easier problem using function 25 believe function 24 smoother finally marked difference problem domain b domain 2b r fval gval global fval gval global 343 table 42 phase 1 results artificial problems function 24 results table 42 multistart results given problems function 24 13 global minimizers never found however results directly comparable results 13 24 tables 43 table 44 give results applying phase 2 set artificial problems using functions 25 24 tables fls sls total number full dimensional small dimensional local optimizations respectively ffval pfval number full function evaluations partial two atoms change function evaluations respectively results show function 25 applying phase 2 allows method readily solve two problems solved phase 1 relocate global minimizers problems many times function 24 half local minimizations find global minimizer results show algorithm 31 successful artificial problems comparison efficiency method wu 12 13 difficult part give costs second papers mainly smoothing useful technique makes problems easier solve used algorithm proceeded set significantly difficult test problems problems generated hendrickson 9 bovine pancreatic ribonuclease typical rather small protein containing 124 amino acids hendrickson derived set twelve test problems using fragments consisting first 20 40 60 80 100 amino acids well full protein two sets distance constraints size distance information given problems exact meaning global problem fls ffval sls pfval global 343 50 33624 15168 1827104 940 table 43 phase 2 results artificial problems function 25 problem fls ffval sls pfval global 343 100 17853 39068 4097761 4781 table 44 phase 2 results artificial problems function 24 minimizer constraints satisfied exactly problems 63 777 atoms 189 2331 parameters wu 13 tested method smallest problems using function 24 reported success values twelve problems hendrickson 9 applied phase 2 repeatedly function 24 decreasing ffl runs usually chose values used wu 13 two smallest problems however started 002 whereas largest problems may find global solutions subproblem proceed subproblems value ffl generally performed 50 iterations phase 2 applied phase 1 first subproblem using constrained pair atom moves step 1b numerical results hendrickson problems summarized table 45 first two columns record number atoms given distance constraints third column last fflproblem solve successfully progression problems approach final column maximum relative error distances respect ideal distances best solution subproblem maximum relative error defined table 45 shows first seven problems 63 377 atoms 189 1131 parameters find global solutions problems remaining five problems 472 777 atoms 1416 2331 parameters solve problems relative accuracy levels 001 004 results indicate approach potential locate exact nearly exact solutions quite large distance geometry problems without using particular structural information finally briefly discuss costs algorithm 31 protein fragment problems analyzed costs two typical runs 63atom 102atom problems 63atom problem entire solution process required 692488 full function evaluations 2416214 partial function evaluations 102atom problem entire solution process required 498500 full function evaluations 952836 partial function evaluations detailed timings show full dimensional local optimization steps phase 1 2 dominate cost algorithm problems accounting 80 total time steps relatively inexpensive therefore cheaper local optimization algorithm number distance final final atoms constraints subproblem relative error 236 957 000 81e4 287 1319 000 81e4 table 45 results protein fragment problems reduce total cost algorithm alternative way reduce cost would work internal coordinates advantage approach number variables greatly reduced generally factor ten although problem longer partially separable parameterization overhead reevaluation partial function gradient values relatively minor compared reduction local optimization cost disadvantage approach already uses structural information problem namely primary structure protein may considered contrary goal assessing potential generalpurpose global optimization methods distance geometry problems 5 summary future research presented new global optimization algorithm intended solve exactly inexactly constrained distance geometry problems algorithm utilizes smallscale global optimization calculations selected subsets parameters performed stochastic global optimization method key part approach structure related previous stochas ticperturbation global optimization methods molecular clusters protein folding several important differences particular three algorithmic choices helped success method none anticipated us initially first expand configuration smallscale global optimization second select linked pair atoms rather single atom parameters smallscale global opti mization third solve progression distance geometry problems constraint bounds become tighter tighter computational tests artificial problems 343 atoms 1029 variables difficult protein fragment problems 777 atoms 2331 variables indicate method successful located configurations satisfying given distance constraints results protein problems especially indicate method quite successful solving large apparently difficult distance geometry problems without using information solution structure many directions continuing research con sidering one use two atoms smallscale global optimization step phase 2 increases cost smallscale global optimization dominant cost strategy able solve 480 atom problem subproblem 000 level second possible direction use buildup approach one finds approximate solutions subsets problem way solving full problem third perhaps intriguing direction combine smoothing approach like wu 12 13 stochasticperturbation global optimization technique recent research protein folding shown combination great potential fi nally stochasticperturbation approach part production distance geometry code one would want find ways combine chemical structural knowledge chemists use solution problems acknowledgement thank zhijun wu bruce hendrickson providing test problems also thank zhijun wu many helpful communications research r computational challenges macromolecular structure determination xray crystallography solution nmrspectroscopy new stochasticperturbation method largescale global optimization application water cluster problems parallel global optimization method solving molecular cluster polymer conformation problems new largescale global optimization method application lennardjones problems global optimization methods protein folding problems distance geometry molecular conformation molecular conformation distance matrices evaluation computational strategies use determination protein structure distance geometry constraints obtained nuclear magnetic resonance molecule problem exploiting structure global optimization distance geometry limited memory bfgs method large scale optimization global continuation distance geometry problems embeddability weighted graphs kspace strongly np hard global optimization molecular clusters using new smoothing approach tr ctr le thi hoai solving large scale molecular distance geometry problems smoothing technique via gaussian transform dc programming journal global optimization v27 n4 p375397 december