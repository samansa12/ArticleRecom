twice differentiable spectral functions function f space n n real symmetric matrices called spectral depends eigenvalues argument spectral functions symmetric functions eigenvalues show spectral function twice continuously differentiable matrix corresponding symmetric function twice continuously differentiable vector eigenvalues give concise usable formula hessian b introduction paper interested functions f symmetric matrix argument invariant orthogonal similarity transformations orthogonal u symmetric department combinatorics optimization university waterloo waterloo ontario n2l 3g1 canada email aslewismathuwaterlooca research supported nserc department combinatorics optimization university waterloo waterloo ontario n2l 3g1 canada email hssendovbarrowuwaterlooca research supported nserc every function decomposed map gives eigenvalues matrix f symmetric function see next section details call functions f spectral functions functions eigenvalues depend spectrum operator classical interest functions arose important role quantum mechanics 7 20 nowadays inseparable part optimization 11 matrix analysis 4 5 modern optimization key example semidenite programming one encounters problems involving spectral functions like log deta largest eigenvalue constraint must positive denite many examples property spectral function f actually equivalent corresponding property underlying symmetric function f among rstorder dierentiability 9 convexity 8 generalized rstorder dierentiability 9 10 analyticity 26 various secondorder properties 25 24 23 also worth mentioning chevalley restriction theorem context identies spectral functions polynomials symmetric polynomials eigen values secondorder properties matrix functions great interest optimization application newtons method interior point methods 13 secondorder nonsmooth optimality conditions 19 requires know secondorder behaviour functions involved mathematical model standard reference behaviour eigenvalues matrix subject perturbations particular direction 6 secondorder properties eigenvalue functions particular direction derived 25 problem interests us paper spectral function twice dierentiable function matrix rather particular direction hessian continuous analyticity discussed 26 thus result lies sense results 9 26 smoothness properties special spectral functions largest eigenvalue certain manifolds helpful perturbation theory newtontype methods see example 15 16 18 17 22 21 14 show spectral function twice continuously dierentiable matrix corresponding symmetric function twice con tinuously dierentiable vector eigenvalues thus particular spectral function c 2 restriction subspace diagonal matrices c 2 example schatten pnorm symmetric matrix pth root function eigenvalues matrix see latter function c 2 p 2 although analytic unless p even integer part general result also give concise easytouse formula hessian results 26 analytic functions rather implicit paper selfcontained results derived essentially scratch making use complexvariable techniques 2 ex ample parallel paper 12 give analogous characterization spectral functions quadratic expansion point may twice dierentiable notation preliminary results follows n denote euclidean space n n symmetric matrices inner product ha vector eigenvalues ordered nonincreasing order n denote set nn orthogonal matrices vector x r n diag x denote diagonal matrix vector x main diagonal x denote vector entries x ordered nonincreasing order x 1 x n let r n denote set vectors x r n x 1 x 2 x n let also dened diag m1 denote sequence symmetric matrices converging 0 m1 denote sequence orthogonal matrices describe sets r n functions r n symmetric invariant coordinate permutations denotes function dened open symmetric set property permutation matrix p x 2 domainf denote gradient f rf f 0 hessian r 2 f f 00 vectors understood column vectors unless stated otherwise whenever denote vector r n make convention thus r number distinct eigenvalues dene corresponding partition call sets blocks denote standard basis r n e vector entries equal 1 also dene corresponding matrices arbitrary matrix denote ith row row vector ij denote jth entry finally say vector block rened vector b implies need following result r symmetric function twice dierentiable point 2 r n let p permutation matrix particular representation r1 e r1 r2 e r2 rr r rr e uv matrices dimensions ji u j ji v j entries equal ij1 real symmetric matrix b b 1 b n vector block rened j u identity matrix dimensions proof apply chain rule twice equality order get parts ii deduce block structure hessian consider block structure permutation matrices p permute rows columns hessian way dened p must stay unchanged using notation lemma dene matrix note 22 make convention ith diagonal block representation dimensions 1 1 set otherwise value b k uniquely determined dierence diagonal odiagonal element block note also matrix b vector b depend point function f lemma 23 2 r n sequence symmetric matrices mm 0 diag mm proof combine lemma 510 10 theorem 312 3 following main technical tool lemma 24 let fmmg sequence symmetric matrices converging 0 mm kmm k converges let r n um u 2 n sequence orthogonal matrices diag diag mm 2 following properties hold orthogonal matrix u form l orthogonal matrix dimensions ji l j ji l j l ii 2 l lim p2i l u ip 0 iii j belong block lim u ij iv 2 l l diag x l mx l l v l p 62 l lim u ip 0 vi indices 6 j lim p2i l u ip 0 vii indices 6 j l diag x l mx l l viii three indices j p distinct blocks lim u ip 0 ix two indices j 2 l lim p2i l u ip ks p2is u ip proof taking limit equation 2 left diag described representation matrix u follows ii let us denote use lemma 23 equation 2 obtain diag diag hm u equivalent form diag um divide sides equations kmm k rearrange diag um diag u diag hm u diag u diag um diag hm notice right hand sides equations converge nite limit increases innity call matrix limit right hand side rst equation l clearly limit second equation u lu going prove parts ii iii together inductively dividing orthogonal matrix um block structure u begin considering rst row blocks um let index rst block 1 limit ith entry matrix left hand side equation 4 lim u ip ks p2is u ip recall v 1 orthogonal matrix notice idiag x sum equation 6 1 get lim u ip ks u ip 0 notice coecients front k l numerator sum zero u ip r u ip us choose number add every coordinate vector thus shifting coordinates shifted vector rst block strictly bigger zero rest strictly less zero comment last limit remains true shift way rewrite last limit shifted vector summands positive immediately see must lim u ip lim u ip rst limits written lim u ip summands positive conclude lim u ip second limits implies immediately lim u ip thus proved part ii 2 1 part iii cases specied good place say words idea proof said divide matrix um blocks complying block structure vector exactly part matrix u proved part ii iii elements rst row blocks division going prove thing rst column blocks order x index 1 consider ith entry matrix left hand side equation 5 take limit lim u pi ks p2is u pi using also blockdiagonal structure matrix u proceed order conclude lim u pi lim u pi ready second step induction let index 2 limit ith entry matrix left hand side equation 4 lim u ip u ip r ks p2is u ip analogously summing limit 2 get lim u ip u ip r ks u ip 0 know 8 lim u ip 0 choose number exchange shifted version conclude lim u ip lim u ip repeat steps second column blocks matrix um inductively exhaust blocks completes proof parts ii iii iv proof part one needs consider ith entry right hand side equation 4 diagonal left hand side converges zero ii iii taking limit proves statement part v part follows immediately part iii vi taking limit equation 4 gives lim s6l ks p2is u ip p2i l u ip l ij jth entry limit right hand side equation 4 note coecients ks sum zero s6l p2is u ip p2i l u ip um orthogonal matrix part v s6l p2is u ip p2i l u ip required moreover l vii statement part detailed way writing fact proved previous part l viii part follows immediately part iii fact expression part viii identical one part v reiterated dierent index conditions later convenience ix take limit jth entry matrices sides equation 4 lim t6ls u ip p2i l u ip ks p2is u ip part viii lth sth summand converge zero hand mm diag hm u ij lim diag hm u u j rows dierent blocks diag hm kmm k converges diagonal matrix tools prove main result paper 3 twice dierentiable spectral functions section prove symmetric function f twice dierentiable point corresponding spectral function f twice dierentiable matrix recall hadamard product two matrices size matrix elementwise product let symmetric function f r n r twice dierentiable point 2 r n dene vector lemma 21 specically index say 2 l l 2 f1 2 rg dene ii ji l pq p 6 q 2 l lemma 21 guarantees second case denition doesnt depend choice p q also dene matrix ij notice similarity denition classical divided dierence constructions lowner theory see 1 chap v example simplic ity argument understood context write b ij following lemma theorem 11 9 lemma 31 let 2 n suppose belongs domain dierentiable point f dierentiable point case orthogonal matrix u satisfying recall standard notions twice dierentiability consider function f n r gradient point exists linear functional euclidean space n thus identied element n denote rf thus rf map n n map dierentiable say f twice dierentiable case interpret hessian r 2 f symmetric bilinear function n n r value particular point denoted r 2 f ah particular xed h function r 2 f ah linear functional n consider element n brevity denoted r 2 f ah hessian continuous say f twice continuously dierentiable case following identity holds t0 next theorem preliminary version main result theorem 32 symmetric function f r n r twice dierentiable point 2 r n f twice dierentiable point diag case hessian given hence proof easy see f must twice dierentiable point whenever f twice dierentiable diag restricting f subspace diagonal matrices get function f interesting case direction let f twice dierentiable point 2 r n suppose contrary either f twice dierentiable point diag equation 10 fails dene linear operator lemma 31 tells us f least dierentiable around diag linear operator 0 sequence symmetric matrices fmm g 1 m1 converging 0 loss generality may assume sequence fmmg 1 m1 mm kmm k converges matrix subsequence fmm g 1 m1 surely property let fum g 1 m1 sequence orthogonal matrices diag diag mm without loss generality may assume um u 2 n otherwise take subsequences fmmg 1 m1 fumg 1 m1 inequality shows every corresponds pair precisely least one pair indices j ij least one pair indices call j innitely many numbers j corresponding pair necessary take subsequence fmmg 1 m1 fumg 1 m1 may assume without loss generality pair indices j last inequality holds dene symbol hm equation 3 notice using lemma 31 lemma 23 fact rf dierentiable get consider three cases every case going show left hand side inequality 11 actually converges zero contradicts assumption case using equation 12 left hand side inequality 11 less equal diag rf diag r 2 fhm going show summand approaches zero goes innity assume 2 l l 2 f1 rg using fact vector block renes vector rf lemma 21 part rst term written askmmk f 0 l p2i l u ip ss6l ks p2is u ip apply lemma 24 parts ii iii last expression concentrate second term using notation equation 1 r bdiag b term less equal diag diag bh diag bdiag mm approaches innity u dene vector h hm taking limits expression 13 turn diag bdiag going investigate term sum separately show actually equal zero rst use block structure matrix b see lemma 21 block structure vector h obtain r qs tr x using fact 2 l v l orthogonal get l diag bh l l diag bhx l l r ls tr x l r ls tr x bdiag shows rst term zero second term use block structure vector b write diag next last equality use part iv lemma 24 l diag diag bh l l diag diag bhx l l l diag b k l l mx l l diag bdiag see second term also zero case ii 6 j l l 2 f1 2 rg using equation 12 left hand side inequality 11 becomes diag rf using fact block renes vector rf write rst summand askmm k s6l ks p2is u ip l p2i l u ip use parts v vi lemma 24 conclude expression converges zero left substituting r 2 diag b get diag diag bh recall notation lemma 21 used denote entries matrix b limit rst summand written lim r sl tr x l mx l p2is u ip u jp clearly p2is u ip u rg left following limit lim diag diag bh using lemma 24 part vii observe right hand side zero case iii 2 l j 2 l 6 using equation 12 left hand side inequality 11 becomes o1 diag rf diag r 2 fhm l ks ks start second term limit lim case u nonzero coordinates entries u j zero left lim diag rf l ks ks expand rst term limit diag rf l p2i l u ip ks p2is u ip t6ls u ip using lemma 24 part viii see third summand converges zero goes innity part ix lemma tells us lim p2i l u ip ks p2is u ip order abbreviate formulae introduce following notation l p2i l u ip substituting everything 14 get following equivalent limit lim l ks l ks ks l ks simplifying get lim ks l ks ks notice r l um orthogonal matrix numerator sum product ith jth row next lemma 24 part viii says lim t6ls lim completes proof nally ready give prove full version main result theorem 33 let nn symmetric matrix symmetric function twice dierentiable point spectral function f twice dierentiable matrix moreover case hessian spectral function matrix w orthogonal matrix w diag dened equation 9 hence diag hi proof let w orthogonal matrix diagonalizes ordered fashion let mm sequence symmetric matrices converging zero let um sequence orthogonal matrices diag w using lemma 31 get also goes innity w orthogonal matrix kwxw matrix x easy check result theorem 32 4 continuity hessian suppose symmetric function f r n r twice dierentiable neighbourhood point hessian continuous point theorem 33 shows f must twice dierentiable neighbourhood point section going show r 2 f also continuous point dene basis fh ij g space symmetric matrices entries matrix h ij zeros except jth j ith one one ith position suces prove hessian continuous applied matrix basis begin lemma lemma 41 let 2 r n let symmetric function f r n r twice continuously dieren tiable point let f g 1 m1 sequence vectors r n converging lim proof every permutation matrix pm p see beginning section 2 meaning bar vector nitely many permutation matrices namely n form n subsequences f g two vectors particular subsequence ordered descending order permutation matrix prove lemma every subsequence done without loss generality may assume p every xed permutation matrix p clearly large enough consequently matrix p blockdiagonal permutation matrices main diagonal dimensions matching block structure consider block structure vectors f g nitely many dierent block structures divide sequence subsequences vectors particular subsequence block structure prove lemma subsequence done without loss generality may assume vectors f g block structure every next using formula hessian theorem 33 lemma 21 together theorem 32 give us equations show without loss generality suces prove lemma case vectors f g ordered descending order vectors block rene vector case consider four cases case lim diag r r 2 f continuous case ii 6 j belong block j block well lim r 2 f continuous case iii j belong dierent blocks block lim prove lim ii see denition b beginning section 3 every dene vectors conclude sequences f converge f g 1 applying mean value theorem twice vector vector notice vector obtained swapping ith jth coordinate using rst part lemma 21 see f 0 finally take limit use continuity hessian f point case iv j belong dierent blocks dierent blocks lim rf continuous denominator never zero ready prove main result section theorem 42 let nn symmetric matrix symmetric function continuously dierentiable point spectral function f twice continuously dierentiable matrix proof know f twice dierentiable f twice dierentiable left prove continuity hessian suppose f twice continuously dierentiable f twice continuously dierentiable hessian continuous take sequence famg 1 m1 symmetric matrices converging 0 let fum g 1 m1 sequence orthogonal matrices without loss generality may assume um u u orthogonal otherwise take subsequences famg fumg using formula hessian given theorem 33 lemma 41 easily see lim every symmetric h contradiction direction follows chain rule observing completes proof 5 example conjecture example suppose require second directional derivative function f point direction b want nd second derivative function w orthogonal matrix wdiag aw let dierentiate twice using lemma 31 theorem 33 diag rfa diag principle function f analytic second directional derivative also computed using implicit formulae 26 work shows answers agree nal illustration consider classical example power series expansion simple eigenvalue case consider function f given kth largest entry x matrix function results show following formulae familiar perturbation theory quantum mechanics agrees result 6 p 92 conclude following natural conjecture conjecture 51 spectral function f ktimes dierentiable matrix corresponding symmetric function f ktimes dierentiable point moreover f c k f c k r matrix analysis derivations derivatives chain rules sensitivity analysis eigenvalues symmetric matrix matrix analysis topics matrix analysis short introduction perturbation theory linear op erators fundamental principles quantum mechanics convex analysis hermitian matrices derivatives spectral functions nonsmooth analysis eigenvalues eigenvalue optimization quadratic expansions spectral func tions minimizing maximum eigenvalue symmetric matrix second derivatives optimizing eigenvalues symmetric matrices towards secondorder methods structured nonsmooth optimization wets variational analysis quantum mechanics first second order analyis nonlinear semid eigenvalue optimization valeurs propres de matrices sym analyticity functions involving eigenvalues tr ctr xin chen houduo qi liqun qi koklay teo smooth convex approximation maximum eigenvalue function journal global optimization v30 n23 p253270 november 2004 lin xiao stephen boyd seungjean kim distributed average consensus leastmeansquare deviation journal parallel distributed computing v67 n1 p3346 january 2007