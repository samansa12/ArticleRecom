balanced sequences optimal routing objective pursued paper twofold first part addresses following combinatorial problem possible construct infinite sequence n letters letter distributed evenly possible appears given rate second objective paper use construction framework optimal routing queuing networks show rather general assumptions optimal deterministic routing stochastic event graphs sequence b introduction rather general problem consider system multiple resources tasks tasks performed resource arrive system sequentially problem construct routing tasks resources minimize given cost function models common multiprocessor systems communication networks cost function may combined load resources show rather general assumptions optimal routing sequence terms expected average workload resource given balanced sequence sequence option route towards given resource taken evenly distributed fashion inria bp 93 2004 route des lucioles 06902 sophia antipolis cedex france email alt mansophiainriafr urlhttpwwwinriafr80mistralpersonneleitanaltmanmehtml inriacnrsinria bp 93 2004 route des lucioles 06902 sophia antipolis cedex france email gaujalsophiainriafr z dept mathematics computer science leiden university pobox 9512 2300ra leiden netherlands email hordijkwileidenunivnl research arie hordijk done sabbatical leave inria sophiaantipolis partially supported ministre franais de lducation nationale et de lenseignement suprieur et de la recherche motivates rst part paper essentially based word combinatorics uses specic vocabulary part relies heavily results 9 17 problem balanced sequences exactly covering sequences studied using combinatorial well arithmetic techniques 20 23 18 7 16 however studies analysis balanced sequences done per se present motivations applications particular use constructions discrete event dynamic systems may discovered seminal work hajek 10 1985 work solves one dimensional case problem generalized 1 goal present paper extend type results multidimensional case surprisingly dioecult dioeerent nature one dimensional case done second part paper show application balanced sequences routing problems part uses results convex analysis mainly 10 2 1 main results used two dioeerent kinds first use fact workload well waiting time customers entering max linear system multimodular functions fairly general assumption stationarity arrival process service times1 use general theorems 2 prove multimodular functions minimized regular sequences superposition several sequences balanced sequence basis main result paper interesting exhibit link balanced sequences scheduling prob lems routing among several systems precisely paper structured follows second section introduce formal denition balanced sequence present overview properties section 3 makes link notion balanced sequences optimal scheduling networks also devoted prove optimality balanced sequences routing customers multiple queue system section 4 presents special cases optimal rates computed balanced sequences section present notion balanced sequences closely related notion sturmian sequences 14 well exactly covering sequences presentation exhaustive many related articles consulted investigation topic 22 11 3 5 20 7 although section selfcontained presents several result interest mostly focus rate problem see problem 2 used application section 3 21 preliminaries let nite alphabet z set sequences dened u 2 z word w u nite subsequence consecutive letters u integer k length w denoted jw j 2 jw j number word w denition 21 sequence u 2 z balanced two words w w 0 u length 2 2 also dene indicator u letter function ffi otherwise support u letter set real number x bxc denote largest integer smaller equal x dxe denote smallest integer larger equal x lemma 22 sequence u 2 z balanced 2 exists real number lim p called rate ffi u proof let us dene rest proof classical subadditivity arguments proof fffi u n g n60 similar fact limits coincide obvious note sum rates letters sequence u one a2a present main result founds theory balanced sequences theorem 23 morse hedlund suppose sequence 2 f0 1g z balanced asymptotic rate letter 1 support 1 satises one following cases irrational case p irrational exists oe 2 r b periodic case p 2 q exists oe 2 q c skew case z sequences support form called bracket sequences theorem shows relation exists balanced sequences bracket sequences irrational case easiest case characterized see theorem 217 two rational cases dioecult study main objective studying balanced sequences application routing control see sections 3 4 analysis right tail sequence fu g ii 0 0 n maters also sequence u shifted version u 0 asymptotic performance see equation 7 hence consider two sequences equivalent note allows us consider skew case rational case equivalent denition 24 sequence 2 f0 1g z ultimately regular exists two real numbers p integer k n note equivalent theorem 25 let u 2 z ffi u regular 2 u balanced ii u balanced ffi u ultimately regular 2 proof straightforward ii direct consequence theorem 23 since three cases sequence ffi u ultimately regular elementary proof ii use theorem 23 found 21 13 sequence u said reduction property ffi u regular 2 corollary 25 shows u reduction property ultimately balanced 22 constant gap sequences constant gap sequences strongly balanced sequences following sense denition 26 sequence g constant gap letter ffi g periodic period form 0 note explains fact g said constant gaps letter since separated next g constant number letters proposition 27 constant gap sequences balanced proof letter ffi g form 0 therefore ffi g regular using characterization balanced sequences given theorem 25 shows g balanced proposition 28 constant gap sequences periodic proof letter ffi g periodic period p period g lcmp 2 next lemma give characterization constant gap sequences stresses fact constant gap kind strong balance proposition 29 g constant gap two nite words w w 0 included g jjw letter jjw j gamma jw 0 j j 6 1 proof let letter alphabet first assume g constant gap jw j gamma jw 0 j 2 necessarily jw 2 conversely let two words g subwords u u 0 ju j ju 2 contradiction therefore ju g constant gap since constant gap sequence balanced letter appears given rate sequence note however since constant gap sequence necessarily periodic rate letter rational section 24 case balanced sequences address following question problem 1 given set p possible construct constant gap sequence n letters rates p solve problem general n give properties set p useful following noneoeective characterization p 23 name exact covering sequences denition 210 set couples f called exact covering sequence every nonnegative integer n exists one one 1 6 6 n general remark note p rational numbers form p smallest period g therefore k divides denition rates also p 1q letters following result proposition 211 rates p constant gap exists n numbers called couples f exact covering sequence proof property simple rewriting fact letter constant gap sequence appears every f ng suppose f exact covering sequence series coeoecient x n series equal therefore using characterization following interesting property lemma 212 18 assume f exact covering sequence appears least twice set q proof proof given similar discussion 23 exact covering sequences e 2ir integer r 1 denition w primitive rth root one set exactly set g equation 1 specied written implies set cannot reduced single point since w zero give concrete examples consider cases n small first note case k equal assume k 1 largest l 1 gap two letters 1 implies 2 2 proposition 213 exists constant gap sequence g rates proof let letter g gap l since alphabet contains two letters 1 means proposition 214 exists constant gap sequence g rates p following holds p 12 14 14 permu tation proof assume p 1 using equation 2 l therefore sequence obtained g removing letters 1 constant gap applying lemma 213 shows solution 14 associated constant gap sequence 1 2 1 3 proposition 215 exists constant gap sequence g rates p fp belongs set permutation proof give sketch elementary proof fact rates equal note equation 2 implies rates equal 2 consider letter assume number 1 two constant takes values hand impossible since l 1 6 2 therefore number 1 two constant true sequence formed removing 1 still constant gap rates form 13 13 13 12 14 14 point case analysis shows original sequence rates 12 14 18 18 12 16 16 16or13 13 16 16g inserting letter 1 constant gap sequence letters 2 3 4 examples constant gap sequences illustrate fact rates sequences strong constraints 23 characterization balanced sequences several studies recently done balanced bracket sequences 13 20 21 16 15 9 characterization involving constant gap sequences given proposition 216 graham let u balanced sequence alphabet f0 1g construct new sequence replacing u subsequence zeros constant gap sequence g alphabet 1 subsequence ones constant gap sequence h disjoint alphabet 2 balanced alphabet 1 2 proof give proof similar huberts proof 11 let letter 1 proof similar letter 2 let w w 0 two words length corresponding words x x 0 u verify jjw since u balanced keep 0s x x 0 corresponding z z 0 words g satisfy g constant gap using lemma 29 jjzj gamma jz 0 j j 6 1 end proof noting construction z z 0 implies jzj jw j conversely following theorem theorem 217 graham let u 2 z balanced non periodic exists partition two sets 1 2 sequence v dened regular furthermore sequences z 1 z 2 constructed u keeping letters 1 2 respectively constant gaps proof theorem given graham 9 bracket sequences independent later proof found 11 balanced sequences relation balanced bracket sequences given theorem 25 makes proofs less equivalent 24 rates balanced sequences also note balanced sequence several asymptotic properties following lemma let us formulate precisely problem study section problem 2 given set p possible construct balanced sequence n letters rates p see following construction possible values rates p makes construction possible tuple said balanceable similar problem addressed 9 15 7 relations rates balanced sequences studied 25 case case well known balanced sequences two letters extensively studied see example 6 14 following result known even often given dioeerent forms theorem 218 1 set rates proof proof similar proof rst part theorem 25 construct sequence support function balanced sequence interval k k contains exactly shows value e dioeer one k varies balanced sequence 0 complementary set clear 0 asymptotic rate contains note proof theorem 218 also gives construction balanced sequence given rates 26 case case essentially dioeerent case 2 case possible rates balanceable essentially one set rates balanceable result formulated form partly proved conjectured 13 proved 20 earlier papers morikawa 16 similar result proved bracket sequences theorem 25 used result morikawa used directly prove following theorem therefore attribute result morikawa even result stated dioeerently theorem 219 morikawa set rates p two rates equal proof proof morikawa technical since use balanced property bracket sequences balanced property used proof becomes easy give proof slightly simpler proof 20 first assume let balanced sequence two letters fa bg constructed rates p 1 replace alternatively iais letters 1 2 get sequence 0 alphabet us show 0 balanced since balanced number iajs interval length k k 1 k 0 number ia 1 js resp ia 2 js interval either odd k2 even proves 0 balanced assume p 1 three dioeerent numbers assume try construct sequence w respective rates alphabet fa b cg step 1 sequence iacaj must appear w exists pair consecutive iaj ibj since means sequences iaaj iacaj appear iaaj appears icj necessarily surrounded two iajs step 2 sequence ibaabj must appear w exist pair consecutive ibj icj sequence form ba n bj n 6 1 possible presence iacaj bregularity implies existence ia aregularity incompatible iba n bj bregularity therefore 2 note also implies existence iaaj iabaabaj step 3 sequence iabacabaj appears w sequence w must contain icj icj necessarily surrounded two iajs since iaaj exists aregularity group necessarily surrounded two ibjs since ibaabj exists consequently necessarily surrounded two iajs since iabaabaj exists get sequence iabacabaj last step letter around word icj ibaabj exists none ibj since iacaj exists therefore two iajs note following two letters cannot icj existence iabaabaj iaj existence ibacj ibj followed necessarily iaj iaaj exists point sequence iabaabacabaabaj necessarily icjs end proof note icj necessarily word iabaabaj right word left finally note word iabaabaj necessarily surrounded two icjs therefore sequence w periodic form abacaba 27 case case similar case rates however two rates equal case complicated theorem 220 rate tuple p distinct rates balanceable p proof seems morikawa proved similar result bracket sequences ever using balanced property proof becomes much simpler suppose show one balanced sequence frequencies frequencies 815 415 215 115 preliminary remark note exists least one word contain j fact used several times following arguments proof involves dioeerent steps step 1 w contains words iacaj iadaj iacdaj iadcaj exists two consecutive iajs ibj therefore either iaaj iacaj iadaj iacdaj iadcaj exist iaaj exists icj surrounded two iajs step 2 w contains word ibaabj first show word iba n bj exists 2 indeed fact iadaj iacaj iacdaj iadcaj exist makes ibbj ibabj impossible hand existence ia necessary aregularity incompatible existence iba n bj bregularity word form iba n bj exists exist two consecutive ibjs one idj icj word 1 form ia ba j da k ba l j note numbers l may equal zero bregularity also exist two consecutive icjs idj word 2 cj note integers dioeer one length 1 js j impossible cregularity step 3 word iabacabaabacabaj exists w exists two consecutive icjs idj step 3 proof lemma 219 know icj necessarily surrounded word iabaj moreover step 4 proof lemma 219 iabacabaabaucabaj u word contains idj icj u cannot start iaj ibacabj cannot start ibj iacaj cannot start icj cannot start idj construction therefore u empty step 4 w uniquely dened periodic period iabacabadabacabaj somewhere w contains idj point extend word uniquely iabacabadabacabaj around idj word iabacabaabacabaj surrounded two idjs ends proof complete picture dioecult see proposition 221 tuple p made less two distinct numbers balanceable proof first rates equal obviously balanceable three construct balanced sequence rates 3p 1 construct balanced sequence rates p using proposition 216 take g constant gap sequence 1 2 3 two pairs rates equal say construct balanced sequence rates apply proposition 216 tuple p made exactly three distinct numbers complex case studied 28 general case section interested case arbitrary n first note proposition 221 easily generalizes dimension proposition 222 tuple p made less two distinct num bers balanceable proof proof similar proof proposition 221 proposition 223 p balanceable proof proof similar proposition 216 w balanced sequence letters consider sequence w 0 constructed starting w replacing ia 1 j element b 1 j ib cyclic way note w 0 following set rates p 1 k next show w 0 balanced since w balanced arbitrary integer number ia 1 js interval length n n 1 n w 0 number ib js interval either bn gamma 1kc bn 1kc proves w 0 balanced general case distinct rates natural give following conjecture due fraenkel bracket sequences conjecture 224 set distinct rates fp balanceable able prove fact morikawa also given insight problem clear whether completely proven partial results given following lemmas lemma 225 rates balance able n 2 n lemma iifj direction conjecture proof construct balanced sequence wn following inductive way first note wn rates show wn balanced induc tion sequence wn letter say letter appears 2 n gammaj times one period form 2 n gammaj gamma 1 intervals length 2 j one length construction wn1 properties still hold therefore wn1 balanced lemma 226 let w balanced rates particular means proof w periodic theorem 217 says w composed two constant gap sequences least one sequences least two letters therefore two letters rates equal lemma 212 therefore rates w two letters also equal lemma 227 let w balanced rates following property 1 6 6 n exists two consecutive letters ia j j lemma partial ionly ifj result conjecture proof proof holds induction let v k denote period balanced sequence rates 2 225 recall according construction proof lemma 225 prove induction w periodic period vn rst prove induction k w contains word v letter w ia j rst step induction note according property w w contains word ia 1 1 j iv 1 v 1 j therefore letter surrounded two ia 1 js also implies existence ia 1 2 1 1 2 1 j using similar argument step 2 proof theorem 220 ends case general case induction assumption k surrounded v kgamma2 word iv kgamma2 k v kgamma2 j existence iv kgamma2 proves word surrounded two ia js therefore two consecutive k form word u contain letter ia j j j k u contains ia u iv kgamma2 j impossible existence ia u contains letter ia j u reduced letter construction presence ia contradicts existence ia therefore u empty second part proof nish proof noticing letter surrounded vn gamma1 noting vn gamma1 necessarily surrounded ia n j lemma 228 assume w balanced assume p 05 projection w 0 w alphabet gamma fag also balanced proof choose two words 2 length n w 0 let v 1 v 2 two words w whose projections alphabet gamma fag v 0 furthermore rst last letters v 1 v 2 let denote number appearances letter v 1 v 2 resp dioeerence number occurrences letter b v 0and v 0 2 1 since w regular since number bs v 1 resp number v 0 step 2 assume l k 1 2 word obtained v 2 truncating rst last letter number 1 word obtained v 1 adding next letters appears v 1 sequence w j number 1 larger 2 contradiction fact w balanced step 3 remains check l 1 add v 1 next letter occurs w right form new word v 1 two successive letters contradicts fact asymptotic frequency least 12 v 1 v 2 number apply argument step 1 conclude number number occurrences letter b v 0 1 v 0 2 1 combining steps conclude w 0 balanced 29 extensions original problem far analyzed case rates add one dioeerent results tend prove rates balanced let us look generalization rates add one assume sequence alphabet lambdag require balanced letters special letter practical point view question viewed whether allows possibilities rates balanced ilossesj allowed represented letter general rates balanced even total sum small illustrated following lemma lemma 229 arbitrary 0 exists two real numbers p 1 p 2 sequence alphabet fa b lambdag asymptotic rate p 1 letter p 2 letter b balanced b proof choose two irrational numbers p 1 p 2 linearly dependent z assume exists sequence fa b lambdag asymptotic rate p 1 letter p 2 letter b balanced b theorem 25 exists two real numbers x ffi otherwise cube 0 set points x dense see example weyls ergodic theorem 19 therefore hits rectangle 1gammap possible kind problems found 21 end short overview balanced sequences must mention positive side iusualj rates 1k 1k often balanceable appendix 43 examples balanced sequences rates given 3 routing customers multiple queues notion balanced sequences gives birth large set elegant properties word combinatorics however rarely used domains balanced sequences dimension used discrete line drawing 14 also scheduling optimization 10 8 however case dioeerently higher dimension illustrated theorem 218 really grasp complexity model present application balanced sequences arbitrary dimensions scheduling optimization consider system sequence tasks executed several processing units tasks arrive sequentially task processed server routing control consists assigning task server processed routing optimal minimizes cost function measures performance system kinds models used study load balancing within several processors parallel processing problems well eoecient network utilization telecommunication systems 31 presentation model section consider precise queueing model system described customers enter multiple queue system composed k nodes node made several queues form event graph event graphs subset petri nets one input transition one output transition per place details dynamics event graphs found 4 particular dynamical behavior linear socalled max algebra 4 many queueing networks represented event graphs long inside choice route followed customers see 1 complete discussion issue routing customers dioeerent nodes controled sequence vectors g n f0 1g k means nth customer routed queue note feasible admission sequence long n link feasible routing policy innite sequence nite alphabet comes choosing alphabet composed letters using alphabet k letters feasible routing policy viewed innite sequence figure 1 shows illustration system considering denote n epoch nth customer enters system assume interarrival time sequence fffi g finally oe ij denote service time nth customer entering jth queue node sequences fffi k g foe ij considered random processes also make stochastic assumption sequences interarrival time customers service times form stationary processes assume interarrival times independent service times 32 optimal admission sequence node pick arbitrary server may last server node example performance criteria node traveling time server node 2 node 1 node k figure 1 illustration routing customers k node system virtual customer would enter node time n routing policy quantity depends values n rst routing choices routing sequence isolate routing decision node customer admitted node customer rejected node denote traveling time time n w particularly interested expected value traveling time respect service times servers contained node respect interarrival times w convex increasing function focus single node function w n studied 1 remarkable property fact function multimodular see 10 2 precise denition several properties multimodular functions merely point multimodularity closely convexity see 2 proposition 31 1 foregoing assumptions function w satises following properties increasing proof properties shown 1 using properties one derive 2 lower bound b ff p increasing ff p continuous routing following discounted costx k also given p dene regular sequence rate p arbitrary phase see denition 24 one show 2 p satises lim m1m however interested performance nodes together therefore choose cost function undiscounted average n linear combination expected traveling time nodes let h increasing linear consider undiscounted average cost feasible routing sequence point mimic general method developed 2 case use following notation objective minimize ga theorem 32 following lower bound holds policies proof due littlewoods jensens inequalities well equation 5 lim ff ff ff ff note 1 hence one may choose sequence ff following limits exist lim 1 continuity b ff ff get 8 note exists p achieves inmum since hb 1 p 1 bk p k continuous consider routing policy p given ip p condition feasibility policy p satised exists regular policy p feasible using correspondence routing policy sequence alphabet p correspond precisely balanceable rates theorem 33 assume p balanceable p optimal average cost ie minimizes ga feasible policies proof proof follows directly theorem 32 equation 6 4 study special cases problem remains addressed nd cases rate vector p balanceable present several simple examples make sure optimal rate p balanceable 41 case optimal rate vector form p theorem 218 says p always balanceable therefore optimal routing sequence given associated balanced sequence note approach give direct way compute value p however gives structure optimal policy figure 2 routing homogeneous queues 42 homogeneous case let k arbitrary node made single server servers identical model displayed figure 2 also assume function h symmetrical coordinates example sum waiting times symmetry convexity p function k p k balanceable associated balanced sequence round robin routing scheme applying theorem 33 yields following result new best authors knowledge theorem 41 round robin routing k identical g1 queues minimizes total average expected workload queues admission sequences information state system 12 round robin routing proved optimal separableconvex increasing order k identical gi1 queues method uses intricate coupling argument whereas proof simple corollary general theory multimodular functions illustrate advantage approach generalize result system composed k identical max linear systems single entry case symmetry argument used case simple queues still holds round robin routing policy minimizes traveling time system case includes models routing among several identical systems composed queues tandem example see figure 3 43 two sets identical servers consequence two previous cases consider system composed k 1 identical queues type 1 k 2 queues type 2 assume h symmetrical k 1 nodes type 1 symmetrical k gamma 2 nodes type 2 symmetry arguments optimal rate vector p form figure 3 routing queues tandem rate vector balanceable indeed implies weighted total average expected workload optimal routing balanced type nodes type weight many examples kind derived examples similar constructions appendix collection balanceable rates also give corresponding balanced sequence ffl 17 27 47 balanceable ffl 111 211 411 411 balanceable ffl 111 211 211 611 balanceable ffl 111 111 311 611 balanceable ffl 114 114 414 814 balanceable ffl real number balanceable corresponding balanced sequence constructed regular sequence rate p 1 replaced turn sequence abac 0 letter ffl n balanceable associated balanced sequence constructed recursively lemma 225 balanced sequence balanced sequence rates constructed following way choose balanced sequence letters b rate fi replace resp b 1 round robin fashion get balanced sequence required rates acknowledgment authors would like thank alain jeanmarie pointed reference 23 gave rst proof lemma 212 r admission control stochastic event graphs multimodularity convexity optimization properties complexity sequences dened billiards cube complexity trajectories rectangular billiards journal combinatorial theory optimal allocation sequences two processes sharing resource covering positive integers disjoint sets form f extremal splittings point processes optimal load balancing distrinuted homogeneous unreliable processors markov desicion chains partial information mots chapter trac disjoint sequences generated bracket function ivi eventually covering families generated bracket function iv symbolic dynamics ii sturmian trajectories roots unity covering sets introduction ergodic theory complementary triples sturmian sequences disjoint pairs sturmian bisequences combinatoire des motifs dune suite sturmienne bidimensionnelle academic press tr generating functionology optimization static traffic allocation policies combinatorial properties sequences defined billiard paved triangles pathwise optimal bernoulli routing policy homogeneous parallel servers combinatorics patterns bidimensional sturmian sequence minimizing service operation costs periodic scheduling optimal allocation sequences two processes sharing resource optimal load balancing distributed homogeneous unreliable processors ctr n brauner crama maximum deviation justintime scheduling problem discrete applied mathematics v134 n13 p2550 05 january 2004 berth robert tijdeman balance properties multidimensional words theoretical computer science v273 n12 p197224 february 2002 berth robert tijdeman lattices multidimensional words theoretical computer science v319 n13 p177202 june 10 2004 bruno gaujal emmanuel hyon alain jeanmarie optimal routing two parallel queues exponential service times discrete event dynamic systems v16 n1 p71107 january 2006 shinya sano naoto miyoshi ryohei kataoka mbalanced words generalization balanced words theoretical computer science v314 n1 p97120 25 february 2004 arie hordijk dinard van der laan note convexity stationary waiting time function density probability engineering informational sciences v17 n4 p503508 october arie hordijk comparison queues different discretetime arrival processes probability engineering informational sciences v15 n1 p114 january 2001 eitan altman bruno gaujal arie hordijk optimal openloop control vacations polling service assignment queueing systems theory applications v36 n4 p303325 december 2000 boris adamczewski balances fixed points primitive substitutions theoretical computer science v307 n1 p4775 26 september raphael rom moshe sidi hwee pink tan design analysis classaware recursive loop scheduler classbased scheduling performance evaluation v63 n9 p839863 october 2006