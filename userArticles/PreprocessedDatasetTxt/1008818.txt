rsaoaep secure rsa assumption recently victor shoup noted gap widely believed security result oaep adaptive chosenciphertext attacks moreover showed presumably oaep cannot proven secure onewayness underlying trapdoor permutation paper establishes another result security oaep proves oaep offers semantic security adaptive chosenciphertext attacks random oracle model partialdomain onewayness underlying permutation therefore uses formally stronger assumption nevertheless since partialdomain onewayness rsa function equivalent fulldomain onewayness follows security rsaoaep actually proven sole rsa assumption although reduction tight b introduction oaep conversion method 3 introduced bellare rogaway 1994 believed provide semantic security adaptive chosenciphertext attacks 7 12 based onewayness trapdoor permutation using corrected definition plaintextawareness 1 victor shoup 15 recently showed quite unlikely security proof exists least nonmalleability onewayness permutation also proposed slightly modified version oaep called oaep proven secure onewayness permutation shoups result mean oaep insecure impossible prove security oaep totally misleading view result states highly unlikely find proof onewayness assumption words shoups result preclude possibility proving security oaep stronger assumptions paper uses stronger assumption precisely reduc tion new computational assumption introduced prove existence simulator decryption oracle based idea prove oaep semantically secure adaptive chosenciphertext attack random oracle model 3 partialdomain onewayness underlying per mutation stronger original assumption since partialdomain onewayness rsa function 13 equivalent fulldomain onewayness security rsaoaep actually proven onewayness rsa function rest paper organized follows section 2 recalls basic notions asymmetric encryption various security notions section 3 reviews oaep conversion 3 sections 4 5 present new security result together formal proof general oaep applications section 6 focus rsa application oaep rsaoaep publickey encryption aim publickey encryption allow anybody knows public key alice send message able recover private key 21 definitions publickey encryption scheme defined three following algorithms key generation algorithm k input 1 k k security pa rameter algorithm k produces pair pk sk matching public secret keys algorithm k probabilistic encryption algorithm e given message public key pk e produces ciphertext c algorithm may probabilistic decryption algorithm given ciphertext c secret key sk returns plaintext algorithm deterministic 22 security notions first security notion one would like encryption scheme one wayness starting public data attacker cannot recover complete plaintext given ciphertext formally means adversary success inverting e without secret key negligible probability space thetaomega message space andomega space random coins r used encryption scheme internal random coins adversary ow mr however many applications require encryption scheme namely semantic security aka polynomial security indistinguishability encryptions denoted ind attacker information plain text example either yes crucial query adversary learn view ciphertext security notion requires computational impossibility distinguish two messages chosen adversary one encrypted probability significantly better one half advantage adv ind adversary seen 2stage turing machine negligible adv ind formally defined 2 theta pr br another notion defined thereafter socalled nonmalleability 6 adversary tries produce new ciphertext plaintexts meaningfully related notion stronger one equivalent semantic security interesting scenario 1 hand attacker use many kinds attacks since considering asymmetric encryption adversary encrypt plaintext choice public key hence chosenplaintext attack may furthermore access information modeled partial full access oracles plaintextchecking oracle input pair c answers whether c encrypts message attack named plaintextchecking attack 11 validitychecking oracle input ciphertext c answers whether valid ciphertext weak oracle involved reaction attacks 8 enough break famous encryption schemes 4 9 namely pkcs 1 v15 decryption oracle input ciphertext except challenge ciphertext responds corresponding plaintext nonadaptiveadaptive chosenciphertext attacks 10 12 latter adaptive chosenciphertext attack denoted cca2 clearly strongest one general study security notions attacks given 1 therefore refer reader paper details however expected security level publickey encryption schemes semantic security adaptive chosenciphertext attacks indcca2 adversary wants distinguish plaintext two messages choice encrypted ask query wants decryption oracle except challenge ciphertext strongest scenario one define 3 review oaep 31 underlying problems consider permutation f f0 1g k gamma f0 1g k also seen original description oaep 3 required f trapdoor oneway permutation however following consider two additional related problems partialdomain onewayness set partialdomain onewayness permutation f onewayness f means adversary whose running time bounded success probability succ ow upperbounded ow partialdomain onewayness f means adversary whose running time bounded success probability succ pdgammaow upperbounded set partialdomain onewayness f means adversary outputs set elements within time bound success probability succ sgammapdgammaow upperbounded denote succ ow resp succ pdgammaow succ sgammapdgammaow maximal success probability succ ow resp succ pdgammaow succ sgammapdgammaow maximum ranges adversaries whose running time bounded third case obvious additional restriction range fact outputs sets elements clear 1 succ sgammapdgammaow succ pdgammaow succ ow note randomly selecting element set returned adversary set partialdomain onewayness one breaks partialdomain onewayness probability succ sgammapdgammaow provides following inequality succ pdgammaow succ sgammapdgammaow however specific choices f efficient reductions may exist also cases three problems polynomially equivalent case rsa permutation 13 hence results section 6 32 oaep cryptosystem briefly describe oaep cryptosystem k obtained permutation f whose inverse denoted g need two hash functions g h specifies instance function f inverse g public key pk therefore f secret key sk g given message 2 f0 1g n random value r r encryption algorithm e pk computes outputs ciphertext thanks secret key decryption algorithm sk extracts k1 algorithm returns returns reject description denotes k 1 least significant bits denotes n significant bits paper 3 bellare rogaway provided security analysis proved oaep construction together trapdoor oneway permutation semantically security weakly plaintextaware unfortunately proves semantic security nonadaptive chosenciphertext attacks aka lunchtime attacks 10 indcca1 even achieved security believed stronger namely indcca2 never proven thus shoup 15 recently showed quite unlikely security proof exists trapdoor oneway permutation however provided specific proof rsa public exponent 3 following provide general security analysis stronger assumption underlying permutation indeed prove scheme indcca2 random oracle model 2 relative partialdomain onewayness function f precisely following exact security result holds theorem 1 let cca2adversary semantic security making q q g q h queries decryption oracle hash functions g h respectively succ pdgammaow 0 greater thanq h denotes time complexity function f order prove theorem relative partialdomain onewayness permutation one use related notion set partialdomain onewayness theorem follows inequalities previous section together lemma stated lemma 2 let cca2adversary semantic security making q q g q h queries decryption oracle hash functions g h respectively succ sgammapdgammaow q denotes time complexity function f next section devoted proving lemma hereafter repeatedly use following simple result lemma 3 probability events e f g ae 5 proof lemma 2 prove lemma 2 three stages first presents reduction ind adversary algorithm b breaking partialdomain onewayness f note present proof interested security partialdomain onewayness f fulldomain onewayness f original paper 3 second shows decryption oracle simulation employed reduction works correctly overwhelming probability partialdomain onewayness f latter part differs original proof 3 corrects recently spotted flaw 15 finally analyze success probability reduction total incorporation abovementioned analysis decryption oracle simulation 51 description reduction first part recall reduction operates let adversary semantic security k attacks within time bound asks q q g q h queries decryption oracle random oracles g h respectively distinguishes right plaintext advantage greater let us describe reduction b 511 top level description reduction 1 b given function f defined public key c aim b recover partial preimage c 2 b runs 1 public data gets pair messages fm well state information st chooses random bit b gives c 1 ciphertext b b simulates answers queries 1 decryption oracle random oracles g h respectively see description simulations 3 b runs 2 finally gets answer b 0 b simulates answers queries 2 decryption oracle random oracles g h respectively see description simulations b outputs partial preimage c one found among queries asked h see list queries asked h 512 simulation random oracles g h random oracle simulation simulate random oracle answers managing queryanswer lists glist hlist oracles g h respectively initially set empty lists fresh query fl g one looks hlist query ffi asked h answer h ffi one builds checks whether c ffi relation holds function f inverted still correctly simulate g answering g note g fl uniformly distributed value since latter uniformly distributed otherwise one outputs random value g fl cases concatenated glist fresh query ffi h one outputs random value h ffi pair concatenated hlist note fl g one may build relation holds inverted function f 513 simulation decryption oracle query decryption oracle decryption oracle simulation ds looks queryanswer glist ffi h hlist pair taken lists defines checks whether soon equalities hold ds outputs n pair found reject returned 514 remarks found preimage c thus inverted f could output expected result stop reduction analysis assume reduction goes b outputs list queries asked h 2 answered b 0 time limit even answer explicitly specified except random value new queries implicitly defined indeed c defined ciphertext randomly defined r seen random variable let us denote askg event query r asked g askh event query asked h let us furthermore denote gbad event r asked g answer something fixed reduction scenario note event gbad implies askg seen gbad event makes random oracle simulation imperfect chosenplaintext attack scenario chosenciphertext attack scenario described decryption simulator may sometimes fail event decryption failure denoted dbad thus denote 52 notations order proceed analysis success probability abovementioned reduction one needs set notations first still denote star variables related challenge ciphertext c obtained encryption oracle indeed ciphertext either 0 1 implicitly defines hash values corresponding pairs may appear g h lists variables refer decryption query c asked adversary decryption oracle thus decrypted simulation consider several events ciphertext queried decryption oracle cbad denotes union bad events ffl sbad denotes event ffl rbad denotes event askrs denotes intersection events oracle queries means r asked g h respectively since ffl askr denotes event r hs phi asked g ffl asks denotes event asked h fail denotes event decryption oracle simulator outputs wrong decryption answer query c precisely may denote fail event fail ith query c analysis however evaluate probabilities regarding event fail uniform manner hence employ notation fail therefore global reduction event dbad set true soon one decryption simulation fails note fail event limited situation plaintext extractor rejects ciphertext whereas would accepted actual decryption oracle indeed soon accepts see ciphertext actually valid corresponds output plaintext 53 analysis decryption oracle simulation analyze success probability decryption oracle simulator ds 531 security claim claim following repairs previous proof 3 based new computational assumption precisely show additional cases consider due corrected definition plaintext awareness 1 unlikely partialdomain onewayness permutation lemma 4 one ciphertext c directly obtained encryption oracle asked h decryption oracle simulation ds correctly produce decryption oracles output query ciphertext c 6 c probability greater 0 within time bound start analysis recall decryption oracle simulator given ciphertext c decrypted well ciphertext c obtained encryption oracle glist hlist resulting interactions random oracles g h let us first see simulation uniquely defines possible plaintext thus output first one finds indeed definition several pairs could satisfy equalities ever since function f permutation thus onetoone value uniquely defined thus ffi h ffi similarly uniquely defined thus fl g fl one may selected either k 1 one keep mind glist hlist correspond inputoutput pairs functions g h thus one output related given input ciphertext correctly built adversary r asked g h simulation output correct answer however output reject situation whereas adversary may built valid ciphertext without asking queries random oracles g h 532 success probability since goal prove security relative partialdomain onewayness f interested probability event fail askh occurred may split according events granted cbadaskrs simulation perfect cannot fail thus consider complementary events concerning latter contribution right hand side first note forgetting askh using lemma 3 one gets prfail cbad askrs less without asked r g taking account event rbad gr unpredictable thus probability phi gr k 1 2 gammak 1 hand probability asked r g without information hs thus r hs asked come conditioning asks sbad less q g delta 2 gammak 0 furthermore event independent askh yields focus former term fail cbad askh missing original proof 3 based weaker notion plaintextawareness split according disjoint subcases cbad sbad sbad rbad using lemma 3 latter event means rbad occurs provided adversary queried h asked h unpredictable independent hs well event rbad occurs probability 2 gammak 0 former event split according askr using lemma 3 upperbounded former event means r asked g whereas unpredictable thus hs unpredictable since r unpredictable probability event q g delta 2 gammak 0 probability asking r g hand latter event means simulator rejects valid ciphertext c whereas hs unpredictable r asked g onetoone property feistel network follows thus gr unpredictable redundancy cannot hold probability greater 2 gammak 1 sum prfail thus prfail cbad consequence running time simulator includes computation foe possible pairs thus bounded q g delta q h delta f o1 54 success probability reduction subsection analyzes success probability reduction respect advantage indcca2 adversary goal reduction given therefore success probability obtained probability event askh occurs reduction ie praskh running time reduction thus evaluate praskh splitting event askh according event bad first let us evaluate first term 2 k1 prdbad j askh q directly obtained lemma 4 prgbad j askh praskg j askh obtained fact event gbad implies askg askh occurs hs unpredictable hence praskg j askh q g delta 2 gammak 0 evaluate second term askh occurs hs unpredictable thus r predictable b well fact independent event bad hence 2 therefore 2 combining evaluation first second terms fact 55 complexity analysis note execution b new gquery fl one look queryanswer pairs ffi h ffi hlist compute well fs apparently one perform computation simulate decryption ciphertext proper bookkeeping allows computation done pair query asked hash functions thus time complexity overall reduction f denotes time complexity evaluating function f 6 application rsaoaep main application oaep certainly famous rsaoaep used update pkcs 1 standard 14 paper 15 shoup able repair security result small exponent using coppersmiths algorithm 5 however result applied repair rsaoaep regardless exponent thanks random selfreducibility rsa partialdomain onewayness rsa equivalent whole rsa problem soon constant fraction significant bits least significant bits preimage recovered note original rsaoaep 3 significant bits involved h function pkcs 1 standards v20 v21 14 rfc2437 least significant bits used value maskedseedkmaskeddb input f rsa function maskedseed plays role maskeddb role insist fact following result holds situations extended one may also remark following argument applied random multiplicatively selfreducible problem rabin function presenting final reduction let us consider problem finding small solutions linear modular equation lemma 5 consider equation solutions values ff except fraction 2 2k0 6 n u unique computed within time bound olog n 3 proof consider lattice say lff good lattice ff good value nonzero vector length respect euclidean norm otherwise use wording bad lattices bad values respectively clear approximately less 2 bad lattices bound 4 2 indeed bad value ff corresponds point integer coordinates disk radius thus proportion bad values ff less 4 2 n given good lattice one applies gaussian reduction algorithm one gets within time olog n 3 basis lff consisting two nonzero vectors u v let point u u solution equation c mod n u less 2 real since furthermore symmetry assuming set beginning 23 choose integer solution equation simply picking random integer u 0 setting write basis u v using real numbers ae oe coordinates found solution homogeneous equation thus indicate lattice unknown integers b gamma12 12 conclusion b closest integers gammaae gammaoe respectively b ae oe one easily recover thus u necessarily unique ut lemma 6 let algorithm outputs qset containing significant bits eth root input partialdomain rsa probability exists algorithm b solves rsa problem n e success probability proof thanks random selfreducibility rsa part bits eth root eth root randomly chosen ff one gets x thus linear modular equation two unknowns r known small solutions smaller 2 k 0 solved using lemma 5 algorithm b runs twice inputs x xff e next runs gaussian reduction q 2 pairs elements coming sets partial preimages sets found unless random ff bad cf gaussian reduction lemma 5 ut remark 7 lemma extended case constant fraction theta leading trailing bits eth root found reduction runs 1theta times adversary success probability decreases approximately 1theta extensions constant fraction consecutive bits also possible anyway pkcs 1 v20 k 0 much smaller k2 theorem 8 let cca2adversary semantic security rsaoaep kbit long modulus k 2k 0 running time bounded advantage making q q g q h queries decryption oracle hash functions g h respectively rsa problem solved probability 0 greater within time bound 0 2t proof lemma 2 states using previous results relating q h set partialdomainrsa rsa easily conclude ut 7 conclusion conclusion one still trust security rsaoaep reduction costly original one however oaep ap plications care needed since security actually rely onewayness permutation partialdomain onewayness acknowledgments thank victor shoup coppersmith dan boneh fruitful comments r relations among notions security publickey encryption schemes random oracles practical paradigm designing efficient protocols optimal asymmetric encryption encrypt rsa chosen ciphertext attack protocols based rsa encryption standard pkcs finding small root univariate modular equation probabilistic encryption reaction attacks several publickey cryptosystems power misbehaving adversaries security analysis original epoc react rapid enhancedsecurity asymmetric cryptosystem transform method obtaining digital signatures public key cryptosystems rsa data security oaep reconsidered tr