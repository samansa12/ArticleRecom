decomposition grayscale morphological templates using rank method abstractconvolutions fundamental tool image processing classical examples two dimensional linear convolutions include image correlation mean filter discrete fourier transform multitude edge mask filters nonlinear convolutions used operations median filter medial axis transform erosion dilation defined mathematical morphology large convolution masks structuring elements computation cost resulting implementation prohibitive however many instances cost significantly reduced decomposing templates representing masks structuring elements sequence smaller templates addition decomposition often made architecture specific thus resulting optimal transform performance paper provide methods decomposing morphological templates analogous decomposition methods used linear domain specifically define notion rank morphological template categorizes separable morphological templates templates rank one establish necessary sufficient condition decomposability rank one templates 3 3 templates use invariance template rank certain transformations order develop template decomposition techniques templates rank two b introduction oth linear convolution morphological methods widely used image processing one common characteristics among require applying template given image pixel pixel yield new image case convolution template usually called convolution window mask mathematical morphology referred structuring element templates used realizing linear convolutions often referred linear templates templates vary greatly weights sizes shapes depending specific applications intuitively problem template decomposition given template find sequence smaller templates k n applying image equivalent applying sequentially image words algebraically expressed terms one purpose template decomposition fit support template ie convolution kernel optimally existing machine constrained hardware con figuration example erims cytocomputer 1 cannot deal templates size larger 3 3 pipeline stage thus large template intended image processing cytocomputer decomposed sequence 3 3 smaller templates important motivation template decomposition speed template operations large convolution masks computation cost resulting implementation prohibitive however many instances cost significantly reduced decomposing masks templates sequence smaller templates instance linear convolution image grayvalued multiplications additions compute new image pixel value convolution computed 1 n row template followed n 1 column template takes 2n multiplications f additions new image pixel value cost saving may still hold parallel architectures mesh connected array processors 2 cost proportional size template problem decomposing morphological templates investigated host researchers zhuang haralick 3 gave heuristic algorithm based tree search find optimal twopoint decomposition morphological template decomposition exits twopoint decomposition consists sequence templates consisting two points twopoint decomposition may best suited parallel architectures limited number local connections since twopoint template applied entire image multi plyshiftaccumulate cycle 2 xu 4 developed al gorithm using chain code information decomposition convex morphological templates twopoint system configurations using chaincode information park chin 5 provide optimal decomposition convex morphological templates fourconnected meshes however decomposition methods work binary morphological templates extend grayscale morphological templates successful general theory decomposition authors university florida gainesville fl 32611 email ps0 rittercisufledu manuscript received nov 9 1995 revised mar 14 1997 recommended acceptance v nalwa information obtaining reprints article please send email transpamicomputerorg reference ieeecs log number 104798 ieee transactions pattern analysis machine intelligence vol 19 6 june 1997 jproductiontpami2inprod1047981047981doc regularpaper97dot ag 19968 042497 149 pm 2 11 templates linear morphological domain evolved theory image algebra 6 7 8 9 10 provides algebraic foundation image processing computer vision tasks setting ritter gader 11 9 presented efficient methods decomposing discrete fourier transform templates zhu ritter 12 employ general matrix product provide novel computational methods computing fast fourier transform fast walsh transform generalized fast walsh transform well fast wavelet transform image algebra template decomposition problems linear morphological template operations reformulated terms corresponding matrix polynomial factorization manseur wilson 13 used matrix well polynomial factorization techniques decompose twodimensional linear templates size n sums products 3 3 templates li 14 first investigate polynomial factorization methods morphological templates provides uniform representation morphological templates terms polynomials thus reducing problem decomposing morphological template problem factoring corresponding poly nomials approach provides decomposition onedimensional morphological templates factors twopoint templates crosby 15 extends lis method twodimensional morphological templates davidson 16 proved morphological template weak local decomposition meshconnected array processors davidson existence theorem provides theoretical foundation morphological template decomposi tion yet algorithm conceived constructive proof efficient takriti gader formulate general problem template decomposition optimization problems 17 18 sussner pardalos ritter 19 use similar approach solve even general problem morphological template approximation however since problems inherently npcomplete researchers try exploit special structure certain morphological templates order find decomposition algorithms example li ritter 20 provide simple matrix techniques decomposing binary well grayscale linear morphological convex templates separable template template expressed terms two onedimensional templates consisting row column template gader 21 uses matrix methods decomposing grayscale morphological template sum separable template totally nonseparable template original template separable gader decomposition yields separable decomposition original template separable method yields closest separable template original mean square sense separable templates particularly easy decompose decomposition separable templates product vertical horizontal strip templates used first step decomposition form matches neighborhood configuration particular parallel architecture linear case separable templates also called rank one templates since corresponding matrices rank one matrices leary 22 showed linear template rank one factored exactly product 3 3 linear templates templates higher rank usually efficiently decomposable however rank template determines upper bounds worstcase scenarios example linear template rank two always decomposes sum two separable templates linear domain notion template rank stems well known concept matrix rank linear alge bra purpose paper develop notion morphological matrix rank similar linear matrix rank way bijection matrices correspond certain rectangular templates analogy linear case define rank morphological template rank corresponding matrix demonstrate notion allows elegant concise formulation new results concerning decomposition grayscale morphological templates separable morphological templates paper organized follows section 2 introduce image algebra notation used throughout paper aforementioned algebraic template decomposition methods section 3 develop notions linear dependence linear independence rank pertinent morphological image processing section 4 establish general theorems separability matrices morphological domain finally section 5 apply result previous sections establish decomposition criteria methods algorithms decomposition grayscale morphological templates proofs theorems given 23 obscure main ideas results paper image algebra heterogeneous manyvalued algebra sense birkhoff lipson 24 6 multiple sets operands operators broad sense image algebra mathematical theory concerned transformation analysis images although much emphasis focused analysis transformation digital images main goal establishment comprehensive unifying theory image transformations image analysis image understanding discrete well continuous domain 6 8 7 paper however restrict attention notations operations necessary establishing results mentioned introduction hence focus morphological image algebra operations henceforth let x subset digital plane z z c h denotes set integers set f denote set functions x f f x use symbols denote binary operations maximum minimum respectively 21 images templates image algebra viewpoint images considered functions templates viewed functions whose values images particular fvalued image point set x function x x e fvalued template x function sussner ritter decomposition grayscale morphological templates using rank method 3 jproductiontpami2inprod1047981047981doc regularpaper97dot ag 19968 042497 149 pm 3 11 e e j notational convenience define ty oe x note image representation f 1 pixel values x f location x image called template weights point since concerned optimizing morphological convolutions set f interest real numbers symbol appended precisely f r r denotes set real num bers algebraic system associated r semilatticeordered group r c h extended arithmetic logic operations defined follows f f f f r r 2 note element acts null element system r c h view operation multiplication operation addition dual system lattice ordered group r c h algebraic system r c h provides mathematical environment morphological operation gray scale dilation r c h provides environment dual operation gray scale erosion focus translation invariant r valued templates x since grayscale structuring elements realized templates template x x oe r e j called translation invariant z f f z 2 3 elements x support template oe r e j point denoted st defined follows translation invariant template called rectangular rectangular discrete array example let r x x oe r e j translation invariant template determined point oe x following function values x oe x r x x x x f r l l l l l l l else visualize rectangular template r shown fig 1 fig 1 support template r point hashed cell indicates location target point 22 basic operations basic operations addition maximum r induce pixelwise operations r valued images tem plates b x oe r x x oe r b x x b x x x b x x b x x x fa f f f fa f f f f f c x oe r denotes constant image f c h f c oe r scalar operations images templates obtained defining c c c c c c c c c c f f f f 23 additive maximum operations forming additive maximum image x oe r template x x oe r results image x oe r determined following function values x x oe fb g f f 8 clearly template x x oe r defines function 4 ieee transactions pattern analysis machine intelligence vol 19 6 june 1997 jproductiontpami2inprod1047981047981doc regularpaper97dot ag 19968 042497 149 pm 4 11 additive maximum template x x oe r e j template oe r e j defined template r x x oe r e j determines f f composition f followed f specifically oe f f f f relationships induce associative distributive laws given later note constant c oe r f f f example following column templates r x x r fig 2 template r constitutes additive maximum templates template 24 properties image template operations following associative distributive laws hold arbitrary image x oe r arbitrary templates x x oe r x x oe r f f f f f 12 results establish importance template decomposition 25 strong decompositions templates sequence templates e j r e j called strong decomposition respect operation template oe r oe r e j written form special case speak separable template support 1 one dimensional vertical array support 2 one dimensional horizontal array example template r x x oe r e j given fig 1 represents separable template since template decomposes vertical strip template x x oe r e j horizontal strip template x x oe r fig 3 pictorial representation column template row template 26 weak decompositions templates sequence templates e j r strictly increasing sequence natural numbers k called weak decomposition respect operation template x x oe r template represented follows say e j weak decomposition rectangular template oe r separable templates separable 27 correspondence rectangular templates matrices note natural bijection f space matrices r space rectangular templates r arbitrary x x c h min min image matrix oe r defined sussner ritter decomposition grayscale morphological templates using rank method 5 jproductiontpami2inprod1047981047981doc regularpaper97dot ag 19968 042497 149 pm 5 11 template x x oe r e j satisfies c h c h k k henceforth restrict attention rectangular templates whose target pixel centered ie rectangular templates form theory minimax algebra 25 examines algebraic structures arising lattice operations maximum minimum addition including space matrices r together operation additive maximum natural correspondence rectangular templates x x oe r e j matrices r allows us use minimax algebra approach order study weak decomposability rectangular templates separable templates example let oe r 33 matrix u v vectors given u v f f c h 17 function f maps square template oe r e j fig 1 maps column vector u column template x x oe r e j row vector v row template x x oe r e j fig 3 section develop new notion matrix rank within mathematical framework minimax algebra relate concept matrix rank one given cuninghamegreen 25 derive notion rank morphological template 31 algebraic structures operations minimax algebra mathematical theory minimax algebra deals algebraic structures bands belts blogs example r together operations maximum addition forms belt cuninghamegreen defines matrix rank matrices certain subsets blog r purposes suffices consider r finite elements r operations maximum minimum addition r induce entrywise operations set n matrices r minimax algebra also defines compound operations pronounced additive maximumfrom r r operation similar regular matrix product known linear algebra obvious dual operation provided additive minimum operation given matrices oe r mk b oe r kn additive maximum r n determined c ik kj matrix r n u column vectors r m1 v row vectors r 1n following equivalence holds corresponding rectangular template fa vertical strip templates f u horizontal strip templates f v u v u v 32 linear dependence vectors vector v oe r n said linearly dependent vectors oe r exist scalars c oe r ce otherwise vector v oe r n called linearly independent vectors v 1 v k oe r n vectors v 1 v k oe r n linearly independent one linearly independent others example consider following elements r 3 f f f f vector v linearly dependent v 1 v 2 33 strong linear independence vectors v v oe r called strongly linearly independent sli exists vector v oe r n v unique representation since definition provide suitable criterion testing collection vectors r n strong linear dependence choose provide alternative equivalent definition based following theorem theorem 1 vectors v v oe r sli following inequalities hold v v vfor vector 6 ieee transactions pattern analysis machine intelligence vol 19 6 june 1997 jproductiontpami2inprod1047981047981doc regularpaper97dot ag 19968 042497 149 pm 6 11 c h r corollary k vectors v 1 v k oe r n sli k oe 1 n 34 rank matrix cuninghamegreen defines rank matrix oe r mn maximal number sli row vectors equivalently maximum number sli column vectors rank finite matrix oe r mn less equal min n 35 remarks rank matrix minimax algebra notion regular linear independence suited define rank minimax algebra certain dimensional abnormalities would occur example possible find k linearly independent vectors r n number k oe n notion strong linear independence gives rise satisfactory theory rank dimension although certain equivalences known linear algebra hold 36 separable rank matrix separable rank matrix oe r mn denoted defined minimal number r column vectors row vectors v 1 v r oe r 1 permit representation following form u v representation form called weak separable decomposition say separable matrix respect operation rank sep 37 rank rectangular template real valued matrix define rank template x x oe r e j separable rank interest rank morphological template motivated problem morphological template decomposition since rank morphological template oe r represents minimal number separable templates whose maximum equivalently minimal number r column templates r x x r e j row templates x x r e j r r ie j section derive theorems concerning separable rank matrices translate directly results rank rectangular templates theorems greatly simplify proofs decomposition results present next section theorem 2 matrix oe r mn representation u v l le j terms column vectors u r 1 row vectors v l n expressed following form l l r 1 given w l 26 remark theorem 2 implies matrix oe r mn separable rank k suffices know row vectors permit weak decomposition k separable matrices order determine representation form w v l l l r 27 like theorems established paper theorem 2 obvious dual terms column vectors choose omit going introduce certain transforms preserve separable matrix rank transforms suited simplify task determining separable rank given matrix 41 column permutations matrices let oe r mn r permutation 1 n associated column permuted matrix r c respect r defined follows r c f f f f f f f f f f f 42 row permutations r permutation 1 define associated row permuted matrix r r oe r mn respect r follows r r f f f f f f f f f f f multiplication matrix oe r mn scalar c oe r defined usual case stands 1 theorem 3 following transformations preserve separable rank matrix oe r mn sussner ritter decomposition grayscale morphological templates using rank method 7 jproductiontpami2inprod1047981047981doc regularpaper97dot ag 19968 042497 149 pm 7 11 column row permutations additions separable matrices scalar multiplications remark column row permutations well additions separable matrices also preserve rank matrix defined cuninghamegreen invariance property follows directly definition matrix rank minimal number sli row vectors column vectors theorem 4 separable rank finite matrix oe r mn bounded rank bounded minimal number l linearly independent row vectors column vectors point finally ready tackle problem determining weak decompositions matrices view separable ranks reader bear mind consequences corresponding rectangular templates matrix oe r mn use notation ai denote ith row vector use notation jth column vector theorem 5 20 let oe r mn separable matrix ai collection row vectors arbitrary row vector ai 0 exist scalars l oe r following equations satisfied l words given arbitrary index 1 0 row vector ai linearly dependent 0 th row vector clearly li ritters theorem gives rise following straightforward algorithm tests given matrix r separable separable case algorithm computes vector pair given matrix decomposed algorithm 1 let oe r mn given let ai denote ith row vector algorithm proceeds follows subtract 1j ij compare c ij 1j 1j matrix separable algorithm stops step successfully completed separable given ca1 note algorithm involves 1n subtractions 1n 1 comparisons hence number operations adds 2m 1n implies algorithm order o2mn remark mentioned earlier given image processing hardware often calls decomposition given template 3 3 templates theorem shows case separable square template problem reduces problem decomposing column template 3 1 templates well decomposing row template 1 3 templates suppose original template size 2n operations per pixel needed applying template image template decomposes n 3 3 templates number operations reduces 9n however simple strong decomposition original separable template row column template length especially using sequential machine since 4n operations per pixel required taking advantage decomposition theorem 6 let square morphological template rank 1 given r column template row template template decomposable templates r decomposable 1 templates decomposable templates example let real valued 5 5 matrix given u v f f template decomposable two templates since template r fu decomposable two 3 1 templates remark course theorem 6 preclude existence templates rank 2 strongly decomposable 3 3 templates example following template rank 1 written product two 3 3 templates 1 2 see fig 4 fig 5 corollary let square morphological template rank k given r k column templates 1 k row tem plates templates r 1 r k decomposable templates templates 1 k decomposable representation terms templates 1 k strongly decomposable templates 8 ieee transactions pattern analysis machine intelligence vol 19 6 june 1997 jproductiontpami2inprod1047981047981doc regularpaper97dot ag 19968 042497 149 pm 8 11 fig 4 example 5 5 template rank 1 decomposable 3 3 templates 1 2 fig 5 templates 1 2 lemma 1 matrix oe r mn separable rank two exits transform tconsisting row permuta tions column permutations additions row column vectorsas well vectors u oe r m1 v oe r 1n ta written following form 0 mn denotes n zero matrix lemma 2 let separable rank preserving transform theorem 3 oe r mn transform maps row vectors row vectors ta column vectors column vectors ta theorem 7 matrix oe r mn separable rank two two row vectors row vectors depend linearly similar theorem hold matrices separable 3 fact expressed theorem 8 theorem 8 every natural number k 3 matrices r weakly decomposable product vector pairs whose row vectors linearly dependent single k tuple row vectors remark theorem 6 matrix oe r mn separable rank two exist two row vectors aao ap p oe 1 mwhich allow weak decomposition case application theorem 2 yields following representation u v f b g 35 u v oe r 111 hence order test arbitrary matrix oe r mn weak decomposability two vector pairs enough compare bi ai bj aj indices j oe 1 b oe r mn computed follows b js 37 algorithm 2 assume matrix oe r mn needs decomposed weak product two vector pairs decomposition possible considering preceding remarks able give polynomial time algorithm solving problem step include number operations involved square brackets compute 2 3 compare result c algorithm stops yielding following result weak decomposition two vector pairs 2 2 k f comparisons algorithm involves total number 2 3n 1 operations amounts order om 3 n example let us apply algorithm 2 following matrix oe r 45 sussner ritter decomposition grayscale morphological templates using rank method 9 jproductiontpami2inprod1047981047981doc regularpaper97dot ag 19968 042497 149 pm 9 11 f compute matrices b oe r 44 c oe r 45 c b c b c b c b f f f f f f f f f comparing matrices c c j example let oe r 99 following matrix constitutes maximum matrix pyramid form matrix paraboloid form f g g g g g g g g since matrices paraboloid pyramid form separable algorithm 2 yield weak decomposition form u ao v ap vectors u v oe r 9 indices p oe 1 9 indeed b oe r 99 denotes matrix computed algorithm 2 f g g g g g g g g f g g g g g g g g f c h f c h 44 weak decomposition used decompose square templates fb1 a1 fb3 templates theorem 6 templates decomposable 3 3 templates column templates fb1 decomposable 3 1 templates row templates fa1 fa3 decomposable 1 3 templates fairly easy choose 3 1 templates r r 4 4 complicated examples recommend using one integer programming approaches suggested 17 18 19 see fig 6 fig 7 hence obtain representation fb1 a1 form 45 rearranging templates r 4 achieve decomposition fb1 a1 four 3 3 templates fig 6 templates size 3 1 size 1 3 providing decomposition template fb1 a1 fig 7 3 3 templates providing decomposition template similar fashion able decompose tem jproductiontpami2inprod1047981047981doc regularpaper97dot ag 19968 042497 plate fb3 a3 four 3 3 templates remark methods decomposing rectangular morphological templates presented paper easily generalized include arbitrary invariant morphological templates correspond matrices r 6 conclusions introduced new theory separable matrix rank within minimax algebra compared theory matrix rank provided cuninghamegreen definition separable rank matrix leads concept rank rectangular morphological template notion significance problem morphological template decomposition using terminology class separable templates represents class templates rank one separable templates strongly decomposed product column template row template generalizing decomposition separable templates developed polynomial time algorithm weak decomposition rectangular template rank two horizontal vertical strip templates currently working improved version algorithm upcoming paper show determining rank arbitrary rectangular template np complete problem discuss consequences morphological template decomposition problems gen eral moreover present heuristic algorithm solving rank problem finding optimal weak decomposition strip templates acknowledgment research partially supported us air force contract f08635 89 c0134 r biomedical image processing parallel 2d convolution mesh connected array processor morphological structuring element decomposition decomposition convex polygonal morphological structuring elements neighborhood subsets optimal decomposition convex morphological structuring elements 4connected parallel array processors available via anonymous ftp ftp recent developments necessary sufficient conditions existence local matrix decompositions classification lattice transformations image processing pproduct applications signal processing decomposition methods convolution operators morphological template decomposition max polynomials maxpolynomials morphological template decomposition nonlinear matrix decompositions application parallel processing decomposition techniques grayscale morphological templates local decomposition grayscale morphological templates global optimization problems computer vision decomposition separable symmetric convex templates separable decompositions approximations grayscale morphological templates algorithms approximating convolu tions proofs decomposition results grayscale morphological templates using rank method heterogeneous algebras lecture notes economics mathematical systems tr ctr engbers r van den boomgaard w smeulders decomposition separable concave structuring functions journal mathematical imaging vision v15 n3 p181195 november 2001 ronaldo fumio hashimoto junior barrera carlos eduardo ferreira combinatorial optimization technique sequential decomposition erosions dilations journal mathematical imaging vision v13 n1 p1733 august 2000