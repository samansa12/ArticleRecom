improving convergence radau iia methods applied index 2 daes paper presents simple new technique improve order behavior rungekutta methods applied index 2 differentialalgebraic equations shown incorporated efficient version code sc radau5 developed e hairer g wanner b introduction recent years differential algebraic equations daes studied various authors see hw91 hlr89 bcp91 importance acknowledged development specific solvers dassl pet86 radau5 hw91 especially important class daes arising practice semiexplicit systems form g f z assumed bounded inverse neighbourhood solution interested obtaining numerical approximation accurate differential algebraic components although ideas presented paper also apply general rungekutta methods focus radau iia methods given used build code radau5 construction well properties briefly recalled section 11 applying sstage radau iia method orders convergence respectively ycomponent zcomponent see hlr89 situations getting accurate value z may important mechanics instance one led use different approach generally speaking order reduction phenomenon may overcome following techniques first possibility consists applying radau iia method index one formulation since radau iia methods applied index one daes exhibit full order convergence z see theorem 31 hlr89 order convergence 2s gamma 1 also z however solving considerably costly matter fact requires evaluate jacobian function f step whenever convergence rate newton iteration gets small instead function f another drawback numerical solution forced longer lie constraint manifold ii second idea consists computing zcomponent solving additional equation g yfy z ie projecting numerical solution socalled hidden constraint corresponding numerical scheme reads order convergence ycomponent still 2s gamma 1 shown also zcomponent using implicit function theorem however technique computationally demanding original one solving new implicit part n requires accurate evaluation g step previously mentioned whenever convergence rate newton iteration becomes small nevertheless noted parallel environment additional cost would shadowed use second processor paper present third approach require analytical form g whose computational cost basically equal standard formulation based pi n976 4 aubry p chartier observation errors zcomponent essentially local nature least order convergence ycomponent consequence making z accurate matter recovering significant terms appear socalled bseries error made possible considering composition basic method several steps noted similar ideas used rpk chan deal order reduction gauss methods applied certain stiff problems see bc93 new order conditions determined section 2 derived straightforward manner work e hairer c lubich roche hlr89 still relatively unknown since satisfied classical rungekutta methods see also bc93 cc95 shown conditions actually redundant may omitted crucial aspect method since allows construction formulas manageable level complexity section 3 implied modifications code radau5 listed finally numerical results presented illustrate advantages new technique 11 basic properties radau iia methods radau iia methods defined particular method r characterized triple b c ij ij1deltadeltadeltas theta matrix sdimensional vector sdimensional vector sequel furthermore use notations 111 construction radau iia methods coefficients uniquely determined following conditions 1 ordered zeros radau right polynomial dx x 2 3 coefficients ij matrix satisfy cs c distinct nonsingular 112 useful properties refer additional simplifying assumptions introduced bp cj previous subsection jc butcher see hw91 page 75 irisa improving convergence radau iia methods applied index 2 daes 5 1 due conditions cs bs c methods stiffly accurate ie vectors b solution cramer system 2 collocation methods theorem 78 hnw91 page 212 3 4 ds gamma 1 satisfied lemma 54 hw91 page 78 optimal convergence results obtained methods jc butcher one hand theorem 53 hw91 e hairer c lubich roche hand theorems 31 44 46 hlr89 collected table 1 table 1 optimal global error estimates sstage method radau iia 12 increasing order convergence zcomponent applying sstage radau iia method c system obtain z coefficients matrix gamma1 4 z n vanishes us replace vector b adjustable vector 4 define new method rw easily seen order convergence ycomponent remains unchanged zcomponent lack accumulation makes errors purely local convergence behaviour zcomponent thus entirely determined following order conditions theorem 86 88 hw91 proposition 1 let ffi ffi z local errors respectively z components rungekutta method dat2 dat2 z sets trees phi vectorial function fl ae scalar ones associated trees 1 nevertheless w enough components allow order convergence greater optimal vector hence get sufficient freedom need consider composition r oe r oe steps variable steps h considered also introduce ratios r characterized triple b c ffl blockmatrix blocks form 1 see hw91 definition notions pi n976 6 aubry p chartier ffl b blockvector b i1deltadeltadeltaoe blocks form b ffl c blockvector c i1deltadeltadeltaoe blocks form c e replacing adjustable vector w offers oe theta degrees freedom ie hopefully enough oe 1 increase order convergence zcomponent aim show construct w implement new method r oew 2 construction vector w section effective construction w described emphasized components depend r forcing one evaluation per step however additional computations become negligible soon dimension system large enough 21 order conditions conditions order k enumerated together associated trees required z required z z let u ac s1 c s1 satisfied c s1 equivalent required 2 z z z z z let u s1 ac equivalent 2 dot stands componentwise product irisa improving convergence radau iia methods applied index 2 daes 7 required z z z z z z z z z z z z z let u s2 ac s3 c s3 7 satisfied c s3 equivalent conditions obtained proposition 1 using simplifying assumptions important note composite method r oe satisfies b2s gamma 1 cs ds gamma 1 22 preliminary calculus order later simplify equations w state basic results eb f proof definition eb gamma1 method c stiffly accurate eb theta blocks matrix gamma1 pi n976 8 aubry p chartier proof definition aa lemma 2 easily proved induction 2 oen oe theta dimensional vector ac n1 c n1 u n dimensional vector given ks r k1 proof let n less equal 2s gamma 2 expanded follows r k1 r k1 e owing cs ks r k1 e similarly expanded l r l implies n 2s gamma 2 obtain r l1 e e e improving convergence radau iia methods applied index 2 daes 9 lemma 4 n less proof follows b2s gamma 1 2 lemma 5 let oen vector gamma1 u n integer n ks proof definition x gamma1 u using lemma 3 obtain ks r k1 ks use lemma 4 complete proof 2 lemma 6 n less 2s proof follows straightforwardly order conditions trees z z 1 let oen vector ca ks r k1 2 let oen vector gamma1 cu n ks r k1 proof definition first part result obtained applying lemma 5 let oen denote vector cu n lemma 3 write ks r k2 furthermore z lemma 2 leads ks ngammak n1gammak ks r k1 pi n976 aubry p chartier result becomes consequence lemmas 4 6 2 lemma 8 n less 2s proof follows order conditions trees z z z proof results follow order conditions trees z z z z z 23 results 2stage method order get thirdorder method w satisfy following linear system l2 taking leads system 4 equations 4 unknowns convenience recall coefficients 2stage radau iia method r 312 matrix corresponding l2 form hence r 1 2 0 1 nonsingular l2 following unique solution irisa improving convergence radau iia methods applied index 2 daes 11 24 results 3stage method order get fifthorder method w must satisfy following linear system l3 taking leads system ten equations nine unknowns however show section one equations identically satisfied collecting results section 22 get r 4 r 4 r 4 3 r 4 r 4 r 4 r 4 r 4 r 4 r 4 r 4 r 4 found r 4 r 4 r 4 r 4 r 4 r 4 system l3 equivalent theorem linearly dependent proof enough show v 1 v 2 u 3 linearly dependent since c order 5 differential component b u implies result2 vectors gamma1 u 3 u 3 v 1 example become linearly dependent prove sufficient show gamma1 u 3 u 3 v 1 dependent b gamma1 u pi n976 aubry p chartier 0 conclude theorem 1 case w depends one parameter chosen minimize quantity dat2 z 5g seems natural goal achieve since attempt minimize local error convenience table 2 collects trees dat2 z 5 values associated functions ff fl phi compute ffs refer hig93 tree u ffu flu phiu table 2 trees dat2 z 5 associated functions 25 sketch case achieve order 7 algebraic component solve system l4 composed c 4 section 21 say 24 equations comparing number equations number unknown could consequently think taking fact shown sufficient since 5 equations identically satisfied see section 61 however seem reasonable consider practical implementation corresponding method owing complexity formulas variable stepsize remark 2 stepsize constant ie r equations identically satisfied see section 61 oe chosen equal 4 3 modifications code radau5 3stage radau iia method implemented e hairer g wanner order solve problems form daes index less equal three solved code called radau5 precise description given section iv8 hw91 adopt notations used implementing method requires slight modifications subroutines radcor solout actually replaced respectively radcorz soloutz irisa improving convergence radau iia methods applied index 2 daes 13 31 modifications radcor computation algebraic component z modified index 2 dae solved n th step accepted two cases considered 1 less three steps computed keep internal stages z n1 z n2 z n3 step size h n value 2 three steps computed keep internal stages z n1 z n2 z n3 step size h n r 1 r 2 computed formulas r w subroutine vectw2 n1 z n1 put z remark 3 continuous outputs need also keep internal stages two steps differential components see section 322 32 new subroutines 321 vectw2 order compute formal expression w create associated fortran subroutine manipulation package maple used call vectw2 uses format vectw2icasvwr1r2 inputs one five cases described icas parameters r 1 r 2 r1r2 output vector w vw five cases considered 1 1 case seen w depends one parameter optimized explained remark 1 2 r 3 r 4 r 5 r 1 allows us reduce cost computation eliminate computational problems used general expression w case 5 divisions zero would occured cases 1 4 322 continuous outputs code radau5 subroutine solout provides user approximations equidistant outputpoints corresponding interpolation formulas implemented subroutine contr5 contr5ix gives approximation u x th component solution point x lie interval x n x n1 u collocation polynomial degree 3 defined 3 pi n976 14 aubry p chartier index 2 daes polynomials degree 3 satisfy 3 theorem 78 hw91 aim increase order convergence algebraic component seems natural search approximation p approximation zx let x form x ngamma2 define q follows vector satisfies linear system using notations section 24 proposition 2 2 0 1 z l3 possesses solution proof theorem 85 86 hw91 according analysis section 21 leads system z l3 theorem 1 possesses solution 2 subroutine vectwz computes w vector w five cases considered h depends one parameter case 1 adjusted remark 1 case value defined continuity w choosen call vectwz uses format vectwzicasvwzr1r2t inputs one five cases described icas parameters r 1 r 2 respectively r1r2t output vector w vwz approximation yx let x form x irisa improving convergence radau iia methods applied index 2 daes 15 vector satisfies linear system c rungekutta method r 2 obtained composition 3stage radau iia method c two steps e vector z proposition 3 proof let us introduce vector following polynomial u theorem 85 86 hw91 using points internal stages follows p equivalent system subroutine vectwy computes bj call vectwy uses format vectwyvwyrt inputs parameters r j respectively rt output vector bj vwy subroutine soloutz provides user approximations px equidistant outputpoints i1deltadeltadeltan differential component x form x choosen satisfy x x n1 algebraic one x form x ngamma2 choosen satisfy x x n call soloutz uses format inputs number accepted steps nr x n xold x n1 x n1 z n1 systems dimension neq one five cases described computation w icas parameters r1 r2 r1r2 stepsize h ngamma2 variable last indicate last computational step reached pi n976 aubry p chartier significant digits modified radau5 figure 1 precision versus computing time algebraic components test problem 4 numerical experiments 41 test problem consider index two problem psi following infinitely smooth function consistant initial values exact solution codes set work4 parameter stopping criterion newtons method work4 work5 parameters c 1 c 2 stepsize control see hw91 page 130134 figure 1 plot cpu time number significant digits gammalog 10 absolute error algebraic components codes use continuous outputs outputs required compute global error take maximum values figure 2 plot cpu time number significant figures differential components codes following problems modified parameters shown irisa improving convergence radau iia methods applied index 2 daes 17261014 significant digits modified radau5 figure 2 precision versus computing time differential components test problem 42 pendulum simplest constrained mechanical system pendulum whose equations motions described hw91 page 483485 applied code radau5 modified code ggl gear gupta leimkuhler formulation consistant initial values simplicity took figure 3 respectively 4 plot cpu time number significant digits algebraic resp differential components codes 43 multibody mechanism seven body mechanism described hw91 page 531545 applied code radau5 modified code index 2 formulation consistant initial values figure 5 respectively 6 plot cpu time number significant digits algebraic differential components codes outputs required 44 discharge pressure control simplified model dynamic simulation problem petrochimical engineering described hlr89 page 116118 applied code radau5 modified code following pi n976 aubry p chartier246810 significant digits modified radau5 figure 3 precision versus computing time algebraic components significant digits modified radau5 figure 4 precision versus computing time differential components pendulum irisa improving convergence radau iia methods applied index 2 daes 19 significant digits modified radau5 figure 5 precision versus computing time algebraic components seven body mechanism significant digits modified radau5 figure versus computing time differential components seven body mechanism pi n976 aubry p chartier13579 significant digits modified radau5 figure 7 precision versus computing time algebraic components discharge pressure control2610001 significant digits modified radau5 figure 8 precision versus computing time differential components discharge pressure control consistant initial values initial step size h equal 10 gamma5 figure 7 respectively 8 plot cpu time number significant digits algebraic resp differential components codes outputs required irisa improving convergence radau iia methods applied index 2 daes 21 5 conclusion new simple technique overcome order reduction phenomenon appearing algebraic component radau iia methods applied index two daes proposed increasing order convergence z made possible considering composition basic method oe steps z n1 defined basic method linear combination internal stages good choice oe provide enough freedom order conditions associated composite method satisfied determined order conditions derive straightforwardly work e hairer c lubich roche section 21 shown conditions redundant might omitted sstage radau iia methods 4 section 23 25 could interesting generalize simplifications radau iia methods general question determine many compositions sstage radau iia method considered obtain order convergence equal 2s gamma 1 algebraic component however seem reasonable consider practical implementation corresponding method 4 owing complexity formulas variable stepsize formulas incorporated code radau5 developed e hairer g wanner slight modifications required section 3 computation algebraic component modified new procedure order continuous outputs created used technique components algebraic differential compute approximations order five equidistant outputpoints according numerical experiments results differential components disappointing however use technique code radau5 leads increase accuracy algebraic components tolerances sufficiently small 6 appendix 61 construction vector w case section explained calculus linear algebra used show composed five times sstage radau iia method sufficient case expand following vectors c 6 use lemma following vectors c 7 use lemma pi n976 22 aubry p chartier r 6 r 6 r 6 r 6 r 6 r 6 let introduce following vectors idem vectors r 6 r 6 r 6 r 6 r 6 r 6 r 6 system l4 equivalent irisa improving convergence radau iia methods applied index 2 daes 23 proposition 4 1 linearly dependent 2 linearly dependent 3 linearly dependent 4 linearly dependent 5 linearly dependent proof expression vectors sufficient show linearly dependent idem part 2 5 proposition method c local order 8 differential component thus order conditions associated trees dat2 7 satisfied particular finally obtain b 6 0 hence proposition shown 2 remark 4 step size constant ie r 1 linearly dependent 2 linearly dependent 3 linearly dependent 4 linearly dependent hence nine equations identically satisfied p choosen equal four pi n976 aubry p chartier r smoothing order reduction effects implicit rungekutta formulae numerical solution initial value problems differentialalgebraic equations composition law rungekutta methods applied index2 differentialalgebraic equations coefficients taylor expansion solution differentialalgebraic systems numerical solution differential algebraic systems rungekutta methods solving ordinary differential equations vol stiff problems differential algebraic problems vol description dassl differentialalgebraic system solver tr ctr frank cameron mikko palmroth robert pich quasi stage order conditions sdirk methods applied numerical mathematics v42 n1 p6175 august 2002 frank cameron matlab package automatically generating rungekutta trees order conditions truncation error coefficients acm transactions mathematical software toms v32 n2 p274298 june 2006