structural modeling flames production environment paper describe system animating flames stochastic models flickering buoyant diffusion provide realistic local appearance physicsbased wind fields kolmogorov noise add controllable motion scale procedural mechanisms developed animating aspects flame behavior including moving sources combustion spread flickering separation merging interaction stationary objects stages process emphasis total artistic behavioral control maintaining interactive animation rates final system suitable high volume production pipeline b figure 1 burning torch waved air clearly relaxed fluid already acting atypically fire hand dramatic element requires maximum level control possible maintaining believable appearance expect fire look complex unpredictable time recognizable structure according conditions burning complexity makes direct numerical simulation fire much less attractive phenomena three reasons numerical simulations scale poorly resolution 3d simulation increases computational complexity increases least on3 foster metaxas 1996 stam fiume 1995 resolution required capture detail even relatively small fire makes simulation expensive number factors affect appearance fire different circumstances leads interdependent simulation parameter space difficult developers place intuitive control functions top underlying physical system fire chaotic small changes initial conditions cause radically different results animation standpoint difficult iterate towards desired visual result together restrictions make numerical simulation poor choice basis largescale fire animation system control efficiency equally important realism paper presents different approach modeling fire instead modeling physics combustion achieve tradeoff realism control efficiency recognizing many visual cues define fire phenomena statistical nature separate vital cues components wish artistically control provides us number distinct structural elements elements physics based general need structural element number animation parameters associated allowing us mimic variety realworld productionworld fire conditions realism achieved basing structural state changes measured statistical properties real flames addition define set largescale procedural models define locally group flame structures evolve time include physicsbased effects fuel combustion diffusion convection well pure control mechanisms animator defined time space curves together structural flame elements procedural controls form basis system modeling animating wide range believable fire effects extremely efficiently context direction driven animation pipeline 2 previous work previous work modeling dynamic flames falls loosely two categories direct numerical simulation visual modeling direct simulations achieved realistic visual results modeling rotational motion due heat plume around fire chiba et al 1994 inakge 1990 simulation also proved efficient modeling behavior smoke given fire rushmeier et al 1995 stam fiume 1993 heat plume explosion yngve et al 2000 shape motion flames however simulation useful numerical models computational fluid dynamics proven amenable simplification without significant loss detail drysdale 1998 without simplification expensive option largescale animations visual modeling focused efficiency control particle systems widely used fire model nishita dobashi 2001 stam fiume 1995 particles interact primitives easy render scale linearly interparticle forces problem realism falls solely shoulders animator though force fields procedural noise achieve adequate looking largescale effects due convection difficult come particlebased model accurately captures spatial coherence real fire flame coherence modeled directly using chains connected particles beaudoin paquet 2001 reeves 1983 retains many advantages particle systems also allowing animators treat flame high level structural element 3 essential model system developed use general fire animation tool eight stages key effectiveness many stages either directly controlled animator driven physicsbased model components follows individual flame elements modeled parametric space curves curve interpolates set points define spine flame curves evolve time according combination physicsbased procedural handdefined wind fields physical properties based statistical measurements natural diffusion flames curves frequently resampled ensure continuity provide mechanisms model flames generated moving source figure 2 classic three stage buoyant diffusion flame curves break generating independently evolving flames limited lifespan engineering observations provide heuristics processes cylindrical profile used build implicit surface representing oxidization region ie visible part flame particles point sampled close region using volumetric falloff function procedural noise applied particles parameter space profile noise animated follow thermal buoyancy particles transformed parametric space flames structural curve second level noise kolmogorov frequency spectrum provides turbulent detail particles rendered using either volumetric fast painterly method color particle adjusted according color properties neighbors allowing flame elements visually merge realistic way complete system define number procedural controls govern placement intensity lifespan evolution shape color size behavior flames result general system efficiently animating variety natural fire effects cost direct simulation incurred desired otherwise system provides complete control largescale behavior 4 structural elements fire animation system built single flames modeled natural diffusion flame see figure 2 observed statistical properties real flames used wherever possible increase realism model 41 base curve basic structural element flame system interpolating bspline curve curve represents central spine single flame flames merge split see section 43 fire phenomena model built primitives first frame animation particular flame active particle generated fixed point burning surface released wind field particle advanced wind field frame using explicit euler integration method rungekutta sufficient completely stable case new particle generated surface line two points sampled n control points evenly distributed along additional frame animation convect freely within wind field convection interpolating bspline fitted passes points curve parametrically sampled generating new set n points always keeping first last unchanged resampling ensures whatever value n visual artifacts dont appear structure control points cluster together side effect large time steps 42 flame evolution animation control points structural curve evolve within wind field evolution providing global shape behavior specific local detail due fuel consumption turbulence combustion interface added later motion built four main components convection diffusion initial motion buoyancy initial motion applied base curve firegenerating surface velocity v particle p0 given initial velocity v flame generated stationary reference frame flames move participating media ie specific inertia provides efficient way taking account moving sources buoyancy due tendency hotter less dense air rise region around visible part flame relatively homogeneous terms temperature least respect ambient temperature chose model buoyancy direct linear upward force resulting flow laminar nature add rotational components form simulated wind fields noise field generated kolmogorov spectrum equation motion structural particle p defined dx pp dt wxpt arbitrary controlling wind field dtp motion due direct diffusion vp motion due movement source ctp motion due thermal buoyancy tp temperature particle diffusion modeled random brownian motion scaled temperature tp thermal buoyancy assumed constant lifetime particle therefore cttbgttt2 2 b coefficient thermal expansion gy vertical component gravity t0 ambient temperature tp age particle equations 1 2 allow us combine accurate simulated velocity fields adhoc control fields without producing visual discontinuities 43 separation flickering model flame separation flickering statistical process classic regions freestanding diffusion flame illustrated figure 2 intermittent region flame defined range hp hi creation flame develops reaches figure 3 different normalized flame profiles candle flame torch flame camp fire flames respectively hi point periodically test random number probability ip determine whether flame flicker separate length h frequency f approximate breakaway rate hz vc average velocity structural control points observation drysdale 1998 sources radius r necessary dh 1 h hmax hmax artistically chosen limit flame length separation occurs region structural curve split top flame region extends top flame randomly selected point could find measured data describes size distribution separated flames absence point selected using normal distribution function mean hphihp2 standard deviation hihp4 control points representing buoyant region fitted curve resampled way parent structure section 41 number points split increased back n case however prevents additional detail appearing buoyancy region flame additional fuel could added lifetime structural particles make separated flame follow eq 1 without modeling combustion process theres accurate way determine fuel content breakaway flame therefore theres good model long remain visible separate flame given lifespan ai3 uniform random variable range 01 length scale ranging 124th second small flames 2 seconds large pool fire cube ensures breakaway flames short lived theres reason buoyant flame cant separate although general entrainment region quickly dominates theres little airborne fuel buoyant flame except oxygen starved fires 44 flame profiles global structure behavior flame defined concentrate visible shape flame flame combustion region fuel source oxidizing agent region clearly defined require model essentially volumetric one model treats segment line two adjacent control points structural curve source potential field beaudoin paquet 2001 total field flame summation fields segments flame rendered volumetrically using different color gradients various isocontours potential field method gives good results small fires like candle flames handles flame merging efficiently stylization difficult however requiring contraction functions desired flame shape addition turbulent noise built directly potential function subsequent transformation stage rendering retain complete control basic shape represent flame using rotationally symmetric surface based simple twodimensional profile profile taken standard library depends scale flame effect wish model see figure 3 examples good results hand drawn profiles well derived photographs define light density visible part flame xfx closest point x parametric surface defined rotating profile density combustion surface normalized one work equation 4 defines simple volumetric density function flame order transform displace starting shape organic realistic looking flame need transform eq 4 onto flames structural curve density function first point sampled volumetrically using monte carlo method point samples survive frame frame sampling allows us deform density function without integrate important though rendering method employed see section 5 independent sample density flame appear pointillistic density function approximated particles displace transform simulate chaotic process flame formation 45 local detail two levels structural fluctuation applied point samples define visible part flame animate time space first directly affects overall shape displacing particles original sample positions second simulates air turbulence define buoyancy noise represents combustion fluctuation base flame propagates flame profile according velocities nearest structural particles section 41 real physical data go noise function visually looks good flow noise perlin neyret 2001 rate rotation linear noise vectors time inversely proportional diameter flame source ie large flames lead quicker vector rotation participating medium also causes flame distort time scale vector field created using kolmogorov spectrum exhibits smallscale turbulence provides visual realism kolmogorov noise relatively cheap calculate generated perframe basis see stam fiume 1993 applications kolmogorov spectrum sample particle therefore displaced away initial position according flow noise value propagated profile figure 4 cylindrical coordinate system used map point samples profile space space deformed structural curve transformed structural curve space according straightforward mapping shown figure 4 displaced second time using vector field generated kolmogorov spectrum transformations particles tested transformed profiles parent flames neighbors particle inside neighboring flame outside region defined eq 4 particle rendered gives appearance individual flames merge kolmogorov field global wind field wxpt ensure merged flames behave locally similar fashion even though nothing explicit model account merging particles final positions ready rendering 5 rendering 51 particle color apparent flame color depends types fuel oxidizer consumed together temperature combustion zone hotter regions bluer instead trying calculate color flames want model find reference photograph map picture onto twodimensional profile used flame shape figure 3 particles take base color directly mapping obviously image could used giving complete control color flame mapping determine intensity light particle base color 52 incandescence flames transmit energy towards camera environment assume visible light transmitted proportional heat energy given flame approximated upward mass flow dhc heat combustion fuel eg 15 mjkg1 wood 48 mjkg1 gasoline af surface area fuel m2 r radius k scale factor visual control particle incandescence camera calculated relative l distance center flame camera n total number particle samples k eq 5 automatically adjusted compensate energy loss due dxi term eq 6 equation 5 also approximates total energy given environment global illumination purposes emitting sphere center flame segment radius h3 gives reasonable looking lighting 53 image creation ideally deformed flames volume rendered directly potential field approach used relatively fast methods available brodie wood 2001 rushmeier et al 1995 system described however volume rendering requires density samples projected two inverse transformations hit density function eq 4 elegant limits us using noise functions integrated quickly instead note due coherence global local noise fields sample points close together tend remain close together transformation therefore sample untransformed profile sufficient density eliminate aliasing transformed sample points also exhibit aliasing transforms inexpensive per particle total particle count isnt huge factor terms efficiency calculate approximate crosssectional area flame would appear camera supersample profile sufficient density complete coverage images paper created using sampling rate around ten particles per pixel gives range around thousand fifty thousand particles per flame intensity particle calculated using eq 6 total energy flame remains constant opacity associated particle difficult calculate however real flames highly transparent bright relation surrounding objects extremely bright objects visible cinema screens video monitors cannot achieve contrast levels high enough give effect unless background relatively dark knowledge theres engineering photographic model apparent opacity incandescent fluids justification observation calculate opacity particle proportional relative brightness behind means physically correct approach appears work well practice particles motion blurred using instantaneous velocities given eq 1 6 procedural control separating fire system series independent components driven desire complete control look behavior flame animations animators direct control basic shape color flames sections 44 51 well scale flickering separation behavior section 43 addition global motion dictated summation different kinds wind field wind fields whether procedural rudolf raczkowski 2000 yoshida nishita 2000 simulated miyazaki et al 2001 well understood effective control mechanism open nature system easily allows many procedural controls three examples follow 61 object interaction interaction structural flame elements stationary object requires wind field flows around representation object approximate object series solid voxels simulate flow hot gas around using method based navierstokes equations described foster metaxas 1997 wind field used eq 1 convect structural control points difference positions modified tested object volume moved outside theres conflict ambiguity direction point moved resolved using adjacency points sample particles used rendering difficult deal realistic way generally wind field naturally carries flame away object cases transformed flame profile remains partly inside simply make depth test object rendering ignore internal particles makes energy eq 6 flame segments inaccurate close object however object usually brightly lit nearby flames noticeable figure 7 shows rendered sequence images involving interaction flames simple objects wind field environment resolution 40x40x40 cells proved sufficient achieve flow avoids objects believable way 62 flame spread many factors influence flames spread object jump objects spread rate models rapidly become complex take account fuel oxidizer concentrations properties combusting material atmospheric conditions angle attack simplified behavior use procedural model perry picard 1994 velocity flame front described f relative orientation flame unburned surface h height flame tf temperature flame l thermal thickness burning material l thermal conductivity air values l l different materials available tables straightforward adjust get desired speed complete animation control use grayscale image determine precisely flames become active surface image mapped onto surface burning object value image samples correspond directly flame activation spreading times similar maps control length time flame burns well overall intensity diameter height 63 smoke generation two measures define capability flame produce smoke first smoke point minimum laminar flame height smoke first escapes flame tip second smoke yield measure volume smoke produced correlates closely radiation emitted diffusion flame procedurally generate smoke particles tip flame smoke point tip given simply h density particles density associated individual particle radiation intensity eq 5 multiplied arbitrary scale factor generated smoke introduced gas simulator foster metaxas 1997 initial velocity vpn1 upper control point temperature set maintain upward buoyancy force specified eq 2 7 results images shown paper generated using system described figure 1 shows sequence four images animation lit torch swung air flames generated torch standing still initial base velocity described section 42 control points influenced thermal buoyancy kolmogorov noise 5 flame structures rendered using 9000 sample particles animation whole took 27 seconds per frame pentium iii 700mhz processor broke 02 seconds dynamic simulation 05 seconds rendering 20 seconds bspline fitting particle sorting stylized example dragon breath animation shown figure 5 flames generated dragons mouth initial velocity long lifespan flames split multiple times using technique outlined section 43 five flames used initially generating eighty freely moving structures end sequence total 15 million sample particles distributed according size flames relative camera dynamic simulation took 3 seconds rendering seconds bspline fitting 1 minute per frame possibility individual flames merging section 45 disabled artistic preference precalculated wind field based random forces gives good internal rotation fireball overall feel theres still low level turbulence missing animation results could improved tracking sample particles time kolmogorov noise although would incur cost rendering prevent undersampling figures 6 7 show selection images large format version movie shrek interaction flames stationary objects respectively animation system used fire required production component system three six parameters related visual behavior flicker rate average lifespan example system actually parameters corresponding direct numerical simulation fairly intuitive mutually independent experience aside learning simulation tools used wind field creation animator productive system within week first using 8 conclusion presented system modeling diffusion flames main focus efficiency fast animation turnaround complete control visual appearance behavior goals mind system built take advantage recent advances direct simulation well proven techniques generating controlling wind fields methods combined novel approach representing structure flame procedural animation methodology produce comprehensive animation tool high volume throughput dial realistic stylistic results 9 r realistic controllable fire simulation recent advances volume introduction fire dynamics 2nd modeling motion hot realistic animation liquids practical animation liquids visual simulation smoke simple model flames modeling rendering various natural phenomena consisting particles method modeling clouds based atmospheric fluid dynamics flow noise synthesizing flames spreading particle systems technique modeling class fuzzy objects modeling motion dense smoke wind field stable fluids depicting fire gaseous phenomena using diffusion processes turbulent wind fields gaseous phenomena animating explosions modeling smoke flow taking obstacles account figure 6 fire system use 3d animated feature film figure 7 interaction flames simple stationary objects tr simple model flames turbulent wind fields gaseous phenomena depicting fire gaseous phenomena using diffusion processes realistic animation liquids modeling motion hot turbulent gas stable fluids animating explosions particle systemsmyampersandmdasha technique modeling class fuzzy objects visual simulation smoke practical animation liquids volume rendering pool fire data modeling rendering various natural phenomena consisting particles realistic controllable fire simulation modeling smoke flow taking obstacles account method modeling clouds based atmospheric fluid dynamics ctr criss martin ian parberry real time dynamic wind calculation pressure driven wind system proceedings 2006 acm siggraph symposium videogames p151154 july 3031 2006 boston massachusetts fabrice neyret advected textures proceedings acm siggrapheurographics symposium computer animation july 2627 2003 san diego california joshua schpok joseph simons david ebert charles hansen realtime cloud modeling rendering animation system proceedings acm siggrapheurographics symposium computer animation july 2627 2003 san diego california alfred r fuller hari krishnan karim mahrous bernd hamann kenneth joy realtime procedural volumetric fire proceedings 2007 symposium interactive 3d graphics games april 30may 02 2007 seattle washington raanan fattal dani lischinski targetdriven smoke animation acm transactions graphics tog v23 n3 august 2004 andrew selle alex mohr stephen chenney cartoon rendering smoke animations proceedings 3rd international symposium nonphotorealistic animation rendering june 0709 2004 annecy france n threy r keiser pauly u rde detailpreserving fluid control proceedings 2006 acm siggrapheurographics symposium computer animation september 0204 2006 vienna austria flavien bridaultlouchez michel leblond franois rousselle enhanced illumination reconstructed dynamic environments using realtime flame model proceedings 4th international conference computer graphics virtual reality visualisation interaction africa january 2527 2006 cape town south africa lin shi yizhou yu taming liquids rapidly changing targets proceedings 2005 acm siggrapheurographics symposium computer animation july 2931 2005 los angeles california insung ihm byungkwon kang deukhyun cha animation reactive gaseous fluids chemical kinetics proceedings 2004 acm siggrapheurographics symposium computer animation august 2729 2004 grenoble france alexis angelidis fabrice neyret karan singh derek nowrouzezahrai controllable fast stable basis vortex based smoke simulation proceedings 2006 acm siggrapheurographics symposium computer animation september 0204 2006 vienna austria nick rasmussen duc quang nguyen willi geiger ronald fedkiw smoke simulation large scale phenomena acm transactions graphics tog v22 n3 july andrew selle nick rasmussen ronald fedkiw vortex particle method smoke water explosions acm transactions graphics tog v24 n3 july 2005 lin shi yizhou yu controllable smoke animation guiding objects acm transactions graphics tog v24 n1 p140164 january 2005 frank losasso frdric gibou ron fedkiw simulating water smoke octree data structure acm transactions graphics tog v23 n3 august 2004 frank losasso tamar shinar andrew selle ronald fedkiw multiple interacting liquids acm transactions graphics tog v25 n3 july 2006 eran guendelman andrew selle frank losasso ronald fedkiw coupling water smoke thin deformable rigid shells acm transactions graphics tog v24 n3 july 2005