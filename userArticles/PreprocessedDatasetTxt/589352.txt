improved symbolic numerical factorization algorithms unsymmetric sparse matrices present algorithms symbolic numerical factorization phases direct solution sparse unsymmetric systems linear equations modified classical symbolic factorization algorithm unsymmetric matrices inexpensively compute minimal elimination structures give efficient algorithm compute nearminimal datadependency graph unsymmetric multifrontal factorization valid irrespective amount dynamic pivoting performed factorization finally describe unsymmetricpattern multifrontal algorithm gaussian elimination partial pivoting uses task datadependency graphs computed symbolic phase algorithms implemented wsmpan industrial strength sparse solver packageand enabled wsmp significantly outperform similar solvers present experimental results demonstrate merits new algorithms b introduction typical dire ct solve rs ge ne ral sparse syste ms line ar e quations form four distinct phase analysis comprising orde ring fillin duction symbolic factorization nume rical factorization sparse coe cie nt matrix triangular factors l u using gaussiane limina tion partial pivoting forward backwarde limination solve x using triangular factors l u righthandside ctor b ite rative fine nt compute solution pape r de scribe algorithms use unsymme tric symbolic nume rical factorization phase watson sparse matrix package wsmpa highpe rformance robust software solving ge ne ral sparse line ar syste ms se algorithms crucial wsmps pe rformance e n shown significantly tte r othe r similar solve rs 18 important contribution pape r show contrary conve ntional wisdom possible symbolically de te rmine static communication patte rn paralle l unsymme tric sparse lu n pre se nce partial pivoting proce ss factoring sparse matrix e xpre sse dire cte acyclic taskde pe nde ncy graph taskdag rtice dag corre spond tasks factoring rows columns groups rows columns sparse matrix e dge corre spond de pe nde ncie twe e n tasks task ady fore xe cution tasks incominge dge comple te addition taskdag datade pe nde ncy graph datadag associate sparse matrix factorization rte x se datadag taskdag give n sparse matrix ane dge rte x rte x j datadag de note le ast output data task quire input task j pape r de fine task task computing column l row u tasks de fine taskdag unique sparse received editors october 3 2001 accepted publication revised form e g ng october 18 2002 published electronically december 3 2002 httpwwwsiamorgjournalssimax24239604html tjw atson research center po box 218 yorktown heights ny 10598 anshulwatson ibmcom matrix give n pe rmutation rows columns howe r datadag function sparse factorization algorithm multifrontal algorithms 9 14 23 sparse factorization work minimal datadag ie datadag smalle st possible dge give n matrix case symme tric sparse matrice minimal task datadags factorization proce ss tre e calle e limination tre e 22 howe r un symme tric sparse matrice task datadags ge ne ral dags ove r e dge se minimal datadag unsymme tric sparse factorization rse e dge se taskdag gilbe rt liu 16 de scribe e limination structure unsymme tric sparse lu factors give algorithm sparse unsym tric symbolic factorization se e limination structure two dags transitive ductions graphs factor matrice l u spe ctive ly use de rive taskdag sparse lu factorization se arche rs argue computing ane xact transitive duction tooe xpe nsive 9 15 propose using subminimal dags e dge ne ce ssary howe r trave rsing unne ce ssary dge nume rical factorization source ove rhe ad ove r paralle l imple ntatione xtra dge pote ntial source unne ce ssary synchronization communication pape r show lative ly straightforward modification gilbe rt lius symbolic factorization algorithme nable ane cie nt computation minimale limination dags also de fine se dge must adde taskdag orde r ge ne rate minimal datadag valid long partial pivoting dynamic row columne xchange pe rforme factorization finally de scribe supple nting datadag furthe r small se ofe xtrae dge yie ld ne arminimal datadag sucie nt handle arbitrary numbe r pivot failure sulting row columne xchange nume rical factorization pivot failure occurs pivot pre dicte analysis phase must alte nume rical factorization cause nume rical value pivot small ans ofe xpe rime nts suite unsymme tric sparse matrice al applications show computing final datadag xtre ly fast furthe rmore matrice te st suite datadag slightly highe r ofe dge taskdag constructe using comple te transitive duction multifrontal thod 9 14 23 sparse matrix factorization usually oe rs significant pe rformance advantage ove r conve ntional factorization sche pe r mittinge cie nt utilization paralle lism mory hie rarchy du id 14 de scribe symme tricpatte rn multifrontal algorithm unsymme tric matrice ge ne rate ane limination tre e base symme tric structure union structure transpose guide nume rical factorization algorithm works square frontal matrice se e se ction 41 incur substantia ove rhe ad ry unsymme tric matrice due unne ce ssary data de pe nde ncie e limination tre e due toe xtra ze ros artificially symme trize frontal matrice davis du 9 hadfie ld 20 introduce unsymme tricpatte rn multifrontal algorithm ove rcome de ficie ncie symme tricpatte rn algo rithm powe rful symbolic phase e nable us use much simplifie e cie nt rsion unsymme tricpatte rn multifrontal algorithm partial pivoting de scribe unsymme tricpatte rn multifrontal algorithm use wsmp ande xpe rime ntally compare othe r state ofthe art sparse unsymme tric factorization code unsymmetric sparse matrix factorization 531 table test ith order n number nonzeros nnz application area origin number matrix n nnz application finite element analysis 3 bayer01 57735 277774 chemistry 4 bbmat 38744 1771722 fluid dynamics programming 6 e40r0000 17281 553956 fluid dynamics 7 e40r5000 17281 553956 fluid dynamics simulation 9 epb3 84617 463625 thermodynamics engineering 14 mixtank 29957 1995041 fluid dynamics engineering simulation simulation pre2 659033 5959282 circuit simulation 19 raefsky3 21200 1488768 fluid dynamics 22 tib 18510 145149 circuit simulation twotone 120750 1224224 circuit simulation wang3old 26064 177168 circuit simulation simulation table 11 introduce suite randomly chose n te st matrice use ine xpe rime nts throughout pape r table shows orde r ofe ach matrix numbe r nonze ros application origin matrix matrice te st suite arise allife proble ms public domain e xpe rime nts porte pape r conducte ibm rs6000 wh2 gbyte ram 8 mbyte le l2 cache 64 kbyte le l1 cache organization pape r follows ction 2 introduce te rms conve ntions notations use pape r symbolic factorization algorithm compute structure triangular factors minimale limination structure de scribe se ction 3 se ction 4 de scribe compute ne arminimal datadags unsymme tric multifrontal factorization nume rical factorization algorithm discusse de tail se ction 5 finish concluding marks se ction 6 last subse ction ofe ach major se ction containse xpe rime ntal sults pe rtaining algorithms se ction 2 terminology conventions assume original n n sparse unsymme tric coe cie nt matrix irre ducible cannot pe rmute blocktriangular form se rious striction cause ge ne ral matrix first duce blocktriangular form n irre ducible diagonal blocks ne e factore 12 assume coe cie nt matrix factore lowe r triangular matrix l uppe r triangular matrix u multiple row column pe rmutations may applie various stage solution proce ss howe r sake clarity always de note coe cie nt matrix factors l u state pe rmutation l u usually cle ar conte xt de note dire cte graph corre sponding n n matrix graph may always associate ane xplicitly de fine matrix howe r n ane dge ij em ij structural nonze roe ntry sparse matrix transpose matrix pre se nte ij em n ji em vice rsa se indice columns structural nonze roe ntry row also se rtice outbound e dge ing similarly structm se indice rows structural nonze roe ntry column also se rtice inbounde dge ing dire cte path node node j dire cte graphg de note ij transitive ductiong ovm em graph graph smalle st dge dire cte path ij ifg dire cte path ij since primarily de aling nonze ro structure matrice rathe r actual value may also loose ly fe r transitive duction transitive duction ofg le ading submatrix de note corre sponding graph transitive duction andg spe ctive ly e dge paths graphs use pape r labe le e dge labe le graph one thre e labe lsl u lu de pe nding labe l ane dge le dge ue dge lue dge l u lue dge rte x j de note l j iu j lu j spe ctive ly lpath j de note l j dire cte path containing l lue dge similarly upath j de note iu j dire cte path containing u lue dge le dge l je xists graph lpare nti similarly iu je xists upare nti lu je xists lupare nti de fine 1 supe rnode q r maximal se conse cutive indice q q 1 r matrice l u de fine supe rnodal matrice l u thate ach supe rnode q r l u pre se nte single row column l u n total numbe r supe rnode furthe rmore r n g h column row indice l u maintain lative orde r supe rnode l u 3 computing taskdag structures l u gilbe rt pre se nt unsymme tric symbolic factorization algorithm compute structure factors l u ir transitive ductions l u figuresummarize gilbe rt lius algorithm algorithm compute structure l u l row row compute structure u columns total time algorithm shown figure spe nds ste p 1 bounde flopslu 16 numbe r ope rations quire multiply sparse matrice l u similarly time spe nt ste p 3 bounde flopsul total computational cost ste ps 2 4 cause transitive duction pe rforme n rows u columns l ith ste p could pote ntially trave rse alle dge ing l andg u ste ps 2 4 gilbe rt lius algorithm much costly ste ps 1 3 cost se ste ps definitions supernodes context unsymmetric sparse factorization used literature 11 unsymmetric sparse matrix factorization 533 n 1 compute trave rsingg u using fact j j structl k j k path kj u i1 2 transitive ly duce structl usingg l ande xte nd tog l 3 compute 4 transitive ly duce structu usingg u ande xte nd tog u end fig 31 gilbert lius unsymmetric symbolic factorization algorithm 16 n 1 transitive ly duce structl usingg l ande xte nd tog l 2 compute 3 transitive ly duce structu usingg u ande xte nd tog u 4 compute end fig 32 modified symbolic factorization algorithm prompte se arche rs se e k alte rnative computing fast incomple te transitive duction 9 15 use alte rnative tog l andg u e dge thang l andg u spe ctive ly incre ase cost ste ps 1 3 nume rical factorization 31 modification gilbert lius algorithm de scribe lative ly simple modification algorithm shown figure 31 start splitting original coe cie nt matrix lowe r triangular part store columns uppe r triangular part store rows modifie symbolic factorization algorithm compute structure l columns ie l rows u rows achie simply formulating algorithm shown figure 31 pe rform ste ps 2 3 twice fore ach two se ts ide ntical data structure sone corre sponding l othe r corre sponding u modifie algorithm shown figure 32 note algorithm figure 32 ste ps 3 4 ide ntical ste ps 1 2 spe ctive ly first two ste ps compute ith rows l u last two ste ps compute ith columns u l actual code algorithm use pair routine die nt argume nts imple nt four ste ps duction size code half howe r se condary ne fit modifie algorithm primary advantage sche allows imme diate de te ction supe rnode symbolic factorization shalle xplain se ction 32 allows us avoid computing storingg l andg u e xplicitly inste ad work ir supe rnodal counte rpartsg l g u 32 use supernodes speed transitive reduction mode rn sparse factorization code ly avily toe cie ntly utilize mory hie rarchie paralle lism hardware crucial high pe r formance sparse matrix factorization crite rion inclusion rows columns supe rnode ofte n laxe 7 incre ase size supe rnode conse cutive rows columns ne arly ide ntical structure ofte n include supe rnode artificial nonze roe ntrie nume rical value 0 adde maintain ide ntical row column structure mbe rs supe rnode rationale slight incre ase numbe r nonze ros floatingpoint ope rations involve factorization compe nsate highe r factorization spe e wsmps lu factorization algorithm also works laxe ge ne rate symbolic factorization symbolic factorization algorithm soon compute ith ite ration oute r loop compare structl i1 structu i1 de te rmine long curre nt supe rnode ne w rowcolumn pair adde curre nt supe rnode structure ide ntical ne arly ide ntical pre vious rowcolumn pair ith rowcolumn pair fails e crite rion mbe rship curre nt supe rnode n ne w supe rnode starte use supe rnode allows us significantly duce cost computing transitive ductions ste p 1 algorithm shown figure 32 inste ad transitive ly ducing e ntire structl duce se h ste p 3 tre ate similarly sult working supe rnode uppe r bound cost computing transitive duction de cre ase cause supe rnodal dagsg l andg u se arche duringe ach n transitive duction ste ps strict supe rnodal andg u would le ast fe dge thang l andg u numbe r supe rnode ason u l contain anye dge ij supe rnode use laxe duce numbe r ofe dge e n furthe r cause pote ntiale dge form ij e liminate taskdag node artificially rge 33 taskdags lu factorization pape r fe r two type taskdags conve ntional dag de note supe rnodal dag de note rte x conve ntional taskdag fe rs task computing single row u corre sponding column l othe r hand rte x supe rnodal taskdag corre sponds se rowcolumn pairs constitute supe rnode although practical imple ntation always work supe rnodal dags ofte n use conve ntional task datadags mainde r pape r e xposition simple sults de scriptions pre se nte te rms conve ntional dags map naturally supe rnodal case first show compute tc te rms conve ntional structure l u transpose matrix l use indicate ij theorem 31 taskdag lu factorization rte x se 1 2 n itse dge se proof prove taskdag show e c sucie nt p se nt prope r orde ring ne limination tasks de note v c structl contribute structl j structu j case n symbolic factorization algorithm figure 32e nsure u containse ithe r ij unsymmetric sparse matrix factorization 535 table comparison conventional symbolic factorization due gilbert liu 16w ith supernodal size largest diagonal block matrix onw hich symbolic factorization performed nsup number supernodes c times seconds tw number edges taskdags produced tw algorithms matrix v nsup conventional supernodal ct bbmat 38744 4877 10 41260 17 6077 79 68 59 e40r5000 17281 2755 60 19891 16 3182 63 63 38 fidap011 16614 1262 23 16613 42 1261 13 13 55 mil053 530238 166155 15 530237 45 166154 32 32 33 mixtank 29957 2984 78 30949 12 3203 10 97 65 nasasrb 54870 3808 49 54869 97 3807 14 14 51 pre2 629628 243693 30 765210 64 317216 26 24 47 raefsky3 21200 1282 21 21199 41 1281 17 17 51 raefsky4 19779 1359 29 19778 50 1358 15 15 58 tib 17583 7823 11 22904 07 10060 22 23 16 twotone 105740 34304 26 126656 91 44856 31 28 29 wang3old 26064 8451 31 26063 54 8450 31 31 57 wang4 26068 8254 30 26067 53 8253 32 32 57 ij true structu structu j l fore e ry rowcolumn pair update row column j must e liminate fore j ore 31 e asilye xte nde supe rnodal case supe rnodal taskdag de fine rte x se ane dge se numbe r supe rnode 34 experimental results table 31 compare gilbe rt lius symbolic factorization algorithm 16 supe rnodal symbolic factorization algorithm de scribe se ction 32 port ir cpu time tc spe ctive ly numbe dge task dags ge ne rate last column table 31 shows factor supe rnodal symbolic factorization faste r conve ntional algorithm table also shows ave rage supe rnode size nm ratio dge fore ach matrix se two ratios close ly late ratio tc ars corre lation ratio dge actual ratio matrix de pe nde nt note time transitive duction ste ps 1 3 algorithm figure 32 duce use supe rnode time computing structure l u ste ps 2 andre mains mostly unchange othe r duction numbe r structure rge due supe rnode laxation fore actual duction achie symbolic factorization time de pe nds lative amounts time spe nt 536 anshul transitive duction computing l u structure ove r table ports numbe r dge taskdags numbe r dge actual lowe r uppe r triangular transitive ly duce graphs trave rse symbolic factorization call e dge se taskdag union e dge se ts corre sponding lowe r uppe r triangular transitive ly duce graphs amount structural symme try matrix ae cts numbe r commone dge twe e n uppe r lowe r transitive ly duce graphs turn de te rmine actual dge taskdag eise nstat liu 15 pre se nt alte rnative comple te transitive duction duce cost ste p sparse unsymme tric symbolic factorization propose e xploiting structural symme try matrix compute partial transitive ductions although pre se nte xpe rime ntal sults die nt se much smalle r matrice appe ars use supe rnode propose se ction 32 achie much highe r spe e dups symbolic factorization computinge xact transitive ductions partial transitive duction sche propose 15 howe r eise nstat lius algorithm spe use supe rnode supe rnodal rsion algorithm e n imple nte supe rlu dist 21 sparse solve r package compare symbolic factorization time supe rlu dist found latte r slowe r 25 ove rall te st suite could partly due imple ntation die nce partly due fact eise nstat lius algorithm save time transitive duction computation spe ndse xtra time rging structure due dundante dge dag appe ars use supe rnode gilbe rt lius algorithm spe e transitive ductione nough match outpe rforme n supe rnodal rsion eise nstat lius algorithm ine xe cution time 4 datadags unsymmetric multifrontal lu factorization original multifrontal algorithm 14 23 de scribe conte xt symme tric patte rn coe cie nt matrix e n applie matrice unsymme tric patte rns introducing ze rovalue de ntrie appropriate locations conve rt original matrix one patte rn aa 14 2 4 cause substantial ove rhe ad ry unsymme tric matrice due e xtra computation pe rforme introduce de ntrie sulting fillin davis du 9 hadfie ld 20 introduce unsymme tricpatte rn multifrontal algorithm ove rcome short coming se ction de lop ne arminimal datadags unsymme tric multifrontal algorithman aspe ct unsymme tric multifrontal factorization e n inve stigate pre vious works shall show se ction 5 availability ne arminimal datadag aids e cie nt imple ntation nume rical factorization phase would also lp minimize synchronization communication ove rhe ads paralle l imple ntation 41 outline symmetric multifrontal algorithm symme tric patte rn multifrontal algorithm guide asse mbly ore limination tre e 22 23 19 se rve task datade pe nde ncy graphs factorization proce ss data associate withe ach supe rnode e limination tre e square frontal matrix frontal matrix f g associate supe rnode de nse matrix whose dime nsions e qual structu q contiguous local row column indice de nse frontal matrix corre spond noncontiguous global indice matrix l eache ntry frontal matrix corre sponds structural nonze roe ntry global matrix afte r frontal matrix f g fully asse mble populate le ading r q columns corre sponding unsymmetric sparse matrix factorization 537 supe rnode also known pivot block factore come parts factors u l spe ctive ly maining trailing part frontal matrix calle update contribution matrix de note c g contribution matrix corre sponding supe rnode asse mble comple te ly frontal matrix pare nt supe rnode ne r acce sse cause pare nt supe rnode e limination tre e n structl r true columns u due symme try cursive formulation symme tricpatte rn multifrontal algorithm task corre sponding supe rnode first comple te ide ntical subtasks fore ach childre n e limination tre e n asse mble ir contribution matrice frontal matrix finally pe rforms partial factorization frontal matrix calling cursive proce dure pe rform task de scribe root su pe rnode e limination tre e comple te factorization sparse matrix symme tric structure 42 outline unsymmetric multifrontal algorithm ove rall structure unsymme tricpatte rn multifrontal algorithm similar symme ric counte rpart e xpre sse form cursive proce dure starting root supe rnode outgoinge dge taskdag howe r two major die nce first die nce controlflow unsymme tric multifrontal algorithm fore starting subtask child task corre sponding pare nt supe rnode must che ck se e child supe rnode alre ady e n proce sse anothe r pare nt first pare nt ach child actually pe rforms cursive computation starting child se cond die nce data flow way contribution matrice asse mble frontal matrice e xplaine low gre ate r de tail call e dge se e c taskdag union e dge se ts transitive ductions l u spe ctive ly assign labe ls e dge e dge contribute e c sole ly e l labe le le dge dge contribute e c sole ly e u labe le ue dge third type labe l lulabe l assigne e dge long inte rse ction e l e u finally le dge l j conve rte lue dge lu j upath iu j ue dge iu j conve rte lu j lpath l j e dge supe rnodal taskdag de fine similarly unlike symme tric multifrontal algorithm frontal contribution matrice unsymme tric multifrontal algorithm ge ne ral ctangular rathe r square furthe rmore contribution matrix unsymme tric multifrontal algorithm pote ntially asse mble one frontal matrix cause supe rnode datadag one pare nt de scribe 20 asse mbly contribution matrice pare nt frontal matrice unsymme tric multifrontal algorithm proce e ds follows h le dge datadag inde x common n alle le nts row u c g pote ntially asse mble f h similarly gu h ue dge inde x common n alle le nts column l c g pote ntially asse mble f h finally g lu h lue dge n e ntire trailing submatrix c g global row column indice gre ate r ore qual asse mble f h ce rtaine ntrie c g may pote ntial de stinations frontal matrice multifrontal factorization guided taskdag matrix lu u lu lu lu u intended destination taskdag u fig 41 example inability taskdag guide complete assembly contribution matrices unsymmetric multifrontal algorithm x denotes nonzero coecient matrix denotes nonzero created due fillin one pare nt ge n datadag contains unne ce ssarye dge cause c g common rows columns frontal matrice one among gs lu lpare nts upare nts unsymme tric multifrontal algorithm muste nsure anye ntry contribution matrix use update one frontal matrix additionally corre ct datadag must sucie nt outgoinge dge supe rnode thate ache ntry contribution matrix pote ntial de stination le ast one frontal matrix 43 inadequacy taskdag unsymmetric multifrontal algorithm ans smalle xample figure 41 show taskdag de fine se ction 33 use datadag n contribution matrice may fully absorbe ir pare nt frontal matrice figure shows sparse matrix factorization fillin transitive ly duce dags l u task dag itse dge labe le de scribe se ction 42 sake claritye ach supe rnode chose n size 1 figure shows frontal contribution shade portions matrice flow data contribution frontal matrice along e dge taskdag note alle dge may le ad data lu 5 asily se e n ue dge 1u 4 abse nt taskdag cause move transitive ly ducing u u ne ce ssary comple te asse mbly c 1 44 datadag predefined pivot sequence shown minimal taskdag cannot se rve datadag unsymme tric multifrontal de fine datadag sucie nt prope r asse mbly contribution matrice long rows columns note xchange among die nt supe rnode pivoting use n de note dag whe supe rscript n stands pivoting datadag p accommodate unsymmetric sparse matrix factorization 539 pivoting de scribe se ction 45 theorem 41 column following conditions n ue dge u j ne ce ssary c comple te ly asse mble pare nts frontal matrice 1 lupare nt ite xists gre ate r j 2 none upare nts structu j 3 e xists k structl k j transpose ore state similarly proof contribution matrix c column contribute l j cause le ast ane le nt corre sponding l kj c time none upare nts frontal matrice column j cannot absorb l j c since lupare nt gre ate r j cannot absorb l j c addition iu j make possible c contribute l j f j transpose case prove n similarly ore 41 capture situation illustrate figure 41 4 pre scribe addition toe nsure comple te asse mbly c 1 theorem 42 n dag forme adding possible e dge according ore 41 provide se e dge dont alre adye xist n n datade pe nde ncy dag unsymme tric multifrontal algorithm without pivoting proof show n datadag must show itse dge se sucie nt comple te absorption contribution matrice ir pare nt frontal matrice prove contradiction without loss ge ne rality assume ane le nt corre sponding l kj c asse mble note j k l kj c ithe r upath iu j n alle ntrie row indice gre ate r ore qual j column c absorbe f j se e ntrie include one corre sponding l kj n upath iu je xists two possibilitie e ithe r lupare lupare nti j lupare nti l j n e ntire trailing submatrix c row column indice gre ate r l including asse mble f l l j n conside r two furthe r possibilitie se ithe r one upare nts structu j one n frontal matrix absorb column j c none upare nts structu j n conditions applicability ore 41 satisfie fore iu j would e n adde n would cause e ntry corre sponding l kj c absorbe f j thus possible e ntry corre sponding l kj le ft unasse mble c similarly shown e ntry corre sponding u jk cannot le ft unasse mble c shown e dge se n sucie nt unsymme tric multifrontal factorization without pivoting show alle dge n inhe rits may ne ce ssary pivoting pe rforme factorization theorem 43 lu factorization without pivoting ane dge u j l dundant maximum inde x structl structu smalle r j proof call structl j maximum inde x structl smalle r j n doe contribute structl j proof l structu similar note ore 43 valid row columne xchange pe r forme lu factorization othe rwise additional fillin cause pivoting could cre ate inde x gre ate r ore qual j structl structu e n pre dicte symbolic factorization original pe rmutation matrix fore alle dge could pote ntially use supe rnodal rsions ore ms 4143 prove n similarly summarize sults subse ction shown construct data dag unsymme tric multifrontal factorization without pivoting taskdag shown although taskdag de rive strict transitive ductions l u l u may still pass one dge datadag dundant pivoting pe rforme factorization fore datadag minimal howe r pivoting pe rforme n pote ntially e dge could ge use 45 supplementing datadag dynamic pivoting show e dge se datadag n constructe se ction 44 may su cie nt pivoting pe rforme factorization also discuss supple nt ge ne rate datadag p whose e dge se sucie nt handle amount pivoting start ove rvie w pivoting thodology unsymme tric multifrontal algorithm e n de scribe de tail 20 diagonale le nt ii q r supe rnode q r fails e pivoting crite rion n first atte mpt made toe xchange row column row j column k pivoting crite rion intrasupe rnode pivoting noe e ct structure factors factorization continue usual howe r may always possible find suitable rowcolumn pair within supe rnode pivot block satisfy pivoting crite rion situation inte rsupe rnode pivoting ne ce ssary lupare nt datadag suitable ith pivot cannot found within pivot block f g n rowcolumn pairs r symme trically pe rmute ne w locations r thuse e ctive ly shrinks q supe rnode te xpands r side e e ct pivoting additional fillin ance stors g datadag smalle r h particular columns l gs uance stors smalle r h ge te xtra row indice rows u gs lance stors smalle r h ge te xtra column indice failure supe rnode h handle similarly cursive manne r n whose construction de scribe se ction 44 supe rnode may lupare nt support symme tric pivoting thod de scribe fore first ste p towards de riving p n alte r e dge se latte r follows fore ach g 1 total numbe r supe rnode smalle st supe rnode h g l h gu xist de signate lupare nt g ane dge gh doe note xist n lue dge g lu h adde datadag l ue dge ghe xists n conve rte lue dge n alle dge gk k h de le te original matrix ducible blocktriangular form n afte r modificatione ach supe rnode othe r root supe rnode lupare nt accommodate rowcolumn pairs fail satisfy pivoting crite rion ir original locations 20 asily se e n modification noe e ct ore ms 4143 cause g l h gu h modifie n g l h gu h original n de fine se ction 44 unsymmetric sparse matrix factorization 541 old indices original matrix multifrontal factorization without pivot failure flu factorization failure pivot 1 handling failure pivot 1 new unassembled intended destination datadag13lu u lu lu fig 42 example factorization show failure pivot 1 handled symmetric permutation row column 1 merge themw ith luparent supernode 4 x denotes nonzero coecient matrix denotes fillin circled x created due pivoting 0 denotes fillin predicted original symbolic factorization value zero due pivotingrelated movement row columns figure also show absence 2 l 4 leaves entry u 15 unassembled c 2 figure 42 shows failure pivot row column 1 atte mpte unsymme tric multifrontal factorization small 5 5e xample matrix rowcolumn 1 symme trically pe rmute ne w location adjace nt 1s lupare nt 4 data dag sults addition row inde x 1 1s upare nt 2 addition column inde x 1 1s lpare nt 3 additionally afte r moving ir ne w locations row 1 u column 1 l ge fillin column row positions row 4 u column 4 l nonze ros ie u 15 l 41 l 51 figure 42 also shows afte r pivoting ne w row 1 c 2 cannot fully asse mble abse nce le dge 2 l 4 arly addition adding dge de scribe de arlie r n quire furthe r modifications orde r se rve datadag unsymme tric multifrontal algorithm dynamic pivoting figure give anothe xample factorization whe n unable guide comple te asse mbly e nt pivot failure note thise xample satisfie first two conditions ore 41 howe r since doe satisfy condition 3 dge adde abse nce pre clude comple te asse mbly c 2 pare nts frontal matrice state prove ore pre scribe modification n pre nt situation illustrate figure 43 theorem 44 column following conditions n ue dge u j ne ce ssary c comple te ly asse mble pare nts frontal matrice e nt failure pivot k 1 lupare nt gre ate r j 2 none upare nts structu j 3 xists upath k u lupare ntk j transpose ore state similarly proof note ore 44 ry similar ore 41 die nce condition 3 pivot k fails n add row structl corre sponds lupare ntk 1 ne w location k gre ate r j 1 ne w inde x j thus failure pivot k transforms condition 3 ore 44 condition 3 applicability ore 41 alre ady e n prove ore 44 state thate n structl doe inde x gre ate r j othe r conditions applicability ore 41 satisfie iu j pre se nt dag n pivoting may sult incomple te asse mbly unle ss thise dge adde cause pivoting cre ate nonze roe ntry l ki j happe ns e xample shown figure 43 original indice pivoting change j k 1 7 8 spe ctive ly light ore 44 introduce anothe r modification n inste ad using ore 41 strictly de rive n omit che cking condition 3 de rive n adding e dge practice satisfy conditions 1 2 ans ore 45 show datadag n e n afte r modifications de scribe sucie nt toe nsure comple te asse mbly contribution matrice e nt inte rsupe rnode pivoting ade r rify figure transpose case ore 45 5 finally ore 46 show supple nting data dag additionale dge pre scribe ore 45 make sucie nt handle contribution matrice face inte rsupe rnode pivoting dide arlie r pape r sake clarity simplicity state prove ore ms 45 46 conte xt conve ntional dags single node supe rnode sults naturallye xte nd supe rnodal dags theorem 45 h lupare nt j following conditions hold n ue dge u h ne ce ssary c comple te ly asse mble pare nts frontal matrice e nt j fails e pivot crite rion original location 1 e xists lpath j l h lupare nti h 2 none upare nts structl j 3 eithe r k structl k h upath k u lupare transpose case state similarly unsymmetric sparse matrix factorization 543 indices indices new f 9 f 486423748 9 lu uu u u u u u original matrix datadag9 x unassembled5 handling failure pivot 1 intended destination lu lu lu lu lu lu fig 43 example factorization show edges n sucient assemble parents frontal matrices event failure pivot 1 convention representing dierent types structural nonzeros figure 42 proof pivot j fails n along othe r faile luchildre n h occupie ne w position fore h since lpath j l column j adde c afte r failure pivot j ne w matrix afte r pivoting j know lupare nt gre ate r ne w j cause lupare nti h since none upare nts old structl j ne w structu j e ithe r thus first two conditions applicability ore ms 41 44 satisfie condition 3 ore 45 quivale nt condition 3 ore ms 41 44 fore ue dge iu j ne e de prope r multifrontal factorization ne w matrix afte r pe rmuting j ne w location since ne w location j rge h common supe rnode ue dge iu h original matrix would suce proof transpose case similar theorem 46 p dag forme adding possible e dge according ore 45 n n p ade quate datadag unsymme tric multifrontal factorization pote ntially unlimite inte rsupe rnode pivoting proof prove showing p possible anye le nt contribution matrix c main unasse mble without loss ge ne rality conside r ane le nt corre sponding l kj c l kj c ne ithe r k structl original l u pre dicte symbolic factorization row k column j adde c due pivoting row k column j parts original structure c n ore 42 alre ady shown e dge se n subse e dge se p sucie nt asse mble l kj show l kj absorbe c one pare nts p adde c due pivoting irre spe ctive whe r row k longe original structl adde c due pivoting lupare nti lupare ntj conside r two case 1 g h 2 g h g h f g row k column j absorb e le nt corre sponding l kj c g h n first condition applicability ore 45 e n conside r two furthe r sce narios 2a le ast one upare nts original structl j 2b none upare nts original structl j case 2a afte r pivoting le ast one upare nts ne w structu j frontal matrix upare nt absorb column j c including e ntry corre sponding l kj case 2b se cond condition applicability ore 45 e n finally whe r row k original structl adde c due failure ude sce nde nt k final location k must gre ate r h ason j k h ie ks ne w location e xte nde supe rnode h n h must luance stor cause implie l h iu h datadag possible cause alre ady working unde r assumption lupare nt g gre ate r h fore k h third condition ore 45 also e n sult ore 45 would e nsure ue dge iu h pre se nt p asse mble column j similarly prove noe ntry corre sponding u jk le ft unasse mble c 46 experimental results se ctions 44 45 showe supple nt e dge se taskdag construct datadag unsym tric multifrontal algorithm table showse xpe rime ntal sults wsmps unsymmetric sparse matrix factorization 545 table time required number edges dag matrix symbolic supplement1 supplement2 total time ed p bbmat 17 6077 06 6142 00 6181 176 102 mil053 45 166154 51 166154 07 166154 508 100 mixtank 12 3203 05 3203 00 3203 125 100 pre2 64 317216 84 320063 16 320942 740 101 twotone 91 44856 12 45866 01 45918 104 102 wang3old 54 8450 03 8450 00 8450 057 100 imple ntation proce dure ge ne rate various dags thre e dags conside table 41 supe rnodal taskdag supe rnodal datadag n unsymme tric multifrontal factorization without pivoting supe rnodal datadag p unsymme tric multifrontal factorization pivoting table shows time compute e ach dags numbe r dge matrice te st suite compute basic symbolic factorization algorithm de scribe se ction fore basic symbolic factorization time fe r proce ss computing n supple nt1 supple nt1 che cks first two conditions ore 41 find e dge adde e n adds outgoing dge supe rnode without lupare nts ld e n supple nt2 proce ss addse dge base first two conditions ore 45 ld e xe cution time supple nt1 supple nt2 de note 1 2 spe ctive ly note e dge n p ne ce ssary sake com putational spe e supple nt1 supple nt2 wsmp che ck conditions ore ms 41 44 45 addinge dge last conditions thre e ore ms skippe eve n conditions se ore ms che cke e dge sulting datadags may ne ce ssary fore n p minimal datadags unsymme tric multifrontal factorization howe r table 41 shows se dags many e dge allife matrice ave rage fore xce sse dge supe rnodal p ove r 4 te st suite shown e dge taskdags insucie nt dire ct data flow unsymme tric multifrontal factorization othe r hand e dge p sucie nte n pivoting fore numbe r dge truly minimal supe rnodal datadag whe twe e n numbe r dge supe rnodal p e xpe rime ntal sults table 41 show se two rs usually fairly close table also shows time quire construct n p also small compare basic symbolic torization time thus thodology de scribe se ction construction datadags unsymme tric multifrontal factorization nt time numbe r dage dge comparison table 41 wsmps lu factorization time give n table 51 shows total symbolic time usually significantly le ss nume rical factorization time 5 implementation details unsymmetric factorization brie f outline unsymme tric multifrontal algorithm base work hadfie ld 20 davis du 9 found se ction 42 add de tails pre se nt comple te algorithm imple nte wsmp wsmp ge towards multiple factorizations matrice sparsity patte rn die nt nonze ro value fore symbolic phase pe rforme output use subse que nt nume rical n die nt pivot se que nce sulting die nt nume rical value fundame ntal datastructure unsymme tric multifrontal algorithm frontal matrix frontal matrix associate withe ach supe rnode figure 51 shows organization typical frontal matrix supe rnode core frontal matrix structl q structu q portion pre dicte symbolic factorization abse nce pivoting first r q columns matrix would factore would save parts u l spe ctive ly maining trailing submatrix would constitute contribution matrix whose conte nts would absorbe frontal matrice pare nts g p extra rows f qr qr extra columns r pivot block pivot block fig 51 organization typical frontal matrix supernode r p failed pivots luchildren supernode appended beginning frontal matrix extra row columns inherited u ldescendents respectively appended end unsymmetric sparse matrix factorization 547 pre se nce nume rical pivotinge xtra pivots othe r rows columns may adde frontal matrix de pe nding labe ls pivot failure childre n g p extra pivots rowcolumn pairs indice adde f g pivots gs luchildre n fail satisfy pivoting crite rion luchildre n g mse lve may inhe rite se faile pivots ir luchildre n fore faile pivots lude sce nde nts g cane nd frontal matrix p pivots adde n size pivot block incre ase r q frontal matrix f g similarly inhe rite xtra rows corre sponding faile pivots ude sce nde nts whose lupare nts gre ate r g ande xtra columns corre sponding faile pivots lde sce nde nts whose lupare nts gre ate r g irre spe ctive ir ne w indice se e xtra rows columns always ap pe nde e nd original rows columns f g list ir indice maintaine ate ach supe rnode eve ntually se asse mble e xtra pivots frontal matrice lupare nts supe rnode whe se pivots faile row column structure pre dicte symbolic factorization intact future factorizations matrice nonze ro patte rn additions se structure due pivoting de pe nd nonze ro value matrix ing factore maintaine se parate ly discarde fore e ach ne w factorization availability static datadag p sucie nt handling arbitrary amount dynamic pivoting critical imple ntation unsymme tric multifrontal algorithm figure give highle l pse udocode factorization algorithm algorithm starts root supe rnode task datadags supe rnode first cursive ly factors unfactore childre n supe r node n looks faile pivots childre n figure numbe r indice e xtra rows columns pivots accordingly allocate frontal matrix appropriate size ne xt ste p contribution original coe cie nt matrix contribution matrice curre nt supe rnode childre n accumulate appropriate locations inside frontal matrix finally algorithm proce e ds factor pivot block frontal matrix update mainde r frontal matrix le ading succe ssfully factore rows columns save portions u l use triangular solve maining contribution matrix ntually asse mble frontal matrice pare nts le ase last pare nt pick contribution frontal matrix lupare nt supe rnode picks faile pivot rowcolumn pairs e ntire trailing submatrix contribution matrix row column indice gre ate r ore qual first inde x pare nt supe rnode maining rows columns supe rnode contribution matrix asse mble frontal matrice l upare nts p possible one l upare nts frontal matrice row column indice common childs contribution matrix howe ache le nt contribution matrix must adde intoe xactly one frontal matrix simple bookke e ping track rows columns e n asse mble suce e nsure condition lative ly fe w rows columns pote ntial copie frontal matrice multiple l upare nts spe ctive ly figure 52 de scription se ction show wsmps unsymme tric multifrontal algorithm fairly straightforward imple nt static task datadags compute symbolic phase use cursion make 548 anshul function uns mf root 1 cursive calls roots childre n fore ach child k root alre ady proce sse k call uns mf k flag supe rnode k alre ady proce sse end 2 colle ct pivoting info de te rmine size f root fore ach child k root p k lchild k faile pivots add sorte list f root se xtra columns hase xtra columns add whose lupare nt gre ate r root sorte list f root se xtra columns che cking duplicate else k uchild k faile pivots add sorte list f root se xtra rows hase xtra rows add whose lupare nt gre ate r root sorte list f root se xtra rows che cking duplicate else k luchild k faile pivots add sorte list f root se xtra pivots hase xtra columns add whose lupare nt gre ate r root sorte list f root se xtra columns che cking duplicate hase xtra rows add whose lupare nt gre ate r root sorte list f root se xtra rows che cking duplicate end 3 initialize roots frontal matrix allocate f root appropriate size fill ze ros populate f root withe ntrie corre sponding supe rnode root 4 asse mbly childre ns contribution matrice f root fore ach child k root p copy appropriate contribution c k f root root last pare nt k pick c k contribution fre e space occupie c end 5 nume rical factorization factor pivot block f root update trailing part ld c root function uns mf fig 52 simple ecient unsymmetric multifrontal algorithm unsymmetric sparse matrix factorization 549 nume rical factorization algorithm much simple r de scribe imple nt e arlie r de scriptions unsymme tric patte rn multifrontal algorithm 20 9 othe r umfpack 8 wsmp sparse solve r available base unsymme tric patte rn multifrontal algorithm also first paralle l solve r available ge ne ral use although hadfie ld 20 provide de xpe rime ntal sults paralle l imple ntation ncube practical paralle l solve r sult thate ort algorithm figure 52 lative ly simple de scription also computationally le cause none sse ntial nonfloatingpoint ope rations handle pivot failure fairlye cie ntly also note worthy structurally symme tric matrice algorithm figure 52 naturally duce symme tricpatte rn multifrontal algorithm guide ane limination tre e place p othe r state nts fore ach supe rnode ove rhe ad using algorithm structurally symme tric matrice 51 experimental results compare unsymme tric lu factoriza tion time wsmp thre e state ofthe art multifrontal sparse solve rs name ly mumps rsion 416 4 5 ma41 2 3 umfpack rsion 32 8 de taile comparative study include solve rs found 18 software compare se ctione mploy die nt variants multifrontal thod mumps contains symme tricpatte rn multifrontal factorization code base classical multifrontal algorithm 14 ma41 se nse hybrid twe e n sym tric unsymme tric patte rn multifrontal solve rs use ane limination tre e guide factorization frontal matrice prune allze ro rows columns umfpack 32 contains variation unsymme tricpatte rn multifrontal algorithm 9 use ane limination tre e de rive structure apart factorization algorithm othe r significant die nce among four software package ae ct ir pe rformance first use diffe nt sche fillre ducing ring de fault wsmp use symme tric pe rmu tation base ne ste ddisse ction ring 17 compute structure aa mumps ma41 use symme tric pe rmutation base approximate mini mum de gre e amd algorithm 1 applie structure aa umfpack use column amd algorithm 10 pre pe rmute columns compute row pe rmutation base nume rical sparsity crite ria factorization se cond die nce use maximal matching algorithm 13 pe rmute rows coe cie nt matrix maximize product magnitude diagonal e ntrie shown 6 18 ae ct factorization time cause change amount structural symme try amount nume rical pivoting factor ization wsmp use pre proce ssing matrice mumps ma41 use structural symme try original matrix le ss 50 umf doe use third die nce wsmp duce coe cie nt matrix blocktriangular form mumps ma41 umfpack 32 table 51 shows nume rical factorization time ope ration counts mumps ma41 umfpack wsmp run options mumps ma41 wsmp change minimize die nce twe e n code othe r factorization algorithm switche pe rmutation avydiagonal form associate scaling mumps ma41 wsmp wsmp inste ad de fault ne ste ddisse ction ring use approximate minimum fill orde ring ry similar amd eve n se change die nce main twe e n four table lu factorization times operation counts mumps ma41 umfpack 32 wsmp w ith similar permutation options best time boldface second best time underlined 32w smp matrix time ops time ops time ops time ops af23560 389 256 358 254 859 346 406 322 bbmat 543 416 563 411 787 391 276 215 e40r0000 493 253 363 158 623 217 080 419 ecl32 642 646 671 644 191 112 139 776 fidap011 858 701 879 696 170 851 651 574 mil053 435 318 400 318 107 462 282 208 mixtank 151 141 152 641 363 243 763 646 nasasrb 128 945 119 943 559 282 104 878 pre2 fail fail fail fail fail fail 346 301 raefsky3 444 290 388 290 160 787 488 417 raefsky4 107 744 929 447 250 129 434 225 twotone 565 383 376 318 301 108 287 149 wang3old 729 578 577 510 406 242 458 323 wang4 118 105 122 105 534 307 884 794 code instance mumps ma41 wsmp first pe rmute matrix diagonal structural nonze ros initial pe rmutation mumps ma41 cause use code compute howe r die nt wsmp pivoting strate gy umfpack base row inhe ntly die nt symme tric inte rsupe rnode pivoting strate gy use mumps ma41 wsmp wsmps algorithms work pe rmutation blocktriangular form imple nte mumps ma41 umf pack howe r e xce ption comp2c e e ct blocktriangularization ope ration count factorization insignificant sult se die nce due fact mumps may pe rform ope rations ne c e ssary structurally unsymme tric matrice factorization ope ration counts four code table die nte n similar ring algorithm fillre duction table 51 faste st factorization time fore ach matrix boldface se cond faste st time unde rline although die nce othe r factorization algorithm itse lf ae ct pe rformance se code ise asy se e broad picture thate rge table 51 boldface e ntrie wsmp column unde rline de ntrie ma41 column many matrice e e ct algorithmic choice software ise vide nt factorization statistics table 51 mumps usually quire floatingpoint ope rations factorization ma41 wsmp cause use artificially symme trize frontal matrice padde ze ros ason umfpack faste r mumps unsymmetric sparse matrix factorization 551 ry unsymme tric matrice baye r01 one tone 2 twotone howe r slowe r matrice structural symme try fidap011 mil053 wang4 partly cause use fillre ducing pe rmutation columns coe cie nt matrix fore starting lu factorization ma41 oe rs significant improve nt ove r mumps matrice ry unsymme tric structure comp2c one tone 1 twotone se e ms ma41s chanism finding ze ro rows columns incurs slight ove rhe ad cannot ose matrice ne arly symme tric structure ase cl32 fidap011 wang4 slowe r mumps cle ar table 51 wsmp smalle st ove rall factorization time se n de fault options modifie compare othe r solve rs de fault options wsmps factorization time usually much smalle r 18 shown table 51 6 concluding remarks pape r de scribe sparse unsymme tric symbolic nume rical factorization algorithms improve pre vious similar algorithms phase particular powe rful othe rs de scribe lite rature ine xpe nsive ly compute minimale limination structure transitive ductions uppe r lowe r triangular factors original coe f ficie nt matrix addition compute ne arminimal datade pe nde ncy dags unsymme tric multifrontal factorization without pivoting datadag slightly highe r ofe dge minimal taskdag capable ofe xpre ssing possible datade pe nde ncie face dynamic pivoting fe ature symbolic phase show datadag aids highpe rformance imple ntation unsymme tric multifrontal lu factorization algorithm factorization algorithm faste r othe r sparse lu factorization algorithms also simple r unsymme tric multifrontal algorithms de scribe pre viously lite rature algorithms introduce additional ove rhe ads factoring matrice symme tric nonze ro patte rn whe n pre se nte sparse matrix symme tric structure symbolic nume rical factorization algorithms datastructure ge ne rate grace fully transform ir symme tric counte rparts without quiring significant amount ofe xtra proce ssing storage distribute dme mory paralle l imple ntation unsymme tric sparse lu e dge datadag conne cting tasks mappe onto die nt proce sse de te rmine inte rproce ss communication patte rn static ne ar minimal nature datadag use algorithms would e xtre ly use ful pote ntial paralle l imple ntations unsymme tric multifrontal factorization changing datadag dynamically could cumbe rsome ine cie nt unne ce ssary dge could incre ase synchronization communication ove rhe ads acknowledgments author wishe thank andre w conn fre gustavson jose ph liu sivan tole anonymous fe e fore xtre ly use ful comme nts one arlie r drafts pape r r approximate minimum degree ordering algorithm vectorization multiprocessor multifrontal code memory management issues sparse multifrontal methods multiprocessors fully asynchronous multifrontal solver using distributed dynamic scheduling multifrontal parallel distributed symmetric unsymmetric solvers analysis comparison tw sparse solvers distributed memory computers influence relaxed supernode partitions multifrontal method unsymmetricpattern multifrontal method sparse lu factorization column approximate minimum degree ordering algorithm supernodal approach sparse partial pivoting direct methods sparse matrices algorithms permuting large entries diagonal sparse matrix multifrontal solution unsymmetric sets linear equations exploiting structural symmetry unsymmetric sparse symbolic factorization elimination structures unsymmetric sparse lu factors fast e recent advances direct methods solving unsymmetric sparse systems linear equations highly scalable parallel algorithms sparse matrix factorization lu factorization sequences identically structured sparse tricesw ithin distributed memory environment scalable sparse direct solver using static pivoting role elimination trees sparse factorization multifrontal method sparse matrix solution theory practice tr ctr timothy davis column preordering strategy unsymmetricpattern multifrontal method acm transactions mathematical software toms v30 n2 p165195 june 2004