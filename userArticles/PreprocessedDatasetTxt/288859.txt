combinatorial properties constructions traceability schemes frameproof codes paper investigate combinatorial properties constructions two recent topics cryptographic interest namely frameproof codes digital fingerprinting traceability schemes broadcast encryption first give combinatorial descriptions two objects terms set systems also discuss hamming distance frameproof codes viewed errorcorrecting codes descriptions seen existence ctraceability scheme implies existence cframeproof code give several constructions frameproof codes traceability schemes using combinatorial structures tdesigns packing designs errorcorrecting codes perfect hash families also investigate embeddings frameproof codes traceability schemes allow given scheme expanded later date accommodate users finally look briefly bounds establish necessary conditions existence structures b introduction traceability schemes broadcast encryption defined chor fiat naor 8 frameproof codes digital fingerprinting proposed boneh shaw 4 although two objects designed different purposes similar aspects one purposes paper investigate relations traceability schemes frameproof codes first give combinatorial descriptions two objects terms set systems also discuss hamming distance frameproof codes viewed errorcorrecting codes descriptions seen existence ctraceability scheme implies existence cframeproof code 4 8 constructions frameproof codes traceability schemes pro vided provide new explicit constructions using combinatorial structures tdesigns packing designs errorcorrecting codes perfect hash families also investigate embeddings frameproof codes traceability schemes allow given scheme expanded later date accommodate users finally look briefly bounds establish necessary conditions existence structures rest section review definitions cframeproof codes c traceability schemes given 4 8 respectively 11 frameproof codes order protect product computer software example distributor marks copy codeword ships user data marked codeword examples might done practice see 5 marking allows distributor detect unauthorized copy trace back user since marked object traced users deterred releasing unauthorized copy however coalition users may detect marks namely ones copies differ change marks arbitrarily prevent group users framing another user boneh shaw 4 defined concept cframeproof codes cframeproof code property coalition c users frame user coalition let v b positive integers b denotes number users scheme set called v bcode w called codeword codeword binary vtuple use b theta v matrix depict v bcode row codeword gamma gamma v bcode suppose gamma say bit position undetectable c let uc set undetectable bit positions c called feasible set c define f feasible set f c represents set possible vtuples could produced coalition c comparing codewords jointly hold codeword w j 2 f cnc user j could framed coalition c produces vtuple w j following definition 4 motivated desire situation occur definition 11 v bcode gamma called cframeproof code every w gamma say gamma cfpcv b short thus cframeproof code codewords feasible set coalition c users codewords members coalition hence coalition c users frame user coalition example 11 4 integer b exists bfpcb b matrix depicting code b theta b identity matrix example 12 exists 2fpc3 4 matrix depicting code 12 traceability schemes many situations payperview television broadcast data available authorized users prevent unauthorized user accessing data data supplier encrypt data give authorized users keys decrypt unauthorized users pirate users might obtain decryption keys group one authorized users called traitors pirate users decrypt data entitled prevent chor fiat naor 8 devised traitor tracing scheme called traceability scheme reveal least one traitor confiscation pirate decoder suppose total b users data supplier generates base set v keys assigns k keys user k keys comprise users personal key denote personal key user u p u message consists enabling block cipher block cipher block encryption actual plaintext data using secret enabling block consists data encrypted using v keys base set decryption allow recovery every authorized user able recover using personal key decrypt cipher block using obtain plaintext data traitors may conspire give unauthorized user pirate decoder f pirate decoder f consist k base keys chosen f u2c p u c coalition traitors unauthorized user may able decrypt using pirate decoder f goal data supplier assign keys users way pirate decoder captured keys possesses examined possible detect least one traitor coalition c provided jcj c c predetermined threshold traitor detection would done computing jf p uj users u jf p uj users v 6 u u defined exposed user definition 12 suppose exposed user u member coalition c whenever pirate decoder f produced c jcj c scheme called ctraceability scheme denoted ctsk b v let us briefly discuss difference scheme 8 8 nk integer n set base keys partitioned k subsets size n denote personal key p u transversal contains exactly one key suppose secret key chosen abelian group g encrypt data supplier splits g every share r n keys computing nk values ij comprise enabling block authorized user one key decrypt every r thus compute definition require personal key transversal personal key made selection k base keys set data supplier use k v threshold scheme shamir scheme 13 example construct v shares key encrypt share r key every note definition generalization one given 8 however generalization way enabling block formed traceability property scheme definition traceability property 8 example 13 present 2ts5 21 21 set base keys z 21 personal key user 0 20 arithmetic done z 21 application construction present theorem 35 shown two base keys occur together exactly one personal key consider happens two traitors u v construct pirate decoder f pirate decoder f must contain least three personal keys p u however user w 6 u v 2 hence either u v exposed user pirate decoder f examined 13 previous results construction frameproof codes traceability schemes main goal accommodate many users possible words want find constructions b large possible given values parameters c v k case traceability schemes general would prefer explicit constructions objects opposed nonconstructive existence results example boneh shaw 4 proved following interesting result theorem 11 integers c v 0 exists cfpc however noted 4 proof constructive hence also provide explicit construction cfpc similarly chor fiat naor 8 gave interesting nonconstructive existence result traceability schemes follows theorem 12 integers c v 0 exists ctsv2c 2 provide several explicit constructions frameproof codes traceability schemes later paper although constructions may good asymptotically 4 8 often better relatively small values c v example order obtain b 2 theorem 11 necessary take v 16c 2 construction useful small values v well constructions simple could implemented easily efficiently combinatorial descriptions section give combinatorial descriptions cframeproof codes ctraceability schemes descriptions fairly easy see existence ctsk b v implies existence cfpcv b use terminology set systems set system pair x b x set elements called points b set subsets x members called blocks set system described incidence matrix let x b set system g incidence matrix x b b theta v matrix ae conversely given incidence matrix define associated set system obvious way 21 description cframeproof codes since cfpcv b b theta v 0 1matrix view frameproof code incidence matrix set system defined following characterization frameproof codes set systems theorem 21 exists cfpcv b exists set system x b subset c blocks exist block b 2 bnfb proof suppose codewords cfpcv b c without loss generality assume codewords first bit positions 0 next bit positions 1 every bit position least one codewords value 0 least one value 1 hence undetectable bit positions first bit positions hard see frameproof property equivalent saying codeword w least one 1 first bit positions least one 0 next bit positions words exist codeword 0s first bit positions 1s next bit positions blocks set system corresponding codewords hence frameproof condition equivalent saying exist block b b 22 description ctraceability schemes since ctsk b v consists b ksubsets vset think set system x set base keys b set personal keys theorem 22 exists ctsk b v exists set system x b b property every choice c blocks ksubset f exist block b 2 bnfb proof suppose x b ctsk b v every set c personal b ksubset f ie pirate decoder personal key b exists block converse also straightforward 23 relationship traceability schemes frameproof codes prove following theorem relating traceability schemes frameproof codes theorem 23 exists ctsk b v exists cfpcv b proof let x b set system corresponding ctsk b v prove x b cfpcv b suppose exist c blocks b block contradicts theorem 22 letting 24 hamming distance 2frameproof codes investigate properties hamming distance cframeproof codes v bcode let dx denote hamming distance two codewords x denote theorem 24 v bcode gamma 2frameproof proof let w w j w h three distinct codewords without loss generality assume ufw w j first r bits w w j dw w j hamming distance metric case least one bit position within first r bit positions w h different w w j condition code 2frameproof stated proof theorem 21 following result immediate corollary previous lemma corollary 25 v bcode gamma 2frameproof give example illustrate application corollary 6 simple explicit construction given q q prime power q hence q 81 see fact verified computer codes produced construction odd prime powers q 31 q 79 applying corollary 25 obtain following result theorem 26 odd prime power q 31 exists 2fpcq q 3 constructions combinatorial structures section give constructions frameproof codes traceability schemes certain combinatorial designs including tdesigns packing designs orthogonal arrays results design theory require found standard references crc handbook combinatorial designs 9 31 constructions using tdesigns first give definition tdesign definition 31 tv k design set system x b b every tsubset x occurs exactly blocks b note simple counting number blocks tv k 1 design use tv k 1 designs construct frameproof codes traceability schemes described following theorems theorem 31 exists tv k 1 design exists cfpcv proof denote distinct blocks let g exists since tdesign hence b 2 bnfb g b 6 tdesign set system satisfying conditions theorem 21 conclusion follows similarly construct traceability schemes tv k 1 designs value c obtained smaller however theorem 32 exists tv k 1 design exists ctsk proof suppose exists tv k 1 design x b let c distinct blocks g f exists b c r hand since hence follows shows tdesign set system satisfying conditions theorem 22 conclusion follows many known results existence construction tv k 1 designs 3 hand known exist 6 however known infinite classes 2 3designs provide nice infinite classes frameproof codes traceability schemes illustrate samples typical results obtained first 3 k 5 2v k 1 design exists v j 1 k mod 9 chapter i2 hence obtain following theorem 33 exist frameproof codes follows 1 exists 2fpcv vv gamma 16 v j 2 exists 3fpcv 3 exists 4fpcv similarly following theorem existence 2traceability schemes note get c 2 theorem 32 need k 5 theorem 34 exists 2ts5 vv gamma 120 v v j design known projective plane order q design exists whenever q prime power see 9 chapter vi7 projective plane frameproof codes obtained interesting view example 11 better however traceability schemes interest theorem 35 exists b p qctsq 1 prime powers q example 13 fact obtained case theorem 35 give another class examples derived 3q 2 1 q 1 1 designs designs called inversive planes exist q prime power see 9 chapter vi7 theorem 36 prime power q exists 32 constructions using packing designs another type combinatorial design used construct frameproof codes traceability schemes packing designs give definition follows definition 32 tv k packing design set system x b every b 2 b every tsubset x occurs blocks b using argument proof theorem 31 following construction frameproof codes theorem 37 exists tv k 1 packing design b blocks exists cfpcv b similarly following construction traceability schemes using argument proof theorem 32 theorem 38 exists tv k 1 packing design b blocks exists ctsk b v mentioned previously tv k 1 designs known exist v however infinite classes packing designs large number blocks ie close obtained designs known orthogonal arrays defined follows definition 33 orthogonal array oat k k theta array entries set 2 symbols rows every theta 1 column vector appears exactly easy obtain packing orthogonal array shown next lemma lemma 39 oat k tks k 1 packing design contains blocks proof suppose oat k entries set f0 1g every column orthogonal array define block consist blocks thus constructed easy check x b tks k 1 packing design following lemma 9 chapter vi7 provides infinite classes orthogonal arrays integer lemma 310 q prime power q exists oat q hence packing design q blocks exists theorem 37 lemma 310 obtain following theorem 311 prime power q integer q exists construction b 2 2c frameproof codes b 2 traceability schemes also resulting traceability schemes transversal type considered 8 33 constructions using perfect hash families section present another method construct frameproof codes uses perfect hash family definition 34 n mwperfect hash family set functions f f ng f1 ng exists least one f 2 f f j x onetoone n mwperfect hash family denoted phfn n mw observe phfn n mw depicted n theta n matrix entries property w columns exists least one row w entries given w columns distinct results perfect hash families found numerous textbooks papers mehlhorn 12 good textbook source recent constructions found papers 2 3 following theorem tells us use perfect hash family enlarge frameproof code theorem 312 exists phfn n c 1 cfpcv exists cfpcnv n proof cfpcv let f phfn n c1 nv ncode consisting n codewords means concatenation strings show gamma 0 c fpcnvn g recall uw set undetectable bit positions w assume exists codeword u c1 f phfn n c 1 exists h 2 f hj c onetoone g thus c different codewords w 1 w hi c1 feasible set cg contradicts fact gamma cframeproof 4 following construction cframeproof codes errorcorrecting codes given theorem 313 exists cfpcv q n n qary code minimum hamming distance min exists cfpcvn n alon 1 gave construction perfect hash families errorcorrecting codes observe use perfect hash family constructed alons method obtain c frameproof code applying theorem 312 resulting code essentially one constructed using theorem 313 however possible use constructions perfect hash families obtain new examples frameproof codes provide one illustration uses following recursive construction 3 lemma 314 suppose exists phfn 1 exists phf integer j 1 example 31 exists phf2 5 4 3 follows theorem 315 integer j 1 exists 2fpc6 theta 4 proof lemma 314 example 31 obtain phf2 theta 4 combine perfect hash family 2fpc3 4 given example 12 apply theorem 312 4 embeddings many cases number users scheme increase system set initially data supplier constuct scheme accommodate fixed number users denoted b number users eventually surpasses b would like simple method extending scheme compatible existing scheme case traceability scheme want change personal keys already issued scheme expanded case frameproof code want recall software already sold solve problem introduce concept embedding frameproof codes traceability schemes larger ones definition 41 let gamma cfpcv b let gamma 0 cfpcv suppose every codeword w 2 gamma exists codeword w first bit positions w 0 w remaining v positions w 0 0s say gamma embedded initially distributor could use code gamma mark products number users surpasses b codewords gamma 0 ngamma used note embedding property ensures codewords gamma changed proceed larger code similar definition given traceability schemes definition 42 let set v base keys ctsk b v let 0 set v 0 base keys ctsk b suppose every personal key ctsk b v also personal key ctsk b say first scheme embedded second scheme note definition embedding even simpler consider set system formulation frameproof codes traceability schemes namely say x b embedded since tdesigns packing designs set systems definition embedding applies fact embeddings combinatorial designs extensively studied convenient method constructing embeddible frameproof codes traceability schemes example case 2designs following result theorem 41 exists 2v k 1 design embedded 2v design exists embedded xip embedded xip give couple illustrations idea necessary sufficient conditions embedding 2v k 1 designs 2v designs known namely v j result known doyenwilson theorem 9 chapter i4 iii1 provides convenient way embedding 2 3frameproof codes larger ones application theorem 41 following theorems obtained theorem 42 v j 6 v 0 2v1 exists 2fpcv v embedded 2fpcv theorem 43 v j exists 3fpcv v embedded 2fpcv small example illustrate example 41 given embedding 27 3 1 design 215 3 1 design 2 fpc7 7 embedded 2fpc15 35 35 codewords 2fpc15 35 given figure 1 first seven codewords restricted first seven bit positions form embedded 2fpc7 7 1101000 00000000 1000000 00110000 0100000 00011000 1000000 00001010 0100000 10000100 0001000 10100000 1000000 01000100 0010000 10010000 0001000 01001000 1000000 10000001 figure 1 2fpc7 7 embedded 2fpc15 35 also wellknown prime power q integers j exists embedded 2q j q 1 design words affine geometry agi q subgeometry agj q see 9 chapter vi7 following result obtained theorem 44 let q prime power let j positive integers j exists embedded embedded 5 bounds section investigate necessary conditions existence frameproof codes traceability schemes take form upper bounds b function c v k case traceability schemes first give bound frameproof codes c fpcv b recall uc denotes set undetectable bit positions subset denotes feasible set c 1 c let begin stating proving simple lemma lemma 51 suppose cfpcv b suppose defined proof suppose g clearly uc uc 0 however since contradicts definition 11 next result provides upper bound b depends cgamma1 theorem 52 suppose cfpcv b suppose defined l cgamma1m proof let w gamma chosen jw codeword w 2 gammanw let r easy see r r contradicts fact gamma cframeproof words subsets r constructed form sperner family respect ground set r sperners theorem see example 11 theorem 63 see dt 1 result follows following bound b immediate corollary corollary 53 gamma cfpcv b proof lemma 51 2 conclusion follows theorem 52 recall example 11 gave construction cfpcc c constructed fpc3 example 12 examples bound corollary 53 met equality turn attention traceability schemes provide upper bound b 8 shown b v kc ctck v b exists give stronger bound also based following observation made 8 lemma 54 suppose x b ctck v b subset c blocks exist block b 2 bnfb b proof proof essentially proof theorem 23 obvious reasons collection subsets b called ccoverfree applying 10 proposition 21 gives upper bound cardinality ccoverfree collection sets following result immediate theorem 55 ctsk b v exists following bound holds c e 6 comments results frameproof codes found phd thesis yeow meng chee 7 chapter 9 chee gives probabilistic construction 2frameproof codes improves upon results 4 provides efficient explicit constructions frameproof codes using idea superimposed codes acknowledgements thank referee several helpful comments authors research supported nsf grant ccr9402141 r explicit construction exponential sized family kindependent sets recursive constructions perfect hash families electronic marking identification techniques discourage document copying class constant weight codes crc handbook combinatorial designs course combinatorics data structures algorithms share secret tr ctr sylvia encheva grard cohen frameproof codes limited coalitions pirates theoretical computer science v273 n12 p295304 february 2002 omer berkman michal parnas jii sgall efficient dynamic traitor tracing proceedings eleventh annual acmsiam symposium discrete algorithms p586595 january 0911 2000 san francisco california united states yan zhu wei zou xinshan zhu collusion secure convolutional fingerprinting information codes proceedings 2006 acm symposium information computer communications security march 2124 2006 taipei taiwan j lfvenberg binary fingerprinting codes designs codes cryptography v36 n1 p6981 july 2005 maura paterson slidingwindow dynamic frameproof codes designs codes cryptography v42 n2 p195212 february 2007 alexander barg gregory kabatiansky class ipp codes efficient identification journal complexity v20 n23 p137147 apriljune 2004 tran van trung sosina martirosyan class traceability codes designs codes cryptography v31 n2 p125132 february 2004 g cohnen encheva litsyn h g schaathun intersecting codes separating codes discrete applied mathematics v128 n1 p7583 15 may wenguey tzeng zhijia tzeng publickey traitor tracing scheme revocation using dynamic shares designs codes cryptography v35 n1 p4761 april 2005 satoshi obana kaoru kurosawa bounds combinatorial structure yevgeniy dodis nelly fazio aggelos kiayias moti yung scalable publickey tracing revoking proceedings twentysecond annual symposium principles distributed computing p190199 july 1316 2003 boston massachusetts tran van trung sosina martirosyan new constructions ipp codes designs codes cryptography v35 n2 p227239 may 2005 yevgeniy dodis nelly fazio aggelos kiayias moti yung scalable publickey tracing revoking distributed computing v17 n4 p323347 may 2005 x r wei bound coverfree families designs codes cryptography v32 n13 p303321 mayjuly 2004 dan boneh brent waters fully collusion resistant broadcast trace revoke system proceedings 13th acm conference computer communications security october 30november 03 2006 alexandria virginia usa dan boneh brent waters fully collusion resistant broadcast trace revoke system proceedings 13th acm conference computer communications security october 30november 03 2006 alexandria virginia usa carlo blundo paolo darco alfredo de santis massimiliano listo design selfhealing key distribution schemes designs codes cryptography v32 n13 p1544 mayjuly 2004 stelvio cimato antonella cresti paolo darco unified model unconditionally secure key distribution journal computer security v14 n1 p4564 january 2006 charles j colbourn multiple access communications using combinatorial designs theoretical aspects computer science advanced lectures springerverlag new york inc new york ny 2002