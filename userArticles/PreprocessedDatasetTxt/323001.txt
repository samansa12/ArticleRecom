matching hierarchical structures using association graphs abstractit wellknown problem matching two relational structures posed equivalent problem finding maximal clique derived association graph however clear apply approach computer vision problems graphs hierarchically organized ie trees since maximal cliques constrained preserve partial order provide solution problem matching two trees constructing association graph using graphtheoretic concept connectivity prove new formulation onetoone correspondence maximal cliques maximal subtree isomorphisms allows us cast tree matching problem indefinite quadratic program using motzkinstraus theorem use replicator dynamical systems developed theoretical biology solve continuous solutions discrete problems attractive motivate analog biological implementations framework also extended matching attributed trees using weighted association graphs illustrate power approach matching articulated deformed shapes described shock trees b jcj denotes cardinality c consider following quadratic function aij adjacency matrix g ie n n symmetric matrix defined 0 otherwise point x 2 sn said global maximizer f sn fxfx x 2 sn said local maximizer exists 0 fxfx x 2 sn whose distance x less fxfx pelillo et al matching hierarchical structures using association graphs 1109 implies x x x said strict local maximizer note fx1 x 2 sn motzkinstraus theorem 40 establishes remarkable connection global local maximizers function f sn maximum maximal cliques g specifically states subset vertices c graph g maximum clique characteristic vector xc global maximizer f sn similar relationship holds strict local maximizers maximal cliques 19 50 result intriguing computational significance allows us shift discrete continuous domain reformulation attractive several reasons suggests exploit full arsenal continuous optimization techniques thereby leading development new algorithms may also reveal unexpected theoretical properties additionally continuous optimization methods often described terms sets differential equations therefore potentially implementable analog circuitry motzkin straus theorem served basis several clique finding procedures 10 18 45 46 also used determine theoretical bounds cardinality maximum clique 45 64 one drawback associated original motzkin straus formulation relates existence spurious solutions ie maximizers f form characteristic vectors observed empirically pardalos phillips 45 recently formalized pelillo jagota 50 principle spurious solutions represent problem since providing information cardinality maximum clique allow us easily extract vertices fortunately solution problem recently introduced studied bomze 7 consider following regularized version ffxx0ax x0x 2which obtained 1 substituting adjacency matrix g witha inwhere n n identity matrix following spuriousfree counterpart original motzkinstraus theorem see 7 proof theorem 2 let c subset vertices graph g let xc characteristic vector following statements hold 1 c maximum clique g xc global maximizer function f sn case 2 c maximal clique g xc local maximizer f sn 3 local hence global maximizers f sn strict unlike original motzkinstraus formulation previous result guarantees maximizers f sn strict characteristic vectors maximal maximum cliques graph formal sense therefore onetoone correspondence exists maximal cliques local maximizers f sn one hand maximum cliques global maximizers hand turn attention class dynamical systems use solving quadratic optimization problem let w nonnegative realvalued n n matrix consider following dynamical system dot signifies derivative wrt time discretetime counterpart readily seen simplex sn invariant dynamics means every trajectory starting sn remain sn future times moreover turns stationary points ie points satisfying xit0 3 xit 1xit 4 coincide solutions equations stationary point x said asymptotically stable every solution 3 4 starts close enough x converges x 1 3 4 called replicator equations theoretical biology since used model evolution time relative frequencies interacting selfreplicating entities 23 discretetime dynamical equations turn special case general class dynamical systems introduced baum eagon 5 context theory markov chains also represent instance original rosenfeldhummel zucker relaxation labeling algorithm 56 whose dynamical properties recently clarified 47 specifically corresponds 1object nlabel case interested dynamical properties replicator equations properties allow us solve original tree matching problem theorem 3 w w0 function xt0wxt strictly increasing increasing along nonstationary trajectory xt continuoustime 3 discretetime 4 replicator dynamics furthermore trajectory converges stationary point finally vector x 2 sn asymptotically stable 3 4 x strict local maximizer x0wx sn previous result known mathematical biology fundamental theorem natural selection 13 23 63 original form traces back fisher 15 far discretetime model concerned regarded straightforward implication general baum eagon theorem 5 fact trajectories replicator dynamics converge stationary point proven recently 33 35 fig 4 coloring shocks four types 28 1shock derives protrusion traces curve segment adjacent 1shocks along radius function varies monotonically 2shock arises neck radius function attains strict local minimum immediately followed two 1shocks flowing away opposite directions 3shocks correspond annihilation curve segment due bend along radius function constant 4shock annihilation point seed radius function attains strict local maximum loci shocks gives blums medial axis light dynamical properties replicator equations naturally suggest simple heuristic solving maximal subtree isomorphism problem let two rooted trees let denote nnode adjacency matrix corresponding tag lettingw inwhere n n identity matrix know replicator dynamical systems 3 4 starting arbitrary initial state iteratively maximize function f defined 2 sn eventually converge probability 1 strict local maximizer virtue theorem 2 correspond characteristic vector maximal clique association graph stated theorem 1 turn induce maximal subtree isomorphism clearly theory guarantee converged solution global maximizer f therefore induce maximum isomorphism two original trees previous experimental work done maximum clique problem 10 46 also results presented paper however suggest basins attraction optimal nearoptimal solutions quite large frequently algorithm converges one despite inherent inability escape local optima since process cannot leave boundary snitis customary start relaxation process interior point common choice barycenter sn ie vector 1 prevents search initially biased favor particular solution 5an examplematching shock trees illustrate framework matching hierarchical structures numerical examples shape matching subtleties associated generating random trees relevance applications computer vision pattern recognition use class example trees derived real system representation shape based abstraction shocks singularities curve evolution process acting simple closed curve plane shock tree begin providing background representation details see 28 62 present experimental results matching shock trees section 6 extend framework incorporate attributes associated shock tree nodes 51 shock tree 27 28 following evolution equation proposed visual shape analysis cpt vector curve coordinates npt inward normal p curve parameter evolutionary time deformation constant 0 controls regularizing effects curvature large equation becomes geometric heat equation 0 equation hyperbolic shocks 30 entropysatisfying singularities form latter case locus points shocks migrate related blums grassfire transformation 12 28 although significantly information available via coloring positions four types arise according local variation radius function along medial axis fig 4 intuitively radius function varies monotonically type 1 reaches strict local minimum type 2 constant type 3 reaches strict local maximum type 4 classification shock positions according colors enumeration possible local neighborhoods around shock type heart representation shocks type form connected component grouped together comprise nodes shock graph 1shock groups separated branchpoints skeleton directed edges graph pelillo et al matching hierarchical structures using association graphs 1111 fig 5 two illustrative examples shocks obtained curve evolution 62 left notation associated locus shock points form shocktypeidentifier right corresponding trees shocktype node identifier adjacent last shocks form curve evolution process appear root node labeled placed shock groups touch one another parent node contains shocks formed prior shocks child node corresponds reversal time curve evolution process obtain hierarchy connected components graph rooted unique vertex children last shock groups form eg palms hand silhouettes fig 5 letters b denote different sides shock group key property shock graph topological structure highly constrained events govern birth combination death shock groups completely characterized shock grammar small number rewrite rules 62 particular shock graph reduced unique rooted shock tree 52 experimental results illustrate power hierarchical structure matching algorithm shock trees whereas node geometric attributes related properties shocks group shall consider shock tree topologies shall consider geometry shortly selected 25 silhouettes representing eight different object classes table 1 first column tool shapes taken rutgers tools database shape matched entries database fig 6 shows maximal subtree isomorphisms found algorithm three examples top eight matches query shape along associated scores shown table 1 scores indicate average nn1 nn2 n size maximal clique found n1 number nodes tree observed 1112 ieee transactions pattern analysis machine intelligence vol 21 11 november 1999 tabulation top eight topological matches query scores indicate average fraction nodes matched two trees see text note topology shock trees used addition geometric information permits finer discrimination compare table 2 experiments maximal cliques found also maximum cliques due property global maximizers objective function typically large basins attraction also shown experimentally 46 49 10 matching algorithm generally takes two three seconds converge sparc 10 note despite fact metriclabel information associated nodes shock trees discounted altogether exemplars class query shape typically within top five matches illustrating potential topological matching process indexing database shapes nevertheless exist matches appear counterintuitive eg matches row 1 column 3 row 2 column 3 row 13 column row 14 column 4 row 21 column 2 row 21 column 3 correspond shapes similar shock tree topologies hierarchies parts drastically different shock geometries part shapes following section extend framework incorporate latter geometric information contained shock sequence location time formation speed direction shock attributes nodes show leads better discrimination shapes provided shock tree topologies alone pelillo et al matching hierarchical structures using association graphs 1113 fig 6 maximal subtree isomorphisms found three illustrative examples shockbased descriptions hand silhouettes shown fig 5 shocktrees silhouettes computed similar fashion 6attributed tree matching weighted tags many computer vision pattern recognition applica tions trees matched nodes associated vector symbolic andor numeric attributes section show proposed framework naturally extended solving attributed tree matching problems 61 attributed tree matching weighted clique search formally attributed tree triple underlying rooted tree function assigns attribute vector u node u clear matching two attributed trees objective find isomorphism pairs nodes similar attributes end let similarity measure attribute space ie symmetric function assigns positive number pair attribute vectors h1 h2 subtree isomorphism two attributed trees v2e22 overall similarity induced subtrees t1h1 t2h2 defined follows isomorphism called maximal similarity subtree isomorphism subtree isomorphism h20 h1 strict subset h10 s0 called maximum similarity subtree isomorphism largest among subtree isomorphisms weighted tag two attributed trees t1 t2 weighted graph g v e defined definition 2 function assigns positive weight node u v2v v1 v2 follows given subset nodes c v total weight assigned c simply sum weights associated nodes maximal weight clique g one contained clique larger total weight maximum weight clique clique largest total weight maximum weight clique problem find maximum weight clique g 9 note unweighted version maximum clique problem arises special case nodes assigned constant weight following result weighted counterpart theorem 1 establishes onetoone correspondence attributed tree matching problem maximum weight clique problem proof essentially identical theorem 1 theorem 4 maximal maximum similarity subtree isomorphism two attributed trees induces maximal weight clique corresponding weighted tag vice versa 62 matching attributed trees recently motzkinstraus formulation maximum clique problem extended weighted case 19 let g arbitrary weighted graph order n weighted characteristic vector subset nodes denoted xc defined follows c uic ui 2 c c uj2c uj total weight c consider following class n n symmetric matrices 1114 ieee transactions pattern analysis machine intelligence vol 21 11 november 1999 quadratic function 2mg following theorem weighted counterpart theorem 2 expands recent result gibbons et al 19 turn generalizes motzkinstraus theorem weighted case see 8 11 proof theorem 5 let g arbitrary weighted graph let b 2mg following hold 1 vector x 2 sn local minimizer g sn x xc c maximal weight clique g 2 vector x 2 sn global minimizer g sn x xc c maximum weight clique g 3 local hence global minimizers g sn strict contrast gibbons et al formulation 19 plagued presence spurious solutions original motzkinstraus problem 11 previous result guarantees minimizers g sn strict characteristic vectors maximalmaximum weight cliques graph note class mg isomorphic positive orthant n jej dimensions jej thenumber edges g class polyhedral pointed cone apex given following matrix one used experiments described 21ui j formulated maximum weight clique problem quadratic program standard simplex use replicator equations approximately solve however note replicator equations maximization procedures minimization problem straightforward see problem minimizing quadratic form x0bx simplex equivalent maximizing x0ee0 bx arbitrary constant1 two attributed trees g corresponding weighted tag define b bij matrix class mg maxbij fundamental theorem natural 1 note conversion minimization problem maximization problem driven purely algorithmic opposed issue one could minimize x0bx simplex using alternative optimization techniques 29 53 however since matching trees graphs expect difference performance marginal selection theorem 3 know replicator dynamical systems 3 4 find local maximizers function x0wx hence minimizers x0bx standard simplex virtue theorem 5 correspond characteristic vectors maximal weight cliques weighted tag stated theorem 4 turn induce maximal similarity subtree isomorphisms unweighted case theoretical guarantee solutions found globally optimal ones experiments reported 11 maximum weight clique problem suggest attraction basins global maximizers quite large observation also confirmed experiments reported typically took 5 10 seconds run sparc 10 63 experimental results provide examples weighted shock tree match ing using geometric attributes associated shock tree nodes vector attributes assigned node attributed shock tree given number shocks group xiyirivii respectively x coordinate coordinate radius time formation speed direction shock sequence obtained outputs shock detection process 60 61 order apply frame work must define similarity measure attributes two nodes u v similarity measure use linear combination four terms incorporating differences lengths radii velocities curvature two shock sequences respectively term normalized provide unitless quantity different geometric properties combined let u contain shocks v contain n shocks without loss generality assume n euclidean length sequence shocks given xn1 q dine manytoone mapping index 2f1 mg index j 2f1 ng similarity measure two attribute vectors used experiments defined pelillo et al matching hierarchical structures using association graphs 1115 different problems maximal clique formulation invokes much weaker constraints 4 1 xm riri 212 present extension maximal clique formulation r case manytoone correspondences i1 particular interest computer vision pattern recogni tion applications trees matched noisy v vertices deleted added 21 i1 developed formal approach matching hierarchical structures constructing association graph whose maximal cliques onetoone correspondence lrv nonnegative constants summing 1 maximal subtree isomorphisms framework change orientation shock general applied variety computer vision measure provides number 0 1 pattern recognition domains demonstrated represents overall similarity geometric potential shape matching formulation allows us attributes two nodes compared measure cast treematching problem indefinite quadratic designed invariant rotations translations program owing motzkinstraus theorem solu two shapes satisfy requirements weight tion found using dynamical system makes function discussed section 61 amenable hardware implementation offers repeated earlier experiments advantage biological plausibility particular weights wu vuv placed node uv relaxation equations related putative neuronal weighted tag weights defined 9 implementations 38 39 also extended lrv set 025 04 02 015 respectively framework problem matching hierarchical struc verified overall results sensitive tures attributes attributes result weights precise choice parameters slight variations placed nodes association graph similarity measure use different norm conversion maximum clique problem maximum ranked results using score given quantity weight clique problem extension proposed size framework problems involving manytoone correspondences presented 4 maximal weight clique found w weight m1 m2 characterizing complexity approach appears total mass associated nodes tree difficult since involves simulation dynamical mumv masses nodes u v respectively system however observed experimentally score represents weight maximal clique scaled basins attraction global maximizers large average total relative mass nodes tree unweighted weighted cases participates match top eight system converges quickly applied shocktree matches shown query shape table 2 matching conversely whereas polynomial time algorithms evident almost queries performance improves exist maximum common subtree problem 37 54 incorporation geometric attributes better 17 knowledge algorithm exists case overall discrimination shapes compare weighted tree matching provides justifica table 1 nonetheless inherent tradeoff tion framework geometry topology eg observe short fat screwdriver row 15 scores better fatter hand appendix shapes thin elongated screwdrivers note qualitative results specifically partial ordering matches row table 2 compare presenting proof lemma 1 need favorably obtained using alternate approach preliminary remarks definitions first note path described 62 latter approach applied strings cannot arbitrary strings 1s 1s since successfully database shapes used trees cycles fact go one level sequential level level approach backtracking along path ie make 1 move cannot return step eigenvalue labeling adjacency matrix parent formally stated saying subtrees rooted two nodes matched used stru vs1s2 sn pathstring two words cost matching two nodes incorporates nodes u v si 1 implies sj 1 j geometries measure similarity define pathpair two nodes u v subtrees global furthermore tree pairu vn p n number algorithm tolerates noise allowing jumps negative components stru v p number levels hence strictly speaking solves approximation positive components stru v clear previous subtree isomorphism problem reasons one observation pathpairs pathstrings equivalent toone comparison two algorithms concepts fact struvstrw z tabulation top eight attributed toplogical matches query scores indicate weight maximal clique multiplied average total relative mass nodes tree matched see text addition geometric information permits finer discrimination shapes compare table 1 note node w path two nodes u v rooted tree stru v obtained concatenating stru w strw v implies denotes usual sum vectors sense pathpairs allow us arithmetic path strings fact technically useful sequel full algebraic structure needed position prove lemma 1 convenience repeat statement lemma 1 let u1v1w1z1 2 v1 u2v2w2z2 2 v2 distinct nodes rooted trees v2e2 suppose following conditions hold 1 w1 u1v1path w2 u2v2path 2 stru1w1stru2w2 3 strw1v1strw2v2 4 stru1z1stru2z2 5 strv1z1strv2z2 strw1z1strw2z2 pelillo et al matching hierarchical structures using association graphs 1117 fig 7 illustration cases arising proof lemma 1 proof first note conditions 13 also 6 stru1v1stru2v2 shall prove pairw1z1pairw2z2 course equivalent thesis lemma proof consists enumerating possible cases exploiting previous observation w uvpath pairu vpairu wpairw v however need auxiliary notation let u node rooted tree set nodes belonging subtree rooted u denoted u formally defined follows note shall enumerate possible ways u1 v1 w1 z1 relate one another t1 clear conditions 16 configuration induces perfectly symmetric situation t2 vice versa therefore shall use index simplify discussion technically means assuming something one tree hypotheses situation arises enumeration possible cases starts observation given two different subtrees tree either one strict subset disjoint otherwise fact cycles graph therefore considering subtrees rooted nodes ui vi following cases arise 1 v viv ui 2 v uiv vi 3 v uiv vi first two symmetric therefore shall consider case 1 case since wi uivi path v viv 2 clearly four subcases possible cf fig 7a 11 12 13 2 let us consider case 11 case vis wizipaths therefore case 12 wis uizipaths hence pairuizipairuiwipairwizi 2 therefore case 13 similar case 12 case wi zivipath therefore finally case 14 similar case 11 since ui path joining wi zi let us consider case 3 ie v uiv vi situation slightly compli cated since wi uivipath form following three subcases 31 32 v viv wi v wiv ui 33 v viv wi v uiv wi cases 31 32 symmetric shall consider cases 31 33 let us start case 31 four possible subcases arise fig 311 312 313 zi2v wi zi 2 v vi314 cases similar previous ones corresponding proofs therefore analogous finally let us consider case 33 four possible subcases arise fig 7c 331 332 333 334 334 similar seen hence omit corresponding proofs case 333 note wi must necessarily either path joining ui zi joining vi zi otherwise graph would cycle proof case analogous previous ones concludes proof lemma tu acknowledgments work done marcello pelillo visiting center computational vision control yale university supported consiglio nazionale delle ricerche italy nserc fcar nsf afosr thank reviewers helpful comments sven dickinson use shapes rutgers tools database r computer vision introduction population genetics theory genetical theory natural selection computer intractability guide graph theory theory evolution dynamical systems tr ctr karsten hartelius jens michael carstensen bayesian grid matching ieee transactions pattern analysis machine intelligence v25 n2 p162173 february brijnesh j jain fritz wysotzki automorphism partitioning neural networks neural processing letters v17 n2 p205215 april philip n klein thomas b sebastian benjamin b kimia shape matching using editdistance implementation proceedings twelfth annual acmsiam symposium discrete algorithms p781790 january 0709 2001 washington dc united states gunilla borgefors giuliana ramella gabriella sanniti di baja hierarchical decomposition multiscale skeletons ieee transactions pattern analysis machine intelligence v23 n11 p12961312 november 2001 andrea torsello edwin r hancock computing approximate tree edit distance using relaxation labeling pattern recognition letters v24 n8 p10891097 may graphical models graph matching approximate models optimal algorithms pattern recognition letters v26 n3 p339346 february 2005 marco carcassoni edwin r hancock correspondence matching modal clusters ieee transactions pattern analysis machine intelligence v25 n12 p16091615 december horst bunke simon gnter weighted mean pair graphs computing v67 n3 p209224 november 2001 alessio massaro marcello pelillo matching graphs pivoting pattern recognition letters v24 n8 p10991106 may evgeny b krissinel kim henrick common subgraph isomorphism detection backtracking search softwarepractice experience v34 n6 p591607 may 2004 simon gnter horst bunke selforganizing map clustering graph domain pattern recognition letters v23 n4 p405417 february 2002 chris ding xiaofeng hanchuan peng finding cliques protein interaction networks via transitive closure weighted graph proceedings 5th international workshop bioinformatics august 2121 2005 chicago illinois dmitriy bespalov ali shokoufandeh william c regli wei sun scalespace representation 3d models topological matching proceedings eighth acm symposium solid modeling applications june 1620 2003 seattle washington usa andrea torsello dzena hidovicrowe marcello pelillo polynomialtime metrics attributed trees ieee transactions pattern analysis machine intelligence v27 n7 p10871099 july 2005 tabbone l wendling jp salmon new shape descriptor defined radon transform computer vision image understanding v102 n1 p4251 april 2006 marcello pelillo matching free trees maximal cliques monotone game dynamics ieee transactions pattern analysis machine intelligence v24 n11 p15351541 november 2002 duck hoon kim il dong yun sang uk lee comparative study attributed relational gra matching algorithms perceptual 3d shape descriptor mpeg7 proceedings 12th annual acm international conference multimedia october 1016 2004 new york ny usa jiang andreas munger horst bunke median graphs properties algorithms applications ieee transactions pattern analysis machine intelligence v23 n10 p11441151 october 2001 josep llados enric mart juan jose villanueva symbol recognition errortolerant subgraph matching region adjacency graphs ieee transactions pattern analysis machine intelligence v23 n10 p11371143 october 2001 davi geiger tyngluh liu robert v kohn representation selfsimilarity shapes ieee transactions pattern analysis machine intelligence v25 n1 p8699 january michel neuhaus horst bunke edit distancebased kernel functions structural pattern classification pattern recognition v39 n10 p18521863 october 2006 peter j giblin benjamin b kimia intrinsic reconstruction shape symmetries ieee transactions pattern analysis machine intelligence v25 n7 p895911 july andrea torsello edwin r hancock skeletal measure 2d shape similarity computer vision image understanding v95 n1 p129 july 2004 fatih demirci ali shokoufandeh yakov keselman lars bretzner sven dickinson object recognition manytomany feature matching international journal computer vision v69 n2 p203222 august 2006 luca lombardi alfredo petrosino distributed recursive learning shape recognition multiscale trees image vision computing v25 n2 p240247 february 2007 thomas b sebastian philip n klein benjamin b kimia recognition shapes editing shock graphs ieee transactions pattern analysis machine intelligence v26 n5 p550571 may 2004 bin luo edwin r hancock structural graph matching using em algorithm singular value decomposition ieee transactions pattern analysis machine intelligence v23 n10 p11201136 october 2001 andrea torsello antonio robleskelly edwin r hancock discovering shape classes using tree editdistance pairwise clustering international journal computer vision v72 n3 p259285 may 2007 thomas b sebastian benjamin b kimia curves vs skeletons object recognition signal processing v85 n2 p247263 february 2005 arjan kuijper ole fogh olsen peter giblin mads nielsen alternative 2d shape representations using symmetry set journal mathematical imaging vision v26 n12 p127147 november 2006 ali shokoufandeh diego macrini sven dickinson kaleem siddiqi steven w zucker indexing hierarchical structures using graph spectra ieee transactions pattern analysis machine intelligence v27 n7 p11251140 july 2005 ali shokoufandeh lars bretzner diego macrini fatih demirci clas jnsson sven dickinson representation matching categorical shape computer vision image understanding v103 n2 p139154 august 2006 stefano berretti alberto del bimbo enrico vicario efficient matching indexing graph models contentbased retrieval ieee transactions pattern analysis machine intelligence v23 n10 p10891105 october 2001 yakov keselman sven dickinson generic model abstraction examples ieee transactions pattern analysis machine intelligence v27 n7 p11411156 july 2005 brijnesh j jain fritz wysotzki central clustering attributed graphs machine learning v56 n13 p169207 marcello pelillo replicator equations maximal cliques graph isomorphism neural computation v11 n8 p19331955 november 1999 michal van wyk tariq durrani barend j van wyk rkhs interpolatorbased graph matching algorithm ieee transactions pattern analysis machine intelligence v24 n7 p988995 july 2002 marcello pelillo andrea torsello payoffmonotonic game dynamics maximum clique problem neural computation v18 n5 p12151258 may 2006