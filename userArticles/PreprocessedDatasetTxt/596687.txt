edge provisioning fairness vpndiffserv networks customers virtual private networks vpns differentiated services diffserv infrastructure likely demand security also guaranteed qualityofservice qos pursuance desire leasedlinelike services however expectedly unable unwilling predict load vpn endpoints paper proposes customers specify requirements range quantitative services service level agreements slas support services internet service providers isps would need automated provisioning system logically partition capacity edges various classes groups vpn connections manage efficiently allow resource sharing among groups dynamic fair manner edge provisioning certain amount resources based slas traffic contract edge allocated vpn connections also need provision interior nodes transit network meet assurances offered boundaries network therefore propose twolayered model provision vpndiffserv networks top layer responsible edge provisioning drives lower layer charge interior resource provisioning help bandwidth broker bb various algorithms examples analyses presented provision allocate resources dynamically edges vpn connections developed prototype bb performing required provisioning connection admission b introduction growing demand since private networks built using dedicated lines offer guaranteed bandwidth latency similar guarantees provided ip based virtual private networks vpns 9 14 internet designed deliver performance guar antees advent differentiated services 3 2 ip backbones provide various levels quality servicerecently proposed expedited forwarding ef 10 per hop behaviour phb recommended method build virtual leased line line vll type pointtopoint connection vpn provide service others example 1617 recently implemented 12 13 bandwidth broker 15 allows user specify single quantitative value ie 1 mbps 2 mbps etc based specification edge routers establish vpn connections dynamically however expected users unable unwilling predict load vpn endpoints 7 providers point view also guaranteeing exact quantitative service might difficult job beginning vpndiffserv deployment 2 therefore propose users specify requirements range quantitative service example user wants establish vpn stub networks b figure 1 sure whether needs 05 mbps 06 mbps 1 mbps knows lower upper bounds requirements approximately specify range 05 1 mbps requirement isp outsources service latter isp offer multiple options via website figure 6 help customers select suitable option activate services dynamically fly several advantages users need specify exact capacity gives flexibility specify range price customers pay higher one pays lower bound capacity lower normally needed paid upper bound capacity low load possible users might enjoy upper bound rate say 1 mbps example without paying anything extra kind pricing might attractive users isps take advantage attract customers without breaking commitment however poses significant challenge isps would need deploy automated provisioning system able logically partition capacity edges various classes groups group identified offer example 05 1 mbps could represent one group 12 mbps could represent another vpns manage efficiently allow resource sharing among groups dynamic fair manneralso must provision interior nodes network meet assurance offered boundaries network therefore proposed twolayered model section ii provision vpndiffserv networks top layer responsible edge provisioning drives lower layer charge interior resource provisioning help bandwidth broker bb restricted paper edge provisioning considering fact complexities lie boundaries network main driving force overall provisioning section iii various algorithms examples analysis presented provision allocate resources dynamically edges fairness issues allocating unused resources addressed section iiid prototype bb performing required provisioning connection admission described section iv section v concludes paper summary contributions discussion future research directions edge router 3 interior router 1 interior interior edge router 1 edge router 3 edge router 5 edge router 4 isp stub network customer customer stub network 1a network stub customer customer stub network c 1c fig 1 vpn diffserv deployment scenario ii provisioning requirements vpndiffserv networks model provisioning diffserv networks mean determination allocation resources necessary various points network also modification existing resources shared dynamically among various vpn classes ie groups quantitative case vpns qualitative traffic assured service required provisioned network boundaries network interior determination resources required node quantitative traffic needs estimation volume traffic traverse network node isp naturally knows sla amount vpn quantitative traffic enter transit network specific edge node volume cannot estimated exact accuracy various interior nodes traversed vpn connections know path connections 1 however routing topology known figure almost accurately estimated default path doesnt meet requirements incoming connection alternate various qos routing 6 5 also used find suitable path enforced mpls techniques 8 role bandwidth broker automated provisioning based basic needs provisioning vpndiffserv network support quantitative service consider provisioning two layered model top layer responsible edge provisioning driving bottom layer charge interior provisioning figure 2 seek provide system vpn services available demand find bandwidth broker 1517 right choice capable performing dynamic endtoend admission control setup leased line like vpn maintaining topology well policies states nodes network also capable managing provisioning network resources separately administered ds domain cooperating similar domains edge provisioning interior provisioning bandwidth broker cr cr cr er cr cr cr er fig 2 layered provisioning view vpndiffserv networks b novel bandwidth specified interval overcome users difficulty specifying exact amount quantitative bandwidth required outsourcing vpn service isp model supports flexible way express slas users specify range quantitative amounts rather single value although several advantages also makes edge interior provisioning difficult complexity explained simple ex ample referring figure 1 assume edge router 1 provisioned provide 20 mbps quantitative resources establish vpn connections elsewhere network isp provided two options via web interface vpn customers select rate connections dynamically 1 mbps 2 mbps easy see time 20 connections 1 mbps 10 connections enjoying 2 mbps even mixture two eg 5 connections connections 1 mbps new connection accepted active connection terminates maintaining network state simple doesnt cause either reductions forces renegotiations existing connections 20 connections 1 mbps one connection leaves simply 19 connections 1 mbps admission process equally simple isp provides new option example shown figure 6b users select range 1mbps 2 mbps 1 2 minimum maximum offered guaranteed bandwidth maintaining state admission control difficult detailed example found section iiibwhen 10 users connection would get maximum rate 2 mbps new connections start arriving rate existing connections would de crease example 20 connections rate would stage active connection terminates rate every single connection would expanded 1 mbps mbps simple case single resource group supporting range 1mbps2 mbps reality might several groups shown figure 6b cases renegotiation possible expansion existing connections admission control maintenance network states simple idea presented illustrated figure 3 traffic ef traffic c usermaxi c usermini useri useri vpn pipe vpn connection demand b fig 3 sla bandwidth specified interval c user mini c user mini group actual rate vpn connection c useri varies range never gets c user mini b c useri rate configured edge router policing rate traffic submitted rate higher rate marked best effort traffic dropped depending policy c model notations model address novel approach sla provide policies algorithms automated resource provisioning admission control however support provisioning first start allocating certain percentage resources node edge interior accommodate quantitative traffic edge quantitative portion logically divided dedicated vpn tunnels ie require 1mbps 2 mbps explicitly connections wish rates defined range ie 051 mbps 12 mbps etc top level bandwidth apportionment shown figure 4 notations ffl ct total capacity node interface ffl cded capacity allocated vpn connections requiring absolute dedicated service ffl cshared capacity apportioned vpn connections describe requirement range ffl c qual remaining capacity qualitative traffic ffl cquan capacity provisioned quantitative traffic equal cded cshared c quan c quan shared ded c qual z shared c qual c qual b b fig 4 top level bandwidth apportionment logical partitioning edge b logical partitioning interior edge cquan rate controlled policing shaping interior cquan indicates amount capacity allocated actually protected quantitative traffic need arises values different different nodes kind logical partitioning helpful capacity never wasted even portions resources allocated quantitative traffic used vpn connections unused capacity naturally goes qualitative portion enhances best effort qualitative service true edge interiors cshared shown figure 4 logically divided multiple groups group supports different range figure 5 might multiple groups group define following notations ffl c basei base capacity group shared vpn connections belonging group ffl c user mini isp offered minimum guaranteed bandwidth user vpn connection ffl c user maxi isp offered maximum guaranteed bandwidth user vpn connection ffl n sharedi current number shared vpn connections ffl c sharedi amount capacity currently used group ffl c useri actual rate active connections group equal c sharedi section 3 cshared unused total unused bandwidth shared service groups sharedunused c basei ded shared shared qual c00000000000000000001111111111111111111unused fig 5 microscopic view bandwidth apportionment edge numerous sharing policies apply shared service groups call shared service groups reality base capacity shared certain number vpn connections sharing policy might allow group share resources among connections also share groups vpn connections case unused capacity may also apply dedicated capacity priority given certain groups allocating unused resources actually fair sharing challenging problem address issues following sections developing provisioning mechanisms iii edge provisioning policies analysis algorithms based model described section ii various allocation policies could adopted isps ingress point allocate capacity dynamically maintain guarantee quality service various types incoming existing vpn connections multiple classes vpns supporting different bandwidth specifi cations suitable policies ffl policy capacity unused one group cannot used groups means multiple shared service groups one group whose resources exhausted supporting numerous connections doesnt borrow resources others even groups unused capacityalso none groups allowed use unused capacity dedicated service group ffl policy ii capacity unused one shared service group borrowed another shared service group however like previous pol icy supposed borrow dedicated service group ffl policy iii capacity unused dedicated service group borrowed tunnels shared service groups also groups share resources among section start vpn connection acceptance algorithms ingress point admission complexities lie complexities introduced need partition share resources support model policies presented analysis examples algorithms policy iii iii clarify detail vpn call acceptance ingress job admission control determine whether vpn connection request accepted rejected request accepted required resources must guaranteed group new vpn establishment request admitted least minimum bandwidth stated offer satisfied also retaining least minimum requirements existing users ie c user mini new vpn connection request accepted ensures admitted vpn connection always receive least minimum offered bandwidth c user mini group restricting number maximum connections join group much capacity accepted connection actually decided connection state group sharing policies going discuss next subsections b capacity allocation sharing among groups policy base capacity allocated group solely used vpn connections belonging group circumstance resources assigned one group borrowed others even capacity unused makes allocation simple edges also interior implementation point view simple since unused capacity used groups qualitative services mentioned earlier also enhanced vpn connection accepted system checks connection allocated maximum rate possible base capacity c basei enough assign existing connections maximum rate c user maxi otherwise base capacity shared among existing new vpn connec tion therefore express admission policy follows example 1 following example assume total link bandwidth mbps one shared user group also assume isp offers group c user base capacity c base1 allocated group 20 mbps mbps calls accepted long condition c user mini section iiia met number calls exceed c user mini new arriving call rejected example 21st call example accepted c user1 would been21 minimum bandwidth could longer guaranteed fore call rejected c capacity allocation sharing among groups policy ii capacity allocated group fully used vpn con nections capacity borrowed connections shared service groups needed however borrowed capacity must relinquished needed group capacity borrowed although borrowing deallocation adds complexity edge provisioning connections various groups ever better chances enjoying higher rates following present algorithms regarding vpn connection arrival termination possible expansion existing connections result termination connection shared service group c1 vpn connection arrival like previous case vpn connection arrival essentially involves checking availability resources used new con nection available allocating capacity incoming call even base capacity certain group allows new connection belonging group assign maximum isp offered rate ie c user maxi resource sharing among various groups might happen resources group borrowed groups leaving required resources ie cshared unused c user maxi case resource must relinquished appropriate groupss deallocation existing connections leads rearrangement capacity connections noted capacity relinquished way borrowed numerous ways unused capacity borrowed competing groups see sections iiic3 iiid sake simplicity group maximum excess bandwidth c release first next group enough base capacity support new connection max offered rate hi shared unused capacity also enough support new connection max offered rate see example 2 cshared unused c user maxi shared unused capacity borrowed capacity relinquished borrowers see example 3 else n relinquish c user maxi groups max excess bw rearrange bandwidth groups mentioned capacity borrowed one group others one group borrows resources natu rally base capacity less needed ie much one group borrow depends much unused resources available least equal maximum offered rate c user maxi amount allocated otherwise ie cshared unused c user maxi whole unused resource goes group question divided among connections group shared capacity equal exceeded base capacity hi unused capacity still support new connection rate capacity borrowed see example 4 cshared unused c user maxi unused capacity less max rate capacity shared existing new connection see example 5 else n cshared unused consider several numerical examples section clarify algorithms analysis presented following examples assume total link bandwidth mbps two shared users groups ie 2 group 1 c user c user c user prior vpn connection request group 1 group 1 c c user c user max1 also cshared unused greater c user max1 hence c prior vpn connection request group 1 example c greater c user mbps means group 1 hasnt used base bandwidth new connection maximum offered bandwidth 1 mbps however cshared unused time request arrival cshared gamma mbps indicates another group borrowed capacity group 1 group left least c user mbps request could assigned desired amount resource therefore option left relinquish 1 mbps group borrowed searching table find group 2 taken bandwidth therefore need deduct 1 mbps group 2 recompute individual share vpn connection c c shared2 gammac user max1 mbps obviously c mbps prior vpn connection request group 2 case one group used full allocated base capacity borrow resources group left spare capacity c total spared capacity cshared unused value greater c user max2 ie 2 mbps therefore new vpn connection request allocated maximum offered value ie 2 mbps even exceeding base capacity group 2 example 5 prior vpn connection request group 2 example depicts scenario one group already exceeded base capacity accommodate new connection request unused resource left groupshere even new call arrival group 2 borrowed mbps current capacity allocated group equally distributed among existing new arriving vpn connection therefore c mbps c2 vpn connection termination vpn connection terminates resources might released relevant group depending current rate every connection enjoying group rate less equal maximum offered rate capacity released groups current share result connections group increases equally capacity shared lower number connections however current rate every connection already equal maximum offered rate termination would trigger deduction c user maxi shared resource c sharedi connections already enjoying c user maxi rate change occurs existing connectionsthe algorithm stated follows see example 6 cshared unused cshared unused cshared unused cshared unused clarify vpn connection termination process consider similar examples presented previous section example connection termination group 1 c shared1 user 1 means capacity used group connection termination remain unchanged even termination new value c shared1 also 10 mbps vpn connection equally share capacity c shared1 capacity deducted group total unused shared capacity also remain unchanged example 7 vpn connection departure group 1 example c shared1 user states fact prior departure active vpn connections using maximum possible offered bandwidth c user 1 mbps total hence departure trigger deduction c user mbps total capacity used group prior departure capacity even deduction good enough satisfy active connections offering highest possible rate 1 mbps therefore c mbps vpn connection receive c shared1 termination process triggers deduction c user max1 capacity used group 1 unused shared capacity increase value cshared unused c3 vpn capacity expansion unused shared capacity left groups distributed among others priority given certain groups allocating unused capacity next section present various policies allocate unused dedicated capacity might apply well consider one case preference given needy groups need determined ratio c useri c user maxi order groups according ratio reordered groups first one lowest c useri c user maxi last one highest c useri c user maxi reordering done expansion algorithm starts allocating unused bandwidth first group next based availability resources stated shared unused shared cshared unused gamma n sharedi c user shared unused cshared unused cshared unused example 8 vpn connection termination group 2 termination vpn connection group 2 cshared unused mbps need resources groups capacity used partly fully find group 1 need resource since c user1 user max1 1 remains seen extent could use unused capac ity c shared1 c shared unused 11 greater c user max1 1 mbps therefore capacity group 1 expanded n shared1 c user mbps allocating existing connection c user remaining unused capacity reduced cshared unused gamma n shared1 c user mbps example 9 vpn connection departure group 2 unlike previous example group 1 needed use portion unused resources remaining capacity allocated existing group 1 vpn connections order enhance service c shared1 increased 10 212 mbps existing connection receive c shared1 12mbps fair allocation unused dedicated resources policy iii previous section discussed methods one shared service group borrow resources another similar group section discuss possibilities sharing unused dedicated resources among various shared service groups shared service groups allowed borrow resources unused dedicated resources define new term shared cded unused question allocate unused dedicated resources fairly among competing groups vpn tunnels want maximum bandwidth offered isp policy offer possible point shared shared quantity needed allocated maximum possible offered rates connections even allowing unused dedicated resources used shared service groups greater 0 need define fair set user throughput values ie c useri given set maximum offered loads c user maxi c shared words need divide extra capacity cded unused among needy groups fair manner however fair sharing extra resources trivial issue addressed others different network situations 20 11 18 19 proposals 11 favour sharing bottleneck capacity equally among users independent requirements others 20 18 advocate penalize users causing overloads share resources among vpn connections group equal sharing unused dedicated capacity help much groups connections already enjoying rates close c user maxi time also doesnt alleviate problem groups rates c user mini much less c user maxi fairness criterion 20 also doesnt fit would deprive heavy user groups gain share unused dedicated resources even enjoying rates much c user maxi case complicated fact penalizing heavy user groups cannot reduce current share might happen certain cases trying maximize rates lower user groups following sections discuss various fair sharing methods edges d1 allocation unused resources lower user groups first case first need order user groups based c user maxi values objective satisfy lower user groups first trying allocate maximum offered values higher user groups less chances acquire resources left dedicated service group rationale behind vpn users satisfied allocating higher user groups might bring little changes many cases sufficient extra resource available ordering leads service groups possible expand k groups vpn tunnels belonging group enjoy maximum offered band th group receives rest unused dedicated resource tunnels remain unchanged total enhanced shared capacity computed follows shared n sharedi c user maxi cded unused n sharedi c user computation helps us view c shared shared different groups however general case true k 2 cases shared c shared1 cded unused cded unused practice unused dedicated capacity process starts asking first group unused capacity enough satisfy vpn connections connection receives maximum value c user maxi queries second group wise whole amount capacity allocated first group divided among competing connections process continues long unused capacity positive figure assume situation 3 groups vpn connections capacity respective c user maxi also cshared mbps group 1 c 025 mbps group 2 c mbps c user mbps group 3 c mbps c user mbps prior availability cded unused 7 mbps groups already ordered applying algorithms see first two groups allocated maximum rates therefore expanded 15 theta 12 theta respectively rest unused capacity cded unused gamma mbps goes third group d2 allocation unused resources highest needy groups first much like process described difference groups ordered based needs apportionment mechanisms algorithms remain need determined ratio c useri c user maxi groups lower ratios get preference groups higher ratios therefore process starts feeding needy group continues long unused capacity previous section c user max3 c user max1 067 c user2 c user max2 083 clearly group 3 needy group cded unused mbps serve needy group 3 enhance service new c c user 067 previous examples group never chance grab portion unused bandwidth new policy allows improve service substantially d3 allocation unused resources based proportional needs although mechanism seems fair since allocates based groups need many cases several needy groups little differences needs cases apportionment might always fair unused dedicated resources exhausted trying feed first groups remain deprived get share section fore present way allocate unused resources based proportional need group need resource ie ratio c useri c user maxi receives portion unused resource proportional groups need therefore group receiving extra resource based proportional need expanded ded unused c shared excessi shared excess need group c shared excessi actually excess quantity needed offer connections group maximum value c user maxi therefore c shared example 12 let us consider example illustrate use proportional need ordering needed allocation extra capacity solely based proportional need group 1 c user1 c user max1 067 group 2 c user2 c user max2 group 3 c user3 c user max3 05application allocation policy expand capacity group 1 c 70515gamma5 connections improved new c c user max1 079 similarly group 2 c mbps c c user max2 089 group 3 c user 068 clearly shows proportional sharing fairly enhances rate needy group 3 wouldnt case applied fairness methods iv implementation bandwidth broker dynamic configuration underlying network may provide different classes service satisfy various vpn customers identifying generic functionality provided resource policy options present bb standard web interface shown figure 6b bandwidth broker manages outsourced vpns corporate customers service level agreements slas isps allows one user specify demand www interface establish vpn certain qos two endpoints essential components bandwidth broker bb needs keep track existing connections available resources update relevant databases reflect recent network state bb interacts specialized configuration daemons cd certain user request arrives setup tunnel bb decide whether allocate enough resources meet demand tunnel bb invokes sla database check validity user request essentially needs maintain connection database contains list currently active vpns edge resource database keep track records quantitative resource available base capacity current resource consumption various router interfaces fig 6 bb web interface users b examples dynamic configuration switch network public internet 130926622 univ geneve univ berne univ berne fig 7 experimental setup vpn resource controller bandwidth broker checks resource connection databases whenever new connection arrival departure might trigger modification rates existing connec tions better understanding edge routers dynamically configured meet user demand conform sla demonstrate examples dynamic rate allocations vpn connections commercial cisco routers considering similar examples detailed section iii see simple algorithms really applied edge devices let us consider experimental setup figure difservvpns three vpn qos capable edge routers private network behind configuration 1 user wants establish vpn connection source 172170100 destination 172200100 chooses menu 12 mbps isp provided website submits request resource group definition edge resource database entries shown figure 8 applying algorithm presented section 3 policing rate c user1 configured edge router 1309270101 c mbps user b chooses menu also gets c since capacity group 1 ability support assume two users c decide vpn connection capacity varying 05 mbps group 2 support connections maximum available rate 1 mbps therefore c mbps also configured router connections see following policing individual vpn connection inbound c users b c users c ratelimit input accessgroup 140 2000000 2000000 8000000 conformaction setprectransmit 1 exceedaction setprectransmit 2 ratelimit input accessgroup 141 2000000 2000000 8000000 conformaction setprectransmit 1 exceedaction setprectransmit 2 ratelimit input accessgroup 142 1000000 2000000 8000000 conformaction setprectransmit 1 exceedaction setprectransmit 2 ratelimit input accessgroup 143 1000000 2000000 8000000 conformaction setprectransmit 1 exceedaction setprectransmit 2 classifying requested vpn traffic accesslist 140 permit ip host 172170100 host 172200100 accesslist 141 permit ip host 172170101 host 172200100 accesslist 142 permit ip host 172170102 host 172200100 accesslist 143 permit ip host 172170103 host 172200100 show ingress router policing marking since diffserv unidirectional assume bit precedence 1 used ef traffic marking traffic exceed specified rate marked best effort bit precedence 2 users familiar cisco routers notice first traffic rate parameters example 2000000 2000000 2000000 8000000 ratelimit policing marking commands rate refer c useri group two burst parameters controller resource 172170100 140 172200100 resource definition connection database edge resource database network elements edge routers request web interface edge router group base capacity used capacity resource group usermin usermax user id source address id time id source tun dest address dest tun resource group usage current activation fig 8 partial entries connection resource databasesa scenario connections receive maximum offered value configuration 2 users b also want establish connections sources 172180100 172180101 respectively choose menu 05 1 mbps ie group 2 see capacity exhausted group 2 therefore two new connections two existing connections share base capacity 2 mbps connection configured c c user mbps shown figure 9 new configuration script used point follows ratelimit input accessgroup 140 2000000 2000000 8000000 conformaction setprectransmit 1 exceedaction setprectransmit 2 ratelimit input accessgroup 141 2000000 2000000 8000000 conformaction setprectransmit 1 exceedaction setprectransmit 2 ratelimit input accessgroup 142 500000 2000000 8000000 conformaction setprectransmit 1 exceedaction setprectransmit 2 ratelimit input accessgroup 143 500000 2000000 8000000 conformaction setprectransmit 1 exceedaction setprectransmit 2 ratelimit input accessgroup 144 500000 2000000 8000000 conformaction setprectransmit 1 exceedaction setprectransmit 2 ratelimit input accessgroup 145 500000 2000000 8000000 conformaction setprectransmit 1 exceedaction setprectransmit 2 accesslist 144 permit ip host 172170100 host 172180100 accesslist 145 permit ip host 172170101 host 172180101 v conclusion paper proposed novel range based sla allows customers specify requirements range quantitative service vpn connections since unable unwilling predict load vpn endpoints support services proposed developed prototype bandwidth broker bb logically partition capacity edges various service classes groups vpns manage efficiently allow resource shar controller resource 172170100 140 172200100 resource definition connection database edge resource database network elements edge routers request web interface edge router group base capacity used capacity resource group usermin usermax user id source address id time id source tun dest address dest tun resource group usage current activation 172170100 144 172200100 151 2 05 mbps 1720 fig 9 scenario rate existing connections reduced accommodate new connections ing among groups dynamic fair manner various algorithms examples analysis presented provision resource dynamically edges support qos vpn connections one obvious advantage system pricing gain price customers pay higher one pays lower bound capacity lower normally needed paid upper bound capacity low load possible users might enjoy upper bound rate without paying anything extra pricing might attractive users isps take advantage attract customers advantages believe model quite attractive isps willing deploy real world scenario vi acknowledgement work described paper part work done project charging accounting technologies internet cati 4 funded swiss national science foundation project 50030545591 50030545601 snf r equip project 2160053299981 foundation forderung der wissenschaftlichen forschung der universitt bern r routing guidelines efficient routing methods framework differentiated services architecture differentiated services overview quality service routing nextgeneration highspeed networks problems solutions framework qosbased routing internet flexible model resource management virtual private networks mpls support differentiated services framework ip based virtual private networks expedited forwarding phb bottleneck flow control implementation bandwidth broker dynamic endtoend resource reservation outsourced virtual private networks implementation service broker management qos enabled vpns core mpls ip vpn architecture benjamin teitelbaum fairness window flow controlled computer networks study fairness packet switching networks fairness atm networks tr ctr raffaele bolla roberto bruschi franco davoli capacity planning ip virtual private networks mixed traffic computer networks international journal computer telecommunications networking v50 n8 p10691085 6 june 2006 haci mantar ibrahim okumus junseok hwang steve j chapin scalable intradomain resource management architecture diffserv networks journal high speed networks v15 n2 p185205 january 2006