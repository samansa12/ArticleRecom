excluding graph minor allows low treewidth 2coloring article proves conjecture thomas every graph g integer k every graph minor isomorphic g 2coloring either vertices edges color induces graph treewidlh k generalizations also proved b introduction vertex partition graph g n parts set p 1 p n induced subgraphs g n edge partition graph g n parts set q 1 q n subgraphs g n partition n parts associated coloring edges vertices appropriate n colors obvious way edge partition q 1 q n graph g balanced witnessed vertex partition p 1 j technical condition needed later terms colorings set colors c edge coloring witnessed vertex coloring c every edge e endpoints u v holds c e given graph g decomposition g pair x graph vertex bag x v g following satisfied 2 every edge xy g v x x 3 every x v g subgraph induced v connected width x date may 1 2001 1991 mathematics subject classification primary 05c15 secondary 05c55 key words phrases treewidth vertex partitions edge partitions small components authors research partially supported national science foundation grant dms9400946 authors research partially supported national security agency grant number mda90494h2057 3 authors research supported oce naval research grant number n00014 92j1965 4 research authors partially supported louisiana education quality support fund grant leqsf199598rda08 tree x treedecomposition treewidth graph g denoted twg smallest integer w g treedecomposition width w graph partial ktree treewidth k treewidth important theoretical application graph minors project also algorithmic qualities many problems nphard class graphs solvable linear time class graphs treewidth k every fixed k given graphs g h g minor h denoted g h g obtained subgraph h contracting edges g minor h h graph gminor important result robertson seymour 5 see also 8 p planar graph integer k every graph g pminor treewidth k true nonplanar graph n n planar grid treewidth n see 4 authors 2 generalizing relaxation conjecture 1 showed given surface although graph g embedded surface may arbitrarily large treewidth g vertex partition edge partition two graphs whose treewidth bounded function depending euler characteristic surface set graphs embedded surface example minorclosed class g h g h thomas 9 conjectured every minorclosed class graphs class graphs partition property words thomas conjectured prove following theorem 11 theorem every graph k integers k every graph kminor vertex partition two graphs treewidth k v edge partition two graphs treewidth ke follows following stronger theorem 12 theorem every graph k integer j 1 integers k j every graph kminor vertex partition j parts form graph treewidth k v edge partition j 1 graphs j parts form graph treewidth ke also prove 13 theorem every graph k integer j 1 integers j every graph kminor vertex partition v graphs j j parts form graph treewidth edge partition e graphs j j parts form graph treewidth j proofs theorems completed section 6 proofs accomplished follows first important result robertson seymour theorem 21 structure graphs without particular graph minor stated section 2 corollary theorem 21 namely corollary 22 structural graphtheoretic result actually use structure elements surfaces treewidth main structure surfacelike structure called outgrowth partitions defined break outgrowth pieces called layers bounded height partitions layers considered section 3 bound treewidth layers established section 4 section 5 deals two graph constructions mentioned section 2 namely extensions cliquejoins finally already noted main proofs completed section 6 assist proofs important relationships treewidth graph minors needed proofs results follow easily definitions treewidth minor following clique complete subgraph given two graphs g h graph j cliquejoin g h g h clique j subgraph g h 14 lemma 1 g h twg twh 2 h cliquejoin g 1 g 2 twh maxtwg 1 3 vertex x 2 excluding graph let p n path vertices circuit vertices cyclic given positive integer r rring perimeter 1 n graph r vertex set 1 n family bags decomposition r width r 1 note definition rring diers 6 require vertices perimeter however vertices required perimeter easy construction would put perimeter without violating condition paper introduce closely related concept rround perimeter 1 n graph r vertex set 1 n family bags decomposition r width r 1 observe n rring perimeter 1 n x also rround perimeter note width r 1 means denote set strings letters alphabet v supergraph h consists vertex set edge set incidence function often identify e vertex string h e comparison edge hypergraph associated set vertices whereas edge supergraph associated ordered list vertices possibly repetition edge e nondegenerate otherwise degenerate two strings v cyclically equivalent one obtained sequence moves reversals v 1 throughout paper every edge supergraph size least two edge supergraph h 2edge order two otherwise superedge let denote set 2edges let e 3 h denote set superedges supergraph h embedded surface follows vertex point 2edge e image continuous injective map f e 0 1 f e 0 f e 1 endvertices e superedge image continuous map f closed disk distinct points cyclic order boundary f continuous mapping f injective 1 n thus nondegenerate image f closed disk otherwise obtained closed disk identifying certain points boundary intersections pointsets vertices edges except mentioned sometimes identify vertices edges supergraph h pointsets surface faces h connected components h crosscap respectively handle reduction surface performed replacing crosscap respectively handle disk say surface reduction surface write obtained possibly empty sequence crosscap handle reductions declare embedding supergraph h also embedding whenever define crosscap handle reductions faces similarly thus without loss generality may always perform possible crosscap handle reductions faces define two constructions may able use certain circumstances face surface punctured k times k disjoint boundaries cap face replacing k disks span face adding new 2edges face boundaries joined one boundary thus provided face reductions together cappings spannings may assume every face open disk throughout paper unless otherwise noted assume every graph g every supergraph h every surface connected every face simply connected every face open disk given surface positive integer r let routgrowth pair g h g graph h supergraph embedded superedge rring r perimeter 1 n g graph obtained h replacing superedge rring r follows starting vertex disjoint copies graphs 2 h every given surface positive integers r let r soutgrowth triple g h 0 g graph h supergraph embedded g graph obtained h replacing 0 sround replacing every superedge rring described detail clearly g h g h 0 outgrowth refer graph g graph outgrowth note 6 graph referred outgrowth note also definition outgrowth diers 6 allow superedges degenerate nonempty set surfaces g h routgrowth g h routgrowth let k 0 empty graph intended k 0 k 0 routgrowth possible values r thus set surfaces k 0 k 0 routgrowth empty let k 0 k 0 routgrowth repeat definitions r replaced r given integer k let g kvertex extension g set k vertices h example set apex graphs set graphs 1vertex extensions planar graphs following major structural result 6 theorem followed important step proving graph minors theorem 7 21 theorem robertson seymour let k graph let k set surfaces k cannot embedded numbers rk wk dk every graph kminor may constructed cliquejoins starting wkvertex extensions graphs k rkoutgrowths degenerate edges mentioned theorem 21 proved slightly dierent understanding rrings noted however easy show theorem remains valid additionally require vertices rring perimeter paper wish use modified version structural theorem removing bound dk number superedges rrings removing requirement superedges nondegenerate 22 corollary let k graph let k set surfaces k cannot embedded numbers rk wk every graph kminor may constructed cliquejoins starting wkvertex extensions graphs k rkoutgrowths note k planar graph graph kminor may constructed cliquejoins starting graphs wk vertices special case theorem 21 corollary 22 every planar graph p graph pminor low treewidth appears 5 see also 8 3 layers main step towards proving theorem 12 finding edge vertex j 1coloring routgrowth g h j colors form graph bounded treewidth bound would involve r j clearly loss generality adding new edges g h deleting parallel 2edges describe two constructions shortly first examine boundary face may complicated circuit face f let f denote closure let boundary let df closed disk interior f boundary df continuous injective map f f extends uniquely continuous map list cyclic order points df mapped vertices let v n string v 1 v n vertexboundary f string unique cyclic equivalence face f order f nondegenerate otherwise degenerate face f vertexboundary v 1 v n n 3 fill f trivial superedge f rring r f adding new superedge embedded natural way note pointset f replaced pointset f minus vertices n new faces order two incident f trivial r ring r f edges bag x perimeter vertex similarly may fill face trivial sround superedge adding 2edges v v i1 mod n g h already present embedded natural way suppose f 0 face supergraph h say h full respectively full every face respectively f 0 order two incident one 2edge one superedge fill h respectively performing possible face fillings respectively except f 0 possible encyclings set elements p h supergraph h surface set vertices edges faces h define symmetric incidence relation elements h vertex v incident edge vertex v incident face f face f incident edge e f intersects pointset e point vertex incidences possible particular elements type cannot incident define metric p hp h r elements h let da least integer consecutive entries sequence p 0 pm incident particular da 1if b incident given connected supergraph h drawn surface face f 0 height h h element x p h relative f 0 given every vertex integer height g h routgrowth f 0 face h 2h 0 integer g hf 0 r hlayer provided every vertex edge h height h layers interest vertex edge partitions routgrowths define components respectively r hlayers h specified later prove assertion definitions following section proves layers bounded treewidth use traditional approach defining vertex edge partition outgrowth g h based upon distance given face f 0 supergraph without loss generality h f 0 full integer h 0 let v h set vertices height h integers set edges g one end height height j note e similarly observe edges e h1h height h 1 whereas edges e hh may heights h 1 h h e 2edge convenient define vertex edge partitions via colorings integer l 2 set colors z l integers mod l canonical vertex l coloring assigns color h mod l vertices v h canonical edge lcoloring assigns color h mod l edges e h1h e hh note edgecoloring balanced witnessed given vertex coloring interested subgraphs formed 1 j l colors bounding treewidth components subgraphs since adjacent vertices edges dier height one sucient bound treewidth following two types wish express g ab outgrowth appropriate supergraph done naturally provide details suppose general g subgraph g g h routgrowth f 0 face h rring r associated superedge e 3 h define outgrowth g h layer g h f either e 2 h rring r also delete edges drawing h deleting edges leaves vertices deleted remove vertex v v drawing h vertex list superedge every rring perimeter every bag deletions superedge size less two delete deletions superedge size two say incident vertices u v edge uv r replace 2edge uv otherwise delete otherwise make new embedding disk representing subset old embedding hits appropriate remaining vertices let f face h contains pointset f 0 note f need simply connected continue reducing capping filling faces f ab reduce span face full construction 31 lemma suppose g h routgrowth face f 0 full integers l 2 full r j 1layers moreover g v g e subgraphs g ab proof statements clear except bound j 1on height edges added filling faces endpoints v b g without loss generality may assume edges already g 0 result immediate may suppose 0 considering heights original g hf 0 vertices g ab heights ranging 1 b edges g ab heights ranging 1to b 1 vertices edges g ab height 1 g hf 0 incident face f ab h ab height l zero consequently vertices edges g e height l 1 less original height g hf 0 thus l height bounds height best possible 4 bounding treewidth r hlayers section establishes bound treewidth r hlayer terms r h hlayer triple g h f h special superedge associated superedge associated r ring g obtained h replacing superedges sround rrings hlayer f created deletion f note f face h height f incident faces declared 1 vertices edges height surface let denote euler characteristic let h denote h h fractional part h following main theorem section 41 theorem g h f full r hlayer g treewidth proof theorem follow lemmas definitions stating prove two easy corollaries used proof main theorem appearing next section 42 corollary g hf full r hlayer g treewidth proof fill face f sround apply theorem 41 43 corollary let g connected graph g h routgrowth let f face h g balanced edge vertex lcoloring j l colors form graph treewidth proof follows lemma 31 preceding discussion 2degree vertex v supergraph h denoted deg 2 v degree v full supergraph subcubic every vertex 2degree three denote bag associated superedge perimeter vertex r l note h full implies edges listed cyclically around vertex alternate 2edges superedges 44 lemma counterexample theorem 41 counterexample h full subcubic proof discussed suppose supergraph h full without loss generality remainder proof similar proof graph obtained subcubic graph contraction although must preserve height structure suppose x vertex 2degree three let height x j let cyclic ordering edges around x superedge e 2edge without loss generality height 1 j 1 suppose l 3 1 define height preserving decontraction x obtain remove x h add two new vertices x x add new 2edge e edge 1 e 1 e l1 l declared incident x edge l e l declared incident x h embedded naturally x x incident h bag x l x x bag x associated 1 l h change x x x x preserve required properties rrings srounds creates note choice 1 operation increase height finitely many height preserving decontractions obtain h subcubic g minor g lemma 14 1 result follows sometimes useful rotate perimeter around rring next simple lemma shows may done adding factor two width 45 lemma r rring perimeter 1 n 2rring perimeter proof let r rring perimeter 1 n means bags given give result 46 lemma counterexample theorem 41 counterexample h full subcubic height h 1 proof suppose r hlayer h full subcubic height h small possible suppose h 1 shall construct r follows obtain contradiction h denote set edges e h height h since h full subcubic every superedge e2h 2edge 2 h e bound face finitely many height preserving decontractions may ensure 2edges form matching applying lemma 45 rotate rring r associated e2h obtain 2rring r perimeter construct h h deleting f every e e2h creating face f filling f superedge f need associate f 1round specifying bags g h f required properties e2h r corresponds naturally vertex f leave bag unchanged routine check l required properties lemma follows complete proof theorem 41 proof suppose g h f r hlayer contradicts theorem lemmas may assume h full subcubic h suppose first h 0 h single superedge f let h graph single face f eulers formula set c exactly 2 edges spanning tree h 2 x v g let x set vertices v v g x bag associated v clearly h 2 x connected every x v g 2edge associated four entries corresponding bag vertexlist face f let e z e two bags one end e x e h 2 x x e z e let gd g obtained g deletion 2 2s 1 vertices lemma 14 treedecomposition g width 3s2 bag size 3s1 obtained follows using tree arbitrarily choose root z bag union bags removed associated x l together predecessor x rooted tree result result similarly reduction similar proof lemma 46 briefly outline modifications arguments case need rotate rrings construction although may first decontractions cost bounds reduce case worst vertex associated one bag size two size 1 edges e2h form matching assume tree contains obtain required bound 5 extensions clique sums section extend partition results outgrowths minorclosed classes become apparent edge partitions previous sections required balanced property useful dealing clique joins set surfaces integer r 1 let r set graphs routgrowths set graphs integer w 0 let w set pairs g w g graph w v g w w g w call vertices w extra vertices g w set graphs g exists w g w set graphs wvertex extensions graphs inductively follows g cliquejoin g 1 g 2 clique q restriction taking arbitrary cliquejoins v q w theorem 21 corollary 22 still hold restriction imposed get corollary 51 corollary let minor closed class graphs class graphs finite set surfaces numbers r w proof choose graph k let wk result follows corollary 22 modified noted restriction clique joins let c set colors let e graph edge coloring b vertex coloring say graph g k b b c make similar definition vertex coloring edge coloring witnessed vertex coloring may combine balanced full coloring property every edge e endpoints u v holds ce cu cv call condition endpoint rule say c balanced k b full coloring ce balanced k b edge coloring 52 lemma suppose set graphs w 0 integer let c set colors suppose k b 1 every graph k b g 2 every graph balanced k b g balanced k b proof 1 let set graphs every graph k b vertex coloring suppose g exists w g w w thus gw k b coloring extend coloring gw g arbitrarily coloring w result follows using lemma 143 suppose g 1 w g 2 w w g cliquejoin g 1 g 2 clique q v q w induction coloring g 1 coloring g 2 w note graphs g 1 g 2 w vertex disjoint may use two colorings vertex color g 1 g 2 w leaves vertices w v q colored arbitrarily observe b c gv b cliquejoin g clique vertex set required 2 let set graphs every graph k b coloring suppose g wish find balanced k b also give vertex coloring c witnesses c e balanced combine balanced full coloring thus color edges vertices g every edge satisfies endpoint rule g w exists w g w w thus gw balanced k b full coloring extend coloring gw g arbitrarily coloring w coloring edges incident vertices arbitrarily subject endpoint rule result follows using lemma 143 suppose g g cliquejoin g 1 g 2 clique q v q w induction balanced full coloring g 1 balanced k b coloring g 2 w note graphs g 1 g 2 w vertex disjoint may use two colorings fully color g 1 g 2 w leaves vertices w v q edges incident vertices edges colored color vertices edges arbitrarily subject endpoint rule except edge e endpoints b c edges geb q choice coloring edges v q v therefore geb cliquejoin g 1 eb g 2 eb clique 6 proofs main theorems section prove theorems stated section 1 well theorems finite set surfaces let 61 theorem let finite set surfaces let r 1 w 0 l 2 integers every graph r balanced edge vertex lcoloring j l colors form graph treewidth proof follows corollary 43 lemma 52 62 theorem let minor closed class graphs class graphs let l 2 integer exist numbers every graph balanced edge vertex lcoloring j l colors form graph treewidth j proof follows corollary 51 theorem 61 proofs theorem 11 theorem 12 follow immediately finally need prove theorem 13 first consider partitioning graphs bounded treewidth topic examined 3 need new formulation ktree g graph following structure suppose n k let v j gv j kclique observe largest clique g size k 1 recall subgraph ktree partial ktree every simple graph treewidth k partial ktree 1 set colors define canonical balanced full extend vertex coloring uniquely subject proper vertex coloring edge e endpoint v v j j color 63 theorem let treewidth k g balanced full coloring c v g geb btree every b c proof without loss generality g ktree let c canonical balanced full coloring let eb observe bclique k neighborhood v j gv j b 1clique gv b b 1tree geb obtained gv b attaching vertex v v b bclique geb btree vertex coloring c let c denote corresponding vertex partition two vertex colorings c 1 c 2 defined c v vertex gets ordered pair colors family colorings similarly make similar definitions edge colorings partitions clearly ii also following theorem sounds technical straightforward useful set c integer j let c 64 theorem following statement holds edge vertex colorings classes graphs suppose j j closed subgraphs respectively induced subgraphs edge respectively coloring case let j 1 l j j integers 1 suppose every graph lcolored every j colors form graph 2 suppose every graph mcolored every j j every colors form graph j exists integer every graph icolored every j j every j colors form graph j proof prove edge case vertex case almost identical let g let c eg c coloring satisfying 1 c set colors size l b c coloring satisfying 2 cb set colors size extend coloring cb eg assigning single new color say edge egeb yield c b c desired coloring uses colors may prove theorem 13 fact follows following stronger theorem using corollary 51 65 theorem let finite set surfaces let r 1 w 0 j 1 integers integers v e every graph r vertex partition v graphs j j parts form graph treewidth j 1 edge partition e graphs j j parts form graph treewidth j proof follows theorem 61 theorem 63 theorem 64 r graphs forbidden subgraphs partitioning graphs bounded tree width graph minors graph minors graph minors xvi graph minors xx quickly excluding planar graph problem session third slovene conference graph theory tr graph minors v excluding planar graph quickly excluding planar graph surfaces treewidth cliqueminors partitions graph minors xvi excluding nonplanar graph ctr jaroslav neetil patrice ossona de mendez linear time low treewidth partitions algorithmic consequences proceedings thirtyeighth annual acm symposium theory computing may 2123 2006 seattle wa usa jaroslav neetil patrice ossona de mendez treedepth subgraph coloring homomorphism bounds european journal combinatorics v27 n6 p10221041 august 2006 demaine fedor v fomin mohammadtaghi hajiaghayi dimitrios thilikos subexponential parameterized algorithms boundedgenus graphs hminorfree graphs journal acm jacm v52 n6 p866893 november 2005