fast algorithm deblurring models neumann boundary conditions blur removal important problem signal image processing blurring matrices obtained using zero boundary condition corresponding assuming dark background outside scene toeplitz matrices onedimensional problems blocktoeplitztoeplitzblock matrices twodimensional cases computationally intensive invert especially block case periodic boundary condition used matrices become block circulant diagonalized discrete fourier transform matrices paper consider use neumann boundary condition corresponding reflection original scene boundary resulting matrices block toeplitzplushankel matrices show symmetric blurring functions blurring matrices always diagonalized discrete cosine transform matrices thus cost inversion significantly lower using zero periodic boundary conditions also show use neumann boundary condition provides easy way estimating regularization parameter generalized crossvalidation used blurring function nonsymmetric show optimal cosine transform preconditioner blurring matrix equal blurring matrix generated symmetric part blurring function numerical results given illustrate efficiency using neumann boundary condition b introduction fundamental issue signal image processing blur removal signal image obtained point source blurring process called impulse response function point spread function observed signal image g convolution blurring function h true signal image f deblurring problem recover f blurred function g given blurring function h basic problem appears many forms signal image processing 2 5 12 14 practice observed signal image g finite length width use recover finite section f convolution g completely determined f domain g defined precisely blurred signal g defined interval b say completely determined values true signal f b also affected values f close boundary b convolution size interval affects g depends support blurring function h thus solving f finite length g need assumptions values f outside domain g defined assumptions called boundary conditions natural classical approach use zero dirichlet boundary condition 2 pp211220 assumes values f outside domain consideration zero results blurring matrix toeplitz matrix 1dimensional case block toeplitztoeplitzblock matrix 2dimensional case see 2 p71 however matrices known computationally intensive invert especially 2dimensional case see 2 p126 also ringing effects appear boundary data indeed close zero outside domain one way alleviate computational cost assume periodic boundary condition ie data outside domain consideration exact copies data inside 12 p258 resulting blurring matrix circulant matrix 1dimensional case blockcirculant circulantblock matrix 2dimensional case matrices diagonalized discrete fourier matrices hence inverses easily found using fast fourier transforms see 12 p258 however ringing effects also appear boundary unless f close periodic common practice image processing literature methods also proposed assign boundary values see lagendijk biemond 18 p22 references therein instance boundary values may fixed local image mean obtained modelbased extrapolation paper consider use neumann reflective boundary condition image restoration sets data outside domain consideration reflection data inside neumann boundary condition studied image restoration 21 3 18 image compression 25 20 image restoration boundary condition restores balance lost ignoring energy spreads outside area interest 21 also minimizes distortion borders caused deconvolution algorithms 3 approach also eliminate artificial boundary discontinuities contributed energy compaction property exploited transform image coding 20 use neumann boundary condition results blurring matrix toeplitz plushankel matrix 1dimensional case block toeplitzplushankel matrix toeplitzplushankel blocks 2dimensional case although matrices complicated structures show always diagonalized discrete cosine transform matrix provided blurring function h symmetric thus inverses obtained using fast cosine transforms fcts fct requires real multiplications done half cost fft see 23 pp5960 inversion matrices faster matrices obtained either zero periodic boundary conditions also show use neumann boundary condition provides easy way estimating regularization parameter using generalized crossvalidation remark blurring functions usually symmetric see 14 p269 however case blurring function nonsymmetric show optimal cosine transform preconditioner 6 blurring matrix generated symmetric part blurring function thus blurring function close symmetric optimal cosine transform preconditioner good preconditioner outline paper follows x2 introduce three different boundary con ditions x3 show symmetric blurring matrices obtained neumann boundary condition always diagonalized discrete cosine transform matrix x4 show using neumann boundary condition generalized crossvalidation estimate regularization parameter done straightforward way x5 give construction optimal cosine transform preconditioners matrices generated nonsymmetric blurring functions x6 illustrate numerical examples image restorations algorithm efficient concluding remarks given x7 2 deblurring problem simplicity begin 1dimensional deblurring problem consider original signal blurring function given blurred signal convolution h f ie ith entry g blurred signal given deblurring problem recover vector given blurring function h blurred signal finite length 2 f gammam1 f gammam2 thus blurred signal g determined f f linear system 3 underdetermined overcome make certain assumptions called boundary conditions unknown data f gammam1 reduce number unknowns discuss boundary conditions let us first rewrite 3 f gammam1 f gammam2 hm h gammam 21 zero dirichlet boundary condition zero dirichlet boundary condition assumes signal outside domain observed vector g zero 2 pp211220 ie zero vector matrix system 4 becomes see 6 coefficient matrix toeplitz matrix many iterative direct toeplitz solvers solve toeplitz system 8 costs ranging log n 2 operations see instance 19 16 1 7 2 dimensional case resulting matrices blocktoeplitztoeplitzblock matrices inversion matrices known expensive eg fastest direct toeplitz solver 4 operations n 2 byn 2 blocktoeplitztoeplitzblock matrix see 17 22 periodic boundary condition practical applications especially 2dimensional case need solve system efficiently one usually resort periodic boundary condition amounts setting 3 see 12 p258 matrix system 4 becomes nbyn toeplitz matrices obtained augmenting n gamma zero columns l r respectively important advantage using periodic boundary condition b obtained circulant matrix hence b diagonalized discrete fourier matrix 9 solved using three fast fourier transforms ffts one finding eigenvalues matrix b two solving system cf 15 thus total cost log n operations 2dimensional case blurring matrix blockcirculantcirculantblock matrix diagonalized 2dimensional ffts tensorproducts 1dimensional ffts 2 log n operations 23 neumann boundary condition neumann boundary condition assume data outside f reflection data inside f precisely set 3 thus 4 becomes j nbyn reversal matrix remark coefficient matrix 10 neither toeplitz circulant toeplitzplushankel matrix although matrices complicated structures show x3 matrix always diagonalized discrete cosine transform matrix provided blurring function h symmetric ie h follows 10 solved using three fast cosine transforms fcts log n operations see 15 approach computationally attractive fct requires real operations twice fast fft see 23 pp5960 thus solving problem neumann boundary condition twice fast solving problem periodic boundary condition establish similar results 2dimensional case blurring matrices block toeplitzplushankel matrices toeplitzplushankel blocks 3 diagonalization neumann blurring matrices 31 onedimensional problems first review definitions properties discrete cosine transform matrix let c nbyn discrete cosine transform matrix entries r kronecker delta see 14 p150 note c orthogonal ie c also nvector v matrixvector multiplications cv c v computed log n real operations fcts see 23 pp5960 let c space containing matrices diagonalized c ie nbyn real diagonal matrixg 12 sides see eigenvalues ii q given hence eigenvalues q obtained taking fct first column q particular matrix c uniquely determined first column next give characterization class matrices c let us define shift vector v nbyn symmetric toeplitz matrix v first column hx nbyn hankel matrix x first column last column lemma 1 chan chan wong 6 kailath olshevsky 15 martucci 22 sanchez et al 24 let c class matrices diagonalized discrete cosine transform matrix c follows lemma 1 matrices diagonalized c special toeplitzplushankel matrices theorem 1 let blurring function h symmetric ie h matrix given 10 written particular diagonalized c proof 10 6 clear equal u definitions l r 5 7 also obvious hence theorem 1 solution f 10 given diagonal matrix holding eigenvalues 13 obtained one fct hence f obtained three fcts remark 14 straightforward construct neumann blurring matrix dirichlet blurring matrix 6 need reflect first column get hankel matrix hoeu j oeu add clearly storage requirements matrices need store first column 32 twodimensional problems results x31 extended natural way 2dimensional image restoration problems case one concerned solving least squares problem similar 3 except matrix block matrix zero boundary condition resulting blurring matrix blocktoeplitztoeplitzblock matrix form block j toeplitz matrix form given 7 first column row 16 completely determined blurring function blurring process neumann boundary condition resulting matrix block toeplitzplus hankel matrix toeplitzplushankel blocks precisely gammam mgamma1 gammam1 block j nbyn matrix form given 10 note j 17 j 16 related 14 thus straightforward construct blurring matrix matrix blurring function directly obviously storage requirements next show symmetric blurring function blurring matrix 17 diagonalized 2dimensional discrete cosine transform matrix hence inversion done using three 2dimensional fcts theorem 2 blurring function h ij symmetric ie j diagonalized 2dimensional discrete cosine transform matrix comega c whereomega tensor product proof note comega iiomega c since block j 17 form given 14 theorem 1 j diagonalized c ie follows comega cac comega iiomega caiomega c c tomega comega c tomega let p permutation matrix satisfies ie jth entry k th block permuted k th entry jth block p iomega c 1 0 2 18 matrix j form 14 particular j c j diagonal matrix thus comega cac comega c tomega 2 permutation diagonal matrix hence still diagonal matrix 4 estimation regularization parameters besides issue boundary conditions wellknown blurring matrices general illconditioned deblurring algorithms extremely sensitive noise 12 p282 illconditioning blurring matrices stems wide range magnitudes eigenvalues 10 p31 therefore excess amplification noise small eigenvalues occur method regularization used achieve stability deblurring problems classical regularization 10 p117 stability attained introducing regularization operator restricts set admissible solutions specifically regularized solution f computed solution min term kdfk 2 2 added order regularize solution regularization parameter controls degree regularity ie degree bias solution one find solution f 19 solving normal equations usually kdfk 2 chosen l 2 norm kfk 2 h 1 norm klfk 2 l first order difference operator matrix see 14 8 12 correspondingly matrix 20 identity matrix discrete laplacian matrix boundary conditions latter case zero boundary condition imposed discrete laplacian dirichlet boundary condition periodic boundary condition circulant diagonalized ffts see instance 12 p283 neumann boundary condition discrete laplacian neumann boundary condition diagonalized discrete cosine transform matrix see instance 4 thus use neumann boundary condition blurring matrix regularization operator matrix 20 diagonalized discrete cosine transform matrix hence inversion still done three fcts fixed cf 15 another difficulty regularization choice generalized crossvalidation 11 technique estimates directly without requiring estimate noise variance based concept prediction errors vector minimizes error measure ith element af g ith element g f k good estimate f af k good approximation g k average given average squared error predicted value af k actual value g k given byn generalized crossvalidation gcv weighted version error jj j jth entry socalled influence matrix 11 golub et al shown v written optimal regularization parameter chosen minimizes v since v nonlinear function minimizer usually cannot determined analytically however neumann boundary condition used rewrite v ff fi represent eigenvalues respectively recall ff obtained taking fct first column respectively since matrices diagonalized discrete cosine transform matrix c thus gcv estimate computed straightforward manner see 13 periodic boundary condition gcv estimate also computed similar procedure however use zero boundary condition determining gcv estimate require inversion large matrix clearly overwhelming task images reasonable size 5 optimal cosine transform preconditioners matrices c symmetric see 12 discrete cosine transform matrices diagonalized blurring matrices symmetric blurring functions nonsymmetric blurring functions matrices c may used preconditioners speed convergence iterative methods conjugate gradient method given matrix define optimal cosine transform preconditioners ca minimizer kq gamma frobenius norm 6 16 ca obtained solving linear systems give simple approach finding ca theorem 3 let h arbitrary blurring function blurring matrix h neumann boundary condition imposed optimal cosine transform preconditioner ca found follows 1 onedimensional case ca blurring matrix corresponding symmetric blurring function neumann boundary condition imposed 2 2dimensional case ca blurring matrix corresponding symmetric blurring function given ij j h ij h igammaj h gammaij h gammaigammaj 4 neumann boundary condition imposed proof give proof onedimensional case proof twodimensional case similar first note u v symmetric skewsymmetric matrices respectively ku f hence since second term right hand side affect diagonal matrix minimizer given diagonal easy check that2 claim diagonal entries chv gammaj vc true minimizer given theorem 3 follows directly theorem 1 prove claim first note 11 r cos also clear j jhv gammaj v skewsymmetric toeplitz matrix therefore view theorem 3 results x3 easy find ca blurring matrices generated nonsymmetric blurring functions take symmetric part blurring functions form block toeplitzplushankel matrices given 10 17 theorem 3 also see blurring function close symmetric ca good approximation hence good preconditioner see numerical results x6 6 numerical experiments section illustrate efficiency employing neumann boundary condition two boundary conditions image restoration problems tests done matlab data source photo 1964 gatlinburg conference numerical algebra taken matlab 4 see construct right hand side vector g correctly need vectors f l f r ie need know image outside given domain thus figure 1 gatlinburg conference image1020150005001500250035102051525001002003 b c figure 2 gaussian blur b outoffocus blur c noisy blurred image gaussian blur outoffocus blur start 480by640 image photo cut 256by256 portion image figure 1 gives 256by256 image picture consider restoring gatlinburg conference image blurred following two blurring functions see 14 p269 truncated gaussian blur ae ce ii outoffocus blur ae c h ij jth entry first column 16 c normalization constant remark gaussian blur symmetric separable whereas outoffocus blur symmetric separable see figures 2a 2b gaussian white noise n signaltonoise ratio 50db added blurred images noisy blurred images shown figures 2c 2d note blurring cigarette held prof householder rightmost person clearly shown cf figure 1 remark regularization parameter based generalized crossvalidation method see x4 suitable zero boundary condition imposed method require inversion many large matrices comparison cost among different boundary conditions chose optimal regularization parameter minimizes relative error reconstructed image f defined kf gamma f k 2 kfk 2 f original image optimal accurate one significant digit obtained trial error figures 3 4 present restored images three different boundary conditions optimal relative errors used l 2 norm regularization functional see figures imposing neumann boundary condition relative error ringing effect smallest also cigarette better reconstructed using neumann boundary condition using two boundary conditions rel figure 3 restoring gaussian blur zero left periodic middle neumann right boundary conditions rel figure 4 restoring outoffocus blur zero left periodic middle neumann right boundary conditions next let us consider cost recall need three 2dimensional ffts fcts compute restored images periodic neumann boundary conditions respectively thus costs approaches 2 log n operations though neumann one twice fast fct requires real multiplications 23 pp5960 zero boundary condition solve blocktoeplitztoeplitzblock system fastest direct toeplitz solver requires 4 operations see 17 tests systems blurring function 3 theta gaussian 67 outoffocus 81 73 48 43 26 blurring function 3 theta gaussian 17 17 13 12 7 7 outoffocus 22 21 15 14 9 9 table 1 numbers iterations required using zero boundary condition solved preconditioned conjugate gradient method circulant preconditioners 7 table 1 shows numbers iterations required two blurring functions different stopping tolerance 10 gamma6 note cost per iteration four 2dimensional ffts thus cost extremely expensive especially small conclusion see cost using neumann boundary condition lower using two boundary conditions finally illustrate effectiveness optimal cosine transform preconditioners blurring functions close symmetric general tests preconditioners given 6 consider 2dimensional deconvolution problem arising groundbased atmospheric imaging figure 5a gives 256by256 blurred noisy image ocean reconnaissance satellite observed groundbased imaging system figure 5b 256 by256 image guide star observed similar circumstances see 8 discrete blurring function h given pixel values guide star image blurring matrix obtained 17 imposing neumann boundary condition 50 100 150 200 2500408 figure 5 observed image b guide star image c crosssection blurring function note blurring function exactly symmetric case see figure 5b however crosssections blurring function see instance figure 6c know close symmetric therefore used preconditioned conjugate gradient algorithm optimal cosine transform preconditioner remove blurring see x5 use l 2 norm regularization functional figure 6a present restored image optimal original image given figure 6b comparison figure restored image b true image table 2 number iterations convergence using optimal cosine transform preconditioner image restored 4 iterations stopping tolerance 10 gamma6 preconditioner used acceptable restoration achieved 134 iterations see table 2 remark cost per iteration using optimal cosine transform preconditioner almost preconditioner 1178 theta 10 8 1150 theta 10 8 floating point operations per iteration respectively thus see preconditioned conjugate gradient algorithm optimal cosine transform preconditioner efficient effective method problem 7 concluding remarks paper shown discrete cosine transform matrices diagonalize dense toeplitzplushankel blurring matrices arising using neumann reflective boundary condition numerical results suggest neumann boundary condition provides effective model image restoration problems terms computational cost minimizing ringing effects near boundary interesting note discrete sine transform matrices diagonalize toeplitz matrices 3 bands discrete laplacian zero boundary conditions dense toeplitz matrices general see 9 instance r superfast solution real positive definite toeplitz systems ieee signal processing mag azine fast computation discretized thinplate smoothing spline image data based preconditioners total variation deblurring conjugate gradient methods toeplitz systems generalization strangs preconditioner applications toeplitz least squares problems sine transform based preconditioners symmetric toeplitz systems regularization inverse problems generalized crossvalidation method choosing good ridge parameter new york matlab package analysis solution discrete illposed problems fundamentals theory applications fast algorithms block toeplitz matrices toeplitz entries iterative identification restoration images wiener rms root mean square error criterion filter design prediction reducing boundary distortion image restoration symmetric convolution discrete sine cosine transforms diagonalization properties discrete cosine transforms tr ctr ben appleton hugues talbot recursive filtering images symmetric extension signal processing v85 n8 p15461556 august 2005 marco donatelli claudio estatico stefano serracapizzano boundary conditions multipleimage reblurring lbt case journal computational applied mathematics v198 n2 p426442 15 january 2007 michael k ng andy yip fast map algorithm highresolution image reconstruction multisensors multidimensional systems signal processing v12 n2 p143164 april 2001 daniela calvetti preconditioned iterative methods linear discrete illposed problems bayesian inversion perspective journal computational applied mathematics v198 n2 p378395 15 january 2007 jianfeng cai raymond h chan carmine fiore minimization detailpreserving regularization functional impulse noise removal journal mathematical imaging vision v29 n1 p7991 september 2007 michael k ng andy c yau superresolution image restoration blurred lowresolution images journal mathematical imaging vision v23 n3 p367378 november 2005