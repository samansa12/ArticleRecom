accuracy decoupled implicit integration formulas dynamical systems often decomposed loosely coupled subsystems system ordinary differential equations odes modelling problem partitioned corresponding subsystems loose couplings exploited special integration methods solve problem using parallel computer solve problem efficiently standard methodsthis paper presents accuracy analysis methods numerical integration stiff partitioned systems odes discretization formulas based implicit euler formula second order implicit backward differentiation formula bdf2 subsystem partitioned problem discretized independently couplings subsystems based solution values previous time steps applied way discretization formulas called decoupledthe stability properties decoupled implicit euler formula well understood paper presents error bounds asymptotic error expansions used controlling step size relaxation subsystems validity partitioning decoupled bdf2 formula analyzed within frameworkfinally analysis used design decoupled numerical integration algorithm variable step size control local error adaptive selection partitionings two versions algorithm decoupled implicit euler bdf2 respectively used examples realistic problem solved examples compare results decoupled implicit euler bdf2 formulas compare results corresponding classical formulas b introduction numerical solution stiff systems ordinary differential equations odes requires implicit discretization formulas implicit algebraic problems usually solved newtontype iteration method involves solution systems linear equations often turn sparse attempts parallelize standard algorithm one outlined often lead disappointing efficiency parallel algorithm finegrained large sequential fraction waveform relaxation method 1 although developed parallel computation mind leads efficient parallel algorithms class problems works well multirate integration considered integral feature waveform relaxation method relaxation part method potential source computational inefficiency one relaxation iteration fairly expensive convergence may slow decoupled integration methods paper developed response problems encountered parallelizing standard integration methods problems waveform relaxation decoupled integration methods like waveform relaxation method exploit partitioning system odes loosely coupled subsystems decoupled integration methods employ one occasionally two relaxation iterations multirate integration quite natural waveform relaxation method although still possible parallel implementations decoupled integrations methods finer grained parallel waveform relaxation methods decoupled integration methods may department computer science university copenhagen universitetsparken 1 dk2100 copenhagen denmark email stigdikudk efficient sequential computer standard integration methods like waveform relaxation method previous paper introduced decoupled implicit euler method 2 existence global error expansion proved general choice step size thus permitting use richardson extrapolation sufficient condition stability discretization given 3 condition called monotonic maxnorm stability guarantees contractivity partitioned systems odes qualitative terms characterized monotonically maxnorm stable subsystem stable couplings one subsystem others weak paper organized follows section 2 partitioned systems odes decoupled discretization formulas gives preliminaries definitions including definition monotonic maxnorm stability presentation decoupled implicit euler decoupled implicit second order backward differentiation formula bdf2 section 3 error bounds gives error bounds classical decoupled implicit euler formulas bounds closely tied monotonic maxnorm stability condition applies euler formulas bounds readily generalized bdf2 formula section 4 asymptotic error formulas error estimation includes four subsections treating explicit formulas classical implicit formulas decoupled implicit euler finally decoupled bdf2 formulas explicit formulas used error estimation prediction decoupled formulas asymptotic errors classical formulas smallest achievable decoupled formulas therefore interest asymptotic errors decoupled formulas given various modes operation error estimation techniques presented section 5 integration algorithm first presents general principles decoupled integration algorithms derived previous analysis details implementation decoupled implicit euler formula given followed minor modifications required replacing euler formula bdf2 formula implementation employs variable step size control local error adaptive selection partitionings among two predetermined alternatives integration algorithms used section 6 examples chemical reaction kinetics real problem solved using decoupled classical versions implicit euler bdf2 examples show excellent performance decoupled formulas 2 partitioned systems odes decoupled discretization formulas define system odes continuous stable systems differential equations considered stiff step size discretization explicit integration method limited stability discretization accuracy efficient numerical integration stiff systems therefore requires implicit integration methods let original problem 21 partitioned 0y 0y 0 10 20 necessary partitioning stated explicitly f r 21 monotonic maxnorm stability following stability condition introduced 3 plays crucial role stability decoupled implicit integration methods stability partitioned system 22 said monotonically maxnorm stable exist norms k delta k r functions rj u v rj u v ku following condition holds logarithmic maxnorm 1 delta q theta q matrix rj condition 24 states matrix rj diagonally dominant nonpositive diagonal elements linear problem rj matrix chosen theorem 3 3 includes results monotonic maxnorm stability including possible choices rj monotonic maxnorm stability admits arbitrarily stiff problems 22 decoupled implicit euler stability convergence decoupled implicit euler method defined following discretization subsystems implicit euler formula 2 qn variables convex combinations values fy ik r convex combinations general depend subsystem index r order simplify notation dependency specified explicitly method called decoupled algebraic system resulting discretization 21 eulers implicit formula decoupled number independent algebraic problems decoupled implicit euler formula used basis parallel methods 25 solved independently parallel different rvalues method used multirate mode h rn 6 h jn r 6 j multirate formulation used parallel waveform relaxation method 1 sequential solution 25 single processor general computationally cheaper solving complete system therefore decoupled implicit euler method may also attractive alternative classical euler formula sequential processor even multirate opportunity theorems 4 5 3 assure stability discretization 25 monotonically maxnorm stable problem convergence waveform relaxation stability condition poses restrictions choice step sizes h rn convexity rn necessary stability theorem decoupled implicit euler method convex combination would typically zeroorder interpolation multirate organizations linear interpolation option multirate aspect discussed extensively 2 3 results techniques paper readily extended multirate algorithms ever presenting results multirate algorithms would add substantially notational complexity furthermore algorithms example presented sections 5 6 respectively exploit multirate formulation therefore multirate aspect explored 23 organization jacobi gaussseidel relaxation definition decoupled implicit euler formula 25 suggests jacobitype organization computation well suited parallel computation define function g j partitioning f given 22 jr q assuming step size hn subsystems decoupled implicit euler formula expressed compact form yn definition g j given corresponds jacobi organization computation similar gggammas defined gaussseidel organization ggammasr q decoupled implicit euler formula based gaussseidel organization general accurate 27 gaussseidel organization although inherently sequential may still used parallel partitioning 22 admits redblack reordering similar reordering based colors see eg 4 following generic function g meaning either g j gggammas used decoupled implicit euler formula used relaxation iterations m1 yn computational cost iteration 29 approximately cost computing yn 27 relaxation carried convergence resulting discretization classical implicit euler discretization numerical solution n computed accepted usually used computing next step denoted yn yn n relaxation 29 subsystem r solved sweep usually newtontype iteration carried convergence relaxation iteration based new tons method jacobi gaussseidel organization shown may converge fast substantially less computation per iteration rn qn rn potential parallelisation less gaussseidel organization jacobi organization 24 decoupled bdf2 bdf2 also used decoupled mode stability results formula known linear problems constant step size 5 decoupled bdf2 course relaxed euler formula 29 210 m1 3 error bounds 31 decoupled implicit euler error decoupled implicit euler formula bounded follows consider local truncation error subsystem r decoupled implicit euler formula using jacobi organization r r qn assume monotonic maxnorm stability condition 23 24 fulfilled n r introduce simplified notation n r subtraction leads r n bound local error r decoupled implicit euler formula cf lemma 22 section iii2 6 rr n since rr 24 r 32 classical implicit euler similar local error bound established classical implicit euler formula expressed follows notation analogous 25 using monotone maxnorm stability condition obtain r m1 defined bound local error r classical implicit euler formula analogous 32 valid values step sizes may interesting useful values lt n main difference 32 33 last term 32 local truncation error norm lt n oh 2 order last term 32 oh 2 since offdiagonal elements ij small last term 31 may negligible local error bound decoupled implicit euler formula almost equal local error bound classical implicit euler formula 4 asymptotic error formulas error estimation 41 explicit formulas numerical solution stiff systems odes requires implicit discretization formulas numerical integration algorithm typically also includes explicit formula used error estimation computing initial value iterative newtontype method used solving implicit discretization problem decoupled implicit euler bdf2 formulas furthermore require computation yn use explicit formula option explicit euler formula e obvious choice connection implicit euler formula implicit decoupled euler formula however explicit formulas including f generally avoided connection stiff problems hkfy k ae 1 bound ky e may approached yngamma1 smooth solution case solved approximately yngamma1 therefore polynomial interpolation formulas preferred predictors 7 linear interpolation formula local error expansion second order polynomial predictor formula p2 local error expansion formula assuming 42 classical implicit euler bdf2 classical implicit euler local error expressed partial derivatives rest section 4 computed n eterms obtained substituting expansion yn 44 euler formula 43 taylor expanding point finally identifying eterms equal power hn principal local error term h 2 estimated divided difference values yngamma2 classical bdf2 formula cf 211 local error expansion assuming principal local error term bdf2 estimated error estimates 45 47 based divided differences asymptotically correct 8 step size varies according oet sufficiently smooth essentially step size variation attempted algorithms section 52 43 decoupled implicit euler local error decoupled implicit euler formula 27 depends definition yn number relaxation iterations performed cf 29 two different modes corresponding different choices yn considered different number relaxation iterations partitioned system 22 monotonically maxnorm stable mode 1 discretizations stable mode 2 discretizations cannot guaranteed stable 431 mode 1 local error expressed follows e r terms 48 found analogously e r terms 44 27 1 e 1 e 1 relation gy exploited expression e 1 3 element vector 2 g evaluated 0 principal local error term h 2 estimated using p cf k inequality may fulfilled subsystems loosely coupled means guaranteed monotonic maxnorm condition error estimation based p used quality estimate somehow monitored continually e 2 r terms 48 found 2 like analogous terms e 2 e 2 relation gy exploited expression e 2 3 classical implicit euler formula therefore principal local error term h 2 2 estimated using 45 substituted yn e 1 e 2 terms unchanged relaxation iterations 3 e identical e 3 classical implicit euler formula 432 mode 2 local error expressed follows e e e e 1 terms 1 1 identical e 1 e 2 classical implicit euler respectively e 1 computational cost p n general much less cost 1 n mode 1 although lead different e 3 expressions e 1 3 one value smaller general however use n instead may compromise stability decoupled implicit euler formula cf section 22 mode 1 e unchanged relaxation iterations 2 e 2 development error terms e 3 e 3 given illustrate influence increasingly accurate values decoupling original problem subsystems efficient mode 1 2 decoupled implicit euler formula gives results close classical implicit euler formula 2 decoupling poor differences higher order e r e r terms significant ky k error expansions include multirate integration derivation error expansions analogous covering multirate integration could done using basic definition 25 would notationally complicated results essentially 44 decoupled bdf2 decoupled bdf2 211 admits natural choices yn decoupled implicit euler formula three modes using increasingly accurate yn presented mode 1 expected possess best stability properties among three different modes although theoretical results available 5 mode 3 second order predictor value yn expected weakest terms stability properties mode 2 somewhere 441 mode 1 errors decoupled bdf2 considered 1 subsequent relaxation iterations 212 local error expressed follows constant step size e r terms 411 found analogously e r terms 44 e 1 e 1 full order accuracy bdf2 reached another relaxation iteration performed 2 error terms e 2 e 2 ky 3 n k ae k2g principal local error term estimated using formula 47 inequality may fulfilled subsystems loosely coupled guaranteed monotonic maxnorm stability condition since error resulting 410 oh 2 step might replaced decoupled implicit euler formula mode 1 result denoted e11 n subsection bdf2 relaxation 412 replaced 2 2 local error expansion constant step size 2 9 h 3 decoupled eulerbdf2 combination expected oh 3 error decoupled formula best stability properties expectation based fact decoupled implicit euler formula mode 1 stable partitioned system 22 monotonically maxnorm stable result exist decoupled bdf2 formula 410 yet another relaxation iteration 2 n 2 3 leads local error expansion principal local error term classical bdf2 46 including case variable step size principal local error term thus estimated using formula 47 computational cost using mode 1 rather high therefore following modes practical interest 442 mode 2 another possible choice yn computed 41 corresponding local error expansion constant step size 1 9 h 3 assuming principal local error term estimated using formula 47 subsystems loosely coupled another relaxation iteration would lead principal local error classical bdf2 principal local error term estimated using 47 443 mode 3 using mode obtain principal local error term classical bdf2 therefore also possibility estimating error using formula 47 use n decoupled bdf2 may give rise concern stability discretization 444 summary decoupled bdf2 formulas following table summarises local error results decoupled bdf2 formula combination mode number relaxations error oh 3 principal local error c 3 h 3 one additional relaxations yn relaxns 5 integration algorithm 51 general principles previous sections presented decoupled section 22 various iteration techniques approaching classical implicit euler formula section 23 asymptotic local error expansions given different modes employment corresponding local error estimation techniques section 43 finally similar results presented decoupled bdf2 sections 24 44 components used construct numerous integration algorithms design decisions may guided properties problem solved main objective integration algorithm solve problem specified accuracy using arithmetic operations possible following discussion deals decoupled implicit euler formula since stability results error bound apply formula bdf2 formula expected analogous properties implementation decoupled bdf2 formula similar implementation decoupled euler formula 511 mode local error bound 31 shows accurate value yn reduces influence partitioning local error according section 43 mode 2 preferred mode 1 accuracy computed little additional cost although ky p 0 reverse may true larger values hn mode 1 therefore preferred alternative approach improving accuracy yn relaxation 29 one relaxation iteration yn considered value relaxation increase mode attractive respect however relaxation computationally expensive used strictly necessary 512 partitioning error error due partitioning described matrix rj aggressive partitioning small subsystems otherwise scalar equations may lead rj matrix relatively large offdiagonal elements may diagonally dominant 24 according 31 error term including ky n may therefore contribute significantly conservative partitioning typically larger subsystems accommodate strong couplings assure numerically small offdiagonal elements rj error bound 31 clearly shows may lead decoupled euler formula essentially error properties classical formula gaussseidel organization 28 takes advantage nonsymmetric structure rj assume partitioned system 22 reordered symmetrically equation number variable number make rj close lower triangular possible ka rj rj k ae ka rj rj k 31 modified follows jr n jr n larger lower triangular n rj values multiplied smaller errors smaller upper triangular n rj values multiplied larger errors 513 stability stability assured matrix rj diagonally dominant 24 yn convex combination previous solution values mode 1 latter condition fulfilled diagonal dominance condition may fulfilled sufficiently conservative partitioning however monotonic maxnorm stability condition section 21 sufficient condition necessary condition therefore mode 2 may used without encountering stability problems also used diagonal dominance condition 24 fulfilled conservative partitioning 24 fulfilled closer fulfilled improve stability likely also accuracy cf previous section partitioning error however conservative partitioning leads computationally expensive discretization aggressive partitioning relaxation iterations mode 1 compromise stability furthermore monotonic maxnorm stability guarantees convergence process 52 implementation details algorithm use decoupled implicit euler formula bdf2 variable step size choose two different partitionings aggressive partitioning conservative partitioning aggressive partitioning uses smallest subsystems possible order computational cost conservative partitioning uses somewhat larger subsystems order maintain accuracy transient solution phases decoupled implicit euler formula used mode 2 relaxation iteration n 1 used two relaxation iterations n 2 quality partitioning monitored using 49 classical euler solution computed incurred cost mode 1 yn partitioning criterion therefore replaced 2 oe 1 mode 2 1 replaced 1 2 mode 1 used two relaxation iterations 2 n always available cost involved monitoring partitioning negligible mode 2 used one relaxation iteration therefore cost step partitioning monitored double cost ordinary mode 2 step since 2 n required 2 n available mode 2 seems obvious return 2 n result step yn 2 n since 2 n supposedly accurate 1 n however yn 2 n returned occasionally yn 1 n common result following example generates oscillations local error estimate failing improve accuracy therefore yn 1 n always returned mode 2 integration algorithm outlined follows initialisation step 1 ffl choose conservative partitioning n ffl error estimation step n n 41 compute 1 n decoupled backward euler formula using mode 2 2 computed mode 1 used predicted solution p n inaccurate explained monitor monitor partitioning ffl estimate principal local error term using 45 est ffl new step size tol est aggressive partitioning step size formula averages 1 tol est reduce tendency oscillations step size selection step size decreasing solution may entering transient phase requires conservative partitioning aggressive partitioning used number steps next monitor partitioning reduced decreasing n monitor partitioning chosen using following conditions monitor partitioning ffl mode 2 relax decoupled implicit euler formula extra time compute 2 n mode 1 use 1 n following test 1 2 1 choose aggressive partitioning else choose conservative partitioning shift conservative aggressive partitioning switch aggressive conservative partitioning reflects aggressive partitioning satisfactory switch opposite direction tentative since known conservative partitioning satisfactory aggressive partitioning may also satisfactory therefore first step switch direction monitored algorithm developed presented decoupled implicit euler mula modifications beyond obvious accommodate decoupled bdf2 small euler formula replaced decoupled bdf2 211 mode 3 first order predictor replaced second order predictor 42 except first integration step still taken euler formula second step uses decoupled bdf2 mode 2 principal local error estimated using 47 normalization fi local error estimate introduced 6 section iii2 est fik step size selection scheme modified slightly averaging used increasing step sizes est step size averaging useful increasing step sizes reduce risk instability prevents rapid reduction step size transients 6 examples chemical reaction kinetics example problem mathematical model chemical reactions included threedimensional trans portchemistry model air pollution air pollution model system partial differential equations equation models transport deposition emission chemical reactions pollutant use operator splitting number submodels obtained including following system nonlinear odes nonlinearities mainly products ie p l typically sums terms form c ilm ty l ym il ty l respectively l 6 chemistry model replicated node spatial discretization transport part numerical solution system 32 odes challenging replication results hundreds thousands millions equations efficient numerical solution crucial problem selection solution techniques employed far described 9 10 system odes stiff real part eigenvalues jacobian along solution ranging 0 gamma8 step sizes range 100 1000 therefore implicit integration schemes required resulting nonlinear algebraic problem main computational task involved advancing numerical solution one time step method based partitioning system called euler backward iterative method described 9 characterized discretization implicit euler formula block gaussseidel iteration solution algebraic equations discretization ideal partitioning would involve subsystems size one ie cf 22 chemical reaction kinetics problem would particularly advantageous since included l equations never p definition therefore l general linear solution scalar equation implicit integration formula performed without iterations partitioning scalar equations viable problem however paper 9 identifies total 12 equations solved blocks 4 4 2 2 equations numbering chemical species used table b1 9 block gaussseidel iteration proceeds follows parentheses denote blocks equations f1 2 3 12 4 5 19 21 6 7 8 9 10 14 15 remaining scalar equationsg partitioning 9 specified used basis partitioning used results 11 9 euler backward iterative formula relaxed convergence obtain equivalent classical implicit euler formula results 11 obtained decoupled implicit euler formula mode 2 one relaxation timing results 11 show good efficiency approach aggressive partitioning ordering used example decoupled implicit euler bdf2 described f12 4 5 20 scalar equations 1 2 15 16 remaining scalar equationsg subsystems two four equations enclosed parentheses rest equations treated scalar equations conservative partitioning ordering specified f12 1 2 15 16 4 5 remaining scalar equationsg except block 10 equations partitioning scalar equations partitioning considered aggressive another one fewer equations appearing blocks andor blocks smaller concerning two partitionings presented obvious partitioning aggressive since f4 5 1 2 15 16g ae f1 2 15 16 4 5 8 10 29 30g parentheses retained facilitate reference partitioning ordering specifications aggressive partitioning clearly aggressive partitioning presented 9 since f4 5 1 2 15 16g ae f1 2 3 12 4 5 19 21 8 9 15 16g relation conservative partitioning obvious since one larger block equations appearing smaller blocks partitioning used 9 presumably based knowledge chemical actions partitionings used obtained semiautomatic method described paper 12 none partitionings monotonically maxnorm stable although come close despite fact instability problems en countered surprising since monotonic maxnorm stability sufficient necessary condition stability decoupled implicit euler formula example used paper differs slightly example 9 differences appear equations treated scalar considered partitionings 61 decoupled implicit euler figure 61 shows errors obtained using classical implicit euler formula solid line decoupled implicit euler formula dashdot line implemented described section 5 two different partitionings mentioned used adaptively step size chosen decoupled global integration error time fig 61 integration error classical implicit euler solid line decoupled implicit euler dashdot line implicit euler algorithm obtain local error estimate 10 gamma3 minimum step size 90 classical implicit euler formula applied step size selection discrepancy errors seen insignificant reference solution computed using variable step size variable order max imum implementation backward differentiation formulas 13 bound relative local error estimate 10 gamma6 errors presented figures maximum relative deviations reference solution measured componentwise values components vary widely magnitude time axis seconds initial time corresponds 6 model includes influence sun chemical reactions leads distinct transients solution sunrise sunset minimum integration time step 90 seconds large step integrate transients accurately large spikes global integration error seen around 7 pm 5 t105000 next day 7 pm t155000 transient behaviour sunrise sunset extent considered modelling artifact since large local contribution global error influence global error large essentially ignored introducing minimum time step observed behaviour global error uncommon stiff systems odes figure 62 shows estimated principal local error step size adjusted keep estimate 10 gamma3 algorithm quite successful except transients minimum step size 90 used figure 63 shows resulting step size selection upper graph selection partitioning lower graph low value indicates aggressive partitioning high value indicates conservative partitioning values ordinate axis pertain step size total number steps 737 182 25 steps using conservative partitioning e estimated local error fig 62 estimated principal local error decoupled implicit euler time step size partitioning fig 63 integration step size selected decoupled implicit euler formula upper graph selection partitioning lower graph integration using conservative partitioning single steps use aggressive partitioning observed first step switch aggressive partitioning quality monitored satisfactory monitor partitioning algorithm immediately returns conservative partitioning example demonstrates application implementation decoupled euler formula solving nontrivial practical problem computational cost substantially less classical implicit euler formula trace instability solution computed decoupled implementation e global integration error fig 64 integration error classical bdf2 solid line decoupled bdf2 dashdot line time step size partitioning fig 65 integration step size selected decoupled bdf2 upper graph selection partitioning lower graph 62 decoupled bdf2 numerical integration previous section repeated using decoupled bdf2 step size controlled keep estimated local normalized error est 10 gamma3 resulting global integration error shown figure 64 dashdot line together corresponding error classical bdf2 using step size selection solid curve deviation noticed error decoupled bdf2 comparable error classical bdf2 formula comparing figure 61 seen global error decoupled bdf2 formula significantly smaller global error decoupled implicit euler formula difference originates mainly transients including initial transient minimum stepsize 90 seconds used finally figure 65 shows step size partitioning selection similar figure 63 maximum step size decoupled bdf2 greater 1700 three times maximum step size euler formula necessary number integration steps 311 42 number steps needed euler formula conservative partitioning used 73 steps 311 23 substantial payoff using decoupled bdf2 instead decoupled euler formula since amount work per step essentially two decoupled formulas performance decoupled bdf2 algorithm mode 3 convincing trace instability although use second order polynomial predictor computing yn somewhat risky stability point view acknowledgements comments editor anonymous referees helped choosing asymptotically correct error estimates improving presentation r waveform relaxation method timedomain analysis large scale integrated circuits methods parallel integration stiff systems odes stability backward euler multirate methods convergence waveform relaxation connection convergence properties waveform relaxation astability multirate integration methods solving ordinary differential equations control order steplength backward differentiation methods estimation errors derivatives ordinary differential equations photochemical kinetics mechanism urban regional computer modelling exploiting natural partitioning numerical solution ode systems arising atmospheric chemistry partitioning techniques stability decoupled integration formulas odes intgr integration stiff systems ordinary differential equations tr