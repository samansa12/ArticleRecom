parameter estimation deformable template model recent years number statistical models proposed purposes highlevel image analysis tasks object recognition however general models remain hard use practice partly result complexity partly lack software paper concentrate particular deformable template model proved potentially useful locating labelling cells microscope slides rue hurn 1999 model requires specification number rather nonintuitive parameters control shape variability deformed templates goal arrange estimation parameters way microscope users expertise exploited provide necessary training data graphically identifying number cells displayed computer screen additional statistical input required paper use maximum likelihood estimation incorporating error structure generation training data b introduction use highlevel models image analysis increased popularity last years problem interpretation understanding images become important one specific task models proposed object recognition locating objects scene providing estimates type position outline confocal microscopy image figure 1 one application showing optical section cartilage growth plate two types cell present one stage analysis data identify distinguish cells basis shape size manual segmentation cell would tedious time consuming task especially image forms one large number similar images great need automated procedure number different approaches statistical nonstatistical exist tackling task paper concentrate highlevel statistical model represents cell polygon outline model embedding deformable templates marked point process handle unknown number objects point process stochastic geometrical objects thus constructed conditioned observed data ie data image simulation techniques used generate samples posterior distribution samples used estimate quantities number objects type outline position although much progress understanding models recently remain somewhat inaccessible part due difficulty specifying many parameters associated work needed microscope users could routinely use techniques automatic extraction formation significant step towards goal would way automating parameter estimation parameters describing stochastic variations shape objects parameters data model aim paper provide solution way interaction microscope user estimation procedures purely graphical enduser supplies computerdrawn templates cells training data parameter estimation take form polygons fitted screen display image data plan paper follows section 2 review highlevel deformable template model propose likelihood model suitable confocal microscopy applications section 3 briefly discuss inference model using reversible jump markov chain monte carlo methods discuss parameter estimation section 4 treating image degradation parameters fully bayesian way using likelihood methods remaining parameters concentrate deriving maximum likelihood estimates deformation parameters assumption training data recorded measurement error due imperfect handtracking individual cells conduct studies latter estimation problem section 5 using artificial data comparisons made known values also using cartilage data set adopting bayesian approach denote scene x recorded pixellated data posterior interest given xjy yjx x since concerned components ie cells scene x specified highlevel variable composed unknown length list constituent components scene approach pioneered grenander coauthors recent sources references found grenander miller 1994 jain zhong lakshmanan 1996 baddeley van lieshout 1993 blake isard 1998 21 object prior x prior model random configuration cells built around stochastic template model single cell embedded mixture model different cells types used mark distribution marked point process model 211 template model single cell prototypical cell described nsided template defined set vectors give edges polygon figure 2a example one type cell characteristically circular edges describe polygonal approximation circle closure polygonal template equivalent condition described way template location information consider first vertex located origin second located g 0 second figure 2b order accommodate scaling rotational effects template may globally scaled scalar r rotated angle ff figure 2c model natural shape variability occuring cells type edge g subject stochastic deformation incorporates scaling r rotation ff plus additional edgespecific gaussian deformation length direction figure 2d final edgespecific effect describes change length direction undeformed g new edge prior global scaling rotation writing deformed edge rff representing changes thus haver sin ff cos ff rff writing 0 determines rff gammar sin specifying distribution r angular radial components bivariate gaussian zero correlation conditional fixed values r ff 0 independent gaussians mean zero ignoring moment constraint deformed template must closed ie suggest first order cyclic markov structure ft 0 ft 1 independently ndimensional gaussian distribution mean 0 circulant inverse covariance matrix incorporating scaling entries zero define length 2n vector considering unconstrained nonclosed polygon case imposing closure constraint deformed template destroy simple structure 2 derive distribution closure constraint section 422 212 marked point process multiple objects possible allow objects different types forming mixture model using different basic templates different deformation parameters weights mixture model represent relative frequencies occurrence refer rue hurn 1999 details mixture distribution used mark distribution marked point process model model unknown number objects baddeley van lieshout 1993 within framework object x comprises point gives location unspecified deformation model set marks specify attributes case type outline points lie window related data observation coordinates marks space associated object types shapes configuration cells described finite unordered set object process ie marked point process theta poisson object process basic reference process poisson process conditional number objects k objects uniformly identically distributed joint density fx defined density fx poisson object process example model pairwise interactions objects defined neighbours relation function could used van lieshout 1995 discusses various interaction models model situation objects allowed overlap confocal microscopy images optical sections objects defined neighbours interaction function hx taken zero objects x x j overlap one otherwise model known hard core object process take point denoted c location first vertex object first mark categorical variable defining object type remaining marks deformations standard template type refer rue syversveen 1998 details 22 poisson likelihood model yjx confocal microscopy confocal microscopy produce relatively highquality sectional images certain specimen types technique works scanning focal point laser stained specimen fluorescence emitted focal point recorded image built grid fluorescent dye concentration measurements likelihood model data approximates microscope measuring fluorescence photon counts begin assuming cells typical fluorescence level background emits fluorescence signal measured 8 bit scale ie integers 0 255 order minimise clipping signal operator adjusted experimental stage scale factor shift b mean background value b mean foreground value b sufficiently far ends range measurement addition recording process involves additive instrument white noise approximate record pixel p gaussian random variable mean equal blacklevel b plus expected scaled poisson count p variance equal variance instrument noise oe 2 plus scaled expected poisson count variance p2cell indicator whether pixel labelled cell background fy p g assumed conditionally independent given configuration x inference highlevel object model resort markov chain monte carlo techniques refer gilks richardson spiegelhalter 1996 introduction list references key idea construct markov chain posterior equilibrium density estimate expected values empirical average along trajectory realization markov chain makes possible access estimated expected values uncertainty represented estimated variance estimated marginal density construct markov chain need set basic transition rules take us around statespace hopefully moving efficiently around thereby creating good estimates low variance empirical averages basic transition types problem follows ffl change part template boundary randomly chosen object ffl change type object ffl propose birth new object ffl propose death object details mcmc algorithm transitions given rue husby 1998 rue syversveen 1998 birth death moves rely applications green 1995 algorithm variable dimension distributions practice basic transitions listed ensure sufficient mixing markov chain main problems transitions various object types difficulties uncertainty whether one object actually two objects lying close together rue hurn 1999 approach problem extending template model allow variable number sides demonstrating allows smoother transitions object types easing transitions split merge objects model described previous sections relies specification parameters controlling marked point process prior degradation model parameters particularly involved deformations hard interpret intuitive way section propose parameter specification approach hopefully allow models type widely used practice parameters degradation process handled bayesian way remaining parameters estimated using maximum likelihood methods 41 bayesian treatment degradation parameters unknown parameters measurement process typical fluorescence level b operator controlled measurement adjustments oe 2 recording noise since estimation parameters section image data would dependent good initial segmentation propose instead treat hyperparameters choice prior distributions intended mainly impose constraints variables positive 255 noise variance rather precision given 2 1 prior distribution since expected order squared pixel units mean fluorescence given fairly diffuse 2 255 prior reflecting positive variable expected take reasonably large value although vary considerably specimens data carry considerable information regarding parameters intended priors exert much influence refer hurn 1998 discussion similar setting joint posterior distribution interest markov chain monte carlo methods needed sampling generally done one parameter time requiring conditional posterior distributions pixels p2cell pixels p2cell 42 estimation prior model parameters computationally feasible treat remaining parameters similar bayesian manner since would require intractable normalising constants depend parameters alternative suggest use likelihoodbased methods work training data generated microscopist tracing cell outlines number slices image data using computer mouse method two benefits first microscopists expertise used data collection second userinteraction estimation procedure 421 marked point process parameters p fl use hardcore interaction model marked point process means normalising constant complex maximum likelihood estimation however previous experience object recognition problems suggests results particularly sensitive specification parameters propose use naive estimators observed proportions different cell types training data fp g observed frequency per unit area fl estimators least accurate situations significant packing observed training data case alternative simulate prior model first estimated deformation parameters searching range values fp g fl match observed simulated frequencies approach could coded advance also note recent work baddeley turner 1998 use maximum pseudolikelihood methods fit various point processes although approach would considerably complex 422 deformation parameters fi ffi tracking errors derive likelihood function fi ffi using data number polygons vertices observed error although inclusion observation error complicates derivation realistic assumption given intended manner collecting training data begin transforming deformation model polygon edges model corresponding vertex locations recall first vertex defines location entire polygon first vertex location second vertex v 1 located rff note vertices nonclosed polygon considering x components separately vertices x gammag xg gammag x gammag xg gammag x gammag x 1t 1t 1 2n theta 2 matrix whose first column consists n 1s followed n 0s whose second column n 0s followed n 1s v rff vector vertex x positions undeformed template first vertex zero rotated ff scaled r write 3 form assume record n vertices closed polygon error assume errors normally distributed since true location polygon unobservable begin finding unconstrained distribution v given r ff phi ffl 0 observable 3 4 distribution denoting marginal variance ffl x 22 unconstrained distribution find distribution v arbitrary v reorder components v x components vertex pairs rewriting 5 partitioning mean variance correspond partitioning sets v v n note ev n jr ff phi closure undeformed template v rff denote partitioned inverse variance matrix also rearrange ordering fffl g manipulation conditional density v show appendix particular v interested v 0 ie case find distribution vertices closure constraint use known marginal distribution together 8 integrating ffl 0 show appendix phi 22 first 2n gamma 2 components reordered reordered distribution conditioning uses 4 since ffl may independent ffl 0 resulting distribution phi 22 phi distribution v 0 arises convolution distribution v 0 distribution ffl 0 assuming v 0 uniformly distributed observation window variance ffl 0 small comparison window size v 0 taken also uniformly distributed window finally assumption independence polygon shapes likelihood cells product individual likelihoods finally since many applications reasonable assume scale rotation cell known model allows cell associated scaling r rotation ff concentrate case common unknown r cells would used example size distinguishing characteristic cell recognition treating scale rotation additional nuisance parameters adds parameters r ff optimisation order obtain maximumlikelihood estimates however appendix show rotation optimisation may done exactly set fi ffi r phi thus reducing computational burden 5 examples estimation deformation parameters 51 artificial example begin artificial example demonstrate properties estimation procedure since allows us consider effect various model misspecifications basic template experiments eightsided regular approximation circle radius 1 deformation model takes parameters analytically intractable find maximum likelihood estimates fi ffi matlab mathworks inc 1994 used numerical optimisation also used direct entry vertex locations using mouse 511 effect model misspecification order assess importance deriving maximum likelihood estimates assumption measurement error recording vertices simulated realisations deformed template model generated using independent measurement errors variance oe 2 estimates fi ffi found data misspecifying oe 2 table 6 shows mean median estimates resulting 250 repetitions procedure assess variability estimates surprisingly true variance increases estimates become severely biased fi ffi decrease since observed shapes demonstrate greater variability less smoothness expected similarly possible fit model measurement error scale r rotation ff assumed known incorrectly specified effect observed polygons expected shapes attempt fit incorrectly specified template oe 2 1 overestimated balance fi perturbed point degeneracy latter effect due extremely high correlations required deformations needed order mimic rotation rescale 512 estimation different error models seen importance including measurement error modelling investigate different possible models tracking errors seems unlikely errors practise independent consider following three structures independent errors firstorder markov structure variance phi 1 circulant structure oe 1 diagonal oe 2 second diagonal model 3 firstorder markov structure inverse variance phi phi 1 although note oe 1 oe 2 different interpretations model 2 3 training data set simulated cell outlines takes values 25 50 100 simplest noise model also found estimates scale rotation taken unknown nuisance parameter r takes value 1 table 2 summarises results numerical experiments figure 3 shows pairwise scatterplots four estimated parameters case independent noise model 1 unknown scale rotation mean median estimates quoted cases highlight skewed nature sampling distribu tions feature also seen figure 3 marginalising eye figure 3 also demonstrates high correlation structure within estimates particularly fi ffi deformation parameters observation error variance relationships might explained noting unconstrained model whose inverse variance given 1 variance particular given remaining 0 components 1fi correlation two consecutive 0 given remaining components gammaffifi near nonidentifiability due partitioning variability observed vertex locations due deformations due observational error one reasons estimation problem particularly difficult 52 estimation imaging figure 4 shows two template types together 100 cell outlines traced one authors series images cell cartilage display purposes outlines relocated regular grid scalings rotations altered using training data proposed estimation technique applied assuming unknown scale r rotation common measurement error template types three measurement noise models considered table 3 gives resulting parameter estimates together quantity gamma2theta natural logarithm likelihood parameter estimates quantity used determining three models appropriate using akaike information criterion using criterion noise model 3 chosen figure 5 shows simulations fitted model top row shows 50 realisation two deformed template models bottom row shows realisations convolved realisations fitted noise model note rotations set value zero displaying outlines consequently appear less ordered figure 4 result natural structure cartilage 6 discussion userfriendly techniques parameter estimation deformable template models important issue models find widespread acceptance applied work recent work kent dryden anderson 1998 also considered question estimators deformation parameters although valid circular objects observed without measurement error demonstrated possible treat parameters necessary bayesian object recognition approach either fully bayesian way requiring graphical intervention microscope user hope approaches facilitate work area statistical image analysis collaboration endusers techniques r practical maximum pseudolikelihood spatial point patterns stochastic geometry models highlevel vision active contours markov chain monte carlo practice reversible jump mcmc computation bayesian model determination hands pattern theoretic study biological shapes representations knowledge complex systems discus sion confocal fluorescence microscopy leaf cells application bayesian image anal ysis object matching using deformable templates using circulant symmetry model featureless objects bayesian object identification partly destroyed objects using deformable templates bayesian object recognition baddeleys delta loss markov point processes applications highlevel imaging discussion tr