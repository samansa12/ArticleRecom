power balance apportionment algorithms united states congress measure performance task apportioning congress united states algorithm combining heuristicdriven simulated annealing search exactcomputation dynamic programming evaluation apportionments visited search compare actual algorithm currently used united states apportion congress number algorithms proposed conclude every set census data countrys history heuristicdriven apportionment provably yields far fairer apportionments algorithm considered including algorithm currently used united states congressional apportionment b 1 motivation overview seats house representatives united states allocated among states constitution stipulates representa tives shall apportioned among several states according respective numbers counting whole numbers persons obvious implementation requirement would almost always yield fractional numbers seats issue achieve fair integer seat allocations controversial country virtually since founding fact many apportionment algorithms discuss proposed debated famous historical figures including john quincy adams alexander hamilton thomas jefferson daniel webster debate far fact relative fairness two algorithms discuss paper argued supreme court 1992 supreme 1992 1 propose apportionment method consisting simulatedannealing search aimed maximizing fairness resultant apportionments even though complexity algorithm high implementation shows method feasible cases interest deed able run data conducted census years us history results conclusive cases method provably superior respect widely agreed fairness criteria prominent apportionment algorithms used proposed earlier balinski young 1982 see also balinski young 1985 performed detailed comparative study six historical algorithms congressional apportion ment degree algorithms allocations matched states quotas ie portion population times house size mann shapley mann shapley 1960 mann shapley 1962 others studied actual used incongress seat allocations power indices electoral college state paper attempts combine strengths two research lines particular agree balinski young allocations fair light 200 years debate colorfully recounted analyzed balinski young 1982 obtaining new insights merits weaknesses six historical algorithms priority hand many feel fairness defined tight match power quotas rather allocations quotas feeling much harmony modern political science theory widely recognized allocations briefly put supreme court ruled congress acted within authority choosing currently used algorithm huntingtonhill method however supreme courts decision left open possibility congress would acting equally within authority chose adopt algorithm court ruled constitutional frameworkdelegates congress measure discretion broader accorded states terms choosing apportion congresss apparently goodfaith decision adopt huntingtonhill method commands far deference particularly made decades experience experimentation debate supported independent scholars accepted half century supreme 1992 regarding decision mention power balancing issues discussed paper brought court nonetheless experimental results paper suggest among two algorithms discussed court case huntingtonhill algorithm fact gives fairer apportionments terms power balancing power balance apportionment algorithms delta 3 necessarily directly correspond power power indices see detailed definitions later paper provide potentially accurate gauge power see eg discussions shapley 1981 riker ordeshook 1973 2 light repeat comparative study balinski young replace allocation comparisons power index comparisons course historical algorithms designed partthe full story complex political indeed led first presidential veto see balinski young 1982 achieve degree harmony fairness allocations quotas surprising given power indices yet invented however given study comparisons based power indices seems natural add six historical algorithms 3 algorithm tailored achieve harmony power indices quotas used heuristic based simulated annealing paradigm see aarts korst 1989 metropolis et al 1953 kirkpatrick et al 1983 finds apportionment seeking achieve local minimum distance normalized power indices quotas attribute local respect natural neighborhood relation apportionments heuristic yields results fairer obtained historical algorithms report section 3 results last census 1990 obtained similar results census years 1790 1800 1980 1990 function class p first defined valiant valiant 1979a valiant 1979b counting version np p class functions f nondeterministic polynomialtime turing machine n inputs x holds fx number accepting computation paths nx one problem studying power indices power indices typically pcomplete prasad kelly 1990 garey johnson 1979 consequently perform combinatorial search invokes iteration numerous pcomplete computations fortunately dynamic programming approach first proposed mann shapley 1962 yields pseudopolynomial algorithm computing power indices ie algorithm whose running time polynomial size house number states since quantities reasonable values throughout us history maximum values 435 50 also current values able exactly compute needed power indices 2 unfamiliar allocations may correspond power consider following typical motivating example suppose states b c 6 2 2 votes respectively note though states b c 40 per cent seat allocation nonetheless case majorityrule vote polarizing issue states differing interests delegations vote blocs b c power majority 3 use context six historical algorithms mean suggest algorithms proposed algorithms indeed proposed eg algorithm condorcet suggested 1793 condorcet 1847 see balinski young 1982 p 63 however six algorithms key contenders apportionment discussion united states 2 discussion section justify number decisions made designing study describe detail background study 21 study design computer program takes input list states hs tions h parameters regarding random number generation implementation simulated annealing algorithm program computes state appropriate quota considered banzhaf power index shapleyshubik power index represent widely used quantitative ways measure power player state parlance voting game wellknown two indices least artificially constructed examples differ sharply see eg straffin 1978 references therein shapley 1981 straffin 1977 paper seek resolve broader question whether power indices correct appealing measures power whether thus used shape votingapportionment systems issues political science experimental algorithms though much discussion literature naturalness usefulness power indices study simply seeks provideto place value power indicesquantitative information comparative power distributions historical apportionment algorithms simulated annealing hope information also useful political science debate general issue choosing right apportionment scheme section 4 mention directions information suggests banzhaf power index see eg detailed discussion dubey shapley 1979 defined terms winning coalitions winning coalition subset states sum votes states larger half total number votes course equal house size state critical coalition 2 b winning coalition c gamma fig winning coalition banzhaf power index state definition probability randomly chosen coalition coalition chosen randomly set possible coalitions set winning coalitions holds critical shapleyshubik power index shapley shubik 1954 defined terms linear orderings states intuitively represent extent states interested passing bill first state ordering strongest supporter bill last one strongest opponent let ordering state pivot ordering appears position k critical coalition formed first k states words pivot ordering state whose joining turns developing coalition winning coalition shapleyshubik power index state probability randomly chosen ordering holds pivot power balance apportionment algorithms delta 5 order calculate closeness power indices quota normalize pow power index banzhaf shapleyshubik state define normpow recall h house size normalization used mann shapley 1960 rest discussion power state mean normalized power index banzhaf shapleyshubik note h thus normalized powers make easier compare powertoquota closeness 4 main metric used evaluate powertoquota closeness l 2 metrics applied proportions defined l 2 proportions 0in although measures used feel l 2 proportions relevant one performed experiments also respect l 1 metric differences proportions l 2 differences cases reached conclusions completeness definitions three metrics l 1 differences 0in l 2 differences 0in l 1 proportions 0in contrast difference proportion measures dramatic example suppose states b quotas 15 405 respectively given 2 41 votes differences measures treat two states similarly proportions measures state viewed far balance state b however repeat conclusions investigation remain irrespective metric used program apportions votes via six historical algorithmsadams dean huntingtonhill abbreviate hhill tables method also sometimes referred literature simply hill method webster sometimes also referred literature websterwillcox method jef ferson hamiltonand simulated annealing algorithms work follows let us first discuss algorithms adams dean huntingtonhill webster jefferson informally work follows one partitions nonnegative real 4 note many researchers prefer use banzhaf index without normalization 6 delta la hemaspaandra et al line adjacent intervals corresponding number votes one seeks integer one divides states population integer give state number votes corresponding interval value falls sum votes handed equals desired house size formally let say apportionment hv 0 v 1 5 sliding divisor apportionment respect exists real number five historical sliding divisor algorithms defined follows see also balinski young 1982 adams dean huntingtonhill webster jefferson note particular dean huntingtonhill webster algorithms describe intervals respectively harmonic geometric arithmetic means successive integers algorithm currently use united states method geometric means ie huntingtonhill algorithm important caveat constitution requires state given least one representative however artificial requirement would taint comparative analysis algorithms study allow algorithms assign zero votes state example 1990 census data jefferson algorithm allocates 0 votes wyoming learn whether ignoring constitutions one vote minimum rule affected results also ran program added proviso sliding divisor algorithms allowed assign 0 votes state achieved setting 1 0 1 0 obtained result simulated annealing algorithm still best jefferson algorithm still worst 5 hard see exists unique solutions always exists example sliding divisor algorithm apportion two equal states odd house size however five historical sliding divisor algorithms large populations random independent loworder bits informally actual populations nonexistence solutions unlikely occur historical census data never occurred power balance apportionment algorithms delta 7 hamilton algorithm quite different sliding divisor algorithms described hamilton algorithm initially assigns state exactly votes assigns one extra vote h gamma states largest values q ties fractional part cause algorithm fail welldefined practice unlikely occur indeed never actual historical census data finally simulated annealing algorithm propose works follows let us say two apportionments neighbors b obtained shifting one vote state state j ie exist j 6 j apportionment summing h made relatively arbitrary way algorithm used program intentionally makes initial apportionment gives terrible match powers quotas thus rest simulated annealing algorithm try fix poor initial assignment repeatedly neighbor b current apportionment randomly generated b least good sense b powertoquota distance greater b becomes current apportionment even new apportionment b worse still chance become current apportionment namely let delta difference powertoquota distance b powertoquota distance since case b worse delta positive throughout process consider current temperature gradually decreasing time given number iterations occurred current temperature decreased multiplying certain constant less one called cooling let value current temperature randomly generate real number r r e gammadeltat b taken current apportionment place observe temperature approaches value zero probability r less e gammadeltat gets smaller smaller thus initial period jumps various descending hills leading local optima likely process stabilized freezes ie probability choosing apportionment worse current one becomes close zero high probability local optimum hope simulated annealing approach local optimum much worse quality global optimum exact stopping criterion explained section 3 results simulated annealing algorithm course sensitive values initial temperature cooling factor well choice initial apportionment intention finetune values rather prove historical methods easily soundly beaten modern computer sciencebased heuristic approach inputs drawn real census data want emphasize realization goal report section 3 results one rather arbitrary setting parameters plan pursue future thorough investigation impact parameter settings apportionment problem digress mention algorithm potentially beat greedy algorithm 6 step choose better neighbor current ap 6 however real census data used greedy algorithm yielded results 8 delta la hemaspaandra et al portionment stuck local optimum indeed found fourstate instance greedy algorithm gets stuck local optimum global optimum instance 100 representatives must apportioned 4 states populations 823 801 105 101 seen 50 34 14 2 two local optima better b referring shapleyshubik power index defined however starting b going atleastasgoodas b neighbors way reach ie b transitive closure binary relation neighbor atleastasgoodas b moment pass apportionment form 44 verified apportionments form worse b thus reachable b greedy algo rithm certain precise sense smallest example particular simple prove examples one 2 3 states 2 3 state cases locally optimal apportionments also globally optimal prasad kelly 1990 shown banzhaf power index pcomplete garey johnson 1979 shown shapleyshubik power index pcomplete complexity class p usual denotes counting version np valiant 1979a valiant 1979bp class functions f nondeterministic polynomialtime turing machine n x holds fx number accepting computation paths n input x much past 20 years research theoretical computer science devoted proving npcomplete problems thus pcomplete functions cannot feasibly computed unless wide range implausible consequences occur see survey sipser 1992 example toda 1991 see also beigel et al 1991 toda ogiwara 1992 gupta 1995 regan royer 1995 shown turing access p subsumes entire polynomial hierarchy however dynamic programming approach allow us perform exact computation banzhaf power index shapleyshubik power index even relatively large inputs censuses involving 50 states dynamic programming approach problem proposed mann shapley 1962 use notation previous section algorithm involves state constructing matrix c order house size number states also let q minimum number votes needed winning coalition ie 1 entries matrix following represents number coalitions containing state k states whose votes sum j let c jk number coalitions containing k states close given simulated annealing algorithm particular also beating historical algorithms true even though implementation greedy algorithm accepted first local improvement found rather enumerating neighbors accepting one yielding steepest descent power balance apportionment algorithms delta 9 whose votes sum k observe also following recurrence holds note recurrence predecessor jk find banzhaf power index state compute number coalitions critical divide total number coalitions value given coalitions containing losing addition find shapleyshubik power index state compute number linear orderings pivot divide total number linear orderings value given thus computation power indices reduces computation entries matrix c determined calculating iteratively matrices shortcuts obtained using following observations note equations 21 22 need entries 1 looking complementary coalitions one see c thus entries matrix column index k n gamma 12 computed using formula entries k n gamma 12 done largest row index j need still qgamma1 consequently compute quarter entries matrix c namely entries row index verifying verifying computed matrix c state dont start scratch passing state i1 compute i1 c indeed difficult see i1 c convention entries negative row column index 0 algorithm polynomial n q course polynomial length natural encoding input instance reasonable encodings q bits nevertheless since censuses far h 435 able compute exact values banzhaf shapleyshubik census years 1790 1800 1810 1980 state pop quota sab sass adams dean hhill webst jeffer hamilt oh 10847115 190206 19 19 mi 9295297 162995 mo 5117073 89729 9 9 9 9 9 9 9 9 wi 4891769 85778 9 9 9 9 9 9 9 9 co ia ms totals 248072974 4350000 435 435 435 435 435 435 435 435 table 1 states populations quotas apportionments l2ofproportions evaluation power balance apportionment algorithms delta 11 state quota sab adams dean hhill webst jeffer hamilt il 200437 198279 187446 197091 197097 197102 206716 197102 mi 162995 157744 157255 156914 156919 156924 166546 156924 ga 113597 117810 107599 107400 107404 107408 107208 107408 105499 107900 97745 97569 107404 107408 107208 107408 97218 98015 97745 97569 97573 97577 97399 97577 mo 89729 88152 87913 87758 87761 87765 87609 87765 wi 85778 88152 87913 87758 87761 87765 87609 87765 tn 85522 88152 87913 87758 87761 87765 77834 87765 md 83844 88152 78098 77964 77967 77970 77834 77971 mn 76718 78308 78098 77964 77967 77970 77834 77971 la 73998 78308 78098 68185 68188 68191 68074 68191 al 70852 68482 68301 68185 68188 68191 68074 68191 ky 64622 68482 68301 58420 58422 58425 58326 58425 az 64270 68482 68301 58420 58422 58425 58326 58425 sc 61140 58671 58517 58420 58422 58425 58326 58425 co 57768 58671 58517 58420 58422 58425 58326 58425 ct 57640 58671 58517 58420 58422 58425 58326 58425 ia 48691 48873 48746 48666 48668 48670 48589 48670 ms 45122 48873 48746 48666 48668 38925 38861 38925 ks 42919 39085 48746 38922 38923 38925 38861 38925 ar 41220 39085 38984 38922 38923 38925 38861 38925 wv 31449 29307 29231 29185 29186 29187 29139 29187 ut 30210 29307 29231 29185 29186 29187 29139 29187 ne 27677 29307 29231 29185 29186 29187 19423 29187 nm 26567 29307 29231 29185 29186 29187 19423 29187 hi 19433 19534 19484 19453 19454 19455 19423 19455 id 17654 19534 19484 19453 19454 19455 09711 19455 ri 17596 19534 19484 19453 19454 19455 09711 19455 mt 14012 09766 19484 19453 09726 09727 09711 09727 nd 11201 09766 19484 09726 09726 09727 09711 09727 wy 07954 09766 09741 09726 09726 09727 00000 09727 totals 4350000 4350000 4350000 4350000 4350000 4350000 4350000 4350000 table 2 states quotas normalized powers banzhaf power index l2ofproportions state quota sass adams dean hhill webst jeffer hamilt il 200437 200487 189942 199876 199858 199834 209756 199779 oh 190206 190005 179516 mi 162995 158872 158820 158399 158385 158366 168206 158324 ga 113597 118058 107941 107662 107653 107640 107362 107612 105499 107974 97907 97656 107653 107640 107362 107612 97218 97938 97907 97656 97647 97636 97384 97611 mo 89729 87947 87920 87695 87687 87677 87452 87654 wi 85778 87947 87920 87695 87687 87677 87452 87654 tn 85522 87947 87920 87695 87687 87677 77565 87654 md 83844 87947 77977 77779 77772 77763 77565 77743 mn 76718 78001 77977 77779 77772 77763 77565 77743 la 73998 78001 77977 67907 67902 67894 67721 67876 al 70852 68100 68080 67907 67902 67894 67721 67876 ky 64622 68100 68080 58079 58075 58068 57921 58053 az 64270 68100 68080 58079 58075 58068 57921 58053 sc 61140 58244 58226 58079 58075 58068 57921 58053 co 57768 58244 58226 58079 58075 58068 57921 58053 ct 57640 58244 58226 58079 58075 58068 57921 58053 ok 55158 58244 58226 58079 58075 48285 48164 48273 ia 48691 48430 48416 48295 48291 48285 48164 48273 ms 45122 48430 48416 48295 48291 38545 38448 38535 ks 42919 38660 48416 38553 38549 38545 38448 38535 ar 41220 38660 38649 38553 38549 38545 38448 38535 wv 31449 28933 28924 28853 28850 28847 28775 28840 ut 30210 28933 28924 28853 28850 28847 28775 28840 ne 27677 28933 28924 28853 28850 28847 19143 28840 nm 26567 28933 28924 28853 28850 28847 19143 28840 nv 21074 19247 19242 19194 19193 19190 19143 19186 hi 19433 19247 19242 19194 19193 19190 19143 19186 id 17654 19247 19242 19194 19193 19190 09551 19186 ri 17596 19247 19242 19194 19193 19190 09551 19186 nd 11201 09603 19242 09577 09576 09575 09551 09573 wy 07954 09603 09600 09577 09576 09575 00000 09573 totals 4350000 4350000 4350000 4350000 4350000 4350000 4350000 4350000 table 3 states quotas normalized powers shapleyshubik power index l2of power balance apportionment algorithms delta 13 algorithm quota repnormed power distance l2ofproportions metric hhill 0375372 webst 0387777 hamilt 0394220 dean 0438127 adams 1821126 jeffer 1906251 table 4 errors quotas repnormed power banzhaf power index l2of proportions evaluation metric algorithm quota repnormed power distance l2ofproportions metric hhill 0382663 webst 0401829 hamilt 0411409 dean 0424247 adams 1687721 jeffer 1974655 table 5 errors quotas repnormed power shapleyshubik power index l2ofproportions evaluation metric 3 results present results program 1990 census table 1 shows populations quotas 1990 census well apportionments result six historical algorithms simulated annealing algo rithm banzhaf column label sab shapleyshubik column label sass power indices course columns reporting results simulated annealing algorithm need labeled banzhaf shapleyshubik simulated annealing columns apportionment dependent power index used tables 2 3 show normalized power indices tables 4 5 show distance powers quotas according l2onproportions metric tables represent runs following parameters used simulated annealing algorithm cooling factor 09 7 initial temperature 100 number iterations per 7 ideally simulated annealing done cooling factor close 1 possible conceptually gentle cooling likely achieve good result due limited computing resources availablesun sparcstation 10s serving shared cycle serverswe use cooling factor severe would ideally chosen note computational limitation anything degrades quality simulated annealing apportionment yet even handicap simulated annealing algorithm outperformed historical algorithms also note experimental algorithms paradigm successful important useful people access supercomputers also people using modest computing facilities hope study modest workstation performed computations showing simulated annealing outperforms currently used algorithm example 14 delta la hemaspaandra et al formed temperature 1000 stopping factor 5 stopping factor used control termination follows recall temperature algorithm generates considers coolingiter potential swaps decreases current temperature via temperature temperature coolingfactor however algorithm also keeps track many potential swaps considered since last swap performed recall swap performed either improves quality current state degrades quality current state randomly chosen via temperature based probabilistic condition discussed section 21 number reached coolingiter stoppingfactor informally last stoppingfactor temperatures move madeexcept analysis wrap around border temperatures algorithm stops current seat allocation output 4 conclusions census years banzhaf shapleyshubik power index simulated annealing algorithm provides power balance harmony quotas historical algorithms course overly shocking algorithms tailored achieve certain harmony quotas votes apportioned rather quotas normalized power vectors induced votes apportioned generally simulated annealing algorithm achieves strong performance shifting votes away larger states even largestatehostile adams algorithm quite largestatehostile simulated annealing algorithm sense fact noted elsewhere apparent state quotas normalized powers tables section 3 power indices often disproportionally skew power towards large statesthe socalled big state biasis something simulated annealing algorithm able attempt directly remedy thus ones notion fairness close match normalized banzhaf shapleyshubik power indices states vector quotas simulated annealing algorithm strong contender seems provide better match historical algorithms results also suggest one limits ones universe six historical algorithms united states chosen correct one least terms performance respect historical census data huntingtonhill algorithm seems powerfair historical algorithms albeit far less fair simulated annealing indeed 1990 tables one see simulated annealing huntingtonhill algorithm treated small states states receiving five seats identically difference apportionments relative huntingtonhill algorithm simulated annealing shifts voting weight away large states towards middlesized states political implications results somewhat surprising fact adamss algorithm gives large states eg california far fewer seats quotas would seem entitle might suggest large states cheated adamss algorithm indeed scholarly analyses balinski young 1982 supreme court decision mentioned earlier supreme 1992 primarily concerned correspondence seats quotas power balance apportionment algorithms delta 15 however study shows clearly bias power indices show towards large states pronounced overwhelms vote skewing towards small states adams algorithm course tables show largestateskewed algorithm jeffersons even strikingly grants disproportionately much power large states overall terms fairness results suggest current apportionment algorithm used united states huntingtonhill algorithm gives disproportionately much power large states cost giving disproportionately little power middlesized states treating small states fairly final note nothing meant suggest simulated annealing algorithm might politically feasible quite possible probabilistic implementation vote allocation chosen might depend seed given random number generator worse still possible least artificial exam ples different vote allocations would achieve degree quotapower harmony thus algorithm would suggest preference allo cations legislators might well strong differing preferences acknowledgments first author bridging fellow university rochesters department political science work started thanks departments faculty encouraging interest political science voting systems helpful conversations particular including suggesting discussion final paragraph conclusions section also thanks university rochester fellowship gratefully acknowledges lifelong debt michel balinski many years ago introducing study apportionment research authors grateful william lucas claremont graduate school peter van emde boas university amsterdam proofreading earlier version helpful comments also thank joe malkevitch helpful comments grateful acm journal experimental algorithmics editor bernard moret two anonymous referees valuable comments suggestions authors alone course responsible errors r simulated annealing boltzmann machines stochastic approach combinatorial optimization neural computing fair representation meeting ideal one man fair representation meeting ideal one man probabilistic polynomial time closed parity reductions plan de constitution mathematical properties banzhaf power index mathematics operations research 4 computers intractability guide theory npcompleteness closure properties witness reduction values large games values large games equations state calculations fast computing machines closure properties bounded twosided error complexity classes introduction positive political theory measurement power political systems method evaluating distribution power committee system history status p versus np question probability models power indices pp hard polynomialtime hierarchy counting classes least hard polynomialtime hierarchy complexity computing permanent complexity enumeration reliability problems tr