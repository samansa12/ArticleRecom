discontinuityadaptive smoothness priors computer vision abstracta variety analytic probabilistic models connection markov random fields mrfs proposed last decade solving low level vision problems involving discontinuities paper presents systematic study models defines general discontinuity adaptive da mrf model analyzing euler equation associated energy minimization shows fundamental difference different models lies behavior interaction neighboring points determined priori smoothness constraint encoded energy function important necessary condition derived interaction adaptive discontinuities avoid oversmoothing forms basis class adaptive interaction functions aifs defined da model defined terms euler equation constrained class aifs solution c1 continuous allows arbitrarily large bounded slopes dealing discontinuities continuous nature stable changes parameters data good property regularizing illposed problems experimental results shown b introduction moothness generic assumption underlying wide range physical phenomena characterizes coherence homogeneity matter within scope space interval time one common assumptions computer vision models particular formulated terms markov random fields mrfs 1 2 3 regularization 4 applications seen widely image restoration surface reconstruction optical flow motion shape x texture edge detection region segmentation visual integration assumption uniform smoothness implies smoothness everywhere however improper imposition lead undesirable oversmoothed solutions occurs uniform smoothness violated ex ample discontinuities abrupt changes occur necessary take care discontinuities using smoothness priors therefore apply smoothness constraint wile preserving discontinuities one active research areas level vision see eg 5 6 1 7 3 8 9 10 11 12 13 14 15 16 17 18 paper presents systematic study smoothness priors involving discontinuities results based analysis euler equation associated energy minimization mrf regularization models z li currently school electrical electronic engineering nanyang technological university singapore 2263 e mail szlintuixntuacsg analysis identified fundamental difference among different models dealing discontinuities lies ways controlling interaction neighboring points thereby important necessary condition derived regularizers mrf prior potential functions able deal discontinuities based findings socalled discontinuity adaptive da smoothness model defined terms euler equation constrained class adaptive interaction functions aifs da solution c 1 continuous allowing arbitrarily large bounded slopes continuous nature stable changes parameters data good property regularizing illposed problems results provide principles selection priori clique potential functions stochastic mrf models regularizers deterministic regularization models also shown da model includes special instances existing models line process lp model 1 3 weak string membrane 10 approximations lp model 19 20 minimal description length 13 biased anisotropic diffusion 16 mean field theory approximation 17 study discontinuities sensibly carried terms analytical properties derivatives reason analytical regularization special class mrf models used platform consider regularization contains three parts 21 data class solution functions regularizer present work addresses mainly regularizer part section ii regularization models reviewed connection dis continuities section iii necessary condition discontinuity adaptivity made explicit based da model defined compared models section iv algorithm finding da solution presented related issues discussed experimental results shown section v finally conclusions drawn ii smoothness regularization discontinuities mrf vision modeling smoothness assumption encoded energy via one two routes analytic probabilistic analytic route encoding done regularization framework 4 22 regularization viewpoint problem said illposed fails satisfy one following criteria solution exists unique depends continuously data additional priori assumptions imposed solution convert illposed problem wellposed one important assumption ieee transactions pattern analysis machine intelligence vol pami17 no6 pp576586 june 1995 assumptions smoothness 23 incorporated energy function whereby cost solution defined probabilistic viewpoint regularized solution corresponds maximum posteriori map estimate mrf 1 24 prior constraints encoded priori mrf probability distribution map solution obtained maximizing posterior probability equivalently minimizing corresponding energy mrf model general regularization model 1 encode prior constraints smoothness 2 allows arbitrary neighborhood systems nearest ones however analytic regularization model provides convenient platform study smoothness priors close relationships smoothness analytical continuity regularization discontinuities consider problem restoring signal f data denotes noise regularization formulation defines solution f global minimum energy function ef energy sum two terms closeness term ud j f measures cost caused discrepancy solution f data x weighting function b bounds integral smoothness term uf measures cost caused irregularities solution f irregularities measured derivative magnitudes jf n xj identical independent additive gaussian noise uf j ud j f uf correspond energies posterior likelihood prior gibbs distributions mrf respectively 24 smoothness term uf also called regularizer object study work penalizes irregularities according priori smoothness constraint encoded generally defined n gf n xdx 3 un f n th order regularizer n highest order considered n 0 weighting factor potential function gf n x penalty irregularity f ngamma1 x corresponds prior clique potentials mrf models regularizers differ definition un f specifically selection g a1 standard regularization standard regularization 23 4 potential function takes pure quadratic form g q irregular f ngamma1 x x larger jf n j consequently larger potential gf n contributed un f standard quadratic regularizer general form un f wn wn xf n x 2 dx 5 wn x prespecified nonnegative continuous functions 23 may also generalized multidimensional cases include cross derivative terms quadratic regularizer imposes smoothness constraint everywhere determines constant interaction neighboring points leads smoothing strength proportional jf n j shown next section homogeneous isotropic application smoothness constraint inevitably leads oversmoothing discontinuities derivative infinite function wn x prespecified way wn x f n x infinite oversmoothing avoided way wn x act continuitycontrollers 6 suggested wn x may discontinuous prespecified 9 exam ple regarding wn x unknown functions one could solve unknowns using variational methods well wn x thus derived remains unclear introduction line processes 1 3 weak continuity constraints 10 provides solution problem a2 line process model approximations lp model assumes piecewise smoothness whereby smoothness constraint switched points magnitude signal derivative exceeds certain threshold defined lattice rather continuous domain quantize continuous interval b uniformly spaced points x 1 xm f introduce set binary line process variables l 2 f0 1g smoothness term also takes value f0 1g l related l onstate l line process variable indicates discontinuity detected neighboring points offstate l indicates signal two points contin uous turnon line process variable penalized quantity ff give lp regularizer l 6 energy lp model l weak string model extension 2d weak membrane model 10 eq7 corresponds energy posterior distribution surface field f li discontinuityadaptive smoothness priors computer vision 3 line process field l distribution gibbs e gammau fl j 8 z normalizing constant called partition function line process variables determined follows cheaper pay price f economical turn variable l insert discontinuity cost ff interpretation lp model based concept weak continuity constraint introduced blake 5 edge labeling earlier idea weak constraints found hintons thesis work 25 lp model interaction piecewise constant 1 smoothing strength either proportional see next section concept discontinuities extended modelbased recognition overlapping objects 26 27 relational bond two features scene broken features ascribed two different objects finding f 2 ir l 2 f0 1g uf l j minimized mixture real combinatorial op timization algorithms classified cate gories stochastic 1 3 deterministic 19 20 10 17 annealing techniques often combined obtain global solutions stochastic approaches f l updated according probability distribution parameterized temperature parameter example geman geman propose use simulated annealing gibbs sampler 1 find global map solution marroquin 3 minimizes energy stochastic update l together deterministic update f using gradient descent deterministic approaches often use classical gradient based methods applied combinatorial minimization problem converted one real minimization eliminating line pro cess blake zisserman 10 convert previous minimization problem one minimizes following function containing real variables truncated quadratic potential function shall referred line process potential function blake zisserman introduce parameter p g ff j control convexity e obtaining g p ff j parameter p varies 1 0 corresponds variation convex approximation function original form koch et al 19 yuille 20 perform conversion using hopfield approach 28 continuous variables l range 0 1 introduced replace binary line process variables l f0 1g l related internal variable sigmoid function parameter whereby lim 0 energy treatment shown stationary points v hence approximated line process variables 20 gives effective potential function temperature decreases toward zero l approaches geiger girosi 17 approximate line process using mean field theory introduce parameter fi 8 giving approximated posterior probability using saddle point approximation method derive mean field equations yield approximated line process variables identical 13 solution found limit fi 1 proposes continuous adaptive regularizer model smoothness constraint applied without switchoff lp model effect decreased derivative magnitude becomes larger completely true discontinuities derivative infi nite earlier form da model work b regularization models grimson pavlidis 7 propose approach degree interaction pixels across edges adjusted order detect discontinuities lee pavlidis 11 investigate class smoothing splines piecewise polynomials errors fit measured successive regularization used determine whether discontinuities inserted process iterates convergence reached besl et al 29 propose smoothing window operator prevent smoothing across discontinuities based robust statistics liu harris 4 ieee transactions pattern analysis machine intelligence vol pami17 no6 pp576586 june 1995 30 develop based previous work 31 computational network surface reconstruction discontinuity detection estimation first second derivatives performed cooperatively mumford shah 8 define energy continuous domain z i1 ff constants k number discontinuities sequence indicates locations discontinuities minimal solution f fa g k found minimizing value integer k every sequence fa k g every function fx continuously differentiable interval minimization k hard problem using minimal description length principle leclerc 13 presents following function restoration piecewise constant image f noisy data ffidelta 2 f0 1g kronecker delta function minimize function approximates delta function exponential function parameterized approaches solution continuation toward 0 iii discontinuity adaptive mrf model analyzing smoothing mechanism terms euler equation clear major difference different models lies way controlling interaction neighboring points adjusting smoothing strength da model defined based principle wherever discontinuity occurs interaction diminish defining da model focus models involve first order derivative consider general string model solutions f minimizing uf j must satisfy following associated eulerlagrange differential equation simply euler equation 32 dx boundary conditions f f b prescribed constants following discussion solutions differential equation following assumptions made x dx continuous fx continuously differentiable 1 writing euler equation yields dx potential function g usually chosen even b derivative g expressed following form h called interaction function obviously h thus defined also even assumptions euler equation expressed dx magnitude jg 0 f 0 relates strength regularizer performs smoothing hf 0 x determines interaction neighboring pixels necessary condition regularization model adaptive discontinuities lim c 2 0 1 constant condition prohibits smoothing discontinuities limited bounded smoothing case however interaction hj must small large jjj approaches 0 jjj goes 1 important guideline selecting g h purpose adaptation definition 1 adaptive interaction function aif h fl parameterized fl 0 function satisfies class aifs denoted ihi fl defined collection h fl 2 continuity requirement guarantees twice differentiability integrand uf j 20 respect 1 work continuity x dx differentiability assumed variational problems defined continuous domains 32 33 however necessary discrete problems b quantized discrete points example discrete case x allowed take value f10g indicating whether datum dx available li discontinuityadaptive smoothness priors computer vision 5 four choices aifs corresponding apfs bands aif apf band f 0 condition solution f exist 32 ever relaxed h fl 2 c 0 discrete problems evenness ii usually assumed spatially unbiased smoothing positive definiteness iii keeps interaction positive sign jh fl j altered h fl j monotony iv leads decreasing interaction magnitude derivative increases bounded asymptote property v provides adaptive discontinuity control stated earlier properties last meaning zero interaction dis continuities definition characterizes properties aifs possess rather instantiates particular functions therefore following definition da model rather broad definition 2 da solution f defined euler equation 25 constrained da solution c 1 continuous 2 therefore da solution derivative never discontinuities da overcomes oversmoothing allowing solution steep c 1 continuous point x data dx steep every possible data configuration every f 2 c 1 possible two reasons defining da terms constrained euler equation first captures essence da problem da model defined based h fl therein second satisfying h fl may corresponding g fl hence energy closed form g fl defined definition 3 adaptive potential function apf corresponding h fl 2 ihi fl defined called adaptive string following properties sically g fl one order higher h fl continuity 2 see 33 comprehensive discussion continuity solutions class problems da belongs 1 2 3 4 fig 1 qualitative shapes four da functions even g fl derivative function odd however necessary g fl 1 bounded furthermore g fl strictly monotonically increasing jjj increases g fl means larger jjj leads larger penalty g fl j conforms original spirit standard quadratic regularizers determined q line process potential function g ff property penalty fixed increase jjj increases beyond ff idea large values equally penalized questionable 14 practice always necessary know explicit definition g fl important factors euler equation constraining function h fl nonethe less knowing g fl helpful analyzing convexity ef given g fl j exists region j within smoothing strength jg 0 increases monotonically jjj increases function g fl convex b region b fl referred band lower upper bounds b l b h correspond two extrema j obtained solving g 00 b l gammab h g even b l thus g fl j strictly convex h fl defined c 0 bounds b table instantiates four possible choices aifs corresponding apfs bands fig1 shows qualitative shapes trivial constant may added g fl j fig2 gives graphical comparison gjs quadratic lp model first three da models listed table derivatives g 0 fourth aif h allows bounded nonzero smoothing discontinuities lim j1 jh 4fl fl interesting g 00 j except leads strictly convex mini mization fact positive number c 27 leads convex aif hence energy function 3 convex subset models discontinuity adaptivity estimation 3 due following theorem gdelta convex ir realvalued energy function convex wrt f f 2 c 1 fixed 2 c 1 6 ieee transactions pattern analysis machine intelligence vol pami17 no6 pp576586 june 1995 quadratic lineprocess fig 2 comparison different potential functions gj top first derivatives g 0 appealing inherent advantages nonconvex models stability computational efficiency fig2 also helps us visualize da performs smoothing like quadratic g q da allows smoothing strength jg 0 jj increase monotonically j increases within band b fl outside band smoothing decreases j increases becomes zero differs quadratic regularizer allows boundless smoothing j 1 also unlike lp model shuts smoothing abruptly beyond band b ff da decreases smoothing continuously towards zero b relations previous models first three instantiated models behave similar way quadratic prior model noticed 15 understood looking power series expansion g fl j g fl constants c 1 0 expansion also involve trivial additive constant c 0 thus situation sufficiently small j 2 fl adaptive model inherits convexity quadratic model interaction function h also well explains differences various regularizers quadratic regularizer interaction constant everywhere smoothing strength proportional jjj quadratic regularizer leads oversmoothing discontinuities j infinite lp model interaction piecewise constant obviously inhibits oversmoothing switching smoothing jjj exceeds ff binary manner lp approximations using hopfield approach 19 20 mean field theory 17 line process variables approximated 13 approximation effectively results following interaction function temperature decreases toward zero approaches h ff 2 obviously h ff j nonzero member aif family ie h ff j 2 ihi fl therefore approximated lp models instances da model interesting note observation made geiger girosi sometimes finite fi solution may desirable robust 17 pages 406407 suggest optimal finite temperature fi solution algorithm presented 34 estimating optimal fi lp approximation finite fi 1 nonzero 0 instance da lp model aimed approx imate shown section iiid da model indeed stable lp model anisotropic diffusion 35 scalespace method edgepreserving smoothing unlike fixed coefficients traditional isotropic scalespace filtering 36 anisotropic diffusion coefficients spatially varying according gradient information socalled biased anisotropic diffusion 16 model obtained anisotropic diffusion combined closeness term two choices apfs used anisotropic diffusion models g 1fl g 2fl shulman herve 14 propose use following hubers robust error penalty function 37 adaptive potential similar role ff g ff convex function first derivative g 0 j comparing g 0 fi j 24 find corresponding aif h fi function allows bounded nonzero smoothing discontinuities function also applied 38 curve fitting comparative study da model robust statistics found 39 27 approximation 18 leclercs minimal length model 13 effect da apf 1 may one best cost functions piecewise constant restoration general piecewise continuous restoration one needs use 18 nonzero da instance regarding continuity property domains mumford shahs model 8 terzopou los continuitycontrolled regularization model 9 also defined continuous domains da model li discontinuityadaptive smoothness priors computer vision 7 c discrete data 2d cases data available discrete points euler equation adaptive string dx ffidelta dirac delta function integrating equation yields c constant solution f determined following appropriate boundary conditions xm obviously f case piecewise c 1 continuous exactly composed consecutively joined line segments adaptive string model extended 2d higher order equivalents 2d adaptive membrane following x f hf corresponding euler equation 25 data images extending da second order one obtains following adaptive rod 1d adaptive plate 2d xy f xy hf xy f yy hf yy solution stability da solution depends continuously parameters data whereas lp solution informal analysis follows consider lp solution f ff obtained ff solution local equilibrium satisfying h ff f 0 0 depending ff configuration f ff jf 0 ff xj 2 close ff small change deltaff may flip h ff one state due binary nonlinearity h ff flipover leads significantly different solution expressed lim deltaff0 0x function constantly zero domain b variation ffif ff respect deltaff may zero f ff ff causes instability however da solution denoted f fl stable lim deltafl 0 f fl denotes da solution conclusion stability due changes parameter drawn similarly also true respect data given ff fixed solution depends data ie assume small variation ffid data solution f must change accordingly reach new equilibrium satisfy euler equation however always exist possibilities h ff f 0 ff x may flip x jf 0 ff xj 2 near ff resulting abrupt change lp solution f ff represented lim variation ffif ff respect ffid may zero f ff however da model stable changes ie lim f continuous nature analysis concluded da better regularizes illposed problems lp iv computation da solutions solving euler equation euler equation 25 treated boundary value problem also solved minimizing corresponding energy 19 minimum energy sufficiently solution equation form energy needs known order minimize see energy minimization approach chosen bounded energy means minimal solution hence solution euler equation exists h fl chosen corresponding energy ef nonconvex respect f minimization subject local minima see 10 analysis convexity string membrane models following presents discrete method finding local minimum sample integral interval uniformly spaced points x b clarity without loss generality let us assume bounds b rescaled way point spacing one unit 4 4 advanced numerical methods using varying spacing 40 may advantageous obtaining accurate solutions 8 ieee transactions pattern analysis machine intelligence vol pami17 no6 pp576586 june 1995 ie 1 approximate first derivative f 0 first order backward difference f 0 energy 19 approximated consists neighbors using gradientdescent method obtain following updating f solution f takes prescribed values boundary points meet boundary condition 22 values may estimated data near boundaries initial f 0 solution limit equation 49 helps us see da works smoothing due 1g contributions smoothing two neighboring points site 0 proportional product two factors f h fl f relate jg 0 strength smoothing performed regularizers hand hj acts adaptive weighting function control smoothing due difference therefore regard interaction two remarks made first contributions two sides treated separately nonsymmetrically second sum contributions smoothing zero three points aligned hj even since situation updating rule adaptive membrane 2d easily derived 2d case 40 additional term dimension leads following energy letting f ij f ij leads following updating rule f set four neighboring points 5 j updating 2d grid performed white black sites checkerboard alternatively accelerate convergence 5 4neighborhood system model considers derivatives horizontal vertical directions 8neighborhood system regularizer also includes diagonal derivatives weighted 1 2 choose convex using eq49 set f fig 3 gnc algorithm finding da solution three parameters 49 shall determined da model fl parameter related convergence relaxation algorithm upper bound system sta ble also exists optimal value 10 optimal choices quadratic regularization may made using crossvalidation 41 42 43 least squares method 44 presented estimating mrf clique potentials lp model automated selection fl parameters da model unsolved problem currently chosen ad hoc way b nonconvex minimization da model leads nonconvex dynamic systems direct minimization using gradient descent guarantees find local minimum gnclike algorithm constructed approximating global solution convex g guarantees convex energy function ef useful study convexity e analyzing convexity g fl expansion 30 illustrates da model behaves similar way quadratic regularizer hence convex analysis 10 shows sufficient guarantee convexity fl chosen large enough satisfy c real number see analysis 10 determining c exact value c convexity depends g safely assumed c case therefore convex fl 0 chosen equivalent choosing fl 0 f 0 band introduced section apfs 1 2 3 must larger 2v 3v v respectively graduation initially convex approximation g fl target form implemented continuation fl big value target value gnclike algorithm using heuristic outlined fig3 given target value fl target fl algorithm aims construct sequence ffl g fl 1 fl target thus li discontinuityadaptive smoothness priors computer vision 9 ff g approach global minimum f ef algorithm ffl constant judging convergence factor decreasing 1 choice controls balance quality solution computational time principle fl vary continuously keep good track global minimum discrete computation choose 09 099 rapid decrease fl smaller likely lead system unfavorable local minimum witkin et al 45 present sophisticated scheme decreasing fl relating step energy change constants seems reasonable c analog network computation performed using analog net work let f potential neural cell let c 12 membrane capacitance r membrane resistance let conductance synaptic efficacy neurons exponential g 1fl used let external current input 49 written dynamic equation neuron net work diagram network circuit shown fig4 synaptic current 0 exponential g 1fl used plot current ii 0 versus potential difference f shown bottom fig2 voltagecontrolled nonlinear synaptic conductance ii 0 characterized h function defined 27 realizes adaptive continuity control corresponding nonlinear current ii 0 realizes adaptive smoothing current ii 0 diminishes asymptotically zero potential difference neurons 0 reaches far beyond band b fl fig7 shows behavior analog network component defects manufacturing inadequacy quality changes etc defects simulated adding sigma25 evenly distributed random noise r c 55 data shown triangles 50 missing rate locations missing data indicated triangles bottom noise data white gaussian standard deviation r r f l r r fig 4 schematic diagram analog network circuit da model right interaction function chosen h 2fl solutions obtained simulated component defects shown dashed lines comparison obtained without noise shown thicker solid lines ideal signal shown thinner solid lines seen little difference solutions obtained without noise demonstrates stability network circuit also errortolerance property da model v experiments two experimental results presented following 6 first reconstruction real image size 256 theta 256 fig5 apf 1 g 1fl used parameters empirically chosen 2 result shows reconstructed image much cleaner discontinuities well preserved second experiment detection step roof edges simulated noisy pyramid image size 128 theta 128 fig6 detection process runs three stages regularizing input image computing images first derivatives two directions regularized image using finite difference 2 regularizing derivative images detecting steps roofs thresholding regularized derivative images apf 2 g 2fl used parameters empirically chosen first stage regularization second stage edges horizontal vertical directions best detected diagonal directions well done derivatives two axes directions considered da discussed far changes diagonal directions largely ignored regularizers using 8neighborhood system see footnote eq51 help improve detection diagonal changes results fig7 show behavior analog da network component defects manufacturing inadequacy quality changes etc defects simulated adding sigma25 evenly distributed random noise r c 55 data shown triangles 50 missing rate locations missing data indicated triangles bottom noise 6 results found chapter 3 18 fig 5 3d plots image left reconstruction using da right plots drawn sampling images every 4 pixels directions size 64 theta 64 data white gaussian standard deviation solutions obtained simulated component defects shown dashed lines comparison obtained without noise shown thicker solid lines ideal signal shown thinner solid lines seen little difference solutions obtained without noise demonstrates stability network circuit also errortolerance property da model fig 6 step roof edges right detected pyramid image left step edges shown dots roof edges crosses vi conclusion analysis associated euler equation necessary condition made explicit mrf regularization models adaptive discontinuities basis da model defined euler equation constrained class adaptive interaction functions aifs definition provides principles choosing deterministic regularizers mrf clique potential func tions also includes many existing models special instances li discontinuityadaptive smoothness priors computer vision 11 fig 7 stability da solution disturbances parameters da model solution c 1 adaptively overrides smoothness assumption assumption valid without switchingonoff discontinuities lp model da solution never contains true dis continuities da model preserves discontinuities allowing solution arbitrarily large bounded slopes lp model preserves true discontinuities switching small unbounded large slopes owing continuous properties da model possesses theoretical advantages lp model unlike lp model stable changes parameters data therefore better lp model solving illposed problems addition able deal problems continuous domain furthermore better suited analog vlsi implementation acknowledgments author grateful yihong huang eric sung wei yun yau han wang helpful comments r probabilistic solution inverse problems towards 3d vision range images optimisation framework parallel distributed networks solutions illposed prob lems relaxation role vision markov random field modeling computer vision methods mathematical physics robust statistics tr ctr jianfeng cai raymond h chan carmine fiore minimization detailpreserving regularization functional impulse noise removal journal mathematical imaging vision v29 n1 p7991 september 2007 tonazzini l bedini monte carlo markov chain techniques unsupervised mrfbased image denoising pattern recognition letters v24 n13 p5564 january michele ceccarelli finite markov random field approach fast edgepreserving image recovery image vision computing v25 n6 p792804 june 2007 stan z li han wang william c soh robust estimation rotation angles image sequences usingthe annealing mestimator journal mathematical imaging vision v8 n2 p181192 march 1998 david w jacobs daphna weinshall yoram gdalyahu classification nonmetric distances image retrieval class representation ieee transactions pattern analysis machine intelligence v22 n6 p583600 june 2000