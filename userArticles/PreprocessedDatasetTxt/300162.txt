efficient newtontype iteration numerical solution highly oscillatory constrained multibody dynamic systems paper present coordinatesplit cs technique numerical solution equations motion constrained multibody dynamic systems show cs technique implemented within context commonly used solution methods increased efficiency reliabilitya particularly challenging problem multibody dynamics numerical solution highly oscillatory nonlinear mechanical systems highly stable implicit integration methods large stepsizes used damp oscillation small amplitude however standard newton iteration known experience severe convergence difficulties force restriction stepsize introduce modified coordinatesplit cm iteration overcomes problems convergence analysis explains improved convergence nonlinear oscillatory systems numerical experiments illustrate effectiveness new method b introduction equations motion constrained multibody system written 10 generalized coordinates 1 2 lagrange multipliers mq 2 ir nthetan massinertia matrix f 2 ir n force applied system dt velocity acceleration vector constraints smooth functions q whose jacobian assumed full rowrank assume gqmqg q symmetric positive definite every q 2 ir n obtain consistent physics represented 11 degrees freedom system 11 equation 11 wellknown index3 dae 3 13 many methods proposed modeling multibody systems direct numerical integration index3 dae 11 suffers wellknown difficulties inherent solution highindex daes 13 one way lower index involves introducing derivatives constraint gq along additional lagrange multipliers yields stabilized index2 ggl formulation constrained equations motion 8 widely used simulation lagrange multiplier variables fulfill role projecting solution onto position 13d velocity 13c constraints respectively equations 13 related systems solved variety methods consider solution implicit numerical methods bdf radau closely related approach based explicitly projecting numerical solution onto constraints 18 20 22 23 involves many issues implementation considered many numerical methods multibody systems solve system 13 directly also possible eliminate lagrange multipliers reduce size system number degrees freedom one way accomplish begins stabilized index2 system 13 suppose gp fullrank constraint manifold 0g one find annihilation matrix p q 2 ir ngammamthetan p qg premultiplying 13a 13b p q yields index1 dae potential gain efficiency formulation due sizereduction nonlinear system compared 13 important practical consequence 14 eliminated dae via multiplication 13a 13b nonlinear p q thus error test newton iteration convergence test numerical implementation 14 longer need include higherindex variables cause problems direct numerical solution 13 one could principle also consider removing test solution 13 however usually possible justify action particularly case newton convergence test elimination variables newton convergence test solution 13 lead code sometimes produces incorrect solutions fact multiplying nonlinear p q eliminates nonlinear system allows variables excluded tests solution 14 direct numerical solution presents challenges first must means generating p q reliable cheap note jacobian matrix newton iteration involves complicated terms arise derivatives p q need means generating jacobian matrix finally practical issues error test newton convergence test must considered approach obtaining cheap representation p q based coordinate splitting variables widelyused method related sense also making use splitting coordinates generalized coordinate partitioning method 22 order obtain independent generalized coordinates jacobian g calculated assembled configuration q ludecomposition g carried identify nonsingular theta submatrix gy x 2 ir nthetap 2 ir nthetam columns x constitute cartesian basis ir n implicit function theorem assures dependent variables uniquely determined constraint gq least locally function remaining generalized coordinates x ie thus declared independent coordinates twice differentiable function arbitrary x neighborhood assembled configuration differentiating twice constraints 11c respect time multiplying 11b gm gamma1 substituting g v twice differentiated constraints solve obtain dgv dq substituting solution q v 11 eliminating dependent variables yields nm differential equations dh dx statespace form representation 11 7 14 however differs substantially approach outline p q associated method orthogonal g q hence indexreduction differentiating constraints projecting invariant space must carried explicitly particular requires forming derivative velocity constraints ie acceleration constraints explicitly another method 14 proposed 9 18 19 20 p q chosen orthonormal basis local tangent space constraint manifold choosing smoothly varying p q required may cause practical difficulties direct numerical solution 14 via coordinatesplit approach yields efficient reliable method solving equations motion multibody mechanical systems however class multibody systems present additional computational challenges problems highfrequency nonlinear os cillations highly oscillatory components often used model devices strong potential energy typical examples problems arise modeling flexible multibody mechanical molecular dynamic systems many problems oscillations sufficiently small amplitude important model severely restrict stepsize numerical methods types problems stiffly stable implicit numerical integration methods used damp oscillation 17 however stepsize may still severely restricted due difficulties converging newton iteration larger stepsizes studied class oscillating problems 24 solutions composed lowamplitude highfrequency oscillation around smooth solution 17 21 along smooth solution eigenstructure local jacobian matrix varies smoothly however along solutions nearby smooth solution local eigenstructure oscillates high frequency badly behaved standard newton iteration inside damping numerical method starts predictor nearby solution attempts find smooth solution evaluates jacobian matrix nearby solution determines direction takes toward smooth solution unfortunately jacobian matrices yield good directions nonlinear oscillating problems described unless predictor already extremely close smooth solution thus standard newton method must coupled severe reduction timestep achieve adequate predictor section 2 outline csiteration carried efficient method derivative purpose finding smooth solution introduce modification newton iteration ie cmiteration iteration easy implement effective nonoscillatory problems particularly effective nonlinear highly oscillatory problems basic idea cmiteration terms jacobian involve derivatives projection onto constraint manifold terms large complicated compute small slow manifold 21 cmiteration sets terms zero yielding reliable direction towards smooth solution newtontype iteration prove convergence cmiteration give error estimate numerical solution section 3 describe detail structure nonlinear oscillatory mechanical systems derive estimates rates convergence cs cmiterations applied oscillatory systems difference convergence rate explains cmiteration highly effective oscillatory systems shows rate convergence nonoscillatory systems similar cs iteration section 4 numerical experiments given demonstrate effectiveness methods particularly oscillatory nonlinear mechanical systems 2 coordinatesplit technique section present coordinatesplit cs technique defines p q 14a 14b via coordinatesplitting computes matrix cheaply although first glance would appear implementation method would difficult due complications computing derivatives p q show special form pseudoinverse used give much simpler derivation jacobian construction annihilation matrix p q involves solution class pseudoinverses constraint jacobian gq given smooth vectorvalued function rq effective way obtain projected vector p qr use splitting original coordinates definition 21 coordinatesplitting matrix let x matrices whose columns constitute standard cartesian basis ir nthetan kgqy bounded neighborhood u 0 q 0 constraint manifold 0g p theta n coordinatesplitting matrix 11 defined remark 21 note x piecewise constant respect q 0 2 construction cs matrix p q one easily see p qg q 2 ir n ie p q orthogonal rangeg furthermore row vectors p q orthonormal ie p q p identity matrix ir p computation p q carried using lufactorization qr factorization constraint jacobian matrix 12 projected vector p qr computed relatively cheaply addition directly applying formulas given 11 theorem 43 pp 420 obtain dq dq p q defined 21 rq 2 ir ntheta1 using 21 22 coordinatesplit iteration solving nonlinear system time step carried applying example bdf formula yields nonlinear system ae h discretization operator h stepsize time discretization given initial prediction q 0 applying newtontype methods 23 requires solution linear system deltaq n deltav n increments q n v n vn remark coordinatesplit iteration leads natural reliable error estimator numerical integration method particular local error estimator based independent coordinates velocities analyze solution 24 rewrite first two equations 24 ie corresponding derivatives 23a 23b deltaq n deltav n 2n theta 2n matrix j h h dmqn dvn since small enough h j h invertible assumption mq n nonsingular solution 24 computed deltaq n deltav n thus deltaq n deltav n obtained successive solution two linear systems deltaq n deltav n cs iteration efficient formulation newton iteration multibody systems standard convergence theorems apply state conditions ensure convergence cs iteration context numerical integration methods 14 simplicity consider instead secondorder constrained equations motion 11 firstorder system since convergence 29 trivially extended 11 applying stiffly stable numerical methods convergence result wellknown see 13 pp 494498 convergence discretization methods index1 system obtained applying coordinatesplitting matrix p q 29a also well developed construction p q easy see solution cs iteration equivalent local statespace ode independent coordinate x 7 applying linear discretization operator ae h stepsize h 210 scaling 210a h yields nonlinear system residual function r h q convergence cs iteration carried smooth constraint manifold assume q 0 2 exist h 0 x 2 ir pthetan 2 ir mthetan j similarly assume c 2 q 1 q 2 neighborhood uq 0 q 0 convergence cs iteration assured sufficiently accurate initial guess assumptions 213 214 sufficient condition convergence requires numerical integration satisfies dr h dq dq c 3 0 neighborhood true solution q 6 highly oscillatory dynamic systems stepsize numerical method may restricted error test follow oscillation applying stiffly stable numerical method 210 bdf order 2 one may able damp oscillation take larger stepsize follow trajectory equilibrium however convergence newton iteration requires restriction stepsize depending close predictor equilibrium highly oscillatory components newton direction imposed jacobian excite highfrequency oscillations applying newton method directly discretization lagrangian form 29 even severe problem newton convergence observed illustrated numerical experiments section 4 limitation stepsize due newton convergence failures highly oscillatory nonlinear multibody systems overcome via modification cs iteration call cm iteration cm iteration largescale multibody mechanical systems unwanted oscillations due noise highfrequency forces amplitude well solution tolerance however small perturbations position cause drastic changes newton direction results difficulties convergence newtontype methods remedy problem cs iteration reduce noise oscillations setting dp q newton iteration matrix since main source contributing rapidly changing newton direction term large away smooth solution negligible smooth solution cm iteration approximates newton direction 210 via oblique projection unconstrained ode q 0 close solution q eg gq 0 g q invertible applying stiffly stable numerical integrator highly oscillatory problems modification q 0 close enough smooth solution overcomes difficulties cs iteration applying stiffly stable discretization method 216 coupled constraint 210b leads nonlinear system convergence result modified cs iteration denoted cm given next first give upper bound difference derivative projected vector p qrq projected derivative p q drq lemma 21 suppose conditions 213 214 hold disc ir n center q 0 radius 0 dq dq proof 22 dq dq dq sk since row vectors p q p orthonormal vectors ir n applying cauchy inequality gives dq dq q 2 dq condition 213 h 0 implies result convergence cm iteration estimate distance solutions 211 217 given following theorem 21 suppose conditions 213215 hold h 0 neighborhood q fq j g q generated cs iteration choosing sequence fq k g generated cm iteration dq converges q furthermore distance q q bounded moderate constant c proof convergence fq k g follows immediately noting cm iteration inexact newton method 5 property terms cmmodification deletes jacobian hence perturbation newton iteration made small want taking initial guess accurate enough next show estimate 220 since cs cm iterations converge q respectively subtracting sides equation obtain expanding around q 0 yields dq dq dq dq r h q matrix form equations become assumption j invertible write note since dp constraints gq linear fq k g cs iteration fq k g cm iteration case general rate convergence cm iteration superlinear using dennismore characterization theorem 6 3 rate convergence highly oscillatory multibody systems high frequency oscillatory forces often appear modeling vehicle suspension systems modal analysis structural dynamics modeling oscillations computeraided engineering etc simplicity consider constrained dynamic system 11 dominant oscillatory force may example coefficients stiff springs ie practice jq usually oblique towards kerp q ie oscillatory forces acts independent dependent coordinates purpose obtaining smooth solution large stepsizes show cm iteration effective many classes nonlinear oscillatory forces deformation forces common potential forces produce small amplitude highfrequency oscillations usually linear respect local coordinates 4 25 reasons consider class oscillatory forces form components b b 0 slowly varying particular b b 0 may functions constraintdriven generalized coordinates example b 2d bushing problem 24 form gammak sin k x cos k 54 positive constants smooth constrained assumption 32 valid using linear oscillatory force lagrange equations motion multibody system written qv k assumption 214 constraint manifold also assume dq q context cs iteration problem convergence newton iteration explained analyzing reduced potential function reduced potential 31 reduced potential force generated 36 dq iteration reduced potential force acts along normal direction constraint manifold gradient correction term yields dq applying 38 gives dq applying x 38 yields dq highfrequency oscillations appear system eg ffl 0 reduced potential force also becomes oscillatory r nonzero general case solution equilibrium position nevertheless convergence cs iteration achieved using small enough stepsize 17 small stepsizes convergence result cm iteration obtained provided assumptions theorem 21 valid many applications following oscillations interest instead one wants use large time step damp oscillations small amplitude high frequency reason consider multistep numerical integration methods strictly stable infinity astable lower order ie 2 bdf methods 13 convergence lstable implicit rungekutta methods smooth solution highly oscillatory ode multibody mechanical systems found 17 focus convergence cm iteration constrained multibody systems oscillatory forces applying abovementioned linear multistep methods numerical solutions slow manifold evaluated using equilibrium 31 ie slow solution 2 15 satisfies smooth solution asymptotic expansion order ffl around manifold 0g linear form smooth solution 31 far k strongly damped numerical solution 1 iterative solution onto slow manifold constraints may satisfied causes large reaction force form 37 may cause oscillations cs iteration cm iteration annihilates nonlinear oscillations generated reduced potential yields superior performance cm iteration compared cs iteration computing smooth solution 31 result explained following theorem 31 consider numerical solution 31 jq linear h stepsize stiffly stable multistep integration method assume starting values neighborhood smooth solution cs cm iterations converge q respectively rate convergence cs iteration oe cs compared cm iteration oe cm given k k case constraints linear two iterations yield result proof recall cs iteration newton iteration solution using notation defined 28 comparing jacobian matrix cs iteration iteration k jacobian solution cs iteration obtain equation 31 solved multistep method leading coefficient fi using cs iteration dq thus 39 local rate convergence cs iteration given via contraction mapping theorem 6 recall cm iteration newton iteration solution comparing jacobian matrix cm iteration iteration k jacobian solution cm iteration obtain problem 31 fii gammahi noting neighborhood smooth solution fii gammahi equation 311 yields thus similar argument result holds linear numerical integration methods4 numerical experiments 41 pointmass oscillatory force first example simple constrained multibody system influence highly oscillatory force consider unit pointmass constrained 2d unit circle using constraint equation 1 equations motion applied force differentiating constraint respect time explicit form multiplier obtained highly oscillatory force fq one see oscillating frequency fq amplitude proportional magnitude kfk numerical experiments carried using bdf order 2 dassl 3 local error estimation modified stabilized index2 dae denoted ggl local error estimated using position ie q moreover also included experiments newton convergence test ggl modified exclude multipliers corresponding numerical solution denoted ggl coordinatesplit modified coordinatesplit iterations denoted cs cm respectively local error estimated using independent variable x q recommended 24 cm iteration updates matrix p q new jacobian required linear oscillation let unit gravitational force act along negative ydirection apply linear oscillatory force stable equilibrium 0 natural frequency system ffl dissipative force present numerical solution carried moderate solution tolerance 0 025 second simulation results several combinations stiffness coefficient ffl presented table 41 initial values 0 cm iterations show better efficiency cs ggl ggl cases ie comparing numbers function jacobian evaluations table 41 table etfs ctfs denote number failures error test newton convergence test respectively dassl comparing results ggl ggl observe improved newton convergence ffl 0 ie higher frequencies oscillation cm iteration becomes even efficient figure 51 plot total energy numerical solution cm iteration achieves strongest damping dassl able increase stepsize faster cm iteration linear spring force next test replace linear oscillatory force previous constrained system spring forceffl 2 l attachment point spring l 0 natural length 1 stiffness coefficient shown schematically figure 52 method tol ffl steps fevals jevals etfs ctfs table 41 results constrained pointmass linear oscillatory force time logarithmic scale total energy epsilon1e6 tol1e3 order12 cm cs ggl ggl figure 41 total energy comparison linear oscillatory force example method tol ffl steps fevals jevals etfs ctfs table 42 results constrained pointmass oscillatory linear spring force unit mass unit gravitational force set spring attached 0 gamma05 natural length l 04 equilibrium 0 gamma1 0 0 using initial conditions 004471 gamma0999 0 0 results 0005 second simulation ggl ggl cs cm iterations shown table 42 dassl able increase stepsize hence damp solution faster cm iteration cm method quite effective tests figure 53 plot total energy solution numerical solutions x w presented figure 54 42 twobody pendulum bushing second example twobody pendulum 2d cartesian coordinates six generalized coordinates locate centers mass orientation bodies first body grounded second body constrained distance point first body another point b second body fixed orientation held constant leads five constraint equations attachment point spring pointmass 00 figure 42 constrained pointmass linear spring time total energy vs time cm ggl dot ggl solid figure 43 total energy comparison oscillatory spring example xvelocity velocity time lambda multiplier xcoordinate position figure 44 results oscillatory spring example l ab constant local reference coordinate systems body 1 body 2 respectively example use l constraint equations 41 apply nonlinear oscillatory force formulated using nonlinear beam theory 4 type force arises commonly flexible multibody dynamics 25 described 32 deformation force ith jth components function relative displacement reference frames x 0 j shown schematically figure 55 typically relative displacement measured constant vectors respect origins force reference frames respective local coordinate systems ie corresponding origins global coordinate system j transformation matrices global local coordinate system 10 calculated l component kth row lth column ij matrix ij relative orientation matrix two force reference frames ie b b j constant relative velocity time derivative relative displacement relative angular velocity angular velocities bodies j respectively using defined notation force acting ith jth components due deformation written k f 3 theta 3 structural stiffness matrix c f 3 theta 3 damping coefficient matrix similarly torque acting components zi zj deformation force reference frames component component j figure 45 deformation force flexible body k c analogous k f c f note force torque form linear functions relative displacement ij relative 2d bushing force stiffness matrix o1 damping matrix c x c c o1 2d bushing example 33 becomes ffl4 attachment points force device 0 05 0 0 gamma05 0 bodyfixed reference frames bodies 1 2 respectively bushing force introduces oscillatory applied forces causing small oscillations numerical solution yielding highly oscillatory multipliers index2 dae 13 multipliers associated highly oscillatory components exhibit highfrequency oscillations large amplitude standard convergence test newton iteration depends heavily multipliers therefore modified convergence test dassl exclude test multipliers addition multipliers computed ggl applying pseudoinverse gy gammat r predictor dassl ae h discretization operator bdf local error estimated predictorcorrector difference x q x v cs cm ggl q v ggl using initial values numerical results shown table 43 10 moderate stiffness methods perform well note constraint violation initial values o10 gamma3 implies difference constraint reaction force initial value q 0 q constraint manifold according theorem 31 rate convergence cs iteration proportional ffi ffl oh increasing numbers convergence test failures dassl expected ffl 0 example frequent convergence test failures occured observe difficulties newton convergence ggl ggl iterations hand cm iteration better newton convergence explained theorem 31 able take much larger time steps nonlinear oscillation damped effectively table 44 results shown figure 56 plot stepsize taken dassl ggl ggl cs cm using stiffness coefficient method tol steps fevals jevals etfs ctfs table 43 results twobody pendulum bushing force method tol steps fevals jevals etfs ctfs table 44 results bushing problem time stepsize ggl x cs ggl figure time steps used solving bushing problem r projected implicit rungekutta methods differentialalgebraic equations asymptotic methods theory nonlinear oscillations numerical solution initialvalue problems differentialalgebraic equations john wiley numerical methods unconstrained optimization nonlinear equations error control multistep methods applied odes invariants daes multibody dynamics automatic integration eulerlagrange equations constraints index reduction methods differentialalgebraic equations differentiation pseudoinverses nonlinear least squares problems whose variables separate matrix computations solving ordinary differential equations ii stiff differential algebraic problems computer aided kinematics dynamics mechanical systems volume perturbation methods applied mathematics variational principles mechanics integration stiff mechanical systems rungekutta methods numerical solution eulerlagrange equations numerical solution eulerlagrange equations geometric interpretation differentialalgebraic equations approach torsion dynamics macromolecules generalized coordinate partitioning dimension reduction analysis constrained dynamic systems constrained equations motion multibody dynamics odes manifolds computational challenges solution nonlinear oscillatory multibody dynamic systems dynamics articulated structures tr ctr b fox l jennings zomaya modelling computation nonlinear multibody cable systems international journal computers applications v28 n2 p154161 april 2006