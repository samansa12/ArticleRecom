global optimization approach unequal sphere packing problems 3d problem unequal sphere packing 3dimensional polytope analyzed given set unequal spheres polytope double goal assemble spheres way overlap ii sum volumes spheres packed polytope maximized optimization application automated radiosurgical treatment planning formulated nonconvex optimization problem quadratic constraints linear objective function basis special structures associated problem propose variety algorithms improve markedly existing simplicial branchandbound algorithm general nonconvex quadratic program heuristic algorithms incorporated strengthen efficiency algorithm computational study demonstrates proposed algorithm obtain successfully optimization limiting size b introduction optimization packing unequal spheres 3dimensional polytope ana lyzed given set unequal spheres polytope objective assemble way 1 spheres overlap 2 sum volumes packed spheres maximized note conventional 2dimensional 3dimensional packing problems also called binpacking problem extensively studied 2 7 11 fundamentally dierent problem considered present work unequal sphere packing problem important applications automated radio surgical treatment planning 12 14 stereotactic radiosurgery advanced medical technology treating brain sinus tumors uses gamma knife deliver set extremely high dose ionizing radiations called shots target tumor area 13 good approximation shots considered solid spheres large irregular target regions multiple shots used cover dierent parts tumor however procedure usually results 1 large dose inhomogeneities due overlap dierent shots 2 delivery large amount dose normal tissue arising enlargement treated region two shots overlap optimizing number position individual sizes shots significantly reduce inhomogeneities dose normal tissue simultaneously achieving required coverage unfortunately since treatment planning process tedious quality protocol depends heavily experience users fore automated planning process desired achieve goal wang wu et al 12 14 mathematically formulated planning problem packing spheres 3d region packing density greater certain given level packing problem proved npcomplete approximate algorithm proposed 12 work formulate question nonconvex quadratic optimization present solution methods based branchandbound technique let k number dierent radii spheres given set r k 1 k corresponding radii l available spheres radius therefore total number spheres set kl use single value l simplicity presentation however model easily modified case dierent numbers l k spheres available dierent radii r k total number spheres given set let polytope given x z r 3 l maximum number spheres packed designate variables location sphere packing sphere packing radius assigned variables ik 1 k used handle task sphere radius r k preliminaries optimization formulated follows 3 st 2 constraints 1 3 respectively ensure two spheres overlap sphere centered within polytope constraints 4 5 guarantee one radius chosen sphere ie sphere packed radius r k sphere radius r k packed together 3 4 5 constraints 2 state distance center sphere boundary polytope least large radius sphere hence 2 3 force spheres packed inside polytope 3 constraint 2 rewritten 6 since righthand side 6 nonnegative 6 implies 3 moreover binary 01 variables ik 5 replaced inequalities ik ik note ik 1 implied constraint 4 steps allow restatement problem p1 follows note constant 4 original objective function omitted numbers variables quadratic constraints 3kl ll1lk respectively quadratic function constraint 7 neither convex concave exist several algorithms 1 9 developed solving general nonconvex quadratic program nqp short nqp transformed semidefinite programming problem sdp additional rankone constraint dropping rankone constraint one obtains sdp relaxation problem tightest relaxation among others 3 hence p2 solved using branchandbound type method based sdp relaxation however due relative slowness instability sdp software conceptual algorithm impractical even problem small size since requires many iterations sdp relaxation commonly methods solution nqp class designed linear programming lp relaxation approach known reformulationlinearization technique 10 assumption additional box constraints variables new nonlinear constraints generated pair box constraints order construct relaxed convex area original nonconvex feasible region nonlinear terms nonlinear constraint accordingly replaced new variables result recasting linear program based technique linearization alkhayyal et al 1 proposed rectangular branchandbound algorithm solve class quadratically constrained programs raber 9 proposed another branchandbound algorithm problem based use simplices partition elements use underestimate ane function whose value vertex simplex agrees corresponding nonconvex quadratic function work 9 demonstrated simplicial algorithm often better performance rectangular algorithm respect computational time interestingly raber 9 mentioned simplicial rectangular algorithms exhibit poor performance packing problem giving experimental details obvious packing problem similar much simpler structures constraints paper examine customization rabers simplicial branchandbound algorithm 9 tailored problem well known underlying simplicial subdivision key factor influencing quality relaxation therefore eciency branchandbound algorithm investigation structure optimization suggests ecient simplicial subdivision ii dierent underestimations nonconvex functions based observations three variants algorithm constructed discrete nature packing enables heuristic design obtaining good feasible solutions outcome leads savings computational time memory size remainder paper organized follows section 2 derive lp relaxation problem respect simplicial subdivision simplicial branch andbound algorithm presented section 3 section 4 gives heuristic algorithms section 5 presents three variations previous algorithm based use special structures section 6 reports computational results proposed branch andbound algorithm conclusions work presented section 7 programming relaxation construction lp relaxation problem p2 one developed 9 sake complete description outline procedure transpose vector first write problem p2 following form ik r n c r n coecient vector objective correspond constraints 7 8 respectively av b represents linear constraints 9 10 11 furthermore matrix q il specified follows il matrix zero entries appropriate size 1 1 1 1 corresponds coecients 7 l r 2 r 1 r k r 2 r k r 2 r 2 r 1 r k r 2 r k r 2 k corresponds 11 1k l1 lk 7 k similarly r 3l3l ik r klkl written follows 0 number linear constraints p2 denote polytope defined linear constraints mn b r construct lp relaxation problem need represent matrix q il resp sum positive semidefinite matrix c il resp negative semidefinite matrix il resp ik usually spectrum decomposition achieves goal however need perform task since matrices q il possess special structures give decomposition immediately readily seen decompositions il satisfy desired property consider construct linear programming relaxation problem let nsimplex u v vertices let w r nn matrix consists columns v point v represented substitution v p2 14 obtain following equivalent problem st replacing q il 12 13 quadratic term lefthand side constraint 15 16 divided convex concave functions replacing q il 12 13 respectively relaxation problem constructed ignoring convex part replacing concave part linear underestimate function underestimation use convex envelope concave function f respect simplex ane function whose value vertex coincides f precisely quadratic constraints 15 v convex envelope w il w respect similar fashion quadratic constraints 17 v convex envelope w ik w respect obviously upper bound objective function p3 obtained solving following lp relaxation problem 3 simplicial branchandbound algorithm simplicial branchandbound algorithm presented section mentioned use algorithm 9 prototype however two heuristics designed obtaining feasible solutions embedded branching operation carried dividing current simplex two simplices let v v j two vertices satisfying 2 denotes 2norm vector define simplex split two simplices splitting simplices property nested sequence q simplices details see horst 4 5 resulting algorithm presented branch bound algorithm step 1 start heuristic1 calculate possible feasible solution v f objective function value fv f successful set step 11 let construct simplex 0 contains polytope u set solve problem lpr s0 problem infeasible original problem solution stop otherwise let optimal solution optimal value 0 set feasible solution p2 stop otherwise start heuristic2 v 0 calculate feasible solution v 0 value fv 0 lb fv 0 set step 12 ub lbub stop k 2 k according 25 28 set k step 21 solve problem lpr j infeasible set let optimal solution k optimal value j step 22 v j k feasible solution p2 set step 23 v j k feasible run heuristic2 v j k calculate feasible solution v j value fv j otherwise select simplex set 2 details heuristic1 heuristic2 given section 4 parameter gives tolerance solution obtained algorithm call solution obtained algorithm optimal solution convergence algorithm guaranteed follows theorem 1 6 8 9 algorithm generates infinite sequence v k every accumulation point v sequence optimal solution problem 1 algorithms heuristic1 heuristic2 described section recall heuristic1 finds feasible solution beginning branchandbound algorithm heuristic2 generates feasible solution infeasible solution obtained relaxation subproblem first give algorithm heuristic1 basic idea place many spheres possible relatively large radii polytope let c list given set kl candidate spheres ordered r 1 r kl consider 3d triangle defined four constraints arbitrarily chosen polytope p designate triangles fixing p algorithm starts picking sphere top c checks whether sphere located one four corners triangle p procedure continued rest spheres list four spheres placed search spheres list exhausted spheres packed satisfy 1that touch exactly three sides triangle 2 mutual intersection occurs pair spheres see figure 1 3 satisfy constrains p obtaining initial packing algorithm attempts insert spheres pair spheres p without violating packing condition see figure 2 phase figure 1 figure 2 step 1 determine center sphere l tangent three planes corresponding three constraints p sphere l satisfies constraints polytope p overlap spheres 1 k 1 pack sphere l set step 2 ik l ii l kl k 0 go step 5 step 3 stop otherwise set l1 go step 1 step 4 set l step 1 phase ii step 5 otherwise pair packed spheres j set l 1 repeat steps 6 7 step 6 l kl stop otherwise set step 7 locate center sphere l satisfies constraints p overlap spheres 1 k pack sphere l set go step 6 termination algorithm k 0 feasible packing obtained next describe heuristic2 let solution relaxation subproblem suppose feasible either ik integral spheres overlap radius decided ie use r k radius sphere see figure 3 following fix centers spheres determine radii mutually overlap see figure 4 note triplet means sphere placed let r 1 r k figure 3 figure 4 heuristic2 step 1 set step 2 sphere l centered satisfies polytope constraints overlap spheres 1 l 1 set sphere l centered l z l radius r k go step 4 step 3 k k set 2 otherwise set lk sphere centered l z l step 4 l l set l 2 otherwise stop 5 improvement algorithm section discuss special structures optimization present improvements previous algorithm based structures first describe construct initial simplex 51 generating initial simplex start branchandbound algorithm need initial simplex 0 contains polytope u generated following algorithm generate initial simplex step 1 choose nondegenerate vertex v 0 polytope u step 2 construct matrix r nn n binding constraints step 3 compute step 4 set remark 1 n constraints decide nondegenerate vertex v 0 selected follows choose three constraints 9 constraints 11 dicult see n coecient vectors constraints linearly independent set linear inequality constraints linear equations ie system linear equations determines unique solution considered v 0 remark 2 vertex v 0 kl zero entries determined 31 equation 30 replaced solution obtained maintains k repeating process equations 30 yields 3l solutions index v 1 v 3l solutions generated replacing denoted v 3l1 v n precisely 52 splitting simplex dierent way well known simplicial branchandbound paradigm computational time usage memory grow extremely fast dimension polytope u increases simplex split two simplices according 25 28 length longest among pairs vertices simplex vertex v 0 replaced vertex v matrix w 1 w except column v v 0 replaced column v v 0 similarly columns matrix w 2 w except column v j v 0 replaced v v 0 recall entries zeros matrices 12 hence coecients j sil 22 depends first 3l coordinates v 0 values first 3l coordinates sil remains unchanged constraints 22 subproblem respect simplices j j 1 2 quality relaxation would significantly improved splitting leads computation subproblems provide neither good lower useful upper bounds avoid situation choose v v j v maximum among consequently coordinates corresponding ik considered one negative eect choice quality relaxation constraint necessarily improved however since linear constraint always considered defect expected serious accordingly number subproblems decreased whole branchandbound process another potential diculty convergence algorithm must addressed let v vertices q since divide simplex minimize largest value v vertices possible nested sequence q simplices satisfy 29 case guaranteed accumulation point infinite sequence obtained algorithm optimal solution 53 another decomposition matrix q il shown section 2 make underestimation quadratic function lefthand side quadratic constraint 7 use decomposition 12 replacing 2 ik ik 7 could result dierent matrix il r 2 r 1 r k r 2 r k r 2 spectral decomposition matrix q il provides positive semidefinite negative semidefinite matrices dierent given 12 following procedure similar section 2 c il il positive semidefinite negative semidefinite respectively example two magnitudes radii r 1 r 2 considered c il r klkl constructed follows let 2 il r 2r 23r 2s r 2r 23r 2s r 1 r 2 r 2 r 2 r 2 r 1 r 2 r 2 il shown eigenvalues matrix c il nonnegative resp nonpositive hence two matrices desired properties consequently another lp relaxation constructed based new spectral decomposition remains change decomposition 54 another form relaxation section focus dierent form relaxation problem p2 let us omit quadratic constraints 8 corresponding 0 1 condition ik furthermore relax condition two spheres overlap distance two spheres needs greater small positive value precisely consider problem st remark one take smallest value among radii given set magnitude since variables quadratic p4 convex envelope concave function x x l determined first 3l coordinates vertices corresponding simplex given implies sucient construct simplices 3ldimensional space let initial simplex 3ldimensional space contains polytope p ith entry v j identical v j defined similarly q il respectively let x submatrices corresponding following quadratic program st negative semidefinite matrix convex envelope quadratic term v therefore obtain relaxation p4 follows since constraints 8 ignored constraints 7 relaxed 42 problem quality relaxation may inferior previous methods however dimension simplices kept memory 3l therefore total memory used may far smaller required methods 6 computational study section discuss details implementation algorithm report experimental results reoptimization suppose simplex branching node simplex divided 1 2 25 28 vertex v 0 replaced v columns matrices w 1 w 2 replaced v v 0 respectively columns remain unchanged therefore case two new subproblems generated splitting 1 2 could use information optimal solution lp relaxation problem associated construction lp relaxation problem respect 1 2 coecients corresponding j constraints 22 23 changed due substitutions column v v 0 w 1 w 2 respectively consequently changing coecients could use reoptimization technique solve lp relaxation problem starting optimal solution corresponding simplex test problems test problems generated follows first construct simplex vertices 0 0 10 10 0 0 0 10 0 10 10 10 calculate maximum inscribed sphere simplex radius 288675 randomly generate points surface sphere construct tangent planes x z pass points respectively let z halfspace containing inscribed sphere intersection h simplex 3dimensional polytope sphere packing problem considered hence total number linear constraints polytope test set 4 dierent pairs radii spheres used shown tables 12 table 1 combinations radii c r radius 6 100 050 table 2 combinations radii c r radius computational experiments conducted dec alpha 21164 workstation 600mhz used cplex 651 lp solver relaxation problems limits memory computational time set 512mb 3600 seconds respectively besides prototype algorithm given section 3 three variations also implemented 1 algorithm nss uses simplex splitting given section 52 2 algorithm nmd uses matrix decomposition given section 53 3 algorithm xyz uses simplex xyz space given section 54 algorithm tested 5 instances pair c r radii table 1 since three algorithms reached either limit memory limiting computational time instances present results algorithm xyz data shown tables 47 table 10 represent average results legends used tables given table 3 tables 47 observe computational time grows drastically number spheres packed increased since dimension problem 3 outcome consistent observation 1 9 computational time table 3 legends used tables legend meaning l maximum number spheres packed c r combination radii lp number linear programs solved number cases terminated caused limit cpu time 3600 seconds e number cases terminated number cases terminated caused limit memory 512 mb time cpu time seconds ublb ratio values ub lb ub ub lb upper lower bounds objective function value respectively algorithm org prototype algorithm given section 3 algorithm nss algorithm using simplex splitting given section 52 algorithm nmd algorithm using spectral decomposition given section 53 algorithm xyz algorithm using simplex xyz space section 54 increases exponentially dimension increases big dierence algorithm org algorithm nmd sense gross behaviors algorithm nss solves fewer lps two previously mentioned algorithms therefore needs less time leads solution greater number instances without violating limits either memory time since simplex splitting based length first 3l coordinates avoids solving unnecessary subproblems among algorithms algorithm xyz shows best performance instances solved except case c even successfully obtained solutions half instances 5 two reasons behavior considered first since dimension simplices 3l much less memory needed keep information simplices second since simplices involve coordinates variables x z simplex splitting favorable characteristic algorithm nss fewer lps needed solved noted dimension instances solved previous papers 1 9 range 16 ii computational time memory demand simplicial branchandbound algorithm usually increases exponentially dimension problem therefore modest increase dimension could put solution range contrast sphere packing problem discussed dimension instances solved algorithm xyz extended hence conclude algorithm xyz gains eciency since takes advantage intrinsic structure problem next let us focus algorithm org algorithm xyz consider influence polytope p performance five instances polytope generated randomly number constraints taking results shown tables 89 observed even l c r identical comparative behaviors algorithms sensitive shape polytope behavior arises since quality solutions generated heuristics depends shape polytope ii initial simplex 0 depends polytope skinny polytope volume 0 p 0 would large fact means algorithms copiously waste eort solving lps defined zone reaching optimal solution table shows results three values radii considered ie value k eects number quadratic constraints 8 ii increasing number quadratic constraints enhances diculty problem comparing case results table 7 observed big change numbers lps solved algorithm less sensitive value k size l occurs since numbers quadratic constraints 7 8 grow increasing l finally algorithms exhibited reduced performance c namely dierences radii large conclusions paper considered optimization unequal sphere packing demonstrated improvements existing simplicial branchandbound algorithm advantageous use intrinsic structure problem specially computational study showed improved algorithm xyz could solve instances much larger size observed optimal solutions found many instances algorithm reached limitations either computational time memory signals table 4 results algorithm org time e algorithm spends large amount eort verifying optimality solution turn behavior indicates 1 developing improved method relaxation necessary solving problems larger size 2 algorithm terminated solution obtained high quality 3 better heuristic method could start feasible solution obtained branchandbound algorithm would important obtaining approximate solution larger problems table 5 results algorithm nmd time e table results algorithm nss table 7 results algorithm xyz time e table 8 results algorithm org time table 9 results algorithm xyz time table 10 results algorithm xyz time e r relaxation method nonconvex quadratically constrained quadratic programs semidefinite programming relaxations nonconvex quadratic programs generalized bisection nsimplices handbook global optimization global optimization deterministic approaches siam journal comput ing global optimization action simplicial branchandbound method solving nonconvex quadratic programs new reformulationlinearization technique bilinear programming problems strippacking algorithm absolute performance bound 2 packing unequal spheres automated radiosurgical treatment plan ning physics dosimetry gamma knife tr threedimensional packing generalized bisection italicnitalicsimplices strippacking algorithm absolute performance bound 2 simplicial branchandbound method solving nonconvex allquadratic programs