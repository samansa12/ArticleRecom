generalization lamberts reflectance model lamberts model body reflection widely used computer graphics used extensively rendering techniques radiosity ray tracing several realworld objects however lamberts model prove inaccurate approximation body reflectance brightness lambertian surface independent viewing direction rough surface increases viewing direction approaches light source direction paper comprehensive model developed predicts body reflectance rough surfaces surface modeled collection lambertian facets shown surface inherently nonlambertian due foreshortening surface facets model accounts complex geometric radiometric phenomena masking shadowing interreflections facets several experiments conducted samples rough diffuse surfaces plaster sand clay cloth surface demonstrate significant deviation lambertian behavior reflectance measurements obtained strong agreement reflectance predicted model b introduction active area research computer graphics involves creation realistic images images rendered using one two wellknown techniques namely ray tracing 34 radiosity 6 quality rendered image depends great extent accuracy reflectance model used past decade computer graphics witnessed application several physicallybased reflectance models image rendering see 7 16 9 13 reflection surface broadly classified two categories surface reflectance takes place interface two media different refractive indices body reflectance due subsurface scattering previous work physicallybased rendering focused accurate modeling surface reflectance predict ideal specular reflection smooth surfaces well wide directional lobes rougher surfaces 13 contrast body component often assumed lambertian lambertian surface appears equally bright direc tions model advanced lambert 18 200 years ago remains one widely used models computer graphics several realworld objects however lambertian model prove poor inadequate approximation body reflection figure 1a shows real image clay vase obtained using ccd camera vase illuminated single distant light source direction sensor figure 1b shows rendered image vase shape one shown figure 1a image rendered using lamberts model illumination direction case real vase expected lamberts model predicts brightness b figure 1 real image cylindrical clay vase b image vase rendered using lambertian reflectance model cases illumination viewing direction cylindrical vase decrease approach occluding boundaries sides however real vase flat appearance image brightness remaining almost constant entire surface vase clearly lambertian 1 deviation lambertian behavior significant variety realworld materials concrete sand cloth accurate model describes body reflection commonplace surfaces imperative realistic image rendering 1 note real vase significant specular component case vertical highlight would appeared middle vase makes vase shown figure 1a non lambertian show primary cause deviation roughness surface figure 2 illustrates relationship magnification reflectance also see 16 reflecting surface may viewed collection planar facets high magnification picture element rendered pixel includes single facet lower magnifications pixel include large number facets though lambertian assumption often reasonable looking single planar facet reflectance lambertian collection facets imaged onto single pixel deviation significant rough sur faces increases angle incidence pa per develop comprehensive model predicts body reflectance rough surfaces provide experimental results support model lamberts model stance limit proposed model reflectance scale pixel pixel specular facets torrancesparrow lambertian facets orennayar figure 2 roughness surface causes reflectance properties vary image magnification topic rough surfaces extensively studied areas applied physics geophysics engineer ing development first models primarily motivated describe nonlambertian behavior moon models empirical opiks model 22 modification minnaert 19 models physical foundation found incorrect contrast smith 29 buhl et al 3 attempted develop theoretical models reflectance rough surfaces smith modeled rough surface random process assumed point surface lambertian reflectance smiths analysis however confined plane incidence easily extensible reflections outside plane moreover smiths model account interreflection effects buhl et al 3 modeled surface collection spherical cavities analyzed interreflections using surface model present complete model accounts masking shadowing effects arbitrary angles reflection incidence subsequently hering smith 14 derived detailed thermal emission model surfaces modeled collection vcavities however cavities assumed identical aligned direction namely perpendicular sourceviewer plane model limited plane incidence recently body reflection emerged topic interest graphics community poulin fournier 26 derived reflectance function anisotropic surfaces modeled collection parallel cylindrical sections addressing different cause nonlambertian reflectance one discussed hanrahan krueger 10 used linear transport theory analyze subsurface scattering multilayered surface researchers graphics numerically precomputed fairly complex reflectance functions stored results form lookup tables coefficients spherical harmonic expansion examples see 4 16 33 approach though practical many instances replace need accurate analytical reflectance models reflectance model developed applied isotropic well anisotropic rough surfaces handle arbitrary source viewer directions takes account complex geometrical effects masking shadowing interreflections points sur begin modeling surface collection long symmetric vcavities vcavity two opposing facets facet assumed much larger wavelength incident light surface model used torrance sparrow 30 describe incoherent directional component surface reflection rough sur faces assume facets lambertian 2 first develop reflectance model anisotropic surfaces one type facetslope vcavities cavities aligned direction surface plane next result used develop model general case isotropic surfaces normal facet distributions zero mean arbitrary standard deviation standard deviation parameterizes macroscopic roughness surface fundamental result work body reflectance rough surfaces uniform increases viewer moves toward source direction deviation lamberts law predicted previous reflectance model present several experimental results demonstrate accuracy model experiments conducted real samples sand plaster cloth cases reflectance predicted model found strong agreement measurements derived model implemented shading function renderman 32 conclude comparing real rendered images variety objects results demonstrate two points fundamental computer graphics several realworld objects body reflection components significantly nonlambertian b model presented paper used create realistic images variety realworld objects surface roughness model effects shadowing masking interreflection need analyzed order obtain accurate reflectance model accomplish use roughness model proposed torrance sparrow 30 assumes surface composed long symmetric vcavities see figure 3 cavity consists two planar facets width facet assumed small compared length assume facet area da small compared area da surface patch imaged single sensor pixel hence pixel includes large number facets facet area large compared wavelength incident light therefore geometrical optics used derive reflectance model assumptions summarized 2 da da denote slope orientation facet vcavity model oe polar angle assumption limit implications reflectance model presented nonlambertian behavior reported expected wide range local body reflectance models see 5 example since surface roughness shown play dominant role da da q figure 3 surface modeled collection vcavities oe azimuth angle torrance sparrow assumed facets equal area da use distribution represent number facets per unit surface area normal oe use probability distribution represent fraction surface area occupied facets given normal referred slopearea distribution p oe facetnumber distribution slopearea distribution related follows slopearea distribution easier use number distribution following model derivation since distributions rotationally symmetric respect global surface normal figure 3 3 reflectance model section derive reflectance model rough diffuse surfaces lack space important results discussed details refer reader oren nayar 23 24 derivation draw several wellknown radiometric definitions given 20 consider surface area da imaged single sensor element direction distant point light source direction area da composed large number symmetric vcavities vcavity composed two facets slope facing opposite directions consider flux reflected facet area da normal projected area surface occupied facet da cos see figure 3 thus computing contribution facet radiance surface patch need use projected area da cos actual facet area da radiance contribution call projected radiance facet da cos cos r dr 2 dr solid angle subtended sensor optics ease description dropped source viewing directions notations projected radiance flux consider slopearea distribution facets given p oe total radiance surface obtained aggregate lrp oe facets surface z a0 31 model unidirectional singleslope distribution first surface type consider facets slope vcavities aligned direction azimuth angles facets either oe oe consider lambertian facet albedo ae fully illuminated shadowing completely visible mask ing sensor direction radiance facet proportional irradiance equal ae irradiance facet ea e0 irradiance facet illuminated headon ie denotes dot product two vectors using definition radiance 20 flux reflected facet sensor direction v substituting expression 2 get expression clearly illustrates projected radiance tilted lambertian facet equal viewing directions geometric attenuation factor surface illuminated viewed normal direction n facets fully illuminated visible larger angles incidence reflection however facets shadowed masked adjacent facets see figure 4 geometrical phenomena reduce projected radiance facet reduction brightness derived using geometry incorporated single term called geometrical attenuation factor gaf lies zero unity several derivations gaf presented 30 2 23 final result compactly represented gaf valid facet normal necessarily bisector angle source sensor direction x z q x z x z x shadowing b masking c interreflection figure 4 shadowing masking interreflection vcavity projected radiance gaf projected radiance lambertian facet obtained multiplying projected radiance given 4 gaf given 5 note projected radiance denoted l 1 rp superscript used indicate radiance due direct illumination source following discussion use l 2 rp denote radiance due interreflections interreflection factor task modeling interreflections presence masking shadowing ef fects case lambertian surfaces energy incident light ray diminishes rapidly interreflection bounce therefore model twobounce interreflections ignore subsequent bounces since length l vcavity much larger width w ie l ae w viewed onedimensional shape translational symmetry shapes twobounce interreflection component determined integral onedimensional crosssection shape 28 z r ydy 7 x shortest distances facet points intersection two facets see figure 4c k 0 kernel translational symmetry case derived 15 8 know orientation considered facet orientation adjacent facet limits integral interreflection equation determined masking shadowing two facets let mv width facet visible viewer width adjacent facet illuminated definitions radiance projected radiance get v da r x dx using following change variables w radiance due twobounce interreflections given 7 written using 8 integral evaluated refer right hand side equation 11 interreflection factor total projected radiance facet sum two components radiance due direct source illumination given equation 6 interreflection component therefore lrpa oe unidirectional singleslope surface considered two types facets normals oe oe hence radiance surface given source sensor directions simply average projected radiances two facet types 32 model isotropic singleslope dis tribution facets isotropic surface slope uniformly distributed oe previous section evaluate projected radiance sum two components projected radiance due direct illumina tion rp projected radiance due interreflection previous section calculated two components single facet normal therefore radiance isotropic surface determined integral projected radiance oe given source direction direction first find ranges facet orientation oe facets masked shadowed masked shad owed neither masked shadowed 3 requires careful geometrical analysis integral decomposed parts corresponding maskingshadowing ranges range evaluated using corresponding radiance expressions 6 11we refer interested reader oren nayar 23 24 details 33 model gaussian slopearea distri bution surface considered consists vcavities single slope realistic surfaces modeled slopearea distribution p oe includes variety different facet slopes surface roughness isotropic slopearea distribution described using single parameter namely since facets uniformly distributed oe two components radiance isotropic surface therefore determined z 0 rp sin da 13 projected radiance components obtained previous section assume isotropic distribution gaussian mean standard deviation oe ie p oe reasonably rough surfaces described using zero mean distribution 2oe 2 c normalization constant 34 functional approximation reflectance model obtained evaluating integral using results section 32 gaussian distribution 0 resulting integral cannot easily evaluated therefore pursued functional approximation integral accurate arbitrary surface roughness angles incidence reflection deriving approximation carefully studied functional forms l evaluated previous step details found oren nayar 23 24 enabled us identify basis functions used approximation conducted large set numerical evaluations integral 13 varying surface roughness oe angles incidence reflection r oe r evaluations identified basis functions used arrive accurate functional approximation surface radiance procedure applied independently source illumination component well interreflection component final approximation results given define source illumination component radiance surface roughness oe 3 imagine vcavity rotated global surface normal given source sensor direction various maskingshadowing scenarios visualized coefficients sin ff cos oe sin otherwise approximation interreflection component two components combined obtain total surface radiance finally brdf surface obtained radiance irradiance fr r important note approximation presented obeys helmholtzs reciprocity principle see 1 also note model reduces lambertian model note substituting albedo function wavelength ae dependency model wavelength comes explicitly next section present several experimental results verify diffuse reflectance model give brief illustration main characteristics model figure 5 shows reflectance predicted model rough surface radiance lr plane incidence oe plotted function reflection angle r incidence angle two curves shown figure obtained numerical evaluation integral 13 first curve solid line includes direct illumination interreflection components radiance second thin line direct illumination compo nent notice radiance plots deviate substantially lambertian reflectance surface radiance increases viewing direction approaches source direction curves divided three sections backward source direction radiance maximum gets cut due strong masking effects r exceeds cutoff occurs exactly independent rough ness middle section plot radiance varies approximately scaled tan r function constant offset finally interreflections dominate forward direction facets selfshadowed visible facets receive light primarily adjacent facets illustrated difference two curves figure 6a effect varying incidence angle shown chosen plot brdf rather radiance better illustrate effect varying r r strong masking strong interreflection lambertian forward backward figure 5 diffuse reflectance plane incidence surface incidence angle thin line radiance due direct illumination without inter reflections f r f f r f f r f b figure brdf different angles incidence b radiance outside plane incidence plots interesting note model predicts nearlambertian behavior small incidence angles 0 results facets vcavity nearly equal irradiance small angles incidence incidence angle increases backscatter phenomenon begins dominate figure 6b shows effect placing sensor outside plane incidence sensornormal plane perpendicular sourcenormal plane rough surface exhibits nearlambertian characteristics qualitative model section propose simplification reflectance model presented previous section order obtain simplification slight sacrifice accuracy must made return computations saved image rendering following simplified model arrived studying numerous simulations relative significance various terms functional approximation given 14 simulations showed coefficient c3 makes relatively small contribution total radiance simpler model thus obtained discarding c3 ignoring interreflections ae sin ff tan fi two coefficients b obtained directly c1 c2 respectively note qualitative model also reduces lambertian model 4 experimental verification conducted several experiments verify accuracy reflectance model experimental setup 23 24 used measure radiance samples shown figure 7 camera light source sample figure 7 sketch photograph setup used measure reflectance figures 8 9 shows results obtained samples wall plaster sand b radiance sample plotted function sensor direction r different angles incidence measurements made plane incidence oe 0 measured brightness values shown dots compared predicted model plotted solid lines two samples b oe ae selected empirically obtain best match measured predicted flectance used numerical evaluation model equation 13 samples radiance increases viewing direction r approaches source direction reflection contrast behavior rough specular surfaces reflect forward direction lambertian surfaces radiance vary viewing direction samples model predictions experimental measurements match remarkably well cases small peak noticed near source direction phenomenon known opposition effect retroreflection sharp peak close source direction caused different backscattering mechanism one described model see 12 17 31 21 27 11 figures show results sample c foam sample cloth body reflectance component also significant surface reflection component case reflectance model used linear combination new model torrancesparrow model 30 describes incoherent directional component surface reflection based surface model long symmetric ks l r r l r body surface reflection components respectively kb ks weighting coefficients two components experiment used functional approximation reflectance parameters oe ae kb ks estimated fitting using nonlinear optimization model measured data additional experiments reported oren nayar 23 wall plaster r figure 8 reflectance measurement reflectance model using plots wall plaster sample radiance plotted function sensor direction r different angles incidence sand r figure 9 reflectance measurement reflectance model using plots white sand sample b foam r figure 10 reflectance measurement reflectance model plots foam sample c cloth r figure reflectance measurement reflectance model plots cotton towel sample 5 implications graphics section describe implications proposed model realistic rendering figure 12a shows real image rough cylindrical clay vase discussed troduction figure 12b shows rendered image vase using lambertian model known geometry clearly rendered image match real image vase hand appearance rendered vase using proposed reflectance model shown figure 12c closely resembles real vase model parameters chosen empirically obtain best fit measured brightness values figure 13a compares brightness values along crosssection three different vase images figure 12 interesting note brightness real vase remains nearly constant crosssection drops quickly zero close limbs proposed model well predicting behavior lambertian model produces large brightness errors figure 13b shows similar plots illumination 20 ffi right sensor case brightness variation real vase asymmet ric proposed model closely matches real image however lambertian model forces brightness close right limb vase drop much faster real image result brightness peak predicted lambertian model significantly away actual peak image b lambertian c model figure 12 real image cylindrical clay vase compared images rendered using lambertian proposed models illumination camera direction lambertian model measurements brightness brightness b figure 13 comparison image brightness along crosssection real vase vases rendered using lambertian proposed models functional approximation given equation 14 qualitative model given 17 easily used realistic rendering implemented functional approximation shader using renderman shading language 32 figure 14 shows spheres rendered using shader four cases sphere illuminated viewer direction first case oe 0 hence sphere appears lambertian roughness increases sphere begins appear flatter extreme roughness case shown figure 14d sphere appears like flat disc near constant brightness phenomenon widely observed reported case full moon 2528 finally figure 15 shows rendered images scene three matte objects vase cylindrical block cube figure 15a three objects zero macroscopic rough ness ie lambertian illumination case viewer direction note vase cylinder strong brightness variations three visible faces cube distinctly different brightness val ues figure 15b scene illuminated viewer direction three objects roughness consequently shading vase cylinder diminished considerably furthermore contrast flat curved sections cylindrical block also contrast three faces cube reduced substantially important note moderate shading achieved without ambient component illumination rather modeling roughness effects 6 summary conclusion developed comprehensive model body reflectance surfaces macroscopic roughness model first derived anisotropic surfaces facets one slope result used develop model isotropic surfaces gaussian slopearea distri bution also presented qualitative model diffuse reflection simple functional form numerous experiments conducted verify reflectance mechanism described paper real rendered images diffuse objects compared demonstrate proposed model important implications computer graphics r scattering electromagnetic waves rough surfaces models light reflection computer synthesized pictures reradiation thermal emission illuminated craters lunar surface bidirectional reflection functions surface bump maps radiative transfer hemicube reflection model computer graphics mutual illumination illumination color computer generated im agery reflection layered surfaces due subsurface scattering opposition effect moon contribution coherent backscatter photometric studies complex surfaces comprehensive physical model light reflection apparent radiation properties rough surface heat transfer anisotropic reflection model retroreflectance dense distribution spherical particles photometria sive de mensure de gratibus luminis reciprocity principle lunar photometry geometrical considerations nomenclature reflectance photometric studies diffusely reflecting surfaces application brightness moon photometric measures moon moon earthshine generalization lambertian model implications machine vision generalization lamberts reflectance model photometric relief lunar surface model anisotropic reflection digital correction solar illumination viewing angle artifacts remotely sensed images thermal radiation heat transfer lunar surface roughness shadowing thermal emission theory offspecular reflection rough surfaces backscattering enhancement random discrete scatterers renderman companion predicting reflectance functions complex surfaces improved illumination model shaded display tr bidirectional reflection functions surface bump maps illumination color computer generated imagery model anisotropic reflection shape interreflections comprehensive physical model light reflection predicting reflectance functions complex surfaces reflection layered surfaces due subsurface scattering hemicube reflectance model computer graphics improved illumination model shaded display ctr ravi ramamoorthi melissa koudelka peter belhumeur fourier theory cast shadows ieee transactions pattern analysis machine intelligence v27 n2 p288295 february 2005 michael ashikmin simon premoe peter shirley microfacetbased brdf generator proceedings 27th annual conference computer graphics interactive techniques p6574 july 2000 p f lafortune singchoong foo kenneth e torrance donald p greenberg nonlinear approximation reflectance functions proceedings 24th annual conference computer graphics interactive techniques p117126 august 1997 alexander wilkie andrea weidlich caroline larboulette werner purgathofer reflectance model diffuse fluorescent surfaces proceedings 4th international conference computer graphics interactive techniques australasia southeast asia november 29december 02 2006 kuala lumpur malaysia dave edwards solomon boulos jared johnson peter shirley michael ashikhmin michael stark chris wyman halfway vector disk brdf modeling acm transactions graphics tog v25 n1 p118 january 2006 g scott owen ying zhu jeff chastine bryson r payne teaching programmable shaders lightweight versus heavyweight approach acm siggraph 2005 educators program july 31august florian struck christiana bohn sebastian schmidt volker helzle realistic shading human skin real time proceedings 3rd international conference computer graphics virtual reality visualisation interaction africa november 0305 2004 stellenbosch south africa marc levoy kari pulli brian curless szymon rusinkiewicz david koller lucas pereira matt ginzton sean anderson james davis jeremy ginsberg jonathan shade duane fulk digital michelangelo project 3d scanning large statues proceedings 27th annual conference computer graphics interactive techniques p131144 july 2000 marco pellegrini rendering equation revisited avoid explicit visibility computations proceedings tenth annual acmsiam symposium discrete algorithms p725733 january 1719 1999 baltimore maryland united states stphane mrillou jeanmichel dischler djamchid ghazanfarpour brdf postprocess integrate porosity rendered surfaces ieee transactions visualization computer graphics v6 n4 p306318 october 2000 jason lawrence szymon rusinkiewicz ravi ramamoorthi efficient brdf importance sampling using factored representation acm transactions graphics tog v23 n3 august 2004 andrew gardner chris tchou tim hawkins paul debevec linear light source reflectometry acm transactions graphics tog v22 n3 july yizhou yu paul debevec jitendra malik tim hawkins inverse global illumination recovering reflectance models real scenes photographs proceedings 26th annual conference computer graphics interactive techniques p215224 july 1999 aner benartzi ryan overbeck ravi ramamoorthi realtime brdf editing complex lighting acm transactions graphics tog v25 n3 july 2006 paul debevec tim hawkins chris tchou haarmpieter duiker westley sarokin mark sagar acquiring reflectance field human face proceedings 27th annual conference computer graphics interactive techniques p145156 july 2000 lifeng wang wenle wang julie dorsey xu yang baining guo heungyeung shum realtime rendering plant leaves acm transactions graphics tog v24 n3 july 2005 naty hoffman dan baker jan kautz conclusionssummary acm siggraph 2006 courses july 30august 03 2006 boston massachusetts lifeng wang wenle wang julie dorsey xu yang baining guo heungyeung shum realtime rendering plant leaves acm siggraph 2006 courses july 30august 03 2006 boston massachusetts bruno mercier daniel meneveaux alain fournier framework automatically recovering object shape reflectance light sources calibrated images international journal computer vision v73 n1 p7793 june 2007 zhouchen lin tientsin wong heungyeung shum relighting reflected irradiance field representation sampling reconstruction international journal computer vision v49 n23 p229246 septemberoctober 2002 donald p greenberg kenneth e torrance peter shirley james arvo eric lafortune james ferwerda bruce walter ben trumbore sumanta pattanaik singchoong foo framework realistic image synthesis proceedings 24th annual conference computer graphics interactive techniques p477494 august 1997