untangling 2d meshes ale simulations procedure presented untangle unstructured 2d meshes containing inverted elements node repositioning inverted elements may result node movement arbitrary lagrangian eulerian ale simulations continuum mechanics problems large shear deformation fluid flow metal forming meshes inverted elements may also created due limitations mesh generation algorithms particularly nonsimplicial mesh generation untangling procedure uses combination direct node placement based geometric computation feasible set node repositioning driven numerical optimization objective function achieves minimum valid mesh shown combination feasible set based method optimization method achieves best results untangling complex 2d meshes preliminary results also presented untangling 3d unstructured meshes approach b introduction arbitrary lagrangianeulerian ale methods popular class methods simulating continuum mechanics problems large shear deformation uid ow metal forming 12 ale methods consist lagrangian step mesh nodes move according ow material rezone step mesh modied improve quality remapping step solution transferred old mesh new improved mesh 35 methods described improve quality mesh keeping close original mesh however order improve meshes methods described 35 elements starting mesh must valid noninverted therefore lagrangian step ale simulation causes mesh become tangled ie elements become inverted mesh must untangled mesh improvement procedures applied need untangling meshes also exists mesh generation procedure unable create valid elements mesh situation may encountered generation hexahedral meshes general polyhedral meshes guaranteed method directly generating valid mesh 6 may also encountered advancing front based mesh generation tetrahedral hexahedral meshes 79 possible generate small cavities cannot lled positive volume elements cases useful tool untangle mesh initial generation assuming right mesh connectivity generated several researchers recently begun focusing problem untangling unstructured meshes node repositioning 1013 freitag plassmann 1114 untangle meshes optimization local function based maximizing minimum element area mesh vertex knupp 12 performs global optimization dierence absolute signed values element volumes order untangle mesh kovalev etal 13 visit vertex connected least one invalid element reposition vertex directly point feasible set kernel make connected elements valid dene feasible set vertex set locations vertex elements connected vertex valid new location vertex feasible set found clever use simplex method nd three corners feasible set taking mean procedures capable successfully untangling many tangled mesh congurations however conditions may fail untangle mesh may able produce elements sucient positive volume provide good starting point mesh improvement procedures paper method presented untangling unstructured 2d meshes containing triangles quadrilaterals method uses multistep approach based combination relocating vertices positions respective feasible sets minimizing function untangle mesh elements untangling procedures reposition nodes untangle mesh perform topological modications since solution transfer meshes dierent connectivity complex expensive also interest accurate solution transfer procedures endeavor keep mesh close possible original mesh methods described focus ensuring elements mesh meet least bare minimum validity criteria dened simulation procedures use however methods easily combined separate procedures improving quality untangled mesh like ones described 45 rest paper organized follows next section discusses denition element validity denition feasible set vertex section 3 describes untangling mesh feasible set method untangling optimization objective function discussed section 4 section 5 describes multistep untangling procedure achieved greater success untangling meshes two untangling methods finally several simple complex examples mesh untangling mesh optimization 45 presented section 6 followed conclusions denitions study element considered valid corner element considered valid element corner valid jacobian determinant mapping right angle corner unit sides positive requirement conservative required numerical methods 15 element subcells must decomposition one set simplices triangles tetrahedra positive volumes see figure 1 however explicitly account requirements methods positive jacobian determinants everywhere quadrature points given denition element validity feasible set vertex dened set positions vertex connected element valid corners aected position vertex words vertex feasible set connected element valid vertex adjacent edgeconnected neighbors vertex b c e f g f g fig 1 valid invalid quadrilateral elements ab valid quads positive jacobian everywhere c quad valid decomposition positive area triangles abc acd negative jacobian reentrant corner c quad valid decomposition positive area triangles e quad decomposition valid subcells aeoh bfoe fcgo gdho negative jacobian c f quad invalid subcells feasible set vertex connected single triangle halfspace shown 2d example figure 2a assuming ccw ordering vertices triangle vertex connected single quadrilateral general polygonal element feasible set vertex dened intersection three halfspaces illustrated figure 2b position vertex uences jacobian vertex v 1 two edge connected neighbors v 2 v 3 element gure vertex past line aa opposite direction arrows jacobian v 1 area triangle become negative moves past line bb jacobian v 2 area triangle negative moves past line cc jacobian v 3 area triangle figure 2c shows feasible set vertex interior patch elements denition feasible set clear feasible set convex polygon 2d convex polyhedron 3d note feasible set vertex empty depending geometry conguration elements connected vertex implies given positions boundary vertices patch location vertex simultaneously make elements valid example shown figure 3 along congurations feasible set line point feasible set element vertex halfplane boundary direction halfplane b c c fig 2 illustration feasible sets feasible set vertex connected single element b feasible set vertex connected pentagon c polygonal feasible set vertex connected patch triangular quadrilateral elements 3 untangling finding feasible set denition feasible set given leads natural method untangling meshes feasible set vertex determined vertex positioned inside referred feasible set method approach vertex mesh visited connected elements examined see invalid invalid element exists among feasible set line feasible set fig 3 degenerate null feasible sets feasible set line b feasible set point c null empty feasible set elements connected vertex feasible set vertex computed vertex placed center feasible set method loops mesh elements valid invalid element xed feasible set vertex found computing intersection halfspaces representing feasible region vertex respect element 2d accomplished intersection pairs lines demarcating feasibility halfplanes work feasible set found chasing algorithm described orourke 16 found work well number test cases figure 4 example mesh untangling intersection based feasible set method illustrated step step gure invalid quadrilaterals shown shaded nodes connected least one invalid quadrilateral shown black intersection based computation feasible set works well 2d nding feasible set polyhedron intersection halfspaces impractically complex 3d therefore alternate method positioning vertex inside feasible set implemented based simplex method described 13 13 idea proposed boundary lines halfplanes forming feasible set 2d interpreted inequality constraints minimization arbitrary function function linear function minimum must occur intersection two inequality constraints words corner feasible set polygon therefore corners feasible set polygon found minimizing dierent linear functions along appropriate inequality constraints using simplex method 1718 idea simplied recognizing untangling sucient c fig 4 untangling mesh feasible set method node placement center feasible set initial mesh bc intermediate meshes final mesh shaded quadrilaterals indicate invalid elements vertices represented black connected least one invalid quadrilateral nd one position vertex inside feasible set make connected elements valid implies unnecessary nd corners feasible set polygon therefore untangling patch elements 2d inferred sucient nd three distinct corners feasible set polygon reposition vertex center triangle formed corners therefore procedure minimizes simple linear functions nd three distinct corners feasible set polygon vertex repositioned center triangle formed corners two distinct corners found feasible set line connecting two vertex repositioned midpoint line one distinct corner found feasible set point vertex repositioned point note case feasible set line point one elements connected vertex zero area feasible set approach untangling useful direct way xing inverted elements aecting nodes connected invalid ele ments characteristic useful accurate solution transfer ale methods old mesh new untangled mesh also feasible set degenerate xing mesh method results elements substantial volume rather near zero volume however shortcoming approach elements cannot xed feasible set associated vertices empty optimization approach untangling several researchers proposed use numerical optimization untangling meshes approach appropriate objective function minimized make invalid elements valid freitag plassmann 11 attempt untangle meshes minimizing local function mesh vertex local function vertex taken minimum volume connected elements knupp 12 proposed optimization global objective function based dierence signed volumes elements corresponding absolute values thus objective function contribution element negative area area ith element mesh function minimized j minimization function bring elements zero area volume state still considered unusable numerical simulations therefore knupp suggested addition user controlled parameter function modifying j role force function reach minimum elements small positive volume instead zero volume however discussed later proper selection tricky behavior objective b c fig 5 objective function behavior respect areavolume one element linear function without b linear function c quadratic function function one element without shown figures 5a b respectively objective function eq 2 nonsmooth due presence absolute value term linear form minimization functions requires special expensive methods nonlinear optimization gradient based method used must modied account fact gradient objective function discontinuous done interrupting line search valid elements become invalid vice versa thereby causing jump gradient point gradient reevaluated optimization continued overcome optimization issues objective function proposed knupp 12 modied work quadratic smooth shown one element figure 5c since objective function one element smooth convex expected global objective function formed combining functions elements mesh shown eq 3 also smooth convex j smooth function minimized using standard numerical optimization method smooth functions conjugate gradient method 1718 found practice minimization quadratic form objective function untangles mesh reliably linear form illustrate untangling meshes numerical optimization 1d cases mesh untangling discussed rst example consider 1d fig 6 tangled 1d mesh b one possible untangled mesh conguration mesh 4 points x 1 x 2 x 3 x 4 x 1 x 4 xed boundary points x 2 x 3 interior points shown figure 6 make visualization mesh tangling easier valid elements shown nodes single line level invalid element shown one nodes next higher level going left right element 1 valid shown level element 2 invalid therefore displayed going x 2 x 3 next upper level element 3 valid vertices x 3 x 4 upper level note mesh shown gure cannot xed feasible set approach described earlier since x 3 x 1 making feasible set x 2 empty x 2 x 4 making feasible set x 3 empty objective function formed mesh function two variables readily visualized figures 7a b show linear quadratic objective functions respectively mesh interior central triangle represents portion x space mesh valid ie 4 paths taken optimization dierent starting points gure ie dierent tangled mesh congurations also shown gures mesh conguration shown figure 6 indicated point p 1 figures 7ab optimization performed nite small value seen nal valid conguration mesh depends starting invalid conguration mesh since solution nonunique also optimization procedure gets stuck using linear objective function eq 2 due presence discontinuities successfully untangles mesh using quadratic function see point p 2 second example illustrates possible nonlocal eect optimization approach mesh example chosen 1d example 11 points one point outside domain shown figure 8b placement point makes element x 6 x 7 invalid locations mesh vertices various congurations mesh optimization procedure untangles mesh shown figure 8ab fig 7 contour plots objective functions mesh untangling paths followed mesh points x 2 x 3 various starting congurations superimposed linear objective function objective function optimization uses 02 untangling seen optimization procedure moves nodes x 6 x 7 x 8 x 9 x 10 around make mesh untangled process several elements rst become invalid return valid state contrast feasible set approach could xed mesh simply placing x 6 x 5 x 7 initial mesh practice uncommon encounter meshes entangled extreme ways therefore optimization procedure usually aects small number nodes local neighborhood still approach adopted x much mesh possible feasible set approach using optimization untangle meshes fewer nodes perturbed process optimization procedure untangling 2d meshes similar 1d meshes eciency optimization procedure 2d meshes performed series local iterations mesh vertices minimize global objective function instead simultaneous movement mesh nodes important note local iteration vertex terms global function aected movement vertex grouped local objective function minimized simplex elements means areavolume elements connected vertex involved local function complex element types local function includes cross product triple product 3d edge vectors connected element computed vertex edge connected neighbors computing local objective function way ensures global objective function still minimized local iteration iteration node position b fig 8 optimization based untangling 1d mesh one node outside domain path followed mesh nodes optimization progresses bottom top b mesh conguration key stages optimization optimization global function interior vertices preceded loop boundary vertices mesh purpose untangling invalid elements connected boundary objective function boundary vertex evaluated interior vertex however optimization performed respect local parametrization mesh vertex respect boundary mesh edges connected 5 ensures boundary mesh vertex remains original discrete boundary movement figure 9 shows example mesh shown figure 4 untangled optimization procedure figure 9a shows mesh optimized using quadratic objective function without use 0 procedure untangles mesh zero valid elements barely valid barely valid elements interior vertices connected elements shaded gure figure 9b shows optimization nite calculated 10 problem size diagonal bounding box normalized number elements either x directions value 0106 seen gure mesh better case since elements positively valid b fig 9 invalid mesh figure 4 optimized using optimization quadratic objective function without barely valid elements shown shaded b bounding box diagonal normalized number elements x directions using optimization procedure untangling meshes choice must made carefully without ie 00 optimization procedure make elements valid sense volume every element positive least zero however zero volume elements unacceptable many numerical procedures improvement meshes zero volume elements dicult impossible therefore force untangled mesh positive volume elements optimization procedure must use 0 objective function hand increasing indiscriminately also quite detrimental since objective function minimum become nonzero end outside feasible region patch lack solution implies given boundary congura tion possible elements achieve volume equal greater undesirable eect increasing illustrated figure 11 using mesh patch shown figure 10 therefore approach adopted set minimum acceptable area volume elements respect mesh optimization procedures subsequently improve fig 10 mesh patch used illustrate eect increasing untangling optimization dotted triangle shows feasible region vertex v fig 11 eect increasing minimum function particular mesh patch solid triangle interior indicates feasible set dotted region indicates minimum function outside feasible set large mesh 5 threestep procedure mesh untangling previous sections seen feasible set approach local eect mesh could always x mesh hand optimization approach usually xed mesh making elements nonnegative could aect larger number nodes resulted barely valid elements therefore procedures combined 3step procedure maximizing possibility untangling mesh minimal impact mesh rst step procedure performs untangling feasible set method x many elements possible minimal impact valid part mesh second step procedure performs minimization quadratic objective function described earlier order x remaining invalid ele ments optimization procedure rst performs local vertexbyvertex optimization loop boundary vertices order try x many elements possible movement movement boundary vertices constrained original discrete boundary local parameterization technique 5 followed local optimization loop interior vertices connected invalid elements third step procedure performs another round untangling barely valid elements feasible set approach increase volume step requires redenition feasible set boundaries account desired element volumes done mesh usually suitable use input mesh quality improvement procedure one described 45 eect 3step procedure illustrated rst 1d example shown figure 12 rst step feasible set approach able x element x 4 x 5 moving x 5 middle x 4 x 6 however cannot x element x 8 x 9 feasible set x 8 x 9 empty second step optimization method xes elements nodes x 8 x 9 close third step feasible set method achieves better distribution nodes placing nodes connected barely valid elements x 8 x 9 x 9 x 10 middle respective feasible sets 6 results rst example shown figure 13 illustrates untangling mesh arising rayleightaylor simulation mesh made invalid lagrangian step ale simulation problem must xed simulation proceed figure 13a shows part overall domain figure 13b shows tangled portion mesh squares marking nodes connected invalid elements figure 13c shows untangled mesh corresponding tangled meshes shown figures 13ab stages feasible set method feasible set method optimization fig 12 three step procedure involving feasible set method optimization xing 1d mesh untangling mesh illustrated figure 14 figure 14a shows zoomin tangled portion original mesh figure 14b shows mesh rst untangling step feasible set method unable x elements figure 14c shows mesh untangling optimization elements made least barely valid figure 14d shows mesh second round untangling feasible set method elements brought positive volume state finally figure 14e shows mesh improvement reference jacobian matrix based optimization procedure 45 type mesh optimization procedure developed ale simulations improves mesh quality keeping mesh close original conguration seen comparing figures 14de next example shows untangling structured mesh called horseshoe mesh shown figure 15b obtained simple laplacian smoothing mesh shown figure 15a 19 untangled mesh 3stage untangling procedure shown figure 15c finally figure 15d shows untangled mesh improved condition number based optimization procedure 45 improves condition numbers elements much possible figure presents example untangling mesh state texas 20 originally valid mesh shown figure 16a tangled random perturbation subset interior vertices result mesh shown figure 16b maximum perturbation 20 domain size mesh successfully untangled using 3step procedure give b c0350450550650 004 008 012 0160460501 011 012 013 0140460501 011 012 013 014 fig 13 untangling lagrangian mesh rayleightaylor simulation part original tangled mesh b zoomin tangled mesh nodes shown square connected least one invalid element c zoomin untangled mesh mesh shown figure 16c example feasible set method alone left behind 17 patches negative area triangles optimization method alone left behind 6 zero area triangles value zero optimization step result condition number based mesh optimization untangled mesh presented figure 16d illustrate good quality meshes obtained untangling procedure combined mesh improvement procedures finally untangling tetrahedral mesh presented figure 17 illustrate principles presented paper extended easily 3d original 3d mesh shown figure 17a tangled 3d mesh obtained perturbing interior nodes shown figure 17b untangled mesh shown figure 17c minimum maximum element volumes untangling 0194 0475 minimum maximum volumes mesh untangled 139e07 0242 therefore untangled mesh suitable input mesh optimization procedure improving mesh quality conclusions multistep method successful untangling unstructured 2d meshes presented paper method uses combination feasible set method optimization method achieve greatest degree success untangling mesh keeping mesh close original mesh b fig 14 steps untangling rayleightaylor simulation mesh zoomin original mesh nodes connected invalid elements shown squares b mesh feasible set approach elements remain less minimum volume c mesh optimization elements remain zero volume mesh second pass feasible set approach elements volume greater required minimum improved reference jacobian matrix based optimization procedure 45 seeks improve mesh keep close original mesh required remapping ale simulations methods shown high degree success untangling complex 2d meshes formulation procedures allows easy extension 3d problems preliminary results promising work progress apply untangling procedure general polygonal meshes c b fig 15 valid mesh horseshoe b mesh tangled simple laplacian smoothing c mesh untangled 3step untangling procedure mesh improvement condition number based optimization 45 improves condition numbers elements much possible acknowledgments work authors performed los alamos national laboratory operated university california us department energy contract w7405eng36 los alamos national laboratory strongly supports academic freedom researchers right publish institu tion however laboratory endorse viewpoint publication guarantee technical correctness work p vachal also supported part czech grant agency grant 201000586 authors wish thank dr richard liska czech technical university prague czech republic dr markus berndt los alamos national laboratory los alamos nm usa implementation feasible set computation geometric intersections authors also thank dr patrick knupp sandia national laboratories valuable input development procedures r arbitrary lagrangianeulerian computing method ow speeds computational methods lagrangian eulerian hydrocodes reference jacobian optimizationbased rezone strategies arbitrary lagrangian eulerian methods tr computational methods lagrangian eulerian hydrocodes computational geometry c arbitrary lagrangianeulerian computing method flow speeds construction compatible hydrodynamics algorithms utilizing conservation total energy smoothing optimisation quadrilateral mesh invalid elements reference jacobian optimizationbased rezone strategies arbitrary lagrangian eulerian methods ctr g irving j teran r fedkiw tetrahedral hexahedral invertible finite elements graphical models v68 n2 p6689 march 2006 raphal loubre mikhail j shashkov subcell remapping method staggered polygonal grids arbitrarylagrangianeulerian methods journal computational physics v209 n1 p105138 10 october 2005 g irving j teran r fedkiw invertible finite elements robust simulation large deformation proceedings 2004 acm siggrapheurographics symposium computer animation august 2729 2004 grenoble france