coherenceenhancing diffusion filtering completion interrupted lines enhancement flowlike structures challenging task computer vision human vision image processing address problem presenting multiscale method nonlinear diffusion filter steered socalled interest operator secondmoment matrix structure tensor mdimensional formulation method analysed respect wellposedness scalespace properties efficient scheme presented uses stabilization semiimplicit additive operator splitting aos scalespace behaviour method illustrated applying 2d 3d images b introduction oriented flowlike structures arise many computer vision image processing problems within field texture analysis appear instance automatic grading fabrics wood surfaces also importance fingerprint analysis forensic applications present many scientific imaging problems ranging fluid dynamics meteorology last least medical imaging instance analysis trabecular structures bones interestingly related tasks gap completion completion interrupted lines also play role human vision tasks perceptual grouping moreover success paintings munch van gogh suggests emphasizing flowlike structures may create effects fascinate many people analysing flowlike patterns active research topic certainly one decade see instance kass witkin 28 besides methods gabor filters steerable filters many approaches equivalent socalled structure tensor interest operator second moment 17 44 meantime field even entered textbooks 21 regarded wellestablished much less attention payed question enhance flowlike patterns poor quality fingerprint trabecular bone images unusual cases would desirable tool improves quality flowlike structures without destroying instance semantically important singularities like minutiae fingerprints problems like grading fabrics applications fluid dynamics also useful multiscale simplification original image embedding scalespace order obtain subsequently coarser global impression main flowlike structures course scalespace take account coherence structures smoothing mainly along preferred orientation instead perpendicular since flowlike structures also present higher dimensional data sets eg 3d images trabecular bones possible generalize method arbitrary dimensions preceding problems addressed paper presenting mdimensional scalespace enhancement coherent structures underlying concept motivated ideas perona current address department computer science university copenhagen universitetsparken 1 dk2100 copenhagen denmark malik improving edge detection creating feedback loop edge detector nonlinear diffusion process 42 similar way embed classical method describing flowlike structures namely structure tensor approach nonlinear diffusion process turns method analysing coherent pattern technique enhancing simplifying contrast nonlinear diffusion filters however use approach process steered diffusion tensor instead scalarvalued diffusivity enables true anisotropic behaviour adapting diffusion process location allowing also different smoothing different directions shall see filter belongs class nonlinear diffusion methods many wellposedness scalespace properties proved also contrast peronamalik filter whose continuous formulation locally wellposed 29 details numerical implementation discussed well particular efficient novel stabilization technique based semiimplicit additive operator splitting aos presented extends previous encouraging experiments aos schemes nonlinear diffusion filtering scalarvalued diffusivity fully anisotropic case diffusion tensor theoretical numerical discussions hold mdimensional case examples results 2d 3d implementations presented outline papers follows section 2 surveys underlying structure tensor method describing coherence images method used section 3 constructing nonlinear diffusion process smoothes along coherent flowlike structures process called coherenceenhancing diffusion ced section 4 gives detailed analysis theoretical properties general class diffusion filters comprising ced section 5 numerical algorithmical questions addressed particular efficient alternative explicit scheme presented section 6 applies ced 2d 3d images different application areas paper concluded summary section 7 results paper presented earlier conferences 50 56 related work since work perona malik 42 numerous nonlinear diffusion filters proposed see eg 23 53 overview nevertheless use spatially varying scalar diffusivity diffusion tensor thus act inhomogeneously nonuniformly image terminology remain isotropic true anisotropic diffusion filtering studied reactiondiffusion model cottet germain 15 diffusion tensor uses eigenvectors v 1 k ru oe eigenvalues given j 0 choice similar method sense diffuses mainly along strongly anisotropic structures however two important differences firstly observe diffusion tensor cannot treated within scalespace framework using uniformly positive definite diffusion tensors moreover cottetgermain model uses additional reaction term leads nontrivial steadystates qualifies pure restoration method without scalespace ambitions secondly eigendirections adapted ru oe eigendirections structure tensor shall see introduction integration scale structure tensor essential model feature order obtain reliable orientation estimates flowlike structures recently cottet el ayyadi proposed modified image restoration model replaces spatial regularization temporal regularization 14 nitzberg shiota 39 pioneered shapeadapted gaussian smoothing shape anisotropic gaussian convolution kernel function structure tensor later similar proposals made 33 61 supplemented scaleselection methods 1 noted common feature preceding shapeadapted gaussian smoothing methods combination isotropic smoothing inside region anisotropic smoothing along edges spacevariant gaussian blurring however equivalent inhomogeneous diffusion process preserve average grey value anisotropic diffusion filters isotropic diffusion within regions anisotropic diffusion along edges found 51 references therein methods different present approach ced basically pure 1d diffusion minimal amount isotropic smoothing added regularization purposes anisotropic partial differential equations smoothing images rely morphological methods meancurvature motion geometric heat equation euclidean shortening flow 30 4 direction perpendicular ru since meancurvature motion propagates isophotes inner normal direction curvaturedependent speed expect completely local methods capable closing interrupted linelike structures holds affine invariant version process 3 46 methods take account semilocal information gained structure tensor recent results carmona zhong 12 confirm importance semilocal estimates smoothing direction also equations meancurvature type one interested specific goals enhancement linelike structures threedimensional nonlinear diffusion filters investigated first gerig et al 18 isotropic case rambaux garcon 43 edgeenhancing anisotropic case generalization coherenceenhancing anisotropic diffusion higher dimensions first proposed 56 recent threedimensional pdebased filter krissian et al 32 3d reactiondiffusion process payot et al 41 may related anisotropic diffusion techniques discussion shows distinctive features approach semilocal analysis means structure tensor combined 1d diffusion along one eigenvectors 2 structure tensor first review reliable tool analysing coherent flowlike structures consider mdimensional image domainomega 0 1 theta delta delta delta theta 0 let image ux represented bounded mapping simple structure descriptor given ru oe gradient gaussiansmoothed version u standard deviation oe denotes noise scale since makes edge detector ignorant details smaller ooe convolution finite domainomega defined convolution k oe u ir u denotes extension u mirroring results applying noflux boundary conditions although ru oe useful detecting edges unsuited finding parallel structures see figure 1 left image shows original fingerprint figure 1bc illustrates gradient orientation using grey values vertical gradients depicted black horizontal ones white observe small oe high fluctuations remain larger oe lead entirely useless results due fact larger oe neighbouring gradients orientation opposite sign cancel one another gradient smoothing averages directions instead orientations 2 make structure descriptor invariant sign changes may replace ru oe tensor product oeomega ru oe ru oe ru matrix symmetric positive semidefinite eigenvectors parallel orthogonal ru oe respectively corresponding eigenvalues jru oe j 2 0 describe contrast eigendirections replaced directions orientations average orientations applying componentwise convolution gaussian matrix named structure tensor interest operator secondmoment matrix useful many different tasks instance analysing flowlike textures 44 corners tjunctions 17 39 shape cues 33 spatiotemporal image sequences 27 equivalent approaches discovered terminology gradients opposite sign share orientation point opposite directions figure 1 local orientation fingerprint image top left bottom right original orientation smoothed gra dient orientation smoothed gradient 5 structure tensor independently 7 28 book jahne 27 gives nice overview methods clarifies mutual relations hard verify symmetric matrix j ae positive semidefinite let eigenvalues ordered let fw 1 wm g denote corresponding orthonormal set eigenvectors since eigenvalues integrate variation grey values within neighbourhood size oae describe average contrast eigendirections w thus integration scale ae reflect characteristic size texture usually large comparison noise scale oe eigenvector wm corresponds smallest eigenvalue orientation lowest fluctuations socalled coherence orientation 3 figure 1d depicts coherence orientation fingerprint image observe exactly desired average orientation lines noted well singularity corresponds singularity original fingerprint image eigenvalues j ae provide useful information coherence structure ie actual amount 3 case p identical minimal eigenvalues one may regard every orientation within span coherence orientation natural images situation happens almost never neglected anisotropy measure coherence one define becomes large strongly differing eigenvalues tends zero isotropic structures coherenceenhancing anisotropic diffusion dimensions know analyse coherent structures draw attention question enhance done embedding structure tensor analysis nonlinear diffusion filter principle nonlinear diffusion filtering follows one calculates processed version ux fx scale parameter 0 solution diffusion equation f initial condition reflecting boundary conditions ru onomega theta 0 1 8 omega theta 0 1 10 hereby n denotes outer normal h usual inner product one wants adapt diffusion process image one choose symmetric positive definite diffusion tensor function local image structure case enhancing flowlike patterns natural adapt diffusion tensor structure tensor j ae ru oe function look like enhancing coherence images flowlike structures need smoothing process acts mainly along flow direction wm notations section 2 smoothing increase strength orientation given coherence may achieved following way construct eigenvectors j ae eigenvalues given ae ff 0 serves threshold parameter ae c get 1 c leads ff exponential function small positive parameter ff 2 0 1 introduced mainly two theoretical reasons first guarantees smoothness structure tensor carries diffusion tensor second reason process never stops even structure becomes remains small linear diffusion diffusivity ff 0 thus ff serves regularization parameter keeps diffusion tensor uniformly positive definite next section shall see useful requirements order establish many theoretical properties ced 4 general wellposedness scalespace framework coherenceenhancing anisotropic diffusion filtering regarded special case within general framework nonlinear diffusion filtering many wellposedness scalespace properties found framework shall analysed study diffusion filter following properties assume f let ainf omega f consider problem omega theta 0 1 omega theta 0 1 diffusion tensor satisfies following properties smoothness positive definiteness w exists positive lower bound k eigenvalues dj ae w evidently coherenceenhancing anisotropic diffusion satisfies preceding requirements assumptions p c following theorem generalizes extends results 13 51 proved theorem 1 wellposedness properties smoothness extremum principle problem p c unique solution ux distributional sense smooth 0 omega theta 0 1 solution depends continuously f respect omegagamma fulfils extremum principle ux onomega theta 0 1 13 proof see appendix a1 remarks observe strong smoothing effect characteristic many diffusion processes boundedness initial image sufficient obtain infinitely often differentiable solution arbitrary small positive times additional requirements instance f uniformly continuous order apply theory viscosity solutions necessary case b continuous dependence solution initial image significant practical impact ensures stability respect perturbations original image importance considering stereo image pairs spatiotemporal image sequences slices medical ct mri sequences since know similar images remain similar filtering c extremum principle offers practical advantage start instance image within range 0 255 never obtain results grey value 257 coherenceenhancing anisotropic diffusion filter covered theorem wellposedness theory well subsequent scalespace framework comprises regularized peronamalik filter catte lions morel coll 13 well edgeenhancing anisotropic diffusion filter described 51 also possible establish semidiscrete fully discrete wellposedness scalespace theory proceeds way see 54 details 41 scalespace properties scalespace representations embed image f family ft f j 0g gradually smoother simplified versions long concept became popular western world work witkin 59 koenderink 31 discovered axiomatically justified japan iijima 26 55 axiomatic scalespace representations devoted linear diffusion scalespace gaussian scalespace one also create nonlinear scalespaces classified unique way 3 8 40 approaches uncommitted since unique classification give us liberty incorporate apriori knowledge anisotropic nonlinear diffusion filtering however offer possibility incorporate knowledge evolution let us study scalespace properties evident filter class p c satisfies typical scalespace properties semigroup property invariance euclidean image transformations greylevel shifts contrast reversion moreover since written divergence form uses reflecting boundary conditions also hard verify average grey level z affected nonlinear diffusion filtering 54 pp 6364jomega j z average grey level invariance property diffusion scalespaces differ morphological scalespaces general evolution pdes latter ones divergence form preserve mean grey value constant average grey level useful scalespace based segmentation algorithms hyperstack 37 49 also desirable quality applications medical imaging grey values measure physical qualities depicted object 411 causality terms nonenhancement local extrema let us turn question sense evolution equation type p c considered smoothing informationreducing image transformation koenderink 31 required scalespace evolution create new level curves increasing scale parameter satisfied isointensity linking scales possible structure coarse scale principle traced back original image causality reason required spatial extrema nonvanishing determinant hessian isophotes scalespace upwards convex showed constraint written sufficient condition causality equation 16 hold requiring local extrema positive negative definite hessians enhanced extremum scale satisfies u minimum maximum implication easily seen first case instance eigenvalues j 1 j hessu positive thus gives causality requirement 16 nonenhancement local extrema first used babaud et al 5 context linear diffusion filtering however also satisfied nonlinear diffusion scalespaces shall see 4 4 linear diffusion case nonenhancement local extrema generally imply number nonincreasing dimensions theorem 2 nonenhancement local extrema let u unique solution 2omega local extremum u nonvanishing hessian local maximum 18 local minimum 19 proof see appendix a2 nonenhancement local extrema one possibility end koenderinks causality quirement another way establish causality via extremum principle 13 following hummels reasoning see 25 details 412 lyapunov functionals behaviour 1 interestingly causality terms nonenhancement local extrema regarded first representative much larger class smoothing properties nonlinear diffusion filtering representatives result studying lyapunov functionals processes lyapunov functionals energylike expressions decrease evolution lower bound useful finding attractors process 1 theorem establishes class lyapunov functionals shows processes type p c converge flat steadystate given average grey value original image desirable property scalespaces since steadystate regarded coarsest global representation original image theorem 3 lyapunov functionals behaviour 1 suppose u solution p c let b defined p c 14 following properties valid lyapunov functionals r 2 c 2 b convex b function z lyapunov functional bounded value phi constant image average grey level continuous 0 decreasing 0 b convergence converges constant image average grey value lim proof see appendix a3 interesting representatives family lyapunov functionals considering lyapunov functions associated respectively preceding theorem gives following corollary corollary 1 special lyapunov functionals let u solution p c defined p c 14 following functions decreasing 2 0 1 kutk l p p 2 b 2n ut jomega j z c h ut z corollary 1 offers multiple possibilities interpret nonlinear anisotropic diffusion filtering smoothing transformation special case follows energy kutk 2 reduced diffusion using parsevals equality know decreasing energy also equivalent decreasing sum squared fourier coefficients part b gives probabilistic interpretation anisotropic diffusion filtering consider intensity image f random variable z f distribution f f z ie f f z probability arbitrary grey value z f f exceed z average grey level invariance equal expected value z z df ut z 23 follows 2n ut even central moment z second central moment variance characterizes spread intensity mean common tool constructing measures relative smoothness intensity distribution fourth moment frequently used describe relative flatness grey value distribution higher moments difficult interpret although provide important information tasks like texture discrimination 22 pp 414415 decreasing even moments demonstrate image becomes smoother diffusion filtering hence local enhancement effects object increase central moments overcompensated smoothing areas choose another probabilistic model images part c characterizes informationtheoretical side scalespace provided initial image f strictly positive omegagamma may regard also twodimensional density 5 zomega called entropy ut measure uncertainty missing information 11 since anisotropic diffusion filters increase entropy corresponding scalespace embeds genuine image f family subsequently likelier versions contain less information moreover process reaches state lowest possible information namely constant image informationreducing property indicates anisotropic diffusion might generally useful context image compression particular helps explain success nonlinear diffusion filtering preprocessing step subsampling observed 16 interpretation entropy terms lyapunov functionals carries also generalized entropies see 48 details previous considerations recognize anisotropic diffusion really simplify original image steady way 5 numerical aspects approximate ced numerically replace derivatives finite differences since continuous ced structure 5 without loss generality omit normalization simplest discretization given finite difference scheme deltat notation u describes vector containing values pixel upper index denotes time level l ij central difference approximation operator x since 27 rewritten deltat observe u k1 calculated explicitly u k without matrix inversions reason called explicit scheme unfortunately explicit schemes require small time steps deltat order stable therefore desirable replace 28 implicit scheme firstorder taylor expansion deltat better stability properties one possibility aosstabilized scheme deltat method achieves stabilization nonnegative matrices semiimplicit discretization diffusion caused lth diagonal entry diffusion tensor typically used step size deltat 2 one order magnitude larger ones explicit scheme type 27 stable 2d 3d standard approximations central derivatives within 3 theta 3stencil matrix inversions 29 come solving diagonally dominant tridiagonal systems linear equations performed linear complexity modified gaussian algorithm thomas algorithm noted 29 uses additive operator splitting aos instead usual multiplicative operator splitting mathematical literature 34 guarantees axes treated way aos schemes introduced 57 efficient reliable method isotropic nonlinear diffusion filtering perform well parallel computer architectures 58 equation 29 shows one way extend anisotropic processes diffusion tensor final ced algorithm follows 1 calculation structure tensor pixel requires one convolution gaussian k oe convolutions k ae convolutions implemented spatial domain exploiting separability symmetry gaussian 2 principal axis transformation structure tensor pixel case done cyclic jacobi algorithm 47 3 calculation diffusion tensor pixel significant speedup possible creating lookup table function 12 beginning programme run 4 calculation deltat 5 calculation l means thomas algorithm 57 6 calculation u algorithm computationally less complex looks first glance typical execution times one iteration hp 9000889 03 seconds 256 theta 256 image 9 seconds 64 theta 64 theta 64 image figure 2 anisotropic equations applied fingerprint image top left original image b top right mean curvature motion left anisotropic diffusion similar cottetgermain model coherenceenhancing anisotropic diffusion 6 examples figure 2 illustrates importance choosing appropriate smoothing direction anisotropic processes figure 2b mean curvature motion applied fingerprint image observe although mean curvature motion completely anisotropic technique many merits computer vision cannot used closing interrupted linelike structures topologically connected structures remain connected gaps become larger since ends move opposite directions mcm exploit semilocal information figure 2c shows effect coherenceenhancing anisotropic diffusion ff integration scale ae set 0 model close spirit cottetgermain filter 15 model difficult find useful noise scale oe smoothing along flowlike structures oe 0 ru becomes eigenvector diffusion halted since corresponding eigenvalue 1 zero oe becomes larger effect illustrated figure 1c dominates opposite gradients cancel one another leading less random smoothing directions coherenceenhancing diffusion filtering nonvanishing integration scale depicted figure 2d observe diffusion along coherence orientation w 2 wellsuited closing interrupted lines flowlike textures due reduced diffusivity noncoherent structures location semantically important singularity fingerprint remains important prerequisite image processing method satisfy applied fingerprint figure 3 scalespace behaviour coherenceenhancing diffusion top left original fabric analysis subsequent ced images parameters used figure 3 depicts scalespace behaviour coherenceenhancing anisotropic diffusion applied fabric image arising computer aided quality control temporal behaviour diffusion filter seems appropriate visualizing coherent fibre agglomerations stripes different scales difficult problem automatic grading nonwovens let us investigate impact coherenceenhancing diffusion images typical texture images still reveal flowlike character end shall process expressionistic paintings vincent van gogh fig 4 shows restoration properties coherenceenhancing anisotropic diffusion applied selfportrait artist 19 observe diffusion filter close interrupted lines enhance flowlike character typical van gogh paintings next painting concerned called road cypress star 20 depicted fig 5 order demonstrate influence integration scale ae filter parameters fixed except ae fig 5b observe value ae small lead visually dominant coherence orientation thus filtered structures reveal lot undesired fluctuations increasing value ae improves image significantly fig 5c interestingly increasing ae hardly alter result fig 5d indicates van gogh painting possesses uniform texture scale reflecting characteristic painting style artist figure 6 illustrates potential ced medical applications depicts human bone internal figure 4 image restoration using coherenceenhancing anisotropic diffusion left selfportrait van gogh saintremy 1889 paris musee dorsay structure distinctive texture presence tiny elongated bony structural elements trabeculae evidence trabecular formation great deal determined external load 60 35 6 reason trabecular structure constitute important clinical parameter orthopedics examples control recovery surgical procedures placement removal metal implants quantifying rate progression rheumatism osteoporosis determination leftright deviations symmetry load establishing optimal load corrections physiotherapy high resolution contemporary ct using slipring technology mr scanners enables vivo analysis detailed trabecular structure vivo analysis trabecular bone means structure tensor investigated 24 36 present paper points ways enhance coherence information medical images order ease analysis figure 6bc observe ced indeed capable closing interrupted lines parallel flow like structures enhanced subsequent coherence analysis becomes much easier increasing time gives coarser representation coherence entire evolution creates taskdriven scalespace dedicated flowlike patterns medical applications physicians often insist small amounts smoothing order reduce noise without affecting clinically relevant structures much simplifications figure 6c would considered misleading figure 7 shows results two iterations threedimensional ced filtering data set reveals size 256 theta 256 theta 128 voxel dimensions 025 theta 025 theta 05 mm 3 depicts ct scan foot area means philips sr8000 slipring ct 140 kv even 3d data sets slight preprocessing using iterations easily performed within acquisition time price suitable hardware would small fraction price ct scanner noted 3d applications might also desirable smooth along two directions instead one ced diffusion methods type studied rambaux garcon 43 3d versions edgeenhancing anisotropic diffusion filter 51 7 summary conclusions present paper treated problem enhancing flowlike patterns tasks reliable measurement local orientation needed experiments demonstrate structure figure 5 impact integration scale coherenceenhancing anisotropic diffusion 8 top left road cypress star van gogh auverssuroise 1890 otterlo rijksmuseum krollermuller filtered ae 1 c bottom left figure top high resolution slipring ct scan femural bone showing trabecular formation slice thickness 1 mm field view 6 left filtered coherenceenhancing anisotropic diffusion oe 05 ae 6 16 c bottom right dito 128 tensor satisfies requirement unlike many applications restrict application pure image analysis use tool steering scalespace evolution end evolve original image means nonlinear anisotropic diffusion equation diffusion tensor reflects local image structure using set eigenvectors structure tensor eigenvalues chosen way diffusion acts mainly along direction highest coherence becomes stronger coherence increases resulting coherenceenhancing diffusion ced process gives theoretically wellfounded scalespace representation proofs presented show unique solution stable perturbations initial image satisfies koenderinks causality requirement creates large family lyapunov functionals ensure process image simplifying converges constant steadystate theoretical framework valid dimension also presented mdimensional numerical scheme stabilization based additive operator splitting aos allows time steps one order magnitude larger explicit case finally use ced illustrated applying 2d 3d data sets results indicate variety possible application areas ranging computer aided quality control fingerprint enhancement medical imaging however gives one aspect filter concept coherenceenhancing diffusion allows also generalizations vectorvalued images details direction found 52 acknowledgments author thanks robert maas stiliyan kalitzin useful comments draft version paper wiro niessen providing 3d trabecular bone data set figure 7 threedimensional ced applied ct data set size 256 theta 256 theta 128 sections depicting slice 180 x 128 100 z respectively right column filtered oe 05 ae 6 t4 r enhancement fingerprint images using shapeadapted scalespace operators axioms fundamental equations image processing image selective smoothing edge detection nonlinear diffusion uniqueness gaussian kernel scale space filtering orientation apatite crystals bone optimal orientation detection linear symmetry operateurs maximaux monotones et semigroupes de contractions dans les espaces de hilbert maximum entropy action adaptive smoothing respecting feature directions image selective smoothing edge detection nonlinear diffusion nonlinear pde operators memory terms image processing image processing reaction combined nonlinear diffusion fast operator detection precise location distinct points nonlinear anisotropic filtering mri data road cypress star signal processing computer vision representations based zerocrossings scale space basic theory normalization pattern case typical onedimensional pattern lecture notes comp computer vision maximum comparison principles anisotropic diffusion toward computational theory shape overview structure images directional anisotropic diffusion applied segmentation vessels 3d images splitting alternating direction methods die architektur der spongiosa nonlinear multiscale representations image segmentation nonlinear image filtering edge corner enhancement classification uniqueness invariant geometric flows adaptive constrained model 3d xray vascular reconstruction scale space edge detection using anisotropic diffusion nonlinear anisotropic diffusion filtering 3d images computing oriented texture fields generic evolution edges families diffused greyvalue surfaces ter haar romeny probabilistic multiscale image segmentation theoretical foundations anisotropic diffusion image processing review nonlinear diffusion filtering anisotropic diffusion image processing history gaussian scalespace axiomatics structure adaptive anisotropic filtering tr ctr tabik e garzn garca j j fernndez high performance noise reduction biomedical multidimensional data digital signal processing v17 n4 p724736 july 2007 josejesus fernandez sam li anisotropic nonlinear filtering cellular structures cryoelectron tomography computing science engineering v7 n5 p5461 september 2005 jo lachaud b taton deformable model complexity independent image resolution computer vision image understanding v99 n3 p453475 september 2005 j martnherrero hybrid object labelling digital images machine vision applications v18 n1 p115 january 2007 guy gilboa nir sochen yehoshua zeevi image sharpening flows based triple well potentials journal mathematical imaging vision v20 n12 p121131 januarymarch 2004 leah bar nahum kiryati nir sochen image deblurring presence impulsive noise international journal computer vision v70 n3 p279298 december 2006