graphs connected medians median set graph g weighted vertices comprises vertices minimizing average weighted distance vertices g characterize graphs respect nonnegative vertex weights median sets always induce connected subgraphs characteristic conditions tested polynomial time employing linear programming immediately verified number specific graph classes b introduction given finite connected graph g one sometimes interested finding vertices minimizing total distance vertices u g distance du x u x length shortest path connecting u x subgraph induced minima f need connected actually every possibly disconnected graph realized median subgraph another graph slater 23 see hendry 18 information pertinent references focus weighted version median problem arises one basic models discrete facility location 25 majority consensus classification data analysis 3 9 10 11 22 weight function mapping vertex set nonnegative real numbers zero function order avoid trivialities total weighted distance vertex x g given vertex x minimizing expression median vertex g respect set medians median set med local median one means vertex x f x exceed f neighbour x denote med loc set local medians consider following questions research supported part alexander von humboldt stiftung ffl median sets med graph connected ffl med loc hold weight functions allow 01 weight functions recognition graphs med loc np complete problem 2 show connectivity median sets respect arbitrary weight functions turns equivalent condition function f local minima global property also formulated certain convexity condition next section investigate weakly convex functions graphs section 3 obtain basic characterizations graphs connected medians one equivalent conditions weak convexity f weight function formulated linear programming problem thus allowing recognize graphs connected medians polynomial time lp condition however entails lot redundancy cannot read graph properties known imply median connectedness striving less redundancy requirements establish main result section 4 employing lp duality particular instance original lp formulation theorem conveniently used derive median properties several specific classes graphs demonstrated final section 2 weakly convex functions realvalued function f defined vertex set v graph g said weakly convex two vertices u v real number 0 1 du v 1 gamma du v integers exists vertex x weakly convex functions introduced arkhipova sergienko 1 name rconvex functions see also lebedeva sergienko soltan 19 interval iu v two vertices u v consists vertices shortest u vpaths convenience use shorthand denote interior interval u v lemma 1 realvalued function f defined vertex set graph g following conditions equivalent f weakly convex ii two nonadjacent vertices u v exists w 2 ffi u v iii two vertices u v distance 2 common neighbour w proof consider two vertices u v distance du shortest paths connecting u v select path small possible condition iii implies 2fw points plane r connecting consecutive points segments get graph piecewiselinear function function necessarily convex usual sense coincides p function f conclude recall realvalued function f defined path holds say function f defined vertex set graph g pseudopeakless two vertices g joined shortest path along f peakless 15 equivalently f pseudopeakless two nonadjacent vertices u v vertex w 2 ffi u v fw maxffu fvg equality holds key property pseudopeakless functions unimodality every local minimum f global proof simple let u global minimum f v local minimum g consider shortest path p u v along f peakless neighbour w v fw maxffu fvg whence required note every weakly convex function pseudopeakless following result constitutes partial converse remark 1 realvalued function f defined vertex set graph g pseudopeakless composition ffffif weakly convex strictly isotone transformation ff reals proof property pseudopeakless clearly invariant strictly isotone transformations range conversely let f pseudopeakless function taking n distinct values 1 ff strictly isotone map assigns assert composition ffffif weakly convex given vertices u v distance 2 let w common neighbour f peakless along path consequently required 2 follows apply lemma 1 functions f g simplest instance given weight function assigning 1 distinguished vertex w 0 otherwise measures distance g vertex say g meshed 6 function ddelta w weakly convex every choice w somewhat weaker property used subsequent results three vertices u v w g said form metric triangle uvw intervals iu v iv w iw u pairwise intersect common end vertices du triangle called equilateral size k remark 2 every metric triangle meshed graph g equilateral see suppose contrary let uvw metric triangle g du w dv w definition weak convexity applied pair u v number provides us neighbour x v necessarily belongs 3 basic characterizations commence giving first answers questions raised introduction proposition 1 graph g following conditions equivalent med loc weakly convex pseudopeakless iv level sets fx f x g induce isometric subgraphs v median sets med induce isometric subgraphs vi median sets med connected conditions vi equivalent analogous condition additional requirement positive following observation basic proof proposition 1 lemma 2 function f weakly convex vertex set v graph g weight function exist positive weight function vertices u v distance 2 med proof f weakly convex lemma 1 exist two vertices u v distance 2 2f w f u f v common neighbours w 2 ffi u v inequality maintained sufficiently small positive perturbations viz add ffi satisfying weights yielding new weights 0 w 2 ffi u v initial inequality remains valid respect thus perturbed weight function may therefore assume actually positive stipulate denote maximum value define new positive weight function every vertex x outside iu v w 2 ffi u v one obtains therefore consists u v concludes proof 2 proof proposition 1 implications ii trivial vi ii covered lemma 2 remains verify implies ii suppose way contradiction function f weakly convex lemma 2 exist positive weight function vertices u v distance 2 pick ffl satisfying define new weight function 0 x therefore u v local minima f 0 establishes implication ii arguments applied prove analogous conditions vi additionally requiring weight functions positive equivalent since trivial vi covered lemma 2 proof complete 2 view lemma 1iii proposition 1 median sets connected pair u v vertices distance 2 following system linear inequalities unsolvable since lp problems solved polynomial time thus obtain following result corollary 1 problem decide whether median sets med graph g connected solvable polynomial time 4 main result order obtain convenient characterization median con nectedness restrict supports weight functions tested take advantage lp duality following form remark 3 let u v vertices graph g du w nonempty subset ffi u v x nonempty subset vertex set g every weight function support included x exists w 2 w exists weight function j support included w every proof let denote submatrix uv defined rows columns corresponding w x respectively asserted equivalence particular instance lp duality formulated javille cf 16 p248 terms systems linear inequalities vertices x define following superset ix proposition 2 median sets med graph g connected weight functions 1 metric triangles equilateral 2 vertices u v every weight function whose support fx included set ju v exists vertex w 2 ffi u v 2f w f u proof necessity immediately follows remark 2 proposition 1 prove sufficiency assume 1 2 hold exists weight function f weakly convex lemma 1 vertices u v distance 2 fixing u v may assume chosen inequality still holds number vertices support outside ju v small possible 2 find vertex x x 0 arrive contradiction slightly modify setting weight x zero possibly transferring old weight vertex ju v distinguish three cases case 1 jdu 2 2dw hence weight function 0 defined contrary minimality assumption case 2 jdu without loss generality assume dv vertex iu iv x maximal distance x x latter equality du vertex iu v iv x 0 maximal distance v since vertices u x 0 must constitute equilateral metric triangle therefore du x 2 define new weight function every w 2 ffi u v either 2 hence contradiction choice case 3 let x 0 vertex iu x iv x maximal distance x since metric triangles g equilateral du obtain 2 define new weight function 0 case 2 every w 2 ffi u v final contradiction 2 view remark 2 may require proposition 2 well theorem g meshed instead metric triangles g equilateral let mu v denote set vertices ju v equidistant u v neighbourhood nx vertex x consists vertices adjacent x note lemma 3 median sets graph g connected vertices u v distance 2 exist necessarily distinct vertices 2 ffi u v vertices 2 mu v proof define weight function hypothesis f pseudopeakless implies asserted inequality let since weights zero outside mu v f v f peakless along shortest path u v f claim 2 indeed otherwise holds either two distinct vertices exists vertex z 2 mu 3 first case would get second case giving contradiction vertices mu v gamma fsg equidistant u well v thus required solution asserted inequality else exists whence 2 consequently therefore constitutes required vertex pair case 2 lemma 4 let u v vertices distance 2 graph g median sets connected select maximal subset ffi u v property vertex exists vertex 2 necessarily distinct ds weight function support included ju v exists vertex w proof lemma 3 set nonempty assume contrary among weight functions violating assertion choose function set small possible set contains vertex x f weakly convex pick first suppose dx distinct vertices new weight function 0 w otherwise hence w 2 ffi u v distinct x contrary choice therefore x adjacent vertices possibly one vertex suppose dx modified weight function 0 defined w otherwise obtain inequalities preceding case thus arrive contradiction conclude dx x adjacent vertices ffi u v 2dx z 2 mu v z 6 x hence could adjoin x contrary maximality therefore shown ffi u v contains exactly one vertex distinct x adjacent x since 2 exists vertex z 2 mu v necessarily new weight function 0 w otherwise giving contradiction concludes proof 2 position formulate principal result theorem graph g median sets connected following conditions satisfied metric triangles g equilateral ii vertices u v distance 2 exist nonempty subset ffi u v weight function j support included two properties ff every vertex 2 companion 2 necessarily distinct fi joint weight neighbours x 2 ju v gamma mu v always least half total weight proof first assume g graph connected medians proposition 2 metric triangles g equilateral let u v pair vertices distance 2 nonempty subset ffi u v provided lemma 4 satisfies inequality ff 2 companion moreover lemma 4 guarantees every weight function support included ju v exists vertex w 2 f u duality formulated remark 3 yields weight function j support included every x 2 ju v weighted sum therefore fi holds x 2 mu v ds x 2 2 latter case companion yields inequality 0 interchanging role infer 2 conversely conditions ii satisfied virtue lp duality remark conditions 1 2 proposition 2 fulfilled whence g connected medians 2 corollary 2 median sets meshed graph g connected whenever following condition satisfied two vertices u v ffi u v exist necessarily vertices 2 ffi u v moreover g satisfies stronger condition requiring addition ds 1 med induces complete subgraph every positive weight function proof first observe inequality also holds case u v distance 2 unique common neighbour indeed x 2 ju v necessarily since g meshed see implies condition ii theorem put trivially satisfied x 2 ju du x dv meshed therefore x adjacent least one thus establishing fi prove second statement observe inequality actually holds vertices x g indeed vertex x select vertex x 0 iu x iv x maximal distance x x 0 belongs ju v adding inequalities multiplied corresponding weight x yields strict inequality holds exactly one former inequalities strict x positive u v cannot belong med circumstances 2 general neither dispense weight functions impose fixed upper bound cardinalities sets occuring theorem following example shows example let g chordal graph 2 vertices comprising set mutually adjacent vertices two vertices u v adjacent vertices wz associated certain subsets z namely sets fx 1 fx ksubsets fy vertex wz adjacent u vertices z weight function j support included pair u v sets z come complementary pairs one z2z equivalent thus order satisfy fi forced take weight function j large support constant note ff u v trivially fulfilled choice finally every pair vertices distance 2 meets condition corollary either replacing u wz selecting z replacing u v wz w z 0 setting shows g connected medians 5 particular cases number graph classes 12 consist particular meshed graphs instance classes chordal graphs generally bridged graphs helly graphs weakly median graphs see respectively case chordal graphs first statement corollary 2 due wittenberg 26 theorem 11 whenever chordal graph satisfies condition pair selected necessarily satisfies comes full action class helly graphs helly graph g alias absolute retract reflexive graphs characteristic helly property vertices nonnegative integers r system inequalities admits solution x whenever holds 8 since helly property formulated lemma 1iii function ddelta z helly graphs meshed verify condition ds 1 first observe helly property nv thus mu 2 vertices pairwise distance 2 whence helly property guarantees common neighbour similarly vertices nv ju v fug common neighbour necessarily 2 ffi u v ds 1 hold therefore established following observation implies result lee chang 20 strongly chordal graphs special helly graphs corollary 3 median sets med helly graph g connected moreover positive med induces complete graph g particular classes meshed graphs pair meeting always selected following trivial rule given vertices u v distance 2 choose pair ffi u v ds large possible evidently meshed graph g satisfies condition selection rule provided following two requirements met complete subgraph vertices u v distance 2 ds induce 4cycle ds notice xx could replace last equality inequality inequality would imply js meshed graph thus reverse inequality would follow symmetry show socalled weakly median graphs satisfy x xx graph weakly median 14 three distinct common neighbours two distinct vertices u v always induce connected subgraph ii functions ddelta z satisfy following condition stronger weak convexity u v distance 2 condition ii also referred weak modularity see 4 trivially weakly modular graphs meshed remark 4 weakly modular graph g satisfies conditions x xx g contain graphs fig1 induced subgraph particular weakly median graphs connected medians theta theta theta theta theta theta theta theta theta theta x x b c fig 1 proof g includes induced subgraph fig 1 u v x violate either xx x conversely assume g weakly modular violates x xx vertices u v x x 2 ju v du xdv x 3 weak modularity necessarily u v x induce one first two graphs fig 1 otherwise say g meshed u v x common neighbour w w adjacent back preceding case w playing role x therefore may assume w common neighbour adjacent u v w induce subgraph isomorphic fig 1b otherwise adjacent obtain graph fig 1c induced subgraph finally note latter graph minus v well fig 1ab forbidden weakly median graph 2 inasmuch pseudomedian graphs quasimedian graphs weakly median remark 4 conjunction proposition 1 generalizes results 3 7 17 24 another class meshed graphs fulfilling x xx associated matroids matroid defined finite set e together collection b subsets referred bases exists e basis graph necessarily connected graph whose vertices bases edges pairs b b 0 bases differing single exchange immediately infer characterization established maurer 21 basis graph every matroid meshed weakly modular general satisfies x xx corollary 4 basis graph every matroid connected medians view corollary 4 proposition 1 one solve median problem basis graph matroid greedy algorithm given weight function assign weight element e 2 e applying greedy algorithm one finds base b maximizing function b 7 assert b minimum function f basis graph indeed neighbour b hence b 2 med loc med required r conditions coincidence local global extrema optimization problems russian helly theorem weakly modular space decomposition via amalgamation cartesian multiplication weak cartesian factorization icosahedra graph theory dismantling absolute retracts reflexive graphs geometry geodesics separation two convex sets convexity structures discrete math medians pseudomedian graphs russian graphs prescribed median conditions coincidence local global minima problems discrete optimization matroid basis graphs median procedure formal theory consensus medians arbitrary graphs solution weber problem discrete median metric spaces russian survey local medians chordal graphs tr ctr victor chepoi clmentine fanciullini yann vaxs median problem plane triangulations quadrangulations computational geometry theory applications v27 n3 p193210 march 2004