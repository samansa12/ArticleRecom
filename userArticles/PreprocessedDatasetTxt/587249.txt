extensible lattice sequences quasimonte carlo quadrature integration lattices one main types low discrepancy sets used quasimonte carlo methods however disadvantage fixed size article describes construction infinite sequence points first bm forms lattice nonnegative integer thus quadrature error using initial lattice large lattice extended without discarding original points generating vectors extensible lattices found minimizing loss function based measure discrepancy nonuniformity lattice spectral test used finding pseudorandom number generators one important example discrepancy performance extensible lattices proposed compared methods practical quadrature problems b introduction multidimensional integrals appear wide variety applications finance 4 48 50 physics engineering 29 42 49 58 statistics 8 12 13 integration domain may often assumed appropriate transformation unit cube case integral takes form z known integrand f adaptive methods 2 developed approximating multidimensional integrals performance deteriorates dimension increases finance problems dimension hundreds even thousands alternative adaptive quadrature monte carlo methods integral approximated sample mean integrand evaluated set p n independent random points drawn uniform distribution 0 quadrature error monte carlo methods typically gamma12 one reason relatively low accuracy points p chosen independently thus parts integration domain contain clumps points parts empty points obtain greater accuracy one may replace random set p carefully chosen deterministic set uniformly distributed 0 1 explained section 3 one may define discrepancy measures much empirical distribution function p differs continuous uniform distribution department mathematics hong kong baptist university kowloon tong hong kong sar china research supported hkbu frg grant 9697ii67 z fredhkbueduhk httpwwwmathhkbueduhkfred x departement dinformatique et de recherche operationnelle universite de montreal cp 6128 succ centreville montreal quebec canada h3c 3j7 f j hickernell h hong p l ecuyer c lemieux one chooses p quadrature rule 11 small discrepancy possible quadrature methods based low discrepancy sets called quasimonte carlo methods discussed several review articles 3 16 40 59 monographs 27 44 53 two important families low discrepancy sets integration lattices 44 chap 5 53 ii digital nets sequences 44 chap 4 two families introduced section 2 one advantage second family number consecutive points good digital sequence low dis crepancy one needs points one may use additional terms digital sequence without discarding original ones hand number points integration lattice specified advance far systematic way adding points integration lattice still retaining lattice structure purpose article provide method constructing infinite lattice sequences thereby eliminating need know n number points advance although emphasis rank1 lattices method may applied integration lattices arbitrary rank given infinite lattice sequence one may approximate multidimensional integrand quadrature rule form 11 moderate number points n 0 error estimate unacceptably high one may choose additional points lattice sequence obtain quadrature rule n 1 points following section describes new method obtaining infinite lattice se quences section 3 briefly reviews results discrepancy quadrature error analysis quasimonte carlo methods used find generating vectors new lattice sequences section 4 issue error estimation addressed section 5 two practical examples explored section 6 new lattice sequences compared existing quadrature methods last section contains concluding remarks 2 integration lattices digital sequences section begins introducing integration lattices next digital sequences ssequences de scribed finally idea underlying digital sequences used produce infinite lattice sequences 21 integration lattices rank1 lattices also known good lattice point glp sets introduced korobov 31 widely studied since see 27 44 53 references therein formula shifted rank1 lattice set simply n number points h sdimensional generating vector integers good lattice point depends n delta sdimensional shift vector 0 1 fxg denotes fractional part vector x ie later generalized glp sets introducing one generating vector shifted integration lattice points based generating vectors h integration lattices use quadrature discussed monograph 53 extensible lattice sequences 3 given n problem choosing good generating vectors although theoretical constructions exist higher dimensions one typically finds generating vectors minimizing discrepancy measure nonuniformity lattice several examples discrepancies given section 3 22 digital nets sequences digital nets sequences another method constructing low discrepancy sets see 32 44 chapter 4 let b denote positive integer greater one nonnegative integer one may extract digits base b representation finitely many nonzero th term digital net sequence given z z 22d generating matrices c theta construction yields digital net fz points generating matrices 1 theta 1 ie c j entries c jkl defined k one digital sequence g prototype digital sequence onedimensional van der corput sequence g defined taking equal identity essence van der corput sequence takes bary representation integer reflects decimal point 23 snets ssequences similarly integration lattices one problem choose generating matrices c j 22 usually done optimize quality factor net sequence nonnegative svector k base b consider following set disjoint boxes whose union unit cube box b k volume b gammak 1 gammadeltadeltadeltagammak snet base b set points 0 1 every box b k contains b mgammak 1 gammadeltadeltadeltagammak points k satisfying thus function piecewise 4 f j hickernell h hong p l ecuyer c lemieux constant boxes b k integrated exactly according quadrature rule integer parameter called quality parameter net takes values 0 smaller value means better net ssequence infinite sequence points 0 1 b points numbered lb l 1b nonnegative integer l using ssequence quasimonte carlo calculations one need know number points required advance first b m1 points give sufficient accuracy one may add next b m2 gamma b m1 points sequence get net b m2 points without throwing away first b m1 points connection digital nets sequences defined snets ssequences 32 let c jiffl denote vector containing first elements th row generating matrix c j given nonnegative integer svector k let cm k following set first k j rows j th generating matrix c furthermore let linearly independent set vectors k following theorem see 32 gives condition digital net net digital sequence ssequence theorem 21 prime bases b digital net defined 22 snet addition finite digital sequence defined 22 ssequence finding good generating matrices digital nets sequences active area research virtually generators found far based number theoretic arguments early sequences include sobol 56 faure 9 niederreiter 43 algorithms sequences found acm transactions mathematical software collection finder software developed columbia university traub papageorgiou implements generalized sobol generalized faure se quences new constructions smaller values given niederreiter xing 47 24 infinite lattice sequences idea underlying digital sequences may extended integration lattices obtain infinite lattice sequences th term rank1 lattice fihng depends inherently number points n thus formula lattice must rewritten way involve n explicitly way first suggested 24 suppose number points n integer power base b 2 assumption digital snet first n values van der corput sequence defined 23 areb extensible lattice sequences 5 although different order therefore term appears definition rank1 lattice may replaced oe b term depend n sdimensional generating vector h 21 typically depends n also may expressed bary form digits k digits h jk affect definition rank1 lattice set points since contribute integers product oe b ih therefore component h may written principle infinite string digits single infinite generating vector may serve possible values preceding paragraphs provide basis defining infinite rank1 lattice sequence altering original definition 21 leads following definition 22 infinite rank1 lattice sequence base b generating vector h form 26 shift delta defined first b terms infinite rank1 lattice sequence 27 rank1 lattice moreover certain subsets ssequence snets subsets infinite rank1 lattice sequence shifted rank1 lattices theorem 23 suppose p set consisting l 1 st run b terms infinite lattice rank1 sequence defined 27 p rank1 lattice shift oe b lb gammam h delta proof proof follows directly definition van der corput sequence note substituting right hand side definition p completes proof definition infinite rank1 lattice sequence may extended integration lattices arbitrary rank definition 24 infinite lattice sequence arbitrary rank bases generating vectors h form 26 defined practical complication integration lattice rank greater 1 multiple indices k may may tend infinity rate complication focus rank1 lattices sections follow theorem 23 also natural extension infinite lattice sequences arbitrary rank proof similar 6 f j hickernell h hong p l ecuyer c lemieux 3 discrepancy unlike snets exist explicit constructions generating matrices c j explicit constructions generating vectors h rank1 lattices arbitrary tables generating vectors lattices exist see 8 14 27 usually obtained minimizing measure nonuniformity discrepancy lattice section describes several useful discrepancy measures quadrature error rule form 11 arbitrary set p worst case error analysis quadrature error leads koksma hlawkatype inequality form 23 dp discrepancy measure nonuniformity point set defining quadrature rule v f variation fluctuation integrand f precise definitions discrepancy variation depend particular space integrands traditional koksmahlawka inequality see 26 44 theorem 211 variation variation sense hardy krause discrepancy l1 star discrepancy f unif uniform distribution unit cube fp empirical distribution function sample p jdeltaj denotes number points set notation denotes l p norm p norm depending context error bounds form 31 involving l p star discrepancy derived 57 62 error bounds involving generalizations star discrepancy appear 21 22 23 55 integrands belong reproducing kernel hilbert space error bound 31 may easily obtained 21 23 discrepancy may written terms reproducing kernel z kx dx dy gamman z example l 2 star discrepancy whose formula originally derived 60 special case formula kx advantage considering reproducing kernel hilbert spaces integrands computational complexity discrepancy relatively small worst 2 operations contrast l1 star discrepancy requires operations evaluate discrepancy type 33 also interpreted averagecase quadrature error 25 41 61 suppose integrand random function lying sample space suppose integrand zero mean covariance kernel kx extensible lattice sequences 7 root mean square quadrature error discrepancy defined p simple random sample mean square discrepancy 25 z formula serves benchmark presumably superior low discrepancy sets since mean square discrepancy gamma1 discrepancy typically gamma12 simple random sample variance function f may defined z f dx mean value variance space averagecase integrands shown 25 z z term braces 35 may seem odd first discrepancy serve averagecase worstcase quadrature error explanation space integrands averagecase analysis much larger space integrands w worstcase analysis see 21 25 references therein proofs results well details known asymptotic results discrepancies snets l1 star discrepancy snet gamma1 log n theorem 410 moreover typical sense average taken possible nets l 2 star discrepancy 0 snets gamma1 log n best possible set discrepancies form 33 sufficiently smooth kernels typical 0 snets gamma32 log n lattice rules topic article known particularly effective integrating periodic functions suppose integrand absolutely convergent fourier series fourier coefficients z k 0 x denotes dot product sdimensional wavenumber vector k x quadrature error particular integrand absolutely convergent fourier series simply sum quadrature errors term n 8 f j hickernell h hong p l ecuyer c lemieux term corresponding enter constants integrated exactly one multiply divide arbitrary weights wk inside sum applying holders inequality one following error bound form 31 23 n 1 fdeltag denotes indicator function order insure discrepancy finite assume weights increase sufficiently fast k tends infinity p node set integration lattice known trigonometric polynomials integrated exactly nonzero wavenumbers dual lattice dual lattice set k satisfying k 0 thus node sets lattices definition discrepancy may simplified certain explicit choices wk appeared literature example one may choose overbar notation defined arbitrary positive weights ff measure assumed smoothness integrand fi node set lattice traditional figure merit lattices 53 furthermore discrepancy df1 p ael zaremba figure merit lattice rules 44 def 531 general case p lattice considered 20 case unequal weights discussed 22 extensible lattice sequences 9 weight function wk takes form 39 positive integer ff infinite sum defining discrepancy 38b may written finite sum general sets p b 2ff denotes bernoulli polynomial degree 2ff 1 chap p node set integration lattice double sum simplified single sum another choice wk weighted r norm vector k power arbitrary positive weights weights unity p node set lattice kkk gammaff ae min kkk r oe gammaff discrepancy equivalent spectral test commonly employed measure quality linear congruential pseudorandom number generators 30 33 spectral test used select lattices quasimonte carlo quadrature 7 34 35 36 case one might call 1 spectral test also interesting return two cases next section 4 good generating vectors lattice sequences mentioned beginning previous section finding good generating vectors lattices typically requires optimizing discrepancy measure subsection propose loss functions optimization algorithms choosing good generating vectors extensible rank1 lattice sequences principle one would like theta 1 array digits h jk according 26 however practice necessary max theta mmax array digits h jk maximum number points max maximum dimension considered finance calculations example necessity timely forecasts may constrain one budget private communication simplicity consider generating vectors h form originally proposed korobov means digits need chosen b choices generating vector tested dimensions max fact extended dimension f j hickernell h hong p l ecuyer c lemieux number j defining generating vector chosen minimizing loss func tion g form function related one measures discrepancy introduced section 3 maximum range values insures resulting generating vector good range numbers points dimensions however since discrepancy depends significantly number points dimension must appropriately scaled arrive function g details scaling given 41 generating vectors based minimizing p ff discrepancy defined 311 generalization p ff figure merit lattice rules advantage requiring osn operations evaluate lattices remove dimension dependence discrepancy divided square root right hand side 36 root mean square scaled discrepancy random sample n gamma12 independent formula scaled discrepancy node set lattice specific choice value fi j crucial seems give good results onedimensional lattices ie evenly spaced points interval 0 1 discrepancy n gamma1 one would expect dimension increases scaled discrepancy would tend least worse n gamma12 therefore remove remaining dimension dependence scaled discrepancy divided fixed asy ms asymptotically ob gammam sgamma12 n tends infinity asymptotic order 0 snets 25 hope achieve lattice sequences furthermore n summary resulting loss function theta optimal values j found minimizing g 1 j different ranges given table 41 algorithm optimizing g 1 j may described intelligent exhaustive search one need compute g 1 j possible values j suppose stage optimization j best known value j one finds j since depends first digits j one immediately eliminate consideration j first gamma 1 digits j search strategy also used loss functions described extensible lattice sequences 11 42 generating vectors based spectral test use spectral test analyze lattice structure linear congruential generators described 30 tables good integration lattices given 34 difference nearly smaller lattices imbedded largest lattice considered must low discrepancy 34 full lattice examined length shortest nonzero vector dual lattice l related discrepancy 312 2 length absolute upper bound constants fl ae depend see 34 references therein bound 8 least upper bound general sdimensional lattice realvalued coordinates b gammam points per unit volume bound 8 least upper bound still reasonably tight numerical results show define normalized 2 spectral test discrepancy larger 1 inverse quantity defined 34 different notation consistent rest article loss function minimized form 42 note 1d 2 j interpreted euclidean distance successive hyperplanes contain points primal lattice l family hyperplanes distance largest problem computing shortest vector 44 formulated quadratic optimization problem integer decision variables k written linear combination vectors basis dual lattice integer coefficients decision variables coefficients see 30 details solved problem using branchandbound algorithm fincke pohst 10 heuristic modifications improve speed worstcase time complexity algorithm exponential 2 j polynomial 2 j fixed 10 practice typically works nicely even 2 j large example one compute 2 arbitrary j less 1 second pentiumii computer 43 generating vectors based 1 spectral test 1 norm length shortest nonzero vector l related discrepancy 312 1 one upper bound established marsaglia 37 applying general convex body theorem minkowski suggests normalized 1 spectral test quantity 12 f j hickernell h hong p l ecuyer c lemieux want minimize loss function 42 g 3 one interpret 1 j 1 j gamma 1 certain cases see 30 minimal number hyperplanes cover points p computed via algorithm dieter 6 works fine 10 independently becomes slow larger time exponential test quantity 48 interpretation similar quality parameter snets define since ss thus rank1 lattice defined j integrates exactly trigonometric polynomials wavenumber k logjk one considers j quality parameter lattice condition similar 25 determines resolution piecewise constant functions exactly integrated net j determines resolution trigonometric polynomials integrated exactly lattice discrepancy node set lattice defined 312 one construct infinite sequence digits j discrepancy decays like n gammaffs parameter ff indicates assumed smoothness integrands 44 tables coefficients made computer searches find best js based minimizing worstcase loss function selected values bounds define range number points lattice maximal number dimensions interested selecting different parameters j different ranges values convenient compromise extreme cases choosing different j pair choosing j pairs practice one typically general idea many points one going take selecting j specialized range one obtain lattice better figure merit particular range table 41 gives optimal js corresponding figures merit 49 computational efficiency constraints searches limited 1 20 best j found verified performance 0 reduced extensible lattice sequences 13 1 1 increased retained smallest 0 largest 1 1 g unchanged table also gives value g imin j defined replacing max min 49 bestcase figure tells us range values taken given region also made exhaustive searches entries table obtained values j g cases table values j defining generating vectors form 41 rank1 lattice sequences base minimizing 49 5 estimating quadrature error advantage extensible lattice sequence n need specified advance therefore practice one would estimate quadrature error initial lattice continue increase lattice size quadrature error meets desired tolerance although discrepancy dp good measure quality set p cannot used directly error estimation worst case error bounds 31 often quite conservative easy way estimate variation integrand average case error given 34 sensitive one defines kernel multiplying kernel factor c 2 changes average case error factor c quadrature error estimates lattice rules investigated 5 28 53 two different kinds quadrature rules error estimates proposed involve estimating error terms qf p l node sets lattices method proposed 53 takes p composed 2 shifted copies lattice rather considering copy rules take p l node sets shifted lattices size b m1 imbedded extensible lattice described section 24 14 f j hickernell h hong p l ecuyer c lemieux another quadrature rule error estimate takes p l independent random shifts lattice done taking delta l independent uniformly distributed random vectors 0 1 note 51 52 set p extended size necessary increasing 1 theory behind error estimates cases 51 52 given following theorem theorem 51 suppose quadrature rule qdelta p based arbitrary p given 11 average value quadrature rules based sets first consider case integrands random functions sample space described paragraph preceding 34 follows discrepancy based covariance kernel secondly consider case fixed integrand f p l random shifts set p 0 independent uniformly distributed proof assuming quadrature rules satisfy 53 follows mean square deviation qf p l qf p may written asm integrand random function sample space covariance kernel k average case error analysis 34 plus 57 leads following equations extensible lattice sequences 15 equations may rearranged give 54 quadrature error rule qf p may also written substituting sum equation 57 gives p l random shifts 55 expected value term gamma vanishes k 6 l taking expected value 58 yields 56 remarks order explain assumptions conclusions theorem given assumption 53 thus conclusion 54 holds cases 51 52 fact part theorem holds imbedded rule rule p l contain number points union p multiple copies p example 54 would apply case p snet made union subnets p l assumption 55 therefore conclusion 56 holds 52 difficulty one tries derive result like 56 imbedded rule form 51 delta random shift argument leading 56 assumes points different p l uncorrelated true 51 however extensible lattice good one expected terms 58 average negative assumption one may conclude right hand side 56 conservative large upper bound expected square quadrature error factor 54 involving discrepancies p p l depend strongly particular choice discrepancy asymptotic rate decay example dp cn gammaff unknown c known ff n number points p although conclusions 56 59 derived different assumptions suggest error estimates form f j hickernell h hong p l ecuyer c lemieux indicates rate decay discrepancy 59 factor c 1 depends conservative one wishes chebyshev inequality implies inequality hold least 1001 gamma c gamma2 time error estimate 510 leads stopping criteria ffl absolute error tolerance note stopping criteria met one would normally increase size p l increasing 1 rather increasing number p l increasing high dimensional problems discrepancy lattice low discrepancy set may decay slowly monte carlo rate gamma12 n see 18 41 therefore even using 59 may advisable make conservative choice ff 12 choice makes approach error estimate 59 based random integrands equivalent 56 based randomly shifted p l sloan joe 53 section 103 suggest error estimate form p formed 2 copies rank1 lattice qf p l imbedded rule based half points p although case exactly fit theorem 51 arguments proof modified obtain result similar 54 would suggest error estimation formula sloan joe reasonable 2dp average disadvantage 2 copy rules require least 2 points may unmanageable large summarize imbedded lattice rules 51 independent random shifts lattices 52 similar error estimates 510 stopping criteria 511 advantage independent random shifts approach theory holds integrand average space integrands one advantage imbedded rules approach one need generate single extensible lattice furthermore set p imbedded rule node set lattice power b never case independent random shifts approach thus accuracy imbedded rule approach likely better examples next section imbedded lattice rules based 51 used 6 examples multidimensional quadrature two example problems chosen demonstrate performance new rank1 lattice sequences proposed section 24 first example computation multivariate normal probabilities second evaluation multidimensional integral arising physics problems extensible lattice sequences 17 61 multivariate normal probabilities consider following multivariate normal z b1 z bs b known sdimensional vectors sigma given theta positive definite covariance matrix j andor b j may infinite unfortunately original form wellsuited numerical quadrature therefore alan genz 12 proposed transformation variables results integral gamma 1dimensional unit cube see 12 13 details transformation see 13 15 comparisons different methods calculating multivariate normal probabilities particular test problem one considered 13 24 may described follows iid uniformly 0 generated randomly according 13 38 61d numerical comparisons made using three types algorithms adaptive algorithm dchure 2 ii older korobov rank1 lattice rule different generating vector n algorithm part nag used 5 12 iii new rank1 lattice sequences proposed section 24 generating vectors given table 41 second third algorithms applied periodizing transformation x 0 1j integrand unit cube appears increase accuracy lattice rule methods computations carried fortran unix work station double precision absolute error tolerance chosen compared actual error e since true value integral unknown test problem value given korobov algorithm tolerance used exact value computing error new rank1 lattice sequences stopping criterion 511 used 4 7 dimension 50 random test problems generated solved various quadrature methods scaled absolute errors effl computation times seconds given box whisker plots fig 61 boxes contain middle half values whiskers give range values except outliers denoted ideally scaled error nearly always less one otherwise error estimate conservative enough hand scaled error small error estimate conservative fig 61 shows adaptive rule performs well smaller dimensions underestimates error quite slow higher dimensions lattice rules well even higher dimensions new rank1 lattice sequences appear faster older korobovtype rule likely due fact lattice sequences proposed reuse old points n must increased f j hickernell h hong p l ecuyer c lemieux 62 multidimensional integral physics keister 29 considered following multidimensional integral applications physics z r z cos dy 62 phi denotes standard gaussian distribution function keister gave exact formula answer compared quadrature methods mcnamee stenger 39 genz patterson 11 51 evaluating integral later papageorgiou traub 49 applied generalized faure sequence finder problem results numerical experiments integral dimension 25 shown figure 62 exact value integral reported 49 consistent numerical results reported 29 49 perform error estimation computed actual error kind numerical method function n number points phi technical difficulty using unshifted lattice rule performing numerical experiments lattice sequences given random shifts modulo 1 box whisker plots show well new rank1 lattice sequences perform 50 random shifts according figure 62 generalized faure sequence base 29 lattice sequence perform much better two rules cases lattice sequences perform better generalized faure sequence 7 conclusion lattice rules simpler code digital nets given construction section 24 possible extensible lattice sequences way one ssequences good generating vectors lattice sequences may found using spectral test minimizing discrepancy measures shown section 4 performance lattice rules many cases comparable multidimensional quadrature rules cases superior acknowledgments thanks alan genz making available software computing multivariate normal distributions also thanks joe traub anargy ros papageorgiou making available finder software r handbook mathematical functions formulas adaptive algorithm approximate calculation multiple integrals valuation mortgage backed securities using brownian bridges reduce effective dimension randomization number theoretic methods multiple integration calculate shortest vectors lattice discrepance de suites associees un systeme de numeration en dimension improved methods calculating vectors short length lattice lagrange extrpolation algorithm sequences approximations multiple inte grals parameters integrating periodic functions several variables simulation multivariate normal rectangle probabilities derivatives theoretical computational results assessment random quasirandom point sets random quasirandom point sets comparison random quasirandom points multidimensional quadrature computing multivariate normal probabilities using rank1 lattice sequences funktionen von beschrankter variation der theorie der gleichverteilung applications number theory numerical analysis randomization lattice rules numerical multiple integration multidimensional quadrature algorithms art computer programming approximate computation multiple integrals distribution digital sequences random numbers fall mainly planes construction fully symmetric numerical integration formu las generating quasrandom paths stochastic processes points sequences small discrepancy shiue eds quasirandom points global function fields faster valuation financial derivatives optimum addition points quadrature formulae lattice methods multiple integration lattice methods multiple integration lattice methods multiple integration theory intractability result multiple integration distribution points cube approximate evaluation integrals nauka computational investigations low discrepancy point sets average case complexity multivariate integration applications multidimensional integration parts tr ctr fred j hickernell harald niederreiter existence good extensible rank1 lattices journal complexity v19 n3 p286300 june hee sun hong fred j hickernell gang wei distribution discrepancy scrambled digital snets mathematics computers simulation v62 n36 p335345 3 march pierre lecuyer quasimonte carlo methods practice quasimonte carlo methods simulation proceedings 35th conference winter simulation driving innovation december 0710 2003 new orleans louisiana fred j hickernell dream quadrature rule journal complexity v19 n3 p420427 june hee sun hong fred j hickernell algorithm 823 implementing scrambled digital sequences acm transactions mathematical software toms v29 n2 p95109 june