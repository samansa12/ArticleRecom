implicitly restarted symplectic lanczos method symplectic eigenvalue problem implicitly restarted symplectic lanczos method symplectic eigenvalue problem presented lanczos vectors constructed form symplectic basis inherent numerical difficulties symplectic lanczos method addressed inexpensive implicit restarts method used compute eigenvalues eigenvectors large sparse symplectic operators b introduction consider numerical solution real symplectic eigenvalue problem 2 ir 2ntheta2n large possibly sparse matrix called symplectic iff equivalently n n theta n identity matrix symplectic matrices form group multiplication eigenvalues symplectic matrices occur reciprocal pairs eigenvalue right eigenvector x gamma1 eigenvalue left eigenvector jx computation eigenvalues eigenvectors matrices important task applications like discrete linearquadratic regulator problem discrete kalman filtering solution discretetime algebraic riccati equations see eg 21 22 28 applications references symplectic matrices also occur solving linear hamiltonian difference systems 6 order develop fast efficient reliable methods symplectic structure problem preserved exploited important properties symplectic matrices eg eigenvalues occurring reciprocal pairs preserved destroyed rounding errors different structurepreserving methods solving proposed 25 lin introduces used compute eigenvalues symplectic matrix structurepreserving method similar van loans squarereduced method hamiltonian eigenvalue problem 38 flaschka mehrmann zywietz show 14 construct structurepreserving methods based sr method 10 11 26 patel 34 33 mehrmann 27 developed structurepreserving algorithms symplectic generalized eigenproblem submitted july 1998 universitt bremen fachbereich 3 mathematik und informatik zentrum fr technomathe matik 28357 bremen frg email bennermathunibremende z corresponding author universitt bremen fachbereich 3 mathematik und informatik zentrum fr technomathematik 28357 bremen frg email heikemathunibremende benner fabender recently banse bunsegerstner 2 3 presented new condensed form symplectic matrices 2n theta 2n condensed matrix symplectic contains nonzero entries determined 4n gamma 1 parameters condensed form called symplectic butterfly form depicted symplectic matrix following 7 5 reduction symplectic matrix butterfly form achieved sr algorithm 10 11 26 suitable tool computing eigenvalueseigenvectors symplectic matrix sr algorithm preserves butterfly form iterations rewritten parameterized form works 4ngamma1 parameters instead 2n 2 matrix elements iteration hence symplectic structure destroyed numerical process due roundoff errors restored iteration condensed form analysis butterfly sr algorithm found 2 4 5 2 3 elimination process computing butterfly form symplectic matrix given uses elementary unitary symplectic transformations well nonunitary symplectic transformations unfortunately approach suitable dealing large sparse symplectic matrices elimination process make full use sparsity hence symplectic lanczos methods create symplectic butterfly form breakdown occurs derived 2 4 given symplectic matrix 2 ir 2ntheta2n lanczos algorithms produce matrix satisfies recursion form ms butterfly matrix order 2k theta 2k columns 2n2k orthogonal respect indefinite inner product defined j 13 latter property called jorthogonality throughout paper residual r k1 depends v k1 w symplectic lanczos method suffer wellknown numerical difficulties inherent lanczos method unsymmetric matrices 2 symplectic lookahead lanczos algorithm presented overcomes breakdown giving strict butterfly form un fortunately far exist eigenvalue methods make use special reduced form standard eigenvalue methods qr sr algorithms employed resulting full symplectic matrix iteration steps different approach deal numerical difficulties lanczos process modify starting vectors implicitly restarted lanczos process see fundamental work 9 35 unsymmetric eigenproblem implicitly restarted arnoldi method implemented successfully see 24 problems addressed fixing number steps lanczos process prescribed value k depends upon required number approximate eigenvalues jorthogonality k lanczos vectors secured rejorthogonalizing vectors necessary purpose implicit restart determine initial vectors associated residual vectors tiny given 14 implicit lanczos restart computes lanczos factorization implicitly restarted symplectic lanczos method 3 corresponds starting vector pm 2 ir 2ntheta2n polynomial without explicitly restart lanczos process vector v 1 implicit restarting mechanism derived analogous technique introduced 4 18 35 section 2 reviews symplectic butterfly form properties helpful analyzing symplectic lanczos method reduces symplectic matrix butterfly form symplectic lanczos method presented section 3 section concerned finding conditions symplectic lanczos method terminating prematurely invariant subspace associated certain desired eigenvalues obtained also consider important question determining stopping criteria implicitly restarted symplectic lanczos method derived section 4 numerical properties proposed algorithm discussed section 5 section 6 present preliminary numerical examples 2 symplectic butterfly form symplectic matrix called butterfly matrix b 11 b 21 diagonal b 12 b 22 tridiag onal banse bunsegerstner 2 3 showed every symplectic matrix exist numerous symplectic matrices ms symplectic butterfly matrix 2 elimination process computing butterfly form symplectic matrix presented see also 4 4 unreduced butterfly matrix introduced lower right tridiagonal matrix unreduced subdiagonal elements b 22 nonzero using definition symplectic matrix one easily verifies b unreduced butterfly matrix b 21 nonsingular allows decomposition b two simpler symplectic matrices tridiagonal symmetric hence parameters determine symplectic matrix read directly unreduced butterfly matrices play role analogous unreduced hessenberg matrices standard qr theory 2 4 5 frequently make use decomposition 21 denote 2 4 benner fabender d2 dn b2 d2 a2d2 remark 21 see 4 unreduced butterfly matrix similar unreduced butterfly matrix b deflation j eigenproblem split two smaller ones unreduced symplectic butterfly matrices eigenvalues eigenvectors symplectic butterfly matrices computed efficiently sr algorithm 7 qr like algorithm qr decomposition replaced sr decomposition almost every matrix 2 ir 2ntheta2n decomposed product sr symplectic r j triangular r submatrices r ij 2 ir nthetan upper triangular r 21 strictly upper triangular 12 following matrix 2 ir 2ntheta2n called trivial symplectic jtriangular trivial form c f diagonal matrices c nonsingular sr decomposition sr exists sr decompositions built passing trivial factors back forth r trivial matrix r another sr decomposition nonsingular way create sr decompositions words sr decomposition unique trivial factors sr algorithm iterative algorithm performs sr decomposition iteration b current iterate spectral transformation function implicitly restarted symplectic lanczos method 5 q chosen qb 2 ir 2ntheta2n sr decomposition qb formed possible symplectic factor used perform similarity transformation b yield next iterate call b b unreduced symplectic butterfly matrix b 25 2 3 rank unreduced symplectic butterfly matrix b 25 form see 4 zzzz symplectic butterfly matrix ffl eigenvalues shifts eigenvalues b algorithm explicitly computing r presented 8 explicit qr steps expense explicit sr steps comes fact qb computed explicitly preferred alternative implicit sr step analogue francis qr step 15 17 20 implicit sr step analogous implicit qr step technique discussed see 4 5 details natural way choose spectral transformation function q choose polynomial choices make use symmetries spectrum symplectic matrices explained 5 better choice laurent polynomial drive sr step example instead p 4 use 2 reduces size bulges introduced thereby decreasing number computations required per iteration moreover use laurent polynomials improves convergence stability properties algorithm effectively treating reciprocal pair eigenvalues unit using generalized rayleighquotient strategy butterfly sr algorithm typically cubic convergent 5 right eigenvectors unreduced butterfly matrices following property helpful analyzing symplectic lanczos method introduced next section 6 benner fabender lemma 22 suppose b 2 ir 2ntheta2n unreduced butterfly matrix 24 order proof lemma need following definition let pn permutation matrix dimension pn clear context leave subscript proof proof induction size b entries eigenvector x denoted x suppose 2 second fourth row since b unreduced know 2 6 0 2 6 0 x 29 obtain 28 gives b 2 using 210 obtain x third row using since b unreduced obtain x contradicts assumption x 6 0 assume lemma true matrices order 2ngamma1 let b 2n2n 2 ir 2ntheta2n unreduced butterfly matrix simplicity consider permuted equation b 2n2n partition 2ngamma2 c n5 x unreduced butterfly matrix 2 implies since 6 0 b 2n2n unreduced hence using 211 get x using obtain 211 contradiction induction hypothesis e remark 23 right eigenvector b jy e 2n 6 0 hence nth component left eigenvector b corresponding 6 0 implicitly restarted symplectic lanczos method 7 3 symplectic lanczos method symplectic matrices sec tion review symplectic lanczos method compute butterfly form 24 symplectic matrix derived 4 usual unsymmetric lanczos algorithm generates two sequences vectors due symplectic structure easily seen one two sequences eliminated thus work storage essentially halved property valid broader class matrices see 16 section concerned finding conditions symplectic lanczos method terminating prematurely invariant subspace associated certain desired eigenvalues obtained finally consider important question determining stopping criteria order simplify notation use following permuted versions b previous section let permutation matrix p 27 31 symplectic lanczos factorization want compute symplectic matrix transforms symplectic matrix symplectic butterfly matrix b permuted version ms sb yields equivalently consider dn 0 structure preserving lanczos method generates sequence permuted symplectic matrices satisfying 8 benner fabender permuted 2k theta 2k symplectic butterfly matrix vector r k1 k1 b k1 residual vector jp orthogonal columns 2n2k p lanczos vectors matrix b 2k2k p orthogonal projection mp onto range 2n2k j 2k2k p denotes permuted 2k theta 2k matrix j form 13 equation 35 defines length 2k lanczos factorization mp residual vector r k1 zero vector equation 35 called truncated lanczos factorization k n note r n1 must vanish since 2n2n columns 2n2n form jp orthogonal basis ir 2n case symplectic lanczos method computes reduction permuted butterfly form symplectic lanczos factorization multiplication trivial matrix specified starting vector v 1 see 4 theorem 41 wn given v 1 lanczos method constructs matrix sp columnwise equations obtain algorithm given table 31 detailed discussion see 4 method choose initial vector e update wm set e e wm computation c update v m1 e table symplectic lanczos method remark 31 using derived formulae w k1 residual term r expressed implicitly restarted symplectic lanczos method 9 still freedom choice parameters occur algorithm essentially parameters b chosen freely set b likewise different choice parameters dm possible note gamma1 since symplectic thus gamma1 matrixvectorproduct transpose mp hence one matrixvector product required computed lanczos vector wm v thus efficient implementation algorithm requires 6n nz number nonzero elements mp 2k number lanczos vectors computed loop executed k times algorithm given table 31 computes odd number lanczos vectors practical implementation one omit computation last vector v k1 one compute additional vector w symplectic lanczos method given divide parameters may zero close zero case occurs normalization parameter dm1 corresponding vector e v m1 zero close zero vector case good approximation jp orthogonal invariant subspace mp equivalently symplectic invariant subspace detected redefining e v m1 vector satisfying algorithm continued resulting butterfly matrix longer unreduced eigenproblem decouples two smaller subproblems case e wm zero close zero invariant subspace mp dimension found good approximation subspace case parameter zero close zero table 31 obtain case real eigenvalue mp hence corresponding due symmetry spectrum also 1b eigenvalue computing eigenvector mp corresponding 1b try augment 2m gamma 1dimensional invariant subspace mp invariant subspace even dimension possible space made jp orthogonal jp orthogonalizing f normalizing jp thus either v m1 wm1 vanishes breakdown benign v m1 6 0 wm1 6 0 breakdown serious reduction symplectic matrix symplectic butterfly matrix v 1 first column transformation matrix exists convergence analysis symplectic lanczos algorithm analogous one unsymmetric lanczos algorithm presented ye 39 given moreover error analysis symplectic lanczos algorithm finiteprecision arithmetic analogous analysis unsymmetric lanczos algorithm presented bai 1 also derived results presented 13 expected computed lanczos vectors loose jjp orthogonality ritz values begin converge 32 truncated symplectic lanczos factorizations section concerned finding conditions symplectic lanczos method terminating prema turely welcome event since case found invariant symplectic following 17 define floating point arithmetic operation together associated integer indexing flop benner fabender subspace 2n2k eigenvalues b 2k2k subset first discuss conditions residual vector symplectic lanczos factorization vanish step k show residual vector starting vector related finally result indicating particular starting vector generates exact truncated factorization given first conditions residual vector symplectic lanczos factorization vanish step k discussed derivation algorithm immediately clear breakdown occurs kx v vg easy see dim kmp hence exist real scalars ff using definition k1 given table 31 expression obtain jorthogonality 0 e implies invariant subspace mp dimension 2k dim kmp g hence properly chosen ff algorithm table 31 implicitly restarted symplectic lanczos method 11 therefore e v implies residual vector symplectic lanczos factorization vanish first step k dimension km equal 2k hence guaranteed vanish k n next discuss relation residual term starting vector dim km cn generalized companion matrix form 1 see 2 proof satz 36 thus define residual 37 note show f k1 scaling residual length 2k symplectic lanczos iteration starting vector v 1 together 39 reveals relation residual starting vectors since det c jorthogonal columns 2n2k jns jtriangular matrix diagonal elements r nonzero columns linear independent choosing 12 benner fabender assures gammaj k 2n2k multiplying 37 right unreduced butterfly matrix see 2 proof satz 36 characteristic polynomial c k equation 310 valid symplectic lanczos recursion starting vector v residual vector f k1 r 2k2k 39 due essential uniqueness symplectic lanczos recursion symplectic lanczos recursion starting vector v 1 yields residual vector expressed polynomial times starting vector v 1 remark 32 38 follows dim km choose c 1 c 2k f shows krylov subspace forms 2kdimensional minvariant subspace residual symplectic lanczos recursion zero k lanczos steps columns 2n2k span symplectic basis subspace km 1 final result section give necessary sufficient conditions particular starting vector generate exact truncated factorization similar way stated arnoldi method 35 desirable since columns 2n2k form basis invariant symplectic subspace eigenvalues b 2k2k subset denote lanczos vectors permuting back ie v theorem 33 let ms 2n2k symplectic lanczos factorization k steps b 2k2k unreduced jordan matrix order 2k proof xj jordan canonical form b 2k2k put x suppose follows hence 36 dim km unreduced dim km k hence dim km therefore similar result may formulated terms schur vectors symplectic schur vectors see eg 28 29 real symplectic schur decomposition symplectic matrix theorems provide motivation implicit restart developed next section theorem 33 suggests one might find invariant subspace iteratively replacing starting vector linear combination approximate eigenvectors corresponding eigenvalues interest approximations readily available lanczos factorization 33 stopping criteria assume performed k steps symplectic lanczos method thus obtained identity permuting back ms implicitly restarted symplectic lanczos method 13 norm residual vector small 2k eigenvalues b 2k2k approximations eigenvalues numerical experiments indicate norm residual rarely becomes small nevertheless eigenvalues b 2k2k may good approximations eigenvalues let eigenvalue b 2k2k corresponding eigenvector vector vector x referred ritz vector ritz value last component eigenvector sufficiently small righthand side 311 small pair f xg good approximation eigenvalueeigenvector pair note lemma 22 je unreduced pair x exact nearby problem small jjejj sufficient ritz pair f xg good approximation eigenvalueeigenvector pair advantage using ritz estimate jd w k1 jj avoid explicit formation residual deciding numerical accuracy approximate eigenpair wellknown nonnormal matrices norm residual approximate eigenvector sufficient information bound error approximate eigenvalue sufficient however give bound distance nearest matrix given approximation exact following give computable expression error assume b 2k2k diagonalizable since ms 2k follows ms 2k thus k last equation rewritten using theorem 2 19 obtain eigentriplet jjjx ki jj g 14 benner fabender furthermore jjejj small enough eigenvalue consequently symplectic lanczos algorithm continued jjejj small cond j jjejj given threshold accuracy 4 implicitly restarted symplectic lanczos method previous sections briefly mentioned two algorithms computing approximations eigenvalues symplectic matrix symplectic lanczos algorithm appropriate matrix large sparse small subset eigenvalues desired length k symplectic lanczos factorization may suffice analysis last chapter suggests strategy finding 2k eigenvalues length k factorization find appropriate starting vector forces residual r k1 vanish sr algorithm hand computes approximations eigenvalues eigenvectors theorem 41 4 implicit qtheorem sr case know exact arithmetic using starting vector sr algorithm length n lanczos factorization generate symplectic butterfly matrices multiplication trivial matrix forcing residual symplectic lanczos algorithm zero effect deflating subdiagonal element sr algorithm remark 31 r symplectic lanczos process hence zero residual implies zero k1 deflation occurs corresponding butterfly matrix goal section construct starting vector member invariant subspace interest approach implicitly restart symplectic lanczos factorization first introduced sorensen 35 context unsymmetric matrices arnoldi process scheme called implicit updating starting vector accomplished implicit shifted sr mechanism allows update starting vector working symplectic matrix ir 2j theta2j rather ir 2ntheta2n significantly cheaper iteration starts extending length k symplectic lanczos factorization steps next 2p shifts applied b 2kp2kp using double quadruple sr steps last 2p columns factorization discarded resulting length k factorization iteration defined repeating process convergence simplicity let us first assume 2n theta 2k p known 35 let real shift using permuted butterfly matrix sp upper triangular matrix two additional subdiagonals reexpress 41 mp 2n2k2 implicitly restarted symplectic lanczos method 15 p sp yields equation fails symplectic lanczos factorization since columns matrix k2 b k2 v k2 2k2 sp nonzero let ij jth entry sp residual term 42 rewriting 42 z blocked as6 6 6 6 4 dk1e dk1e dk2 bk2s 2k22k e dk2ak2s 2k22k e obtain new lanczos identity r k1 b k1 k1 denote parameters parameters b 2k22k2 p addition w k1 last two column vectors two last column vectors 2n2k2 space spanned columns orthogonal sp permuted symplectic matrix space spanned columns jorthogonal thus 43 valid symplectic lanczos factorization new starting vector ae 2 ir seen follows first note unreduced butterfly matrices b 2k22k2 q 2 b 2k22k2 hence q 2 b 2k22k2 obtain q 2 b 2k22k2 upper triangular matrix q 2 b 2k22k2 using 43 follows ae 2n2k2 ae 2n2k2 ae mp 2n2k2 ae mp 2n2k2 benner fabender r k2 e using 43 get gammaae e note symplectic lanczos process vectors v j 2n2k p satisfy condition parameters b j chosen one longer true odd numbered column vectors sp generated sr decomposition parameters b j p thus new lanczos factorization 43 properties could forced using trivial factors numerical tests indicate obvious advantage using standard polynomials shift polynomials instead laurent polynomials results following situation p 2 b 2k22k2 upper triangular matrix four additional subdiagonals therefore residual term 42 five nonzero entries hence last two last four columns 42 discarded order obtain new valid lanczos factorization would discard wanted information avoided using laurent polynomials technique extended quadruple shift case using laurent polynomials shift polynomials discussed section 2 implicit restart summarized given table 41 course iteration choose shifts order apply 2p shifts choosing real shift k implies gamma1 k also shift due symplectic structure problem hence gamma1 k added delta use laurent polynomial q 2 guarantees gamma1 k used shift k 2 delta case complex shift k implies k also shift added delta complex shifts k k delta numerous choices possible selection p shifts one possibility case choosing p exact shifts respect b 2kp2kp first eigenvalues b 2kp2kp computed sr algorithm p unwanted eigenvalues selected one choice selection might sort eigenvalues decreasing magnitude k eigenvalues modulus greater equal 1 select 2p eigenvalues modulus closest 1 shifts k1 complex either choose 2p shifts 2p k1 belongs quadruple pair eigenvalues b 2kp2kp p order preserve symplectic structure either k k1 chosen none implicitly restarted symplectic lanczos method 17 restarted symplectic lanczos method perform k steps symplectic lanczos algorithm compute 2n2k obtain residual vector r k1 jjr k1 jj tol perform p additional steps symplectic lanczos method compute 2n2kp select p shifts compute via implicitly shifted sr steps set 2n2k obtain new residual vector r k1 table kstep restarted symplectic lanczos method different possibility choosing shifts keep eigenvalues good approximations eigenvalues eigenvalues 311 small make sure set shifts complete sense described choosing eigenvalues b 2kp2kp p shifts important consequence next iterate assume simplicity b 2kp2kp p diagonalizable let disjoint partition spectrum b 2kp2kp selecting exact shifts implicit restart following rules mentioned yields matrix g follows 26 moreover new starting vector implicitly replaced sum 2k approximate eigenvectors ae ae properly chosen last equation follows since qb 2kp2kp e 1 component along eigenvector associated hence mentioned kstep restarted symplectic lanczos method table 41 exact shifts builds jorthogonal basis number generalized krylov subspaces simultaneously subspace length 2k p generated restart using exact shifts contains krylov subspaces dimension 2k generated desired ritz vectors detailed discussion see 13 similar benner fabender observation sorensens restarted arnoldi method exact shifts made morgan 30 discussion observation see 30 23 morgan infers method works approximations desired eigenpairs time without favoring one 30 p 1220l 78 bottom remark also applied method presented discussion assumed permuted sr decomposition exists unfortunately always true bulgechase implicit sr step may happen diagonal element j b 1 22 zero almost zero case reduction symplectic butterfly form corresponding first column exist next section prove serious breakdown symplectic lanczos algorithm equivalent breakdown sr decomposition moreover may happen subdiagonal element j 2 2block b 2 23 zero almost zero matrix p split invariant subspace dimension j found shifts applied iteration halted otherwise continue similar procedure described sorensen 35 remark 3 iteration progresses ritz values may converge eigenvalues long entire set wanted eigenvalues converged ritz values may part wanted unwanted portion spectrum either case desirable deflate converged ritz values corresponding ritz vectors unconverged portion factorization converged ritz value wanted necessary keep subsequent factorizations unwanted must removed current subsequent factorizations lehoucq sorensen develop 23 36 locking purging techniques accomplish context unsymmetric matrices restarted arnoldi method ideas carried situation 5 numerical properties implicitly restarted symplectic lanczos method 51 stability issues well known general lanczoslike methods stability overall process improved norm lanczos vectors chosen equal 1 32 37 thus banse proposes 2 modify prerequisite symplectic lanczos method gammaoe implicitly restarted symplectic lanczos method 19 resulting algorithm discussion refer 2 easy see bp sp longer permuted symplectic matrix still desired form butterfly matrix unfortunately sr step preserve structure thus modified version symplectic lanczos method used connection restart approaches form reorthogonalization lanczos algorithm numerically unstable hence rej p orthogonalize lanczos vector soon computed previous ones via wm defines indefinite inner product implied j n rej p orthogonalization costly requires 16nm gamma 1 flops vector wm 16nm flops v m1 thus 2k lanczos vectors computed rej p orthogonalization adds computational cost order flops overall cost symplectic lanczos method standard lanczos algorithms different reorthogonalization techniques studied references see eg 17 ideas used design analogous rej p orthogonalizations symplectic lanczos method noted k small cost rej p orthogonalization expensive another important issue numerical stability sr step employed restart sr step 2k theta 2k symplectic butterfly matrix orthogonal known numerically stable nonorthogonal symplectic transformations used choose among possible transformations ones optimal smallest possible condition number see 8 52 breakdowns sr factorization starting vector aeqmv 1 explicitly restarted symplectic lanczos method breaks impossible reduce symplectic matrix symplectic butterfly form transformation matrix whose first column v 1 thus situation sr decomposition qb exist shown section way breakdowns sr decomposition occur sr step transformations used orthogonal symplectic transformations computation break source breakdown one symplectic gaussian eliminations l j simplicity discuss double shift case following elementary elimination matrices used implicit sr step elementary symplectic givens matrices 31 20 benner fabender elementary symplectic householder transformation elementary symplectic gaussian elimination matrices 8 assume k steps symplectic lanczos algorithm performed 35 implicit restart performed using implicit double shift sr step first step implicit sr step symplectic householder matrix h 1 computed h 1 applied b 2k2k introducing small bulge butterfly form additional elements found positions 2 1 1 2 n 1 remaining implicit transformations perform bulgechasing sweep subdiagonal restore butterfly form algorithm given 2 4 summarized situation table 51 g j g j denote symplectic givens transformation matrices acting planes different rotation angles compute g 1 g 1 b 2k2k compute l 1 l 1 b 2k2k compute g 1 b 2k2k g 1 compute h 1 b 2k2k h 1 table reduction butterfly form double shift case implicitly restarted symplectic lanczos method 21 suppose first exist computed order simplify notation switch permuted version rewrite permuted symplectic matrix b sp 2ngamma2j gamma2 making use fact accumulated transformations affect rows 1 j j leading 2j principal submatrix given e x x x x x hatted quantities denote unspecified entries would change sr update could continued next 2j annihilated permuted symplectic gaussian elimination elimination fail exist sr decomposition qb 2k2k exist needed later implies follows e p e obtain j x x otherwise last gaussian transformation exist next show breakdown sr decomposition implies breakdown lanczos process started starting vector 22 benner fabender consider 51 multiplied right b sp derivations last section know starting vector recursion given trailing 2n submatrix b sp identity well consider multiplied right sp p sp corresponds matrix 52 butterfly w j1 columns jp orthogonal starting vector recursion 53 given deleting last four columns p way implicit restart obtain valid symplectic lanczos factorization length 2 order show breakdown sr decomposition qb implies breakdown symplectic lanczos recursion need show 52 53 obtain know symplectic lanczos algorithm quantities already known consider x3 obviously x using 56 obtain 2 hence x using 55 end 54 see x z3 implicitly restarted symplectic lanczos method 23 53 obtain hence using 54 yields similar follows z argumentation shown sr breakdown implies serious lanczos breakdown opposite implication follows uniqueness lanczos factorization result summarized following theorem theorem 51 suppose symplectic butterfly matrix b 2k2k corresponding 35 unreduced let 2 ir let l j jth symplectic gauss transformation required sr step b first symplectic gauss transformations sr step exist l j fails exist v j 43 6 numerical experiments examples demonstrate properties implicitly restarted symplectic lanczos method presented computational results quite promising certainly preliminary computations done using matlab version 51 sun ultra 1 ieee doubleprecision arithmetic machine precision code implements exactly algorithm given table 41 order detect convergence restart process rather crude criterion used ad hoc stopping rule allowed iteration halt quite early usually eigenvalues largest modulus reciprocals wanted part spectrum much better approximated ones smaller modulus blackbox implementation algorithm stopping criterion replaced rigorous one ensure eigenvalues approximated desired accuracy see discussion section 33 benign breakdown symplectic lanczos process detected criterion serious breakdown detected implementation intends compute k eigenvalues largest modulus reciprocals implicit restart used exact shifts chose shifts 2p eigenvalues b 2kp2kp closest unit circle observations following benner fabender ffl rejorthogonalization necessary otherwise jorthogonality computed lanczos vectors lost steps ghost eigenvalues see eg 17 appear multiple eigenvalues b 2k2k correspond simple eigenvalues ffl implicit restart accurate explicit one ffl leading end wanted ritz values eigenvalues largest modulus reciprocals converge faster tail end closest cut sort behavior observed 35 implicitly restarted arnoldi method order obtain faster convergence seems advisable similar implementation sorensens implicitly restarted arnoldi method matlabs eigs increase dimension computed lanczos factorization instead computing 2n2k basis restart one compute slightly larger factorization eg dimension 2k instead dimension 2k 2 eigenvalues converged subspace dimension 2k computed basis restart followed p additional lanczos steps obtain factorization length k using implicit sr steps factorization reduced one length k symplectic lanczos method would implemented following approach convergence check could done using k ritz values largest modulus reciprocals yield smallest ritz residual jd j eigenvectors b 2k2k ffl fairly difficult find good choice k p every possible choice k exists invariant subspace dimension 2k associated k eigenvalues largest modulus reciprocals k complex choose 2p eigenvalues modulus closest unit circle shifts would tear quadruple eigenvalues apart resulting shift polynomial q qb 2kp2kp choose 2p gamma 2 eigenvalues modulus closest 1 shifts order get full set 2p shifts add last shift real eigenvalue pair largest ritz residual depending good real eigenvalue approximates eigenvalue strategy worked resulting subspace longer subspace corresponding k eigenvalues largest modulus reciprocals real eigenvalue converged eigenvalue unlikely remove eigenvalue restarting keep coming back purging technique like one discussed lehoucq sorensen 23 36 able remove eigenvalue moreover guarantee real eigenvalue p used hence blackbox implementation one either try compute invariant subspace dimension dimension 2k 1 known priori algorithm adapt k iteration process appropriately problem suggested one always computes slightly larger lanczos factorization requested example 61 first test performed concerned loss jorthogonality computed lanczos vectors symplectic lanczos method ghost implicitly restarted symplectic lanczos method 25 eigenvalue problem see eg 17 demonstrate effects rejorthogonali zation 100 theta 100 symplectic matrix eigenvalues 200 100 50 used symplectic blockdiagonal matrix eigenvalues blockdiagonal constructed similarity transformation randomly generated orthogonal symplectic matrix performed obtain symplectic matrix expected using random starting vector eigenvalues largest modulus corresponding reciprocals tend emerge right start eg eigenvalues b 1010 19999997 10006771 4871752 2685083 832399 reciprocals without form rejorthogonalization jorthogo nality lanczos vectors lost iterations indicated figure 61 number lanczos steps 1002k js 1002k fig 61 loss jorthogonality k symplectic lanczos steps loss jorthogonality lanczos vectors results standard lanczos algorithm ghost eigenvalues multiple eigenvalues b 2k2k correspond simple eigenvalues example using rejorthogonalization 17 iterations 6 eigenvalues largest modulus b 3434 using complete rejorthogonalization effect avoided 200 100 4999992 4702461 4593018 4231199 second test performed concerned question whether implicit restart accurate explicit one nine steps symplectic lanczos method random starting vector resulting butterfly eigenvalues using matlab function eig 200000000000000 99999999841718 13344815062428 3679215125563 sigma5750883779240i 26 benner fabender reciprocals removing 4 complex eigenvalues b 1818 using implicit restart described section 4 obtain symplectic butterfly matrix impl whose eigenvalues 200000000000000 99999999841719 13344815062428 reciprocals 26 follows 14 real eigenvalues b 1818 removed seen lost one digit implicit restart indicated underbar lost digits table performing explicit restart explicitly computed new starting vector butterfly expl whose eigenvalues 200000000000000 99999999841793 reciprocals time lost nine digits last set tests performed matrix concerned kstep restarted symplectic lanczos method given table 41 one quadruple complex eigenvalues eigenvalues smallest magnitude problem choosing k n every choice exists invariant symplectic subspace corresponding k eigenvalues largest magnitude reciprocals tests reported random starting vector used figure 62 shows plot jjr k1 jj versus number iterations performed iteration step 1 refers norm residual first k lanczos steps restart performed three lines figure 62 present three different choice k p convergence achieved three examples many shown obviously choice results faster convergence choice 8 convergence means monotonic major part iteration norm residual changing quite dramatically certain stage achieved norm residual converges although convergence quite fast imply convergence fast choices k p third line figure 62 demonstrates convergence need twice many iteration steps example 62 symplectic matrix pencils appear discretetime linearquadratic optimal control problems typically form gammabb note f 6 l n symplectic l gamma n symplectic matrix pencil assuming l n nonsingular f nonsingular solving generalized eigenproblem equivalent solving eigenproblem symplectic matrix gammabb one interested computing eigenvalues l gamma n one use implicitly restarted symplectic lanczos method 27 number iterations normr fig 62 kstep restarted symplectic lanczos method different choices k p restarted symplectic lanczos algorithm step symplectic lanczos algorithm one compute matrixvector products form mx making use special form l n done without explicitly inverting us consider computation first compute next one solve linear system analogous x z ny z obtain order solve compute lu decomposition f solve linear system f using backward forward substitution hence explicit inversion n f avoided case f sparse matrix sparse solvers employed particular control system comes sort discretization scheme f often banded used computing initial band lu factorization f order minimize cost computation 2 note applications computational cost c cx 1 significantly cheaper matrixvector product n theta n matrix case singleinput corresponding operations come two dot products length n using matlabs sparse matrix routine sprandn sparse normally distributed random matrices f b c n different dimensions different densities nonzero entries generated example dimension presented density different matrices chosen matrix nonzero entries 28 benner fabender matlab computed norm corresponding matrix 53 theta first set tests k chosen 5 tested seen figure 63 first 3 iterations norm residual decreases choice p increases quite bit first step eigenvalues b 1010 approximating 5 eigenvalues l gamma n largest modulus reciprocals step 4 wrong choice shifts done cases extended matrices b 2020 b 3030 still approximate 5 eigenvalues l gamma n largest modulus new real eigenvalue coming good approximation eigenvalue l gamma n due way shifts chosen new eigenvalue kept already good approximated eigenvalue little smaller magnitude shifted away resulting dramatic increase jjr k1 jj modifying choice shifts good approximation kept new real eigenvalue shifted away problem resolved good eigenvalues kept convergence occurs steps oline figure 63 using slightly larger lanczos factorization basis restart eg factorization length k 3 instead length k using locking technique decouple converged approximate eigenvalues associated invariant subspaces active part iteration problem avoided number iterations normr modified fig 63 kstep restarted symplectic lanczos method different choices shifts figure 64 displays behavior kstep restarted symplectic lanczos method different choices k p k quite small convergence achieved case far tests presented k always chosen exists deflating subspace l gamma n corresponding k eigenvalues largest modulus reciprocals deflating subspace one one figure 65 convergence plot eigenvalues b 2kp2kp first iteration steps approximate k eigenvalues largest modulus reciprocals 5 j p quite well choice shifts select 2p eigenvalues modulus closest 1 k1 complex 1 choose shifts way last shift chosen implicitly restarted symplectic lanczos method 29 number iterations normr fig 64 kstep restarted symplectic lanczos method different choices k p according strategy explained eigenvalue keeps coming back annihilated better idea resolve problem adapt k appropriately number iterations normr fig 65 kstep restarted symplectic lanczos method different choices k p 7 concluding remarks investigated symplectic lanczos method symplectic matrices employing technique implicitly restarting method using double quadruple shifts zeros driving laurent polynomials results efficient method compute extremal eigenvalues symplectic matrices associated eigenvectors invariant subspaces residual lanczos recursion made zero choosing proper shifts open problem shifts chosen optimal way preliminary numerical tests reported show exact shifts good performance already achieved implementing symplectic lanczos process blackbox algorithm details need consideration particular techniques locking con benner fabender verged ritz values well purging converged unwanted ritz values needs derived similar way done implicitly restarted arnoldi method r analysis lanczos algorithm nonsymmetric eigenvalue problem symplektische eigenwertverfahren zur losung zeitdiskreter optimaler steuerungs probleme condensed form solution symplectic eigenvalue problem symplectic eigenvalue problem sr sz algorithms symplectic butterfly eigenproblem linear hamiltonian difference systems disconjugacy jacobitype conditions matrix factorization symplectic qrlike methods symplectic qrlike algorithm solution real algebraic riccati equation implicitly restarted lanczos method large symmetric eigenvalue problems sur quelques algorithmes de recherche de valeurs propres numerical linear algorithms group theory algebraic problems connection general eigenvalue algorithms symplectic methods symplectic eigenproblems analysis structure preserving methods symplectic eigenvalue problems qr transformation part part ii matrix computations model reduction state space systems via implicitly restarted lanczos method residual bounds approximate eigensystems nonnormal matrices algorithms solution complete eigenvalue problem algebraic riccati equation invariant subspace methods numerical solution riccati equations deflation techniques implicitly restarted arnoldi itera tion solution largescale eigenvalue problems implicitly restarted arnoldi methods new method computing closed loop eigenvalues discretetime algebraic riccati equation canonical forms hamiltonian symplectic matrices pencils restarting arnoldi method large nonsymmetric eigenvalue problems schur decomposition hamiltonian matrices computation stable deflating subspace symplectic pencil using structure preserving orthogonal transformations implicit application polynomial filters kstep arnoldi method analysis look ahead lanczos algorithm symplectic method approximating eigenvalues hamiltonian matrix convergence analysis nonsymmetric lanczos algorithms tr