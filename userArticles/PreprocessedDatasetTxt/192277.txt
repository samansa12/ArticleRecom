clustering algorithm radiosity complex environments present approach accelerating hierarchical radiosity clustering objects previous approaches constructed effective hierarchies subdividing surfaces could exploit hierarchical grouping existing surfaces limitation resulted excessive number initial links complex environments initial linking potentially expensive portion hierarchical radiosity algorithms constrains complexity environments simulated clustering algorithm presented operates estimating energy transfer collections objects maintaining reliable error bounds transfer two methods bounding transfers employed different tradeoffs accuracy time contrast os2 time space complexity initial linking previous hierarchical radiosity algorithms new methods complexities oslogs os time space using methods obtained speedups two orders magnitude environments moderate complexity maintaining comparable accuracy b introduction recent trends realistic image synthesis towards separation rendering process two stages10 2 9 one stages solves global energy equilibrium throughout environment process expensive complexity grows rapidly number objects environment computational demands generally limit level detail environments simulated furthermore solution problem must computed anything useful displayed radiosity algorithms attempt solve global illumination problem discretizing environmentand solving linear system approximate transfer energy elements 5 complex environmentsthe large number interactions expensive email bes arvo dpggraphicscornelledu compute requires form factor visibility calculations challenge reduce computational complexity process one early approaches cohen et al 3 reduced number interactions imposing twolevel hierarchy patches elements environment although number interactions reduced approachwas still op 2 number elements environment currently best radiosity algorithms analogous lineartime algorithms charged particle simulation 6 algorithms work clustering particles together mutual effect wellseparated collections approximated single interaction hanrahan et al 7 used similar strategy reduce number interactions needed radiosity solution hierarchical structure imposed surface environment interactions allowed occur appropriate levels approach works well number initial surfaces small hierarchical radiosity hr algorithms sub divide large surfaces smaller ones cannot group smaller elements larger ones initial linking phase hr must check pairs initial surfaces potential interactions without grouping surfaces together algorithm quadratic number initial surfaces complexity environments often result replacing large surfaces many small surfaces inability group objects together major obstacle conventional hr algorithms several methods developed increase efficiency hr algorithms complex environments global visibility 13 effective computing initial links environments small number cells see many environments however also contain large collections objects mutually visible cases global visibility algorithms suffice importance 12 another method reduces computation areas little noticeable effect surfaces interest approach effective initial interactions computed nothing reduce time initial linking phase importance driven hierarchical radiosity stands gain even clustering standard hierarchical radiosity attempts compute radiance coarsely regions environment means clustering needed less work required initial linking approach clustering developedby rushmeier et al 11 effect complex groups surfaces approximated simpler representations resembling brdfs obtained monte carlo sampling one disadvantage approach automatic appropriate clusters must specified approximated advance also hierarchy maintained coarsest representation used algorithm selected clusters another clustering approach proposed kok8 extended progressive radiosity patches could transfer energy alink blink patch link figure 1 two collections objects interact different levels conventional hr links b fflink requiring linear time space c filink requiring constant time space groups surfaces neither approaches analyze error approximations used transfers illustrate clustering important consider simple configuration consisting two chairs containing 100 surfaces hr would check 10000 potential interactions two chairs would create neighborhood 2500 patch links figure 1 however chairs well separated unlikely energy transfer significant effect illumination either guarantee throughout entire solution gain efficiency coarsely approximating transfer energy shall present new strategy linking would handle configuration creating single link cost comparable either 1 200 conventional links depending separation objects reducing total cost links created two collections objects reduce algorithmic complexity os 2 initial linking step hr 11 overview hierarchical algorithms radiosity three components 1 hierarchical description environment 2 criterion determining level hierarchy two objects interact 3 means estimating energy transfer objects criterion interaction use bounds potential error transfer energy betweentwo objects first describe hierarchical radiosity using approach present two efficient techniques bounding transfers clusters first technique fairly accurate approach call ff linking second faster less accurate approach call filinking corresponding methods determining bounds two ways estimating transfer energy clusters also describe method used create hierarchy clusters starting point clusterbased linking strategies finally give theoretical boundson complexity results implementation demonstrating dramatic speedupsover conventional hr complex environments hierarchical radiosity value radiance function l surface point x due another surface expressed z kernel kx expresses radiance x due differential area point kernel written angle formed normal differential area x direction given gamma x 2 angle formed normal differential area direction given byxgammay also ae bidirectional reflectance distribution function brdf paper shall address ideal diffuse scattering although much analysis extends general reflectance functions compute exact radiance function across receiver lx must evaluated every point receiver general set basis functions used represent radiance functions quadrature rules used compute coefficients basis functions reduces problem evaluating lx fixed number points environment meshed fixed number patches p potentially p 2 interactions hr maintains hierarchical representation initial surface example means quadtree hr allows surfaces interact level hierarchy interactions error less bound requires bounding error transfer two patches done bounding difference maximum minimum transfers12 maximum transfer computed finding maximum value kx points two patches integrating product radiance source denote maximum value function f range theta b f x using notation bound energy transfer may written z lydy expression allows arbitrary distributions radiance across source minimum computed similarly minimum set zero two points occluded maximum minimum values k computed taking set jittered samples source receiver computing maximum minimum values kernel pairs samples 12 occasionally approach greatly underestimates max imum small patch close large patch underestimate usually prevent subdivision however problem diminishes two patches approach size bounding error transfer energy computing interactions given accuracy results linear number interactions 7 transfer energy two surfacescan determined using various formfactor methods main deficiency hr coarsest representation initial surfaces collecting group surfaces together obtain even coarser representation make use coarser representation require bound transfer energy two clusters bound must computed less source receiver figure 2 straightforward approach bounding error link represents maximum value k os 2 gain improvement brute force method checking pairs interactions describe two ways bounding error time complexity better 3 bounding error clusters section describe two strategies computing bounds energy transfer clusters one requiring linear time space one requiring constant time space strategies derived systematically introducing approximations exact expression energy transfer first level approximation results type link call fflink introducing approximations produce filinks although bounds coarse often suffice large fraction interactions 31 fflinks transfer energy cluster patches point computed summing n patches source cluster z kx ylydy since kx function position orientation receiver well source visibility computing transfer radiance two clusters requires evaluating lx least receivers resulting omn work applying approach used hr two clusters relatively expensive bound transfer clusters approach use maximum value kx pairs patches bound transfer maximum radiance receivers due source cluster bounded z lydy maximum value kernel function must computed pair patches time complexity omn see figure 2 improve time complexity split kernel function two simpler functions k r x k x given new functions depends two points requires information orientation one surface k r source receiver figure 3 efficient fflink two clusters accounts projected area reflectivity differential area around x k corresponds differential solid angle subtended differential area around show separation kernel used conservatively bound interaction source cluster receiver cluster done bounding energy reaches receiving cluster source determining much energy potentially reaches receiving patch see figure 3 use pieces kernel bound radiance function point x first k r x replaced maximum value attains volume bs containing source patches sources replace k x maximum value attains source patch also assume visibility term always 1 steps produce following conservative upper bound z z dk e xs z lydy apply idea obtain upper bounds transfer two clusters quantity k x maximized points receiving volume br making k x independent particular receiver factor k r x maximized receiving patch separately thus radiance function bounded follows dk e brs z lydy expression separated two pieces defining z lydy bound flux density incident upon receiving bounding volume dk r e r j bs l max maximizing receiving patches r requires om work therefore time complexity computing bound reduced omn om n bounds needed hr computed upper lower bounds transfer given upper bounds trivial lower bound zero always used lower bound attained visibility points two clusters zero bound error interaction two clusters allows us determine interaction accurate enough bound clusters determines fflink acceptable approximation interaction addition error bound require estimate energy transferred receiving patch across fflink computing estimate well bound k r x associated receiving patch k x associated source patch let radiance receiving patch j estimated z lydy average bounded maximum transfer therefore falls within error bounds hence sufficiently accurate fact quite likely far accurate conservative bounds indicate show fflink clustering approach time space complexity os log first assume initial patches stored hierarchy clusters cluster containing two smaller clusters leaves single patch structuring results binary tree depth log total number clusters level 2 cluster level s2 patches following hanrahan et al 7 greengard 6 assume cluster linked constant c 1 number clusters resulting c 1 2 fflinks level also assume cluster linked clusters approximately level tree fflink two clusters requires space time proportional size clusters summing costs log levels hierarchy gives log num links link cost log therefore rather os 2 work required direct ap proach clustering using fflinks gives time space complexity os log 32 filinks many transfers previous technique still expensive often large numbers interactions insignificant treated coarsely ignored altogether 9 section introduce efficient cruder method bounding interaction two clusters using simple bound kernel kx denote k x bound requires knowledge orientation sur faces bound transfer energy two clusters replacing k maximum value k points x receiving cluster points source cluster see figure 4 thus upsilon z lydy source receiver figure 4 filink clusters worstcase bound transfer two clusters achieved surfaces close possible cluster source directly faces receivers virtue bound requires knowledge surfaces integral radiance source patches beencomputed advanceduring sweep operation described section 51 bound computed constant time fflinks use average value k two clusters estimate energy transferred since average value lies within range given maximum transfer minimum transfer zero meets error tolerance time space complexity system filinks equivalent complexity standard hierarchical radiosity method linking patches error term decreases rapidly dis tance cluster linked constant number clusters since number clusters linear number initial surfaces cost filink independent size clusters complexity os number initial surfaces 33 strategies linking described two different approaches linking clusters accurate clustering technique tends expensive many clusters large environment faster clustering technique coarse eliminate many negligible interac tions approach exploit strengths strategies coarse approach produce acceptable bound accurate technique invoked neither accurate enough clusters recursively subdivided level individual patches reached algorithm resort conventional hr linking criteria norms provide measure size function shall use two different norms quantify error energy transfer two patches clusters previous section computed bound maximum possible difference approximated radiance actual radiance points receiving object corresponds computing bound 1norm radiance function receiver due source formally l exact radiance function receiver e l computed radiance function one previous bounds transfer 1norm gives bound variation computed radiance actual radiance another useful bound energy difference computed actual radiance functions due link bound corresponds 1norm formally z r 1norm bounded weighting term receiver area receiver summing instead finding maximum value write bound fflinks z lydy j area receiver j coarse bounds patchto patch bounds computed similarly hierarchical solution norms easily accommodated norm used affects subdivision strategy performing local pass display solution error pixel important implies 1norm appropriate however global propagation energy throughout environment may useful minimize 1norm error intuitively large surfaces often much significant effect local pass smaller ones another useful norm obtained importance weighting 12 corresponds norm similar 1norm rather weighting receiver area receiver weighted importance 5 implementation 51 clustering ray tracing acceleration techniques collect nearby objects together groups octrees hierarchical bounding volumes form natural hierarchy hierarchy used identify clusters simplicity object appear one cluster otherwise method eliminating copies objects needed prevent object contributing cluster twice reasons chose use bounding volume hierarchies 4 instead octrees generate hierarchy clusters use axisaligned rectangular bounding boxes clusters ray casting hr algorithm combined bounding volume hierarchy perform clustering fairly easily bounds error given earlier fit naturally brightnessweighted refinement scheme hanrahan et al 7 approach first links surfaces together performs several iterations energy propagation refinement system error tolerance gradually reduced final error tolerance reached approach variation multigridding method iteratively solving systems linear equations modifications needed make bounding volume data structures useful clustering accurate clustering approach must loop patches bounding volume link contain four arrays hold maximum average values k source patches well maximum andaverage values k r receiving patches implementation maximum values approximated taking fixed number jittered samples patch bounding volume finding maximum value kernel points although method produce guaranteed bound tends produce good approximation two bounding volumes overlap maximum values unbounded case choose maximum based maximum potential transfer energy environment store estimate intercluster visibility link well visibility estimated using ray casting following pseudocode shows steps needed compute fflink two clusters createfflinksrc rec fflink foreach patch src foreach patch j rec ffboundt ffl return true else return false procedure ffboundt computes bound maximum amount energy transferred across fflink estimates maximum values k k r stored link integral radiance function l patch constant patches product radiance l area patch procedure computing error incurred fflink clusters shown following pseudocode foreach patch tsrc foreach patch j trec maxerr maxmaxerr trecmaxj srcerr return maxerr addition computing error links energy must transferred two clusters gather step hr energy transferred across link including cluster links gather across fflink performed follows foreach patch tsrc srcrad srcrad tvis foreach patch j trec coarse approach clustering using filinks store sum areas patches bounding volume also store radiance bounding volume use source irradiance striking bounding volume use receiver radiance patch receiving cluster updated time link used gather gathering single link would require linear time resulting worse complexity bounds coarse links hr transferring energy across links radiances must swept objects parents children clusters sweep slightly different sweep described hr since cluster holds irradiance incident upon radiance leaving irradiance pushed bounding volume hierarchy patches incident irradiance weighted reflectance patch resulting radiance pushed patches hr pulling radiance children parents hr parent receives areaweighted average radiances children following pseudocode used solving linear system redistribute energy gathered across links hsweep conventional hr sweep procedure sweepc c leaf foreach patch r c else foreach c 0 c lcl return l filinks clusters computed similar fashion fflinks easier compute however looping contents bounding volume required also maximum value k inverse square minimum distance clusters computed little work axis aligned bounding volumes filink stores maximum value best computed value k two clusters createfilinksrcrec filink vis estimatevisibilitysrcrec upsilon brecbsrc tavg vis ff brecbsrc fiboundt ffl return true else return false error filink clusters also straightforward following directly bounds transfer previous discussion higher accuracy links computing error filink implemented return tmax l tsrc tsrc gather phase algorithm filink transfers energy receiving cluster stored irradiance sweep phase scaled brdf procedures allow clusters patches environment linked together two bounding volumes linked possible first check complete occlusion done conservatively checking see convex object completely obstructs shaft source receiver two bounding volumes completely occluded fibound clusters checked sufficiently accurate ffbound checked still accurate enough children larger cluster recursively refined smaller cluster neither clusters children patches refined using patch refinement hr clustering algorithm begins using toplevel bounding box source receiver triggers recursive refinement 52 local pass global solution computed displaying result usually involves smoothing values computed patch patch boundaries visible done gouraud shading surfaces however prone artifacts hierarchical systems 12 better approach use techniques lischinki et al 9 create separate mesh display pur poses using information obtained global solution recomputing parts illumination surface approach based method well method proposed reichert 10 given view approximate intensity100001e06100 1000 10000 100000 link cost initial surfaces log trials figure 5 link cost environments different sizes compared function logs reconstructing radiance function visible point environment done taking collection links levels hierarchy directly affect point link recomputing form factor source point accuracy determined magnitude error links result either recomputing unoccluded form fac tor form factor visibility source point although method produces high quality results computationally expensive techniques paper address methods efficiently computing global pass research required accelerate local pass 6 results hr complexity bound ignoring visibility term os p number initial surfaces p number resulting patches os 2 term comes computing initial links initial surfaces using clustering need check pairs surfaces even mutually visible clustering replaces expensive initial linking step algorithm os log number initial surfaces results algorithm overall complexity os log p sections follow report results several different environments refinement strategies 61 link complexity first show cost links grows size environment first example inside sphere tessellated triangles triangle given emissive power reflectance allowed us vary large range values without really changingthe geometry also becauseevery surface see every surface easy determine exactly many initial links would needed without clustering also challenging environment clustering every cluster overlaps several clusters assign cost 1 patch links filinks cost fflinks number patches receiving cluster n number patches source cluster total link cost sum link costs link computed environment model refined using 1norm criterion links graph figure 5 shows link cost five tessellations ranging 128 patches 32768 initial patches well function costs closely match function largest tessellation conventional hr algorithm would need create store one billion initial links could b c figure 7 solutions different accuracies clustering ad without clustering eh100300500700900 minutes iterations b c clustering clustering figure time solutions increasing accuracy without clustering compute solution clustering links cost 02 reduction time space approximately 500 62 refinement complexity show howa solution refines time without clustering start environment 4170 initial surfaces illuminated three directional lights 8 emitting cubes refine solution initial linking stage eight iterations successively smaller error tolerances example used 1norm bound error interaction graph times global solution accuracy increases appears figure 6 solutions computed hp 755 384 megabytes memory prevent swapping computing solution without clustering images flat shaded patches shown several different levels accuracy figure 7 long thin polygons model create ideal clusters large variation position neither algorithm grows linearly number iterations algorithms simply linear number resulting patches clustering hr becomes progressive algorithm since initial results seen relatively quickly without clustering took 583 minutes first solution appear clustering reduced time 535 minutes speed one hundred times solutions refine rate linked eight iterations clustering solution resulted patches without clustering 114410 patches numbers close subdivision occur refining patch link done way algorithms bounds various kernels estimated using 81 samples visibility checked 81 rays clustering amortizes cost initial linking many refinements except simple environments amortization continues well beyond required levels accuracy amortization cost associated compensated reduced link maintenance need maintain os 2 initial links early iterations high accuracy unnecessary 63 importance also tested algorithm using importance weighted refinement used environment shown figure 7 view group chairs near stairs upper image shown figure 8 created viewdependent local pass described earlier paper global solution used local pass shown image global pass clustering took 3 minutes initial solution 53 minutes entire global solution creating 27318 patches without clustering initial linking took 728 minutes entire global pass took 790 minutes estimates form factor visibility error computed samples make local pass effective causing initial linking take longer previous example figure 8 image resulting local pass solution used local pass 7 conclusions future work clustering effective technique accelerating hr using two different error bounds energy transfer collections surfaces two types links cluster described using approaches hr algorithm reduces asymptotic complexity os 2 p os log p addition making hr progressive algorithm environments moderate complexity obtained speedups two orders magnitude approach presented enables hr work effectively even many mutually visible initial surfaces hierarchy clusters presented paper fairly straightforward modifications traditional bounding volume hi erarchies current research shows beneficial build 5d hierarchies spirit 1 bound direction patch normals well position used obtain tighter bounds transfers since patch orientations constrained implementation described two clusters even one pair patches facing may linked relatively expensive fflink 5d hierarchy seems reduce problem although lower bound zero energy transfers always valid tighter lower bounds two clusters would improve overall performance algorithm unlike upper bounds requires computing guaranteed bounds visibility potentially expensive operation currently implementation uses sampling approach determine upper bound transfer two patchs well transfer patches clusters although noticed serious problems result approximation analytic bounds transfers would produce guaranteed bounds guaranteed bounds transfers make possible examine global error solution mentioned 12 bounds transfers surfaces immediately provide bound total error solution acknowledgments would like thank dani lischinski discussionson complexity helpful comments paper also thanks go greg spencer software handling high dynamic range images work supported nsf grant interactive computer graphics input display techniques ccr8617880 nsfdarpa science technology center computer graphics scientific visualization asc8920219 authors gratefully acknowledge generous equipment grant hewlettpackard corporation r fast ray tracing ray classification progressivemultipass method global illumination efficient radiosity approach realistic image synthesis automatic creation object hierarchies ray tracing modeling interaction light diffuse surfaces rapid evaluation potential fields particle systems rapid hierarchical radiosity algorithm grouping patches progressive radiosity combining hierarchical radiosity discontinuity meshing geometric simplification indirect illumination calculations importancedriven radiosity algorithm global visibility illumination computations tr automatic creation object hierarchies ray tracing fast ray tracing ray classification progressive multipass method global illumination rapid hierarchical radiosity algorithm importancedriven radiosity algorithm combining hierarchical radiosity discontinuity meshing global visibility algorithms illumination computations ctr philipp slusallek marc stamminger wolfgang heidrich janchristian popp hanspeter seidel composite lighting simulations lighting networks ieee computer graphics applications v18 n2 p2231 march 1998 simon gibson roger j hubbold perceptuallydriven parallel algorithm efficient radiosity simulation ieee transactions visualization computer graphics v6 n3 p220235 july 2000 ingo wald carsten benthin philipp slusallek interactive global illumination complex highly occluded environments proceedings 14th eurographics workshop rendering june 2527 2003 leuven belgium luc renambot bruno arnaldi thierry priol xavier pueyo towards efficient parallel radiosity dsmbased parallel computers using virtual interfaces proceedings ieee symposium parallel rendering p7986 october 2021 1997 phoenix arizona united states fraois sillion george drettakis featurebased control visibility error multiresolution clustering algorithm global illumination proceedings 22nd annual conference computer graphics interactive techniques p145152 september 1995 seth teller celeste fowler thomas funkhouser pat hanrahan partitioning ordering large radiosity computations proceedings 21st annual conference computer graphics interactive techniques p443450 july 1994 bruce walter sebastian fernandez adam arbree kavita bala michael donikian donald p greenberg lightcuts scalable approach illumination acm transactions graphics tog v24 n3 july 2005 thomas funkhouser coarsegrained parallelism hierarchical radiosity using group iterative methods proceedings 23rd annual conference computer graphics interactive techniques p343352 august 1996 cline loscos george drettakis luc robert interactive virtual relighting real scenes ieee transactions visualization computer graphics v6 n4 p289305 october 2000 david zareski bretton wade philip hubbard peter shirley efficient parallel global illumination using density estimation proceedings ieee symposium parallel rendering p4754 october 3031 1995 atlanta georgia united states michael garland andrew willmott paul heckbert hierarchical face clustering polygonal surfaces proceedings 2001 symposium interactive 3d graphics p4958 march 2001 l alonso f cuny petit jean jc paul lazard e wies virtual mesh geometric abstraction efficiently computing radiosity acm transactions graphics tog v20 n3 p169201 july 2001 tom mertens jan kautz philippe bekaert hanspeter seidelz frank van reeth interactive rendering translucent deformable objects proceedings 14th eurographics workshop rendering june 2527 2003 leuven belgium ignacio martn xavier pueyo dani tost frametoframe coherent animation twopass radiosity ieee transactions visualization computer graphics v9 n1 p7084 january kirill dmitriev thomas annen grzegorz krawczyk karol myszkowski hanspeter seidel cave system interactive modeling global illumination car interior proceedings acm symposium virtual reality software technology november 1012 2004 hong kong grgory lecot bruno lvy laurent alonso jeanclaude paul masterelement vector irradiance large tessellated models proceedings 3rd international conference computer graphics interactive techniques australasia south east asia november 29december 02 2005 dunedin new zealand bruce walter philip hubbard peter shirley donald p greenberg global illumination using local linear density estimation acm transactions graphics tog v16 n3 p217259 july 1997 cyril soler f x sillion texturebased visibility efficient lighting simulation acm transactions graphics tog v19 n4 p302342 oct 2000 xavier granier george drettakis final reconstruction approach unified global illumination algorithm acm transactions graphics tog v23 n2 p163189 april 2004 daniel meneveaux kadi bouatouch gilles subrenat philippe blasi efficient clustering visibility calculation global illumination proceedings 2nd international conference computer graphics virtual reality visualisation interaction africa february 0305 2003 cape town south africa franois x sillion unified hierarchical algorithm global illumination scattering volumes object clusters ieee transactions visualization computer graphics v1 n3 p240254 september 1995 per h christensen dani lischinski eric j stollnitz david h salesin clustering glossy global illumination acm transactions graphics tog v16 n1 p333 jan 1997 marco pellegrini rendering equation revisited avoid explicit visibility computations proceedings tenth annual acmsiam symposium discrete algorithms p725733 january 1719 1999 baltimore maryland united states per h christensen eric j stollnitz david h salesin tony derose global illumination glossy environments using wavelets importance acm transactions graphics tog v15 n1 p3771 jan 1996 volevich karol myszkowski andrei khodulev edward kopylov using visual differences predictor improve performance progressive global illumination computation acm transactions graphics tog v19 n2 p122161 april 2000 philipp slusallek hanspeter seidel vision architecture global illumination calculations ieee transactions visualization computer graphics v1 n1 p7796 march 1995 cyril soler franois x sillion frdric blaise philippe dereffye efficient instantiation algorithm simulating radiant energy transfer plant models acm transactions graphics tog v22 n2 p204233 april donald p greenberg kenneth e torrance peter shirley james arvo eric lafortune james ferwerda bruce walter ben trumbore sumanta pattanaik singchoong foo framework realistic image synthesis proceedings 24th annual conference computer graphics interactive techniques p477494 august 1997